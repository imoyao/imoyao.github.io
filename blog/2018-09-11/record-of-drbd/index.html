<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>DRBD å¤‡å¿˜è®°å½• | åˆ«é™¢ç‰§å¿—</title><meta name="keywords" content="DRBD,å­˜å‚¨,é›†ç¾¤"><meta name="author" content="imoyao,immoyao@gmail.com"><meta name="copyright" content="imoyao"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="è¿™æ˜¯ä¸€ä¸ªå…³äº DRBD çš„ä½¿ç”¨å¤‡å¿˜å½•ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="DRBD å¤‡å¿˜è®°å½•">
<meta property="og:url" content="https://www.masantu.com/blog/2018-09-11/record-of-drbd/index.html">
<meta property="og:site_name" content="åˆ«é™¢ç‰§å¿—">
<meta property="og:description" content="è¿™æ˜¯ä¸€ä¸ªå…³äº DRBD çš„ä½¿ç”¨å¤‡å¿˜å½•ã€‚">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img.xjh.me/random_img.php?type=bg&ctype=nature&return=302">
<meta property="article:published_time" content="2018-09-11T09:56:38.000Z">
<meta property="article:modified_time" content="2021-01-20T14:14:12.698Z">
<meta property="article:author" content="imoyao">
<meta property="article:tag" content="DRBD">
<meta property="article:tag" content="å­˜å‚¨">
<meta property="article:tag" content="é›†ç¾¤">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img.xjh.me/random_img.php?type=bg&ctype=nature&return=302"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="https://www.masantu.com/blog/2018-09-11/record-of-drbd/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//hm.baidu.com"><link rel="preconnect" href="//fonts.googleapis.com" crossorigin><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="preconnect" href="//zz.bdstatic.com"><meta name="baidu-site-verification" content="code-ODCD2GPxMT"><meta name="yandex-verification" content="{&quot;theme_color&quot;:{&quot;enable&quot;:true,&quot;main&quot;:&quot;#49B1F5&quot;,&quot;paginator&quot;:&quot;#55af7b&quot;,&quot;button_hover&quot;:&quot;#FF7242&quot;,&quot;text_selection&quot;:&quot;#55af7b&quot;,&quot;link_color&quot;:&quot;#99a9bf&quot;,&quot;meta_color&quot;:&quot;#858585&quot;,&quot;hr_color&quot;:&quot;#A4D8FA&quot;,&quot;code_foreground&quot;:&quot;#F47466&quot;,&quot;code_background&quot;:&quot;rgba(27, 31, 35, .05)&quot;,&quot;toc_color&quot;:&quot;#55af7b&quot;,&quot;blockquote_padding_color&quot;:&quot;#49b1f5&quot;,&quot;blockquote_background_color&quot;:&quot;#49b1f5&quot;}}"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?231bfe4abce99ac3586b516eef2ea05e";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload="this.media='all'"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç®€"},
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'å¤©',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"ä½ å·²åˆ‡æ¢ä¸ºç¹ä½“","cht_to_chs":"ä½ å·²åˆ‡æ¢ä¸ºç®€ä½“","day_to_night":"ä½ å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼","night_to_day":"ä½ å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}

// https://stackoverflow.com/questions/16839698/jquery-getscript-alternative-in-native-javascript
const getScript = url => new Promise((resolve, reject) => {
  const script = document.createElement('script')
  script.src = url
  script.async = true
  script.onerror = reject
  script.onload = script.onreadystatechange = function() {
    const loadState = this.readyState
    if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
    script.onload = script.onreadystatechange = null
    resolve()
  }
  document.head.appendChild(script)
})</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-01-20 22:14:12'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}})()</script><meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/atom.xml" title="åˆ«é™¢ç‰§å¿—" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" data-lazy-src="https://cdn.jsdelivr.net/gh/masantu/statics/images/imoyao.jpg" onerror="onerror=null;src='/img/Ellipsis-5s-210px.svg'" alt="avatar"></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">76</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">101</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">13</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="external nofollow noopener noreferrer" href="https://wiki.masantu.com/"><i class="fa-fw fa fa-book"></i><span> Wiki</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fas fa-user-friends"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i><span> More</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/douban/"><i class="fa-fw fa fa-history"></i><span> B&amp;M History</span></a></li><li><a class="site-page" href="/whisper/"><i class="fa-fw far fa-comment-dots"></i><span> Whisper</span></a></li></ul></div></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://img.xjh.me/random_img.php?type=bg&amp;ctype=nature&amp;return=302)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">åˆ«é™¢ç‰§å¿—</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="external nofollow noopener noreferrer" href="https://wiki.masantu.com/"><i class="fa-fw fa fa-book"></i><span> Wiki</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fas fa-user-friends"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i><span> More</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/douban/"><i class="fa-fw fa fa-history"></i><span> B&amp;M History</span></a></li><li><a class="site-page" href="/whisper/"><i class="fa-fw far fa-comment-dots"></i><span> Whisper</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">DRBD å¤‡å¿˜è®°å½•</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2018-09-11T09:56:38.000Z" title="å‘è¡¨äº 2018-09-11 17:56:38">2018-09-11</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2021-01-20T14:14:12.698Z" title="æ›´æ–°äº 2021-01-20 22:14:12">2021-01-20</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%99%E7%A8%8B%E8%AE%B0%E5%BD%95/">æ•™ç¨‹è®°å½•</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><!--åªåœ¨é¦–é¡µï¼ˆhomepageï¼‰åŠ è½½æè¿°é¡µé¢ï¼Œçµæ„Ÿæ¥æºï¼šblinkfox/hexo-theme-matery--><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><script src="\assets\js\APlayer.min.js"> </script><p>è¿™æ˜¯ä¸€ä¸ªå…³äº <code>DRBD</code> çš„ä½¿ç”¨å¤‡å¿˜å½•ã€‚<br><a id="more"></a></p>
<p><img src="/img/loading.svg" data-lazy-src="/images/DRBD-Diagram.png" alt="DRBDåœ¨Linuxå†…æ ¸I/Oæ ˆçš„ä½ç½®"></p>
<p>å¼€å§‹é˜…è¯»ä¹‹å‰ï¼Œè¯·å…ˆæ³¨æ„ç¤ºä¾‹ä¸­ä½¿ç”¨çš„ DRBD ç‰ˆæœ¬</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">drbdadm -V</span><br><span class="line"><span class="meta">#</span><span class="bash"> DRBDADM_VERSION=8.4.3</span></span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼šå®‰è£…çš„ kernel-devel çš„å†…æ ¸æºç ï¼ˆå†…æ ¸æºç è·¯å¾„/usr/src/kernel/ï¼‰å’Œå½“å‰ç³»ç»Ÿçš„ kernel ç‰ˆæœ¬(uname -r)ä¸ä¸€è‡´çš„è¯éœ€è¦æŠŠå½“å‰å†…æ ¸æ›´æ–°ä¸€ä¸‹ã€‚<br>åœ¨<code>2.6.33</code>åŠä»¥ä¸Šç‰ˆæœ¬çš„å†…æ ¸é»˜è®¤ä¸­æœ‰<code>DRBD</code>,ä¹‹å‰åœ¨ç”¨çš„<code>DRBD</code>ä¸»è¦<code>8.0</code>ã€<code>8.2</code>ã€<code>8.3</code> ä¸‰ä¸ªç‰ˆæœ¬,å¯¹åº”çš„<code>rpm</code>åŒ…æ˜¯<code>drbd</code>,<code>drbd82</code>å’Œ<code>drbd83</code>ï¼Œå› æ­¤éœ€è¦å®‰è£…å¯¹åº”çš„å†…æ ¸æ¨¡å—ï¼Œå¯¹åº”çš„åå­—ä¸º<code>kmod-drbd</code>,<code>kmod-drbd82</code>,<code>kmod-drbd83</code>ã€‚<br>ç”±äº<code>drbd</code>æ˜¯ä½œä¸ºå†…æ ¸æ¨¡å—è¿›è¡Œå·¥ä½œçš„ï¼Œæ•…å»ºè®®ä½¿ç”¨ä¸å†…æ ¸å¯¹åº”çš„ç‰ˆæœ¬ï¼Œå¯¹åº”å…³ç³»å¦‚ä¸‹è¡¨ã€‚</p>
<table>
<thead>
<tr>
<th style="text-align:left">Linux releases</th>
<th style="text-align:left">DRBD releases</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">2.6.33</td>
<td style="text-align:left">8.3.7</td>
</tr>
<tr>
<td style="text-align:left">2.6.34</td>
<td style="text-align:left">8.3.7</td>
</tr>
<tr>
<td style="text-align:left">2.6.35</td>
<td style="text-align:left">8.3.8</td>
</tr>
<tr>
<td style="text-align:left">2.6.36</td>
<td style="text-align:left">8.3.8.1</td>
</tr>
<tr>
<td style="text-align:left">2.6.37</td>
<td style="text-align:left">8.3.9</td>
</tr>
<tr>
<td style="text-align:left">2.6.38</td>
<td style="text-align:left">8.3.9</td>
</tr>
<tr>
<td style="text-align:left">2.6.39</td>
<td style="text-align:left">8.3.10</td>
</tr>
<tr>
<td style="text-align:left">3.0 - 3.4</td>
<td style="text-align:left">8.3.11</td>
</tr>
<tr>
<td style="text-align:left">3.5 - 3.7</td>
<td style="text-align:left">8.3.13</td>
</tr>
</tbody>
</table>
<p><strong>æ³¨æ„:</strong>ç›®å‰å®˜ç½‘ä¸Šé¢ 8.0 â€“ 8.3.x å·²æ ‡æ³¨ä¸º<code>Deprecated</code>å³ä¸å»ºè®®ä½¿ç”¨çŠ¶æ€ã€‚</p>
<h2 id="drbd-çŠ¶æ€è®°å½•"><a href="#drbd-çŠ¶æ€è®°å½•" class="headerlink" title="drbd çŠ¶æ€è®°å½•"></a>drbd çŠ¶æ€è®°å½•</h2><p>æœ¬éƒ¨åˆ†å†…å®¹è¯¦è§<a href="/blog/2018-08-29/state-of-drbd/">æ­¤å¤„</a></p>
<h2 id="æ¸…é™¤å•ä¸ª-DRBD-èµ„æºé…ç½®ï¼š-ä»¥-drbd10-ä¸ºä¾‹"><a href="#æ¸…é™¤å•ä¸ª-DRBD-èµ„æºé…ç½®ï¼š-ä»¥-drbd10-ä¸ºä¾‹" class="headerlink" title="æ¸…é™¤å•ä¸ª DRBD èµ„æºé…ç½®ï¼š(ä»¥ drbd10 ä¸ºä¾‹)"></a>æ¸…é™¤å•ä¸ª <code>DRBD</code> èµ„æºé…ç½®ï¼š(ä»¥ drbd10 ä¸ºä¾‹)</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">drbd-overview       # drbdæ¦‚è§ˆ</span><br><span class="line">drbdadm down drbd10         #down drbd</span><br><span class="line">echo yes|drbdadm wipe-md drbd10     #æ¸…é™¤metadata</span><br><span class="line">cd /etc/drbd.d/         # æ³¨æ„ï¼Œæ­¤å¤„æ ¹æ®drbdç‰ˆæœ¬ä¸åŒä¹Ÿå¯èƒ½åœ¨/usr/local/etc/drbd.d/</span><br><span class="line">rm drbd10.res           #åˆ é™¤resourceæ–‡ä»¶</span><br></pre></td></tr></table></figure>
<h2 id="é‡å¯-DRBD-æœåŠ¡"><a href="#é‡å¯-DRBD-æœåŠ¡" class="headerlink" title="é‡å¯ DRBD æœåŠ¡"></a>é‡å¯ <code>DRBD</code> æœåŠ¡</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">service drbd stop </span><br><span class="line">service drbd start </span><br></pre></td></tr></table></figure>
<h2 id="DRBDæ‰©å®¹"><a href="#DRBDæ‰©å®¹" class="headerlink" title="DRBDæ‰©å®¹"></a><code>DRBD</code>æ‰©å®¹</h2><p>å½“é‡åˆ°æˆ‘ä»¬çš„<code>drbd resource</code>è®¾å¤‡å®¹é‡ä¸å¤Ÿçš„æ—¶å€™ï¼Œè€Œä¸”æˆ‘ä»¬çš„åº•å±‚è®¾å¤‡æ”¯æŒåœ¨çº¿å¢å¤§å®¹é‡çš„æ—¶å€™ï¼ˆæ¯”å¦‚ lvmï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå¢å¤§åº•å±‚è®¾å¤‡çš„å¤§å°ï¼Œç„¶åå†é€šè¿‡<code>drbdadm resize resource_name</code>æ¥å®ç°å¯¹<code>resource</code>çš„æ‰©å®¹ã€‚<br>è¿™é‡Œæœ‰éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<br>åªæœ‰åœ¨å•ä¸»æ¨¡å¼ä¸‹å¯ä»¥è¿™æ ·åšï¼Œè€Œä¸”éœ€è¦å…ˆåœ¨ä¸¤èŠ‚ç‚¹ä¸Šéƒ½å¢å¤§åº•å±‚è®¾å¤‡çš„å®¹é‡ï¼Œç„¶åä»…åœ¨ä¸»èŠ‚ç‚¹ä¸Šæ‰§è¡Œ<code>resize</code>å‘½ä»¤ã€‚</p>
<p>åœ¨æ‰§è¡Œäº†<code>resize</code>å‘½ä»¤åï¼Œå°†è‡ªåŠ¨è§¦å‘ä¸€æ¬¡å½“å‰ä¸»èŠ‚ç‚¹åˆ°å…¶ä»–æ‰€æœ‰ä»èŠ‚ç‚¹çš„ re-synchronizationï¼›</p>
<p>å¦‚æœæˆ‘ä»¬åœ¨<code>drbd</code>éå·¥ä½œçŠ¶æ€ä¸‹å¯¹åº•å±‚è®¾å¤‡è¿›è¡Œäº†æ‰©å®¹ï¼Œç„¶åå†å¯åŠ¨<code>drbd</code>ï¼Œå°†ä¸éœ€è¦æ‰§è¡Œ<code>resize</code>å‘½ä»¤ï¼ˆå½“ç„¶å‰ææ˜¯åœ¨é…ç½®æ–‡ä»¶ä¸­æ²¡æœ‰å¯¹ disk å‚æ•°é¡¹æŒ‡å®šå¤§å°ï¼‰ï¼Œ<code>drbd</code>è‡ªå·±ä¼šçŸ¥é“å·²ç»å¢å¤§äº†å®¹é‡ï¼›</p>
<p>åœ¨è¿›è¡Œåº•å±‚è®¾å¤‡çš„å¢å®¹æ“ä½œçš„æ—¶å€™åƒä¸‡ä¸è¦ä¿®æ”¹åˆ°åŸè®¾å¤‡ä¸Šé¢çš„æ•°æ®ï¼Œå°¤å…¶æ˜¯<code>drbd</code>çš„<code>meta</code>ä¿¡æ¯ï¼Œå¦åˆ™æœ‰å¯èƒ½æ¯æ‰æ‰€æœ‰æ•°æ®ã€‚</p>
<h3 id="æµç¨‹ç®€å•ç¤ºä¾‹"><a href="#æµç¨‹ç®€å•ç¤ºä¾‹" class="headerlink" title="æµç¨‹ç®€å•ç¤ºä¾‹"></a>æµç¨‹ç®€å•ç¤ºä¾‹</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> å…ˆåœ¨ä¸¤ç«¯æ‰©å±•Lunï¼ˆéœ€è¦ç›¸åŒå¤§å°ï¼‰</span>     </span><br><span class="line">lvextend -Ll(50G) lvpath</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> drbdä»ç«¯ï¼šï¼ˆåŒä¸»æ¨¡å¼åˆ‡æ¢ä¸ºä¸»ä»æ¨¡å¼ï¼‰</span></span><br><span class="line">drbdadm secondary drbd[Num]     </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> drbdä¸»ç«¯ï¼š</span></span><br><span class="line">drbdadm resize drbd[Num]</span><br></pre></td></tr></table></figure>
<h2 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h2><h3 id="global-common-conf-é…ç½®ï¼ˆç¤ºä¾‹ï¼‰"><a href="#global-common-conf-é…ç½®ï¼ˆç¤ºä¾‹ï¼‰" class="headerlink" title="global_common.conf é…ç½®ï¼ˆç¤ºä¾‹ï¼‰"></a>global_common.conf é…ç½®ï¼ˆç¤ºä¾‹ï¼‰</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">global &#123;</span><br><span class="line">    usage-count no;     # æ˜¯å¦å‘å®˜æ–¹å‘é€ç»Ÿè®¡æŠ¥å‘Šï¼ˆå½±å“æ€§èƒ½ï¼‰</span><br><span class="line">&#125;</span><br><span class="line">common &#123;            # å®šä¹‰drbdè®¾å¤‡å…±äº«çš„å±æ€§ä¿¡æ¯</span><br><span class="line">    handlers &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    startup &#123;       # å¯åŠ¨æ—¶å€™çš„ç›¸å…³è®¾ç½®</span><br><span class="line">        wfc-timeout 50;</span><br><span class="line">        become-primary-on both;     # å…è®¸åŒä¸»</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    disk &#123;</span><br><span class="line">        on-io-error detach;     # é…ç½®I/Oé”™è¯¯å¤„ç†ç­–ç•¥ä¸ºåˆ†ç¦»</span><br><span class="line">        no-disk-flushes ;</span><br><span class="line">        no-disk-barrier;</span><br><span class="line">        c-plan-ahead 0;</span><br><span class="line">        c-fill-target 24M;</span><br><span class="line">        c-min-rate 80M;</span><br><span class="line">        c-max-rate 720M;</span><br><span class="line">    &#125; </span><br><span class="line">    net &#123;               # ç½‘ç»œé…ç½®ç›¸å…³</span><br><span class="line">        protocol C;     # åŒæ­¥å¼‚æ­¥æ§åˆ¶ï¼ˆè§ä¸‹æ–¹ä»‹ç»ï¼‰</span><br><span class="line">        after-sb-0pri discard-younger-primary;  # è„‘è£‚ä¿®å¤</span><br><span class="line">        after-sb-1pri discard-secondary;</span><br><span class="line">        after-sb-2pri call-pri-lost-after-sb;</span><br><span class="line">        allow-two-primaries yes;        # å…è®¸åŒä¸»</span><br><span class="line">        max-buffers        36k;</span><br><span class="line">        sndbuf-size         1024k ;</span><br><span class="line">        rcvbuf-size      2048k;</span><br><span class="line">    &#125;</span><br><span class="line">    syncer &#123;    # åŒæ­¥ç›¸å…³çš„è®¾ç½®</span><br><span class="line">            rate                   4194304k;    # bytes/second</span><br><span class="line">            al-extents              6433;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#</span><span class="bash"> Read_More:http://tech.sina.com.cn/smb/2008-12-22/1050926302.shtml</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="æ•°æ®åŒæ­¥åè®®"><a href="#æ•°æ®åŒæ­¥åè®®" class="headerlink" title="æ•°æ®åŒæ­¥åè®®"></a>æ•°æ®åŒæ­¥åè®®</h3><p><code>DRBD</code>æœ‰ä¸‰ç§æ•°æ®åŒæ­¥æ¨¡å¼:åŒæ­¥ï¼Œå¼‚æ­¥ï¼ŒåŠåŒæ­¥</p>
<ol>
<li>å¼‚æ­¥ï¼šæŒ‡çš„æ˜¯å½“æ•°æ®å†™åˆ°ç£ç›˜ä¸Šï¼Œå¹¶ä¸”å¤åˆ¶çš„æ•°æ®å·²ç»è¢«æ”¾åˆ°æˆ‘ä»¬çš„<code>tcp</code>ç¼“å†²åŒºå¹¶ç­‰å¾…å‘é€ä»¥åï¼Œå°±è®¤ä¸ºå†™å…¥å®Œæˆï¼›</li>
<li>åŠåŒæ­¥ï¼šæŒ‡çš„æ˜¯æ•°æ®å·²ç»å†™åˆ°ç£ç›˜ä¸Šï¼Œå¹¶ä¸”è¿™äº›æ•°æ®å·²ç»å‘é€åˆ°å¯¹æ–¹å†…å­˜ç¼“å†²åŒºï¼Œå¯¹æ–¹çš„<code>tcp</code>å·²ç»æ”¶åˆ°æ•°æ®ï¼Œå¹¶å®£å¸ƒå†™å…¥ï¼›</li>
<li>åŒæ­¥ï¼šæŒ‡çš„æ˜¯ä¸»èŠ‚ç‚¹å·²å†™å…¥ï¼Œä»èŠ‚ç‚¹ç£ç›˜ä¹Ÿå†™å…¥ï¼›</li>
</ol>
<p><code>DRBD</code>çš„å¤åˆ¶æ¨¡å‹æ˜¯é <code>protocol</code>å…³é”®å­—æ¥å®šä¹‰çš„ï¼š<code>protocol A</code>è¡¨ç¤ºå¼‚æ­¥ï¼›<code>protocol B</code>è¡¨ç¤ºåŠåŒæ­¥ï¼›<code>protocol C</code>è¡¨ç¤ºåŒæ­¥ï¼Œé»˜è®¤ä¸º<code>protocol C</code>ã€‚</p>
<p>åœ¨åŒæ­¥æ¨¡å¼ä¸‹åªæœ‰ä¸»ã€ä»èŠ‚ç‚¹ä¸Šä¸¤å—ç£ç›˜åŒæ—¶æŸå®³æ‰ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚åœ¨åŠåŒæ­¥æ¨¡å¼ä¸‹åªæœ‰ä¸»èŠ‚ç‚¹å®•æœºï¼ŒåŒæ—¶ä»èŠ‚ç‚¹å¼‚å¸¸åœç”µæ‰ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚</p>
<p><strong>æ³¨æ„:</strong></p>
<ol>
<li>ä¸»ä»æ‰€åœ¨çš„ç£ç›˜åˆ†åŒºæœ€å¥½å¤§å°ç›¸ç­‰,<code>DRBD</code>ç£ç›˜é•œåƒç›¸å½“äºç½‘ç»œ<code>RAID1</code>ï¼›ï¼ˆæœ¬äººä½¿ç”¨æ—¶å¼ºåˆ¶ç›¸ç­‰ï¼Œä½†ç½‘ä¸Šæ²¡æœ‰å…³äºåˆ†åŒºå¤§å°æ˜¯å¦ä¸€å®šè¦ç›¸åŒçš„ç¡®åˆ‡è¯´æ³•ï¼‰</li>
<li>ç½‘ç»œåŒæ­¥æ—¶éœ€è¦ä¸€å®šçš„æ—¶é—´ï¼Œåœ¨åŒæ­¥å®Œæˆä¹‹å‰æœ€å¥½ä¸è¦é‡å¯ï¼Œå¦åˆ™ä¼šé‡æ–°åŒæ­¥ï¼›</li>
<li><code>DRBD</code>çš„ä¸»èŠ‚ç‚¹ä¸ä¼šç›‘æ§ä»èŠ‚ç‚¹çš„çŠ¶æ€ï¼Œæ‰€ä»¥æœ‰å¯èƒ½ä¼šé€ æˆæ•°æ®é‡ä¼ ï¼›</li>
<li>æ ¼å¼åŒ–åªéœ€è¦åœ¨<code>primary</code>èŠ‚ç‚¹ä¸Šè¿›è¡Œ,ä¸”åªèƒ½åœ¨ä¸»èŠ‚ç‚¹ä¸ŠæŒ‚è½½ï¼›è‹¥ä¸»èŠ‚ç‚¹ä¸‹çº¿,ä»èŠ‚ç‚¹ä¸Šçº¿,åˆ™ä»èŠ‚ç‚¹å¯ä»¥ç›´æ¥æŒ‚è½½,ä¸éœ€è¦å†æ¬¡æ ¼å¼åŒ–ã€‚é›†ç¾¤ä¸­åªæœ‰ primary æœåŠ¡å™¨å¯ä»¥æŒ‚è½½è®¾å¤‡ï¼Œsecondary æŒ‚è½½ä¼šæŠ¥é”™ã€‚åªæœ‰åœ¨è¿›è¡Œæ•…éšœè¿ç§»å‡çº§ä¸ºä¸»æ—¶æ‰éœ€è¦æŒ‚è½½ã€‚</li>
<li>å¦‚æœ<code>DRBD</code>çŠ¶æ€ä¸‹å…³æœºåŒæ§æ¢å¤ä¸è¿‡æ¥ï¼Œå°è¯•åˆ é™¤<code>DRBD</code>é…ç½®ä¿¡æ¯ï¼Œç„¶ååœæ‰<code>DRBD</code>ç«¯ ODSP å’Œ<code>mysql</code>é‡å¯ä¹‹åå³å¯ï¼›(æ­¤æ¡ä»…é’ˆå¯¹å…¬å¸é¡¹ç›®)</li>
</ol>
<h3 id="å•ä¸ªdrbdé…ç½®æ–‡ä»¶ï¼ˆä»¥-drbd10-res-ä¸ºä¾‹ï¼‰"><a href="#å•ä¸ªdrbdé…ç½®æ–‡ä»¶ï¼ˆä»¥-drbd10-res-ä¸ºä¾‹ï¼‰" class="headerlink" title="å•ä¸ªdrbdé…ç½®æ–‡ä»¶ï¼ˆä»¥ drbd10.res ä¸ºä¾‹ï¼‰"></a>å•ä¸ª<code>drbd</code>é…ç½®æ–‡ä»¶ï¼ˆä»¥ drbd10.res ä¸ºä¾‹ï¼‰</h3><ul>
<li><p>é¡¹ç›®ä¸­çš„é…ç½®æ–¹æ¡ˆ</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">resource drbd11 &#123;</span><br><span class="line">    on controller-1 &#123;</span><br><span class="line">        device /dev/drbd11;</span><br><span class="line">        disk /dev/StorPool11/SANLun11;</span><br><span class="line">        address 192.168.2.10:57811;</span><br><span class="line">        meta-disk internal;</span><br><span class="line">    &#125;</span><br><span class="line">    on controller-2 &#123;</span><br><span class="line">        device /dev/drbd11;</span><br><span class="line">        disk /dev/StorPool11/SANLun11;</span><br><span class="line">        address 192.168.2.18:57811;</span><br><span class="line">        meta-disk internal;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>å¦å¤–ä¸€ç§é…ç½®æ–¹æ¡ˆ<br>æ¥è‡ª<a target="_blank" rel="external nofollow noopener noreferrer" href="https://documentation.suse.com/zh-cn/sle-ha/15-GA/html/SLE-HA-all/cha-ha-drbd.html#pro-drbd-configure">è¿™é‡Œ</a></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">resource r0 &#123;   # â‘ </span><br><span class="line">  device /dev/drbd0; # â‘¡</span><br><span class="line">  disk /dev/sda1;   # â‘¢</span><br><span class="line">  meta-disk internal;   # â‘£</span><br><span class="line">  on alice &#123;    # â‘¤</span><br><span class="line">    address  192.168.1.10:7788;     # â‘¥</span><br><span class="line">  &#125;</span><br><span class="line">  on bob &#123; </span><br><span class="line">    address 192.168.1.11:7788; </span><br><span class="line">  &#125;</span><br><span class="line">  syncer &#123;</span><br><span class="line">    rate  7M;   # â‘¦</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç¿»è¯‘ä»¥çœ‹æ‡‚ä¸ºç›®çš„ï¼š   </p>
</li>
</ul>
<ol>
<li>å…è®¸æŸäº›ç³»ç»ŸæœåŠ¡é¡¹å…³è”çš„åç§°ï¼Œå¦‚ï¼šnfs, http, mysql_0, postgres_wal ç­‰ï¼›<br>Name that allows some association to the service that needs them. For example, nfs, http, mysql_0, postgres_wal, etc.</li>
<li><code>DRBD</code>è®¾å¤‡åç§°åŠç¼–å·ï¼›<br>The device name for DRBD and its minor number.<br>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ<code>drbd</code>çš„ç¼–å·æ˜¯<code>0</code>ã€‚udev é›†æˆè„šæœ¬æä¾›ç¬¦å·é“¾æ¥<code>/dev/drbd/by-res/nfs/0</code>ã€‚æˆ–è€…ï¼Œä¹Ÿå¯ä»¥çœç•¥é…ç½®ä¸­çš„è®¾å¤‡èŠ‚ç‚¹åç§°ï¼Œç„¶åä½¿ç”¨ä¸‹é¢è¿™ç§å½¢å¼ä»£æ›¿ï¼š<br><code>drbd0 minor 0</code>ï¼ˆ/dev/å¯é€‰ï¼‰æˆ–<code>/dev/drbd0</code>ï¼›<br>In the example above, the minor number 0 is used for DRBD. The udev integration scripts will give you a symbolic link /dev/drbd/by-res/nfs/0. Alternatively, omit the device node name in the configuration and use the following line instead:<br>drbd0 minor 0 (/dev/ is optional) or /dev/drbd0</li>
<li>èŠ‚ç‚¹ä¹‹é—´è¿›è¡Œå¤åˆ¶çš„åŸå§‹è®¾å¤‡ã€‚æ³¨æ„ï¼šåœ¨æœ¬ä¾‹ä¸­ï¼Œä¸¤ä¸ªèŠ‚ç‚¹ä¸Šé¢çš„è®¾å¤‡æ˜¯ç›¸åŒçš„ã€‚è‹¥ä½¿ç”¨ä¸åŒè®¾å¤‡ï¼Œè¯·å°†ç£ç›˜å‚æ•°ç§»åŠ¨åˆ°çŠ¶æ€ä¸º<code>on</code>èŠ‚ç‚¹ä¸Šã€‚ï¼ˆï¼Ÿï¼‰<br>The raw device that is replicated between nodes. Note, in this example the devices are the same on both nodes. If you need different devices, move the disk parameter into the on host.</li>
<li><code>meta-disk</code>å‚æ•°é€šå¸¸åŒ…å«éšå¼å€¼<code>internal</code>ï¼Œä½†æ˜¯ä½ ä¹Ÿå¯ä»¥æŒ‡å®šä¸€ä¸ªæ˜¾å¼è®¾å¤‡ä¿å­˜å…ƒæ•°æ®ã€‚è¯¦æƒ…å‚è§ï¼š<a target="_blank" rel="external nofollow noopener noreferrer" href="http://www.drbd.org/users-guide-emb/ch-internals.html#s-metadata">è¿™é‡Œ&gt;&gt;&gt;</a><br>The meta-disk parameter usually contains the value internal, but it is possible to specify an explicit device to hold the meta data. See <a target="_blank" rel="external nofollow noopener noreferrer" href="http://www.drbd.org/users-guide-emb/ch-internals.html#s-metadata">http://www.drbd.org/users-guide-emb/ch-internals.html#s-metadata</a> for more information.</li>
<li><code>on</code>èŠ‚é…ç½®æŒ‡æ˜æ”¹é…ç½®åº”ç”¨äºå…·ä½“å“ªä¸ª<code>host</code>ä¸»æœºã€‚<br>The on section states which host this configuration statement applies to.</li>
<li>å„èŠ‚ç‚¹çš„<code>IP</code>åœ°å€å’Œç«¯å£å·ã€‚æ¯ä¸ªèµ„æºéœ€è¦ä¸€ä¸ªå•ç‹¬çš„ç«¯å£ï¼Œé€šå¸¸ä»<code>7788</code>å¼€å§‹ã€‚DRBD èµ„æºçš„ä¸¤ä¸ªç«¯å£å¿…é¡»ç›¸åŒã€‚<br>The IP address and port number of the respective node. Each resource needs an individual port, usually starting with 7788.</li>
<li>åŒæ­¥ç‡ã€‚å°†å…¶è®¾ç½®ä¸ºç£ç›˜è¯»å†™å’Œç½‘ç»œå¸¦å®½çš„ä¸‰åˆ†ä¹‹ä¸€ã€‚ä»…é™åˆ¶é‡æ–°åŒæ­¥ï¼Œè€Œä¸æ˜¯å¤åˆ¶ã€‚<br>The synchronization rate. Set it to one third of the lower of the disk- and network bandwidth. It only limits the resynchronization, not the replication.</li>
</ol>
<h2 id="ä¸»ä»åˆ‡æ¢"><a href="#ä¸»ä»åˆ‡æ¢" class="headerlink" title="ä¸»ä»åˆ‡æ¢"></a>ä¸»ä»åˆ‡æ¢</h2><p>ä¸»å¤‡èŠ‚ç‚¹åˆ‡æ¢æœ‰ä¸¤ç§æ–¹å¼ï¼Œåˆ†åˆ«æ˜¯åœæ­¢<code>DRBD</code>æœåŠ¡åˆ‡æ¢å’Œæ­£å¸¸åˆ‡æ¢ã€‚</p>
<h3 id="æ­£å¸¸åˆ‡æ¢"><a href="#æ­£å¸¸åˆ‡æ¢" class="headerlink" title="æ­£å¸¸åˆ‡æ¢"></a>æ­£å¸¸åˆ‡æ¢</h3><p>ä¸»åˆ‡æ¢æˆä»ï¼Œéœ€è¦å…ˆå¸è½½æ–‡ä»¶ç³»ç»Ÿï¼Œå†æ‰§è¡Œé™çº§ä¸ºä»çš„å‘½ä»¤</p>
<h4 id="ä¸»ç«¯"><a href="#ä¸»ç«¯" class="headerlink" title="ä¸»ç«¯"></a>ä¸»ç«¯</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">umount /data/</span><br><span class="line">drbdadm secondary all</span><br></pre></td></tr></table></figure>
<h4 id="ä»ç«¯"><a href="#ä»ç«¯" class="headerlink" title="ä»ç«¯"></a>ä»ç«¯</h4><p>ä»åˆ‡æ¢æˆä¸»ï¼Œè¦å…ˆæ‰§è¡Œå‡ä¸»çš„å‘½ä»¤ï¼Œç„¶åæŒ‚è½½æ–‡ä»¶ç³»ç»Ÿ</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">drbdadm  primary all</span><br><span class="line">mount /dev/drbd0 /data/</span><br></pre></td></tr></table></figure>
<h3 id="åœæ­¢-drbd-æœåŠ¡åˆ‡æ¢"><a href="#åœæ­¢-drbd-æœåŠ¡åˆ‡æ¢" class="headerlink" title="åœæ­¢ drbd æœåŠ¡åˆ‡æ¢"></a>åœæ­¢ drbd æœåŠ¡åˆ‡æ¢</h3><p>åŸºæœ¬æ€è·¯ï¼šå…³é—­ä¸»èŠ‚ç‚¹æœåŠ¡ï¼Œæ­¤æ—¶æŒ‚è½½çš„<code>DRBD</code>åˆ†åŒºå°±è‡ªåŠ¨åœ¨ä¸»èŠ‚ç‚¹å¸è½½äº†ï¼Œç„¶ååœ¨å¤‡ç”¨èŠ‚ç‚¹æ‰§è¡Œåˆ‡æ¢å‘½ä»¤</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@drbd2 ~]#drbdadm primary all</span><br><span class="line"><span class="meta">#</span><span class="bash"> æ­¤æ—¶æŠ¥é”™ï¼š</span></span><br><span class="line">2: State change failed: (-7) Refusing to be Primary while peer is not outdated</span><br><span class="line">Command &#x27;drbdsetup 2 primary&#x27; terminated with exit code 11</span><br><span class="line"><span class="meta">#</span><span class="bash"> å› æ­¤ï¼Œå¿…é¡»åœ¨å¤‡ç”¨èŠ‚ç‚¹æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</span></span><br><span class="line">[root@drbd2 ~]#drbdsetup /dev/drbd0 primary â€“o</span><br><span class="line"><span class="meta">#</span><span class="bash"> æˆ–è€…</span></span><br><span class="line"><span class="meta">[root@drbd2~]#</span><span class="bash">drbdadm -- --overwrite-data-of-peer primary all</span></span><br></pre></td></tr></table></figure>
<p>å½“åœ¨å¤‡ç”¨èŠ‚ç‚¹æ‰§è¡Œåˆ‡æ¢åˆ°ä¸»èŠ‚ç‚¹å‘½ä»¤åï¼ŒåŸæ¥çš„ä¸»ç”¨èŠ‚ç‚¹è‡ªåŠ¨å˜ä¸ºå¤‡ç”¨èŠ‚ç‚¹ã€‚æ— éœ€åœ¨ä¸»ç”¨èŠ‚ç‚¹å†æ¬¡æ‰§è¡Œåˆ‡æ¢åˆ°å¤‡ç”¨èŠ‚ç‚¹çš„å‘½ä»¤ã€‚</p>
<h2 id="è„‘è£‚ä¿®å¤"><a href="#è„‘è£‚ä¿®å¤" class="headerlink" title="è„‘è£‚ä¿®å¤"></a>è„‘è£‚ä¿®å¤</h2><p>å½“<code>DRBD</code>å‡ºç°è„‘è£‚åï¼Œä¼šå¯¼è‡´<code>DRBD</code>ä¸¤è¾¹çš„ç£ç›˜æ•°æ®ä¸ä¸€è‡´ï¼Œåœ¨ç¡®å®šè¦ä½œä¸ºä»çš„èŠ‚ç‚¹ä¸Šåˆ‡æ¢æˆ<code>secondary</code>ï¼Œå¹¶æ”¾å¼ƒè¯¥èµ„æºçš„æ•°æ®:</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">drbdadm secondary r0</span><br><span class="line">drbdadm -- --discard-my-data connect r0</span><br></pre></td></tr></table></figure>
<p>ç„¶åä½œä¸º<code>primary</code>çš„èŠ‚ç‚¹é‡æ–°è¿æ¥<code>secondary</code>ï¼ˆå¦‚æœè¿™ä¸ªèŠ‚ç‚¹å½“å‰çš„è¿æ¥çŠ¶æ€ä¸º<code>WFConnection</code>çš„è¯ï¼Œå¯ä»¥çœç•¥ï¼‰ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è¿æ¥ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">drbdadm connect r0</span><br></pre></td></tr></table></figure>
<h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><h3 id="åŒæ§é…ç½®äº’ä¿¡ï¼ˆå‡å®šåœ¨æ§-1-æ‰§è¡Œï¼‰"><a href="#åŒæ§é…ç½®äº’ä¿¡ï¼ˆå‡å®šåœ¨æ§-1-æ‰§è¡Œï¼‰" class="headerlink" title="åŒæ§é…ç½®äº’ä¿¡ï¼ˆå‡å®šåœ¨æ§ 1 æ‰§è¡Œï¼‰"></a>åŒæ§é…ç½®äº’ä¿¡ï¼ˆå‡å®šåœ¨æ§ 1 æ‰§è¡Œï¼‰</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">echo y|ssh-keygen -t dsa -f ~/.ssh/id_dsa -N &quot;&quot;</span><br><span class="line">cp ~/.ssh/id_dsa.pub ~/.ssh/authorized_keys</span><br><span class="line">scp -r ~/.ssh controller-2:         #åŒæ§å¯¹ç«¯hostname</span><br></pre></td></tr></table></figure>
<h2 id="å‚è€ƒé˜…è¯»"><a href="#å‚è€ƒé˜…è¯»" class="headerlink" title="å‚è€ƒé˜…è¯»"></a>å‚è€ƒé˜…è¯»</h2><ul>
<li><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://docs.linbit.com/docs/users-guide-8.4/">å®˜æ–¹æ‰‹å†Œ</a></p>
</li>
<li><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.suse.com/documentation/sle_ha/book_sleha/data/cha_ha_drbd.html">SUSE é«˜å¯ç”¨é…ç½®</a></p>
</li>
<li><p><a target="_blank" rel="external nofollow noopener noreferrer" href="http://clusterlabs.org/doc/en-US/Pacemaker/1.1/html/Clusters_from_Scratch/ch07.html">ä½¿ç”¨ DRBD å®ç°å¤åˆ¶å­˜å‚¨</a></p>
</li>
<li><p><a target="_blank" rel="external nofollow noopener noreferrer" href="http://www.cnblogs.com/wxl-dede/p/5114696.html">drbd é…ç½® - Rikewang - åšå®¢å›­</a></p>
</li>
<li><p><a target="_blank" rel="external nofollow noopener noreferrer" href="http://www.3mu.me/centos%E4%B8%8B%E5%AE%9E%E7%8E%B0heartbeatdrbdmysql%E5%8F%8C%E6%9C%BA%E7%83%AD%E5%A4%87%E7%A1%AC%E4%BB%B6%E6%95%85%E9%9A%9C%E8%87%AA%E5%8A%A8%E5%88%87%E6%8D%A2%E9%AB%98%E5%8F%AF%E7%94%A8ha/#respond">CentOS ä¸‹å®ç° Heartbeat+DRBD+MySQL åŒæœºçƒ­å¤‡ç¡¬ä»¶æ•…éšœè‡ªåŠ¨åˆ‡æ¢é«˜å¯ç”¨(HA)æ–¹æ¡ˆ | ä¸‰æœ¨çš„äººç”Ÿâ€”â€”3mu.me</a></p>
</li>
<li><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.ibm.com/developerworks/library/l-drbd/index.html">High availability with the Distributed Replicated Block Device</a></p>
</li>
<li><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://yq.aliyun.com/articles/52043">è®°ä¸€æ¬¡ DRBD Unknown æ•…éšœå¤„ç†è¿‡ç¨‹</a></p>
</li>
<li><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.linuxidc.com/wap.aspx?nid=93422&amp;cid=9&amp;sp=654">DRBD ç®¡ç†ã€æ•…éšœå¤„ç†éƒ¨åˆ†</a>(<a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.linuxidc.com/Linux/2013-12/93422.htm">https://www.linuxidc.com/Linux/2013-12/93422.htm</a>)</p>
</li>
<li><p><a target="_blank" rel="external nofollow noopener noreferrer" href="http://blog.csdn.net/t1anyuan/article/details/52143789">DRBD ç¼–è¯‘å®‰è£…ä¸­å‡ºç°çš„é—®é¢˜åŠè§£å†³å°ç»“ - CSDN åšå®¢</a></p>
</li>
<li><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.linuxidc.com/Linux/2012-01/51661.htm">DRBD é…ç½®å‚æ•°</a></p>
</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="mailto:immoyao@gmail.com" rel="external nofollow noopener noreferrer" target="_blank">imoyao</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://www.masantu.com/blog/2018-09-11/record-of-drbd/">https://www.masantu.com/blog/2018-09-11/record-of-drbd/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="external nofollow noopener noreferrer">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://www.masantu.com" target="_blank">åˆ«é™¢ç‰§å¿—</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/DRBD/">DRBD</a><a class="post-meta__tags" href="/tags/%E5%AD%98%E5%82%A8/">å­˜å‚¨</a><a class="post-meta__tags" href="/tags/%E9%9B%86%E7%BE%A4/">é›†ç¾¤</a></div><div class="post_share"><div class="social-share" data-image="https://img.xjh.me/random_img.php?type=bg&amp;ctype=nature&amp;return=302" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> æ‰“èµ<div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechatpay.jpg" target="_blank"><img class="post-qr-code-img" data-lazy-src="/img/wechatpay.jpg" alt="wechat"></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" data-lazy-src="/img/alipay.jpg" alt="alipay"></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/blog/2018-09-21/get-some-trouble-with-pip/"><img class="prev-cover" data-lazy-src="/images/Python/pip-logo-large.svg" onerror="onerror=null;src='/img/post_loadding.svg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">pip å°è€å¼Ÿï¼Œä½ æ€ä¹ˆè‚¥å››ï¼Ÿ</div></div></a></div><div class="next-post pull-right"><a href="/blog/2018-08-29/state-of-drbd/"><img class="next-cover" data-lazy-src="https://img.xjh.me/random_img.php?type=bg&amp;ctype=nature&amp;return=302" onerror="onerror=null;src='/img/post_loadding.svg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">DRBD çŠ¶æ€æŒ‡æ ‡è®°å½•</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/blog/2018-08-28/drbd-with-external-disk/" title="DRBD ä½¿ç”¨å¤–éƒ¨å…ƒæ•°æ®"><img class="cover" data-lazy-src="https://img.xjh.me/random_img.php?type=bg&ctype=nature&return=302" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-08-28</div><div class="title">DRBD ä½¿ç”¨å¤–éƒ¨å…ƒæ•°æ®</div></div></a></div><div><a href="/blog/2020-07-22/alua-with-drbd/" title="ä¸€ç§åŸºäº DRBD å®ç°çš„ ALUA è§£å†³æ–¹æ¡ˆ"><img class="cover" data-lazy-src="https://cdn.jsdelivr.net/gh/masantu/statics@master/images/dual.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-07-22</div><div class="title">ä¸€ç§åŸºäº DRBD å®ç°çš„ ALUA è§£å†³æ–¹æ¡ˆ</div></div></a></div><div><a href="/blog/2018-05-27/split-brain-of-drbd/" title="å…³äº DRBD è„‘è£‚é—®é¢˜çš„æ€»ç»“"><img class="cover" data-lazy-src="/images/logos/DRBD.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-05-27</div><div class="title">å…³äº DRBD è„‘è£‚é—®é¢˜çš„æ€»ç»“</div></div></a></div><div><a href="/blog/2018-01-11/how-to-configure-drbd-on-CentOS7/" title="CentOS7 ç¯å¢ƒä¸‹é…ç½® DRBD"><img class="cover" data-lazy-src="https://img.xjh.me/random_img.php?type=bg&ctype=nature&return=302" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-01-11</div><div class="title">CentOS7 ç¯å¢ƒä¸‹é…ç½® DRBD</div></div></a></div><div><a href="/blog/2018-01-11/how-to-install-drbd-on-CentOS7/" title="CentOS7 ä¸‹æºç å®‰è£… DRBD"><img class="cover" data-lazy-src="https://img.xjh.me/random_img.php?type=bg&ctype=nature&return=302" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-01-11</div><div class="title">CentOS7 ä¸‹æºç å®‰è£… DRBD</div></div></a></div><div><a href="/blog/2018-08-29/state-of-drbd/" title="DRBD çŠ¶æ€æŒ‡æ ‡è®°å½•"><img class="cover" data-lazy-src="https://img.xjh.me/random_img.php?type=bg&ctype=nature&return=302" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-08-29</div><div class="title">DRBD çŠ¶æ€æŒ‡æ ‡è®°å½•</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" data-lazy-src="https://cdn.jsdelivr.net/gh/masantu/statics/images/imoyao.jpg" onerror="this.onerror=null;this.src='/img/Ellipsis-5s-210px.svg'" alt="avatar"><div class="author-info__name">imoyao</div><div class="author-info__description">æ·±æ·±åˆ«é™¢ï¼Œæ½œæ½œç‰§å¿—ã€‚ä¸€ä¸ªç‹¬ç«‹åšå®¢ï¼Œæœ¬äººä½¿ç”¨ Python è¯­è¨€å¼€å‘ï¼Œè‡´åŠ›äºå†™å‡º Pythonic çš„ä»£ç ã€‚</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">76</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">101</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">13</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="external nofollow noopener noreferrer" href="https://zhihu.com/imoyao"><i class="fab fa-zhihu"></i><span>æ¥çŸ¥ä¹å’Œæˆ‘äº’åŠ¨</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/imoyao" target="_blank" title="Github" rel="external nofollow noopener noreferrer"><i class="fab fa-github"></i></a><a class="social-icon" href="https://blog.masantu.com" target="_blank" title="è‡ªç•™åœ°"><i class="fas fa-feather-alt"></i></a><a class="social-icon" href="/immoyao@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fa fa-rss"></i></a></div></div></div><div class="card-widget card-announcement"><div class="card-content"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>å…¬å‘Š</span></div><div class="announcement_content"><h3>ğŸ’ƒBe my guest!ğŸ‘‹~</h3>ğŸ§ä½ å¯¹æˆ‘çš„å¥½å¥‡å¿ƒå‡å¯åœ¨ <a href="/about/">å…³äºæˆ‘</a> é¡µé¢å¾—åˆ°æ»¡è¶³ï¼›å¦‚æœæ²¡æœ‰ï¼Œä½ æœ‰å›°éš¾æˆ‘å¸®å¿™ï¼Œæˆ‘ä½éš”å£æˆ‘å§“ç‹ã€‚ğŸ˜œ<br>æ¬¢è¿å…³æ³¨ä¸ªäººå…¬ä¼—å· <strong>åˆ«é™¢ç‰§å¿—</strong>ã€‚<br><img alt="idealyard" title="åˆ«é™¢ç‰§å¿—" data-src="https://open.weixin.qq.com/qr/code?username=idealyard" class="lazyloaded" src="https://open.weixin.qq.com/qr/code?username=idealyard"></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="card-content"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#drbd-%E7%8A%B6%E6%80%81%E8%AE%B0%E5%BD%95"><span class="toc-number">1.</span> <span class="toc-text">drbd çŠ¶æ€è®°å½•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B8%85%E9%99%A4%E5%8D%95%E4%B8%AA-DRBD-%E8%B5%84%E6%BA%90%E9%85%8D%E7%BD%AE%EF%BC%9A-%E4%BB%A5-drbd10-%E4%B8%BA%E4%BE%8B"><span class="toc-number">2.</span> <span class="toc-text">æ¸…é™¤å•ä¸ª DRBD èµ„æºé…ç½®ï¼š(ä»¥ drbd10 ä¸ºä¾‹)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%87%8D%E5%90%AF-DRBD-%E6%9C%8D%E5%8A%A1"><span class="toc-number">3.</span> <span class="toc-text">é‡å¯ DRBD æœåŠ¡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DRBD%E6%89%A9%E5%AE%B9"><span class="toc-number">4.</span> <span class="toc-text">DRBDæ‰©å®¹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%81%E7%A8%8B%E7%AE%80%E5%8D%95%E7%A4%BA%E4%BE%8B"><span class="toc-number">4.1.</span> <span class="toc-text">æµç¨‹ç®€å•ç¤ºä¾‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">5.</span> <span class="toc-text">é…ç½®æ–‡ä»¶</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#global-common-conf-%E9%85%8D%E7%BD%AE%EF%BC%88%E7%A4%BA%E4%BE%8B%EF%BC%89"><span class="toc-number">5.1.</span> <span class="toc-text">global_common.conf é…ç½®ï¼ˆç¤ºä¾‹ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5%E5%8D%8F%E8%AE%AE"><span class="toc-number">5.2.</span> <span class="toc-text">æ•°æ®åŒæ­¥åè®®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E4%B8%AAdrbd%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%EF%BC%88%E4%BB%A5-drbd10-res-%E4%B8%BA%E4%BE%8B%EF%BC%89"><span class="toc-number">5.3.</span> <span class="toc-text">å•ä¸ªdrbdé…ç½®æ–‡ä»¶ï¼ˆä»¥ drbd10.res ä¸ºä¾‹ï¼‰</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E4%BB%8E%E5%88%87%E6%8D%A2"><span class="toc-number">6.</span> <span class="toc-text">ä¸»ä»åˆ‡æ¢</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A3%E5%B8%B8%E5%88%87%E6%8D%A2"><span class="toc-number">6.1.</span> <span class="toc-text">æ­£å¸¸åˆ‡æ¢</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%BB%E7%AB%AF"><span class="toc-number">6.1.1.</span> <span class="toc-text">ä¸»ç«¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%8E%E7%AB%AF"><span class="toc-number">6.1.2.</span> <span class="toc-text">ä»ç«¯</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%81%9C%E6%AD%A2-drbd-%E6%9C%8D%E5%8A%A1%E5%88%87%E6%8D%A2"><span class="toc-number">6.2.</span> <span class="toc-text">åœæ­¢ drbd æœåŠ¡åˆ‡æ¢</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%84%91%E8%A3%82%E4%BF%AE%E5%A4%8D"><span class="toc-number">7.</span> <span class="toc-text">è„‘è£‚ä¿®å¤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E4%BB%96"><span class="toc-number">8.</span> <span class="toc-text">å…¶ä»–</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8C%E6%8E%A7%E9%85%8D%E7%BD%AE%E4%BA%92%E4%BF%A1%EF%BC%88%E5%81%87%E5%AE%9A%E5%9C%A8%E6%8E%A7-1-%E6%89%A7%E8%A1%8C%EF%BC%89"><span class="toc-number">8.1.</span> <span class="toc-text">åŒæ§é…ç½®äº’ä¿¡ï¼ˆå‡å®šåœ¨æ§ 1 æ‰§è¡Œï¼‰</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E9%98%85%E8%AF%BB"><span class="toc-number">9.</span> <span class="toc-text">å‚è€ƒé˜…è¯»</span></a></li></ol></div></div></div><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/blog/2021-01-23/calculate-cash-flow-with-python/" title="ä½¿ç”¨ Python è®¡ç®—ä½ çš„ç°é‡‘æµæ”¶ç›Šç‡"><img data-lazy-src="https://img.xjh.me/random_img.php?type=bg&amp;ctype=nature&amp;return=302" onerror="this.onerror=null;this.src='/img/post_loadding.svg'" alt="ä½¿ç”¨ Python è®¡ç®—ä½ çš„ç°é‡‘æµæ”¶ç›Šç‡"></a><div class="content"><a class="title" href="/blog/2021-01-23/calculate-cash-flow-with-python/" title="ä½¿ç”¨ Python è®¡ç®—ä½ çš„ç°é‡‘æµæ”¶ç›Šç‡">ä½¿ç”¨ Python è®¡ç®—ä½ çš„ç°é‡‘æµæ”¶ç›Šç‡</a><time datetime="2021-01-23T02:14:41.988Z" title="å‘è¡¨äº 2021-01-23 10:14:41">2021-01-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/2020-12-12/recurse-rename-dirname-and-file-with-python/" title="ä½¿ç”¨ Python é€’å½’ç›®å½•å¹¶æŒ‰ç…§ç‰¹å®šè§„åˆ™ä¿®æ”¹å…¶ä¸‹æ–‡ä»¶å¤¹åŠæ–‡ä»¶å"><img data-lazy-src="https://img.xjh.me/random_img.php?type=bg&amp;ctype=nature&amp;return=302" onerror="this.onerror=null;this.src='/img/post_loadding.svg'" alt="ä½¿ç”¨ Python é€’å½’ç›®å½•å¹¶æŒ‰ç…§ç‰¹å®šè§„åˆ™ä¿®æ”¹å…¶ä¸‹æ–‡ä»¶å¤¹åŠæ–‡ä»¶å"></a><div class="content"><a class="title" href="/blog/2020-12-12/recurse-rename-dirname-and-file-with-python/" title="ä½¿ç”¨ Python é€’å½’ç›®å½•å¹¶æŒ‰ç…§ç‰¹å®šè§„åˆ™ä¿®æ”¹å…¶ä¸‹æ–‡ä»¶å¤¹åŠæ–‡ä»¶å">ä½¿ç”¨ Python é€’å½’ç›®å½•å¹¶æŒ‰ç…§ç‰¹å®šè§„åˆ™ä¿®æ”¹å…¶ä¸‹æ–‡ä»¶å¤¹åŠæ–‡ä»¶å</a><time datetime="2020-12-12T13:47:47.000Z" title="å‘è¡¨äº 2020-12-12 21:47:47">2020-12-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/2020-12-07/merge-repos-with-git/" title="æŠŠä¸¤ä¸ª Git ä»“åº“åˆå¹¶èµ·æ¥"><img data-lazy-src="https://cdn.jsdelivr.net/gh/masantu/statics/images/pine-watt-dUbKcgu0zjw-unsplash.jpg" onerror="this.onerror=null;this.src='/img/post_loadding.svg'" alt="æŠŠä¸¤ä¸ª Git ä»“åº“åˆå¹¶èµ·æ¥"></a><div class="content"><a class="title" href="/blog/2020-12-07/merge-repos-with-git/" title="æŠŠä¸¤ä¸ª Git ä»“åº“åˆå¹¶èµ·æ¥">æŠŠä¸¤ä¸ª Git ä»“åº“åˆå¹¶èµ·æ¥</a><time datetime="2020-12-07T14:08:18.000Z" title="å‘è¡¨äº 2020-12-07 22:08:18">2020-12-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/2020-12-06/images-hosting/" title="å…è´¹ä¸ªäººåšå®¢å›¾åºŠè§£å†³æ–¹æ¡ˆ"><img data-lazy-src="https://img.xjh.me/random_img.php?type=bg&amp;ctype=nature&amp;return=302" onerror="this.onerror=null;this.src='/img/post_loadding.svg'" alt="å…è´¹ä¸ªäººåšå®¢å›¾åºŠè§£å†³æ–¹æ¡ˆ"></a><div class="content"><a class="title" href="/blog/2020-12-06/images-hosting/" title="å…è´¹ä¸ªäººåšå®¢å›¾åºŠè§£å†³æ–¹æ¡ˆ">å…è´¹ä¸ªäººåšå®¢å›¾åºŠè§£å†³æ–¹æ¡ˆ</a><time datetime="2020-12-06T02:52:09.000Z" title="å‘è¡¨äº 2020-12-06 10:52:09">2020-12-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/2020-12-05/browse-your-tasks/" title="åº–ä¸è§£ç‰› | ä»»åŠ¡åˆ†è§£ï¼Œå„ä¸ªå‡»ç ´"><img data-lazy-src="/images/plan.jpeg" onerror="this.onerror=null;this.src='/img/post_loadding.svg'" alt="åº–ä¸è§£ç‰› | ä»»åŠ¡åˆ†è§£ï¼Œå„ä¸ªå‡»ç ´"></a><div class="content"><a class="title" href="/blog/2020-12-05/browse-your-tasks/" title="åº–ä¸è§£ç‰› | ä»»åŠ¡åˆ†è§£ï¼Œå„ä¸ªå‡»ç ´">åº–ä¸è§£ç‰› | ä»»åŠ¡åˆ†è§£ï¼Œå„ä¸ªå‡»ç ´</a><time datetime="2020-12-05T01:59:43.000Z" title="å‘è¡¨äº 2020-12-05 09:59:43">2020-12-05</time></div></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/images/footer.svg)"><div id="footer-wrap"><div class="copyright">&copy;2017 - 2021 By imoyao</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="external nofollow noopener noreferrer" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ç®€</button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">æœ¬åœ°æœç´¢</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"></div></div></div><hr><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    let initData = {
      el: '#vcomment',
      appId: 'tVPRVDtsAXHH6pVaD2ymi5CY-MdYXbMMI',
      appKey: 'CARePe7R247vdXACFg1fhk4E',
      placeholder: 'æˆ‘ä»¬æœŸå¾…å¹¶æ¬¢è¿ç†æ€§ã€å‹å¥½è€Œå’Œè°çš„å£°éŸ³â€¦â€¦',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'zh-CN',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
    }

    if (true) { 
      initData.requiredFields= ('nick,mail'.split(','))
    }
    
    if (false) {
      const otherData = false
      initData = Object.assign({}, initData, otherData)
    }
    
    const valine = new Valine(initData)
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.querySelector('#vcomment'),loadValine)
  else setTimeout(() => loadValine(), 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script>(function(){
  const bp = document.createElement('script');
  const curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  bp.dataset.pjax = ''
  const s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})()</script></div></body></html>