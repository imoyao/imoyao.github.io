<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>ä½¿ç”¨ Python é€’å½’ç›®å½•å¹¶æŒ‰ç…§ç‰¹å®šè§„åˆ™ä¿®æ”¹å…¶ä¸‹æ–‡ä»¶å¤¹åŠæ–‡ä»¶å</title>
      <link href="blog/2020-12-12/recurse-rename-dirname-and-file-with-python/"/>
      <url>blog/2020-12-12/recurse-rename-dirname-and-file-with-python/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><div class="note danger modern"><p><strong>é£é™©æç¤º</strong></p><ol><li>git ç”¨æˆ·æ‰§è¡Œæ“ä½œå‰ï¼Œè¯·ç¡®ä¿ä½ çš„ git å·¥ä½œåŒºæ˜¯ clean çš„ï¼ˆæ‰€æœ‰ä»£ç å·² pushï¼‰æˆ–è€…å¯ revert/reset çš„ï¼ˆcommitedï¼‰ï¼Œå¦åˆ™ä¿®æ”¹å¯¼è‡´å‡ºç°é—®é¢˜æœ¬äººä¸è´Ÿè¿å¸¦è´£ä»»ï¼›</li><li>å¦‚æœæ˜¯é‡è¦æ–‡ä»¶ï¼Œæ™®é€šç”¨æˆ·æ“ä½œå‰è¯·ç¡®ä¿å°†ç›®å½•æ•°æ®å¤‡ä»½åˆ°å®‰å…¨åŒºåŸŸï¼›</li></ol></div><h2 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h2><p>æœ€è¿‘å‘ç°å¾®è½¯æœ‰ä¸€ä¸ªå°å·¥å…·ä¸“é—¨åšè¿™ä»¶äº‹ï¼šğŸ‘‰<a href="https://docs.microsoft.com/zh-cn/windows/powertoys/powerrename">é€‚ç”¨äº Windows 10 çš„ PowerToys PowerRename å®ç”¨å·¥å…· | Microsoft Docs</a>ï¼Œè¯•ç”¨äº†ä¸€ä¸‹è¿˜æ˜¯å¾ˆé¦™çš„ï¼å¦‚æœåªæ˜¯åœ¨<em>å•ä¸ªç›®å½•</em>åšæ–‡ä»¶é‡å‘½åè¿™ä»¶äº‹ï¼Œå¯èƒ½è¿™ä¸ªå·¥å…·æ¯”æˆ‘åšå¾—æ›´å¥½ã€‚ï¼ˆbug æ›´å°‘ï¼‰ğŸ˜³</p><p><img src= "/img/loading.svg" data-lazy-src="https://cdn.jsdelivr.net/gh/masantu/statics/images/Snipaste_2021-01-20_21-16-08.png" alt="PowerToys PowerRename"></p><h2 id="ç¼˜èµ·"><a href="#ç¼˜èµ·" class="headerlink" title="ç¼˜èµ·"></a>ç¼˜èµ·</h2><p>åœ¨ä½¿ç”¨ <a href="https://github.com/xugaoyi/vuepress-theme-vdoing">vuepress-theme-vdoing</a> ä¸»é¢˜æ„å»ºè‡ªå·±çš„ä¸ªäººçŸ¥è¯†åº“çš„æ—¶å€™ï¼Œæœ‰ä¸€ä¸ªéœ€æ±‚æ˜¯éœ€è¦é‡å‘½åè‡ªå·±çš„æ–‡æ¡£æ–‡ä»¶åå’Œæ–‡æ¡£ç›®å½•ã€‚</p><blockquote><p>å‘½åçº¦å®š</p><ul><li>æ— è®ºæ˜¯<strong>æ–‡ä»¶</strong>è¿˜æ˜¯<strong>æ–‡ä»¶å¤¹</strong>ï¼Œè¯·ä¸ºå…¶åç§°æ·»åŠ ä¸Šæ­£ç¡®çš„<strong>æ­£æ•´æ•°åºå·</strong>å’Œ<code>.</code>ï¼Œä»<code>00</code>æˆ–<code>01</code>å¼€å§‹ç´¯è®¡ï¼Œå¦‚<code>01.æ–‡ä»¶å¤¹</code>ã€<code>02.æ–‡ä»¶.md</code>ï¼Œæˆ‘ä»¬å°†ä¼šæŒ‰ç…§åºå·çš„é¡ºåºæ¥å†³å®šå…¶åœ¨ä¾§è¾¹æ å½“ä¸­çš„é¡ºåºã€‚</li><li>åŒä¸€çº§åˆ«ç›®å½•åˆ«å†…å³ä½¿åªæœ‰ä¸€ä¸ªæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ä¹Ÿè¦ä¸ºå…¶åŠ ä¸Šåºå·ã€‚</li><li>æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹åç§°ä¸­é—´ä¸èƒ½å‡ºç°å¤šä½™çš„ç‚¹<code>.</code>ï¼Œå¦‚<code>01.æˆ‘æ˜¯.åç§°.md</code>ä¸­é—´å‡ºç°<code>.</code>å°†ä¼šå¯¼è‡´è§£æé”™è¯¯ã€‚</li></ul></blockquote><p>è¯¦æƒ…å‚é˜…ï¼š<a href="https://doc.xugaoyi.com/vuepress-theme-vdoing-doc/pages/33d574/">æ„å»ºç»“æ„åŒ–ç«™ç‚¹çš„æ ¸å¿ƒé…ç½®å’Œçº¦å®š | vuepress-theme-vdoing</a></p><p>æœ¬æ¥æƒ³ç›´æ¥æ‰‹åŠ¨ä¿®æ”¹çš„ï¼Œæ”¹äº†ä¸€ç‚¹ä¹‹åæ„Ÿè§‰å·¥ä½œé‡æœ‰ç‚¹å¤§ï¼Œç„¶åå»ç½‘ä¸Šæ‰¾è½®å­ï¼Œä½†æ˜¯å‘ç°æ‰¾åˆ°çš„éƒ½ä¸æ˜¯å¾ˆæ»¡è¶³è‡ªå·±çš„éœ€æ±‚ï¼Œæ‰€ä»¥åªèƒ½è‡ªå·±åŠ¨æ‰‹é€ ä¸€ä¸ªäº†ã€‚</p><h2 id="åŸºæœ¬æ€è·¯"><a href="#åŸºæœ¬æ€è·¯" class="headerlink" title="åŸºæœ¬æ€è·¯"></a>åŸºæœ¬æ€è·¯</h2><ol><li>ä½¿ç”¨<code>os.walk</code>éå†æŒ‡å®šç›®å½•</li><li>å°†æ–‡ä»¶é‡å‘½å<br>æ–‡ä»¶é‡å‘½åæ—¶ç”±äºå…·æœ‰åç¼€å<code>md</code>ï¼Œæ‰€ä»¥é™¤äº†åç¼€åä¸­çš„éƒ¨åˆ†ï¼Œå…¶ä½™éƒ¨åˆ†å¦‚æœæœ‰<code>.</code>åˆ™ç”¨ä¸‹åˆ’çº¿æ›¿ä»£ï¼›ä½†æ˜¯ï¼Œå¦‚æœå¼€å¤´æ˜¯æ•°å­—ç‚¹çš„ç»“æ„ï¼Œåˆ™ç›´æ¥ä¿ç•™ã€‚å¦‚ï¼š<ul><li><code>01.this.is-test-file-name.md</code>ä¿®æ”¹ååº”è¯¥ä¸º<code>01.this-is-test-file-name.md</code></li><li><code>02-this.is-another-test-file-name.md</code>ä¿®æ”¹ååº”è¯¥ä¸º<code>02.this-is-another-test-file-name.md</code></li><li><code>this-is-normal-test-file-name.md</code>ä¿®æ”¹ååº”è¯¥ä¸º<code>03.this-is-normal-test-file-name.md</code></li><li><code>this-is007.abnormal-file-name.md</code>ä¿®æ”¹ååº”è¯¥ä¸º<code>04.this-is007-abnormal-file-name.md</code></li></ul></li><li>å°†ç›®å½•é‡å‘½å<ol><li>åº”è¯¥å…ˆä¿®æ”¹æ–‡ä»¶ï¼Œåé¢ä»å†…å‘å¤–ä¿®æ”¹</li><li>éƒ¨åˆ† vuepress ä¸»é¢˜åŸæœ‰ç›®å½•ã€æˆ‘ä»¬è‡ªå®šä¹‰æ’é™¤çš„ç›®å½•åŠç›®å½•ä¸‹çš„å­æ–‡ä»¶åº”è¯¥æ’é™¤ï¼Œä¸èƒ½ä¿®æ”¹</li></ol></li></ol><h2 id="show-me-code"><a href="#show-me-code" class="headerlink" title="show me code"></a>show me code</h2><ol><li>éå†ç›®å½•<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸä¸ªä½ éœ€è¦å¤„ç†çš„ç›®å½•</span></span><br><span class="line">ROOT_PATH = <span class="string">&#x27;some/path/you/will/deal&#x27;</span></span><br><span class="line"><span class="keyword">for</span> root, dirs, files <span class="keyword">in</span> os.walk(ROOT_PATH):</span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure></li><li>éå†æ—¶éœ€è¦æ’é™¤æŸäº›æˆ‘ä»¬ä¸éœ€è¦ä¿®æ”¹çš„ç›®å½•åŠç›®å½•ä¸‹çš„æ–‡ä»¶<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">current_path = os.path.dirname(os.path.abspath(__file__))</span><br><span class="line">ROOT_PATH = os.path.join(current_path, <span class="string">&#x27;docs&#x27;</span>)  <span class="comment"># éœ€è¦æ‰§è¡Œçš„ç›®å½•</span></span><br><span class="line">EXCLUDE_DIR = [<span class="string">&#x27;.vuepress&#x27;</span>, <span class="string">&#x27;@pages&#x27;</span>, <span class="string">&#x27;_posts&#x27;</span>, <span class="string">&#x27;styles&#x27;</span>]       <span class="comment"># éœ€è¦æ’é™¤çš„ç›®å½•</span></span><br><span class="line"><span class="keyword">for</span> root, dirs, files <span class="keyword">in</span> os.walk(ROOT_PATH, topdown=<span class="literal">True</span>):</span><br><span class="line">    dirs[:] = [d <span class="keyword">for</span> d <span class="keyword">in</span> dirs <span class="keyword">if</span> d <span class="keyword">not</span> <span class="keyword">in</span> EXCLUDE_DIR]</span><br><span class="line">    print(dirs)</span><br></pre></td></tr></table></figure></li><li>è‡ªåº•å‘é¡¶<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="keyword">for</span> root, dirs, files <span class="keyword">in</span> os.walk(ROOT_PATH, topdown=<span class="literal">False</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure></li><li>å› ä¸ºéœ€è¦åŒæ—¶æ’é™¤ç›®å½•å’Œç›®å½•å­æ–‡ä»¶ã€‚æ‰€ä»¥æˆ‘ä»¬æŠŠæ’é™¤æ–¹æ³•å†™æˆä¸€ä¸ªå‡½æ•°<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;æ’é™¤ç»™å®šè¿‡æ»¤æ¡ä»¶çš„é€‰é¡¹&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_not_in</span>(<span class="params">seq, exclude</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    ä½¿ç”¨ not in</span></span><br><span class="line"><span class="string">    :param all_seq: </span></span><br><span class="line"><span class="string">    :param filter_seq: </span></span><br><span class="line"><span class="string">    :return: </span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> [item <span class="keyword">for</span> item <span class="keyword">in</span> seq <span class="keyword">if</span> item <span class="keyword">not</span> <span class="keyword">in</span> exclude]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_filter_sth</span>(<span class="params">seq, exclude</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    ä½¿ç”¨filter</span></span><br><span class="line"><span class="string">    :param seq: </span></span><br><span class="line"><span class="string">    :param exclude: </span></span><br><span class="line"><span class="string">    :return: </span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span>(<span class="built_in">filter</span>(<span class="keyword">lambda</span> x: x <span class="keyword">not</span> <span class="keyword">in</span> exclude, seq))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_subtract_set</span>(<span class="params">seq, exclude</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    å·®é›†æ³•</span></span><br><span class="line"><span class="string">    :param seq: </span></span><br><span class="line"><span class="string">    :param exclude: </span></span><br><span class="line"><span class="string">    :return: </span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span>(<span class="built_in">set</span>(seq) - <span class="built_in">set</span>(exclude))</span><br></pre></td></tr></table></figure>å¯¹äºä¸Šè¿°å¤„ç†æ–¹æ¡ˆï¼Œé€‰æ‹©æ€§èƒ½æ›´å¥½çš„ï¼š<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">A = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">8888</span>))</span><br><span class="line">B = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">2000</span>, <span class="number">6666</span>))</span><br><span class="line">nt = timeit.Timer(<span class="keyword">lambda</span>: not_in(A, B))</span><br><span class="line">ft = timeit.Timer(<span class="keyword">lambda</span>: filter_sth(A, B))</span><br><span class="line">st = timeit.Timer(<span class="keyword">lambda</span>: subtract_set(A, B))</span><br><span class="line">x = nt.timeit(<span class="number">5</span>)</span><br><span class="line">y = st.timeit(<span class="number">5</span>)</span><br><span class="line">z = ft.timeit(<span class="number">5</span>)</span><br><span class="line">print(<span class="string">f&#x27;not_in:<span class="subst">&#123;x&#125;</span>, subtract_set:<span class="subst">&#123;y&#125;</span>, filter_sth:<span class="subst">&#123;z&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># not_in:5.2498173, subtract_set:0.008623699999999346, filter_sth:4.9613408</span></span><br></pre></td></tr></table></figure>å‚è§<a href="https://stackoverflow.com/questions/3013449/list-comprehension-vs-lambda-filter">python - List comprehension vs. lambda + filter - Stack Overflow</a>ã€‚</li><li>å¤„ç†è§„åˆ™<ol><li>å¯¹äºæ–‡ä»¶</li></ol><ul><li>åªå¤„ç†<code>markdown</code>æ–‡ä»¶<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pathlib</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_md_file</span>(<span class="params">file_path</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    æŒ‡å®šæ–‡ä»¶æ˜¯mdæ–‡ä»¶</span></span><br><span class="line"><span class="string">    :param file_path:</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> pathlib.PurePath(file_path).suffix[<span class="number">1</span>:].lower() == <span class="string">&#x27;md&#x27;</span></span><br></pre></td></tr></table></figure></li><li>å¦‚æœå·²ç»ä»¥æ•°å­—å¼€å¤´ï¼Œåˆ™æŒ‰ä»¥ä¸‹è§„åˆ™å¤„ç†<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reg_startswith</span>(<span class="params">check_str, reg</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    10.dsgfdh.md  &gt;&gt;&gt; re.match.obj</span></span><br><span class="line"><span class="string">    dsgfdh  &gt;&gt;&gt; None</span></span><br><span class="line"><span class="string">    :param check_str:str,è¢«æ£€æŸ¥å­—ç¬¦</span></span><br><span class="line"><span class="string">    :param reg:str,æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line"><span class="string">    :return:åŒ¹é…å¯¹è±¡æˆ–None</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> re.match(<span class="string">f&#x27;^<span class="subst">&#123;reg&#125;</span>&#x27;</span>, check_str)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    test_list = [<span class="string">&#x27;10.dsgfdh.md&#x27;</span>, <span class="string">&#x27;dsgfdh&#x27;</span>, <span class="string">&#x27;00xxx&#x27;</span>, <span class="string">&#x27;88,yyy&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> test <span class="keyword">in</span> test_list:</span><br><span class="line">        print(reg_startswith(test, REG_EXP))</span><br></pre></td></tr></table></figure><ol><li>å¦‚æœå‰©ä½™åå­—éƒ¨åˆ†ä»¥<code>[&#39;.&#39;, &#39;-&#39;, &#39;_&#39;]</code>å¼€å¤´ï¼Œåˆ™æ’é™¤åˆ†éš”ç¬¦ä¹‹åæ›¿æ¢å‰©ä½™éƒ¨åˆ†ä¸­çš„<code>.</code><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">make_rename</span>(<span class="params">sub_line</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    _xx.yyy:xx-yyy</span></span><br><span class="line"><span class="string">    xx-yyy:xx-yyy</span></span><br><span class="line"><span class="string">    xx.yyy:xx-yyy</span></span><br><span class="line"><span class="string">    -xx.yyy:xx-yyy</span></span><br><span class="line"><span class="string">    .xx-yyy:xx-yyy</span></span><br><span class="line"><span class="string">    ä½ å¥½:ä½ å¥½</span></span><br><span class="line"><span class="string">    ğŸ’»:ğŸ’»</span></span><br><span class="line"><span class="string">    :param sub_line:</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> sub_line <span class="keyword">and</span> sub_line[<span class="number">0</span>] <span class="keyword">in</span> [<span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;_&#x27;</span>]:</span><br><span class="line">        slice_symbol_str = sub_line[<span class="number">1</span>:]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        slice_symbol_str = sub_line</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;.&#x27;</span> <span class="keyword">in</span> slice_symbol_str:</span><br><span class="line">        str_replace_dot_inline = slice_symbol_str.replace(<span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">        rename_str = str_replace_dot_inline</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        rename_str = slice_symbol_str</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> rename_str</span><br></pre></td></tr></table></figure></li><li>å¦åˆ™åŠ æ•°å­—å¹¶åŠ <code>.</code><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">handler_action</span>(<span class="params">_root, path_item, is_file=<span class="literal">True</span></span>):</span></span><br><span class="line">    <span class="keyword">nonlocal</span> count, count_set</span><br><span class="line">    add_suffix = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> is_file:</span><br><span class="line">        add_suffix = <span class="string">&#x27;.md&#x27;</span></span><br><span class="line"></span><br><span class="line">    reg_exp = <span class="string">r&#x27;\d+&#x27;</span></span><br><span class="line">    reg_match_obj = reg_startswith(path_item, reg_exp)</span><br><span class="line">    <span class="keyword">if</span> reg_match_obj:</span><br><span class="line">        <span class="comment"># æœ¬æ¥æœ‰æ•°å­—</span></span><br><span class="line">        digital = reg_match_obj.group()</span><br><span class="line">        count = <span class="built_in">int</span>(digital)</span><br><span class="line">        count_set.add(count)</span><br><span class="line">        <span class="keyword">if</span> is_file:</span><br><span class="line">            deal_line = pathlib.PurePath(path_item).stem</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            deal_line = pathlib.PurePath(path_item).parts[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">        sub_line = re.sub(reg_exp, <span class="string">&quot;&quot;</span>, deal_line)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> sub_line.startswith(<span class="string">&#x27;.&#x27;</span>):</span><br><span class="line">            sub_line = sub_line[<span class="number">1</span>:]</span><br><span class="line">        sub_name = make_rename(sub_line)</span><br><span class="line">        new_name_with_suffix = <span class="string">f&#x27;<span class="subst">&#123;digital&#125;</span>.<span class="subst">&#123;sub_name&#125;</span><span class="subst">&#123;add_suffix&#125;</span>&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> is_file:</span><br><span class="line">            path_str = pathlib.PurePath(path_item).stem</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            path_str = pathlib.PurePath(path_item).parts[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">        new_name = make_rename(path_str)</span><br><span class="line">        <span class="comment"># æ‰¾å‡ºæœ€å¤§countï¼Œç„¶å+1ä½œä¸ºæ–°ç¼–å·</span></span><br><span class="line">        <span class="keyword">if</span> count_set:</span><br><span class="line">            count = <span class="built_in">max</span>(count_set)</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">        count_set.add(count)</span><br><span class="line"></span><br><span class="line">        new_name_with_suffix = <span class="string">f&#x27;<span class="subst">&#123;count:02&#125;</span>.<span class="subst">&#123;new_name&#125;</span><span class="subst">&#123;add_suffix&#125;</span>&#x27;</span></span><br><span class="line"></span><br><span class="line">    old = os.path.join(_root, path_item)</span><br><span class="line">    new = os.path.join(_root, new_name_with_suffix)</span><br><span class="line">    <span class="keyword">return</span> old, new</span><br></pre></td></tr></table></figure></li></ol></li></ul></li><li><p>å¯¹äºç›®å½•<br>æ‰§è¡Œå¤„ç†æ–‡ä»¶æ—¶çš„ 2 è§„åˆ™</p></li><li><p>æ–‡ä»¶å’Œç›®å½•é‡å‘½åçš„è§„åˆ™ä¸åŒ</p><ul><li>æ–‡ä»¶æœ€åé‡åçš„æ—¶å€™éœ€è¦åŠ åç¼€<code>.md</code>ï¼Œç›®å½•ç›´æ¥é‡å‘½åå³å¯</li><li>æ–‡ä»¶å–æ–‡ä»¶ <a href="https://docs.python.org/zh-cn/3/library/pathlib.html#pathlib.PurePath.stem">pathlib.PurePath.stem</a> å³å¯ï¼Œè€Œç›®å½•éœ€è¦å– <a href="https://docs.python.org/zh-cn/3/library/pathlib.html#pathlib.PurePath.parts">pathlib.PurePath.parts</a><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> is_file:</span><br><span class="line">    deal_line = pathlib.PurePath(path_item).stem</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    deal_line = pathlib.PurePath(path_item).parts[-<span class="number">1</span>]</span><br></pre></td></tr></table></figure></li></ul></li><li>å¤„ç†æ–¹æ³•<br>æ–‡ä»¶è·¯å¾„é‡å‘½å<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rename_path</span>(<span class="params">old, new</span>):</span></span><br><span class="line">    p = pathlib.Path(<span class="string">fr&#x27;<span class="subst">&#123;old&#125;</span>&#x27;</span>)</span><br><span class="line">    target = pathlib.Path(<span class="string">fr&#x27;<span class="subst">&#123;new&#125;</span>&#x27;</span>)</span><br><span class="line">    p.rename(target)</span><br></pre></td></tr></table></figure>æºç ä¸‹è½½ï¼š<a href="https://github.com/imoyao/code-snippets/tree/master/codes/vdoing_rename">vdoing_rename</a></li></ol><h2 id="ç–‘é—®å›°æƒ‘"><a href="#ç–‘é—®å›°æƒ‘" class="headerlink" title="ç–‘é—®å›°æƒ‘"></a>ç–‘é—®å›°æƒ‘</h2><ol><li><p><code>[:]</code>çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ<br><a href="https://stackoverflow.com/questions/10155951/what-is-the-difference-between-slice-assignment-that-slices-the-whole-list-and-d">python - What is the difference between slice assignment that slices the whole list and direct assignment? - Stack Overflow</a><br><a href="https://stackoverflow.com/questions/4081561/what-is-the-difference-between-list-and-list-in-python">What is the difference between list and list[:] in python? - Stack Overflow</a></p></li><li><p><code>os.walk</code>å¦‚ä½•æ’é™¤æŒ‡å®šç›®å½•ï¼Ÿ<br>å‚è§<a href="https://stackoverflow.com/questions/19859840/excluding-directories-in-os-walk">python - Excluding directories in os.walk - Stack Overflow</a></p></li><li><p><code>nonlocal</code>å…³é”®å­—<br>å®ç°é—­åŒ…å‡½æ•°å†…éƒ¨ä½¿ç”¨å¤–éƒ¨å˜é‡</p></li><li><p>å¯¹<code>os.walk</code>ä¸­çš„<code>topdown</code>å‚æ•°çš„ç†è§£</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir root</span><br><span class="line"><span class="built_in">cd</span> root</span><br><span class="line">mkdir \</span><br><span class="line">  d0 \</span><br><span class="line">  d1 \</span><br><span class="line">  d0/d0_d1</span><br><span class="line">touch \</span><br><span class="line">  f0 \</span><br><span class="line">  d0/d0_f0 \</span><br><span class="line">  d0/d0_f1 \</span><br><span class="line">  d0/d0_d1/d0_d1_f0</span><br><span class="line">  d1/d1_f0</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹ç›®å½•ç»“æ„ï¼š</p><figure class="highlight dos"><table><tr><td class="code"><pre><span class="line"><span class="built_in">tree</span> /f</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">â””â”€root</span><br><span class="line">    â”‚  f0</span><br><span class="line">    â”‚</span><br><span class="line">    â”œâ”€d0</span><br><span class="line">    â”‚  â”‚  d0_f0</span><br><span class="line">    â”‚  â”‚  d0_f1</span><br><span class="line">    â”‚  â”‚</span><br><span class="line">    â”‚  â””â”€d0_d1</span><br><span class="line">    â”‚          d0_d1_f0</span><br><span class="line">    â”‚</span><br><span class="line">    â””â”€d1</span><br><span class="line">            d1_f0</span><br></pre></td></tr></table></figure><p>åˆ†åˆ«æµ‹è¯• topdown çš„ä¼ å‚</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">current_path = os.path.dirname(os.path.abspath(__file__))</span><br><span class="line">ROOT_PATH = os.path.join(current_path, <span class="string">&#x27;root&#x27;</span>)</span><br><span class="line">top_down_args = [<span class="literal">True</span>, <span class="literal">False</span>]</span><br><span class="line"><span class="keyword">for</span> top_down <span class="keyword">in</span> top_down_args:</span><br><span class="line">    print(<span class="string">f&#x27;Top_down is <span class="subst">&#123;top_down&#125;</span> â€¦â€¦&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> root, dirs, files <span class="keyword">in</span> os.walk(ROOT_PATH, topdown=top_down):</span><br><span class="line">        <span class="keyword">for</span> dir_item <span class="keyword">in</span> dirs:</span><br><span class="line">            print(<span class="string">f&#x27;dir is:<span class="subst">&#123;dir_item&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> f_item <span class="keyword">in</span> files:</span><br><span class="line">            print(<span class="string">f&#x27;file is <span class="subst">&#123;f_item&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿”å›ç»“æœï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Top_down is True â€¦â€¦</span><br><span class="line">dir is:d0</span><br><span class="line">dir is:d1</span><br><span class="line">file is f0</span><br><span class="line">dir is:d0_d1</span><br><span class="line">file is d0_f0</span><br><span class="line">file is d0_f1</span><br><span class="line">file is d0_d1_f0</span><br><span class="line">file is d1_f0</span><br><span class="line"></span><br><span class="line">Top_down is False â€¦â€¦</span><br><span class="line"></span><br><span class="line">file is d0_d1_f0</span><br><span class="line">dir is:d0_d1</span><br><span class="line">file is d0_f0</span><br><span class="line">file is d0_f1</span><br><span class="line">file is d1_f0</span><br><span class="line">dir is:d0</span><br><span class="line">dir is:d1</span><br><span class="line">file is f0</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼š</p></li><li>åœ¨<code>topdown</code>ä¼ å‚<code>True</code>çš„æ—¶å€™ï¼Œè¿”å›ç»“æœæŒ‰ç…§ç”±å¤–ï¼ˆæ ¹ç›®å½•ï¼‰å‘å†…çš„é¡ºåºæ‰«æï¼š<br>å…ˆæ‰«æç›®å½• d0ï¼Œæ¥ç€æ˜¯ d1 ç›®å½•ï¼Œç„¶åæ˜¯ f0ï¼Œç„¶åè¿›å…¥ d0 ç›®å½•ï¼Œæ‰«æåˆ° d0_d1 ç›®å½•å’Œæ–‡ä»¶ d0_f0 ä¸ d0_f1ï¼Œç„¶åè¿›å…¥ d0_d1 æ‰«æåˆ° d0_d1_f0ï¼Œæœ€åå¾—åˆ° d1_f0</li><li>åœ¨<code>topdown</code>ä¼ å‚<code>False</code>çš„æ—¶å€™ï¼Œè¿”å›ç»“æœæŒ‰ç…§ç”±å†…ï¼ˆæ ¹ç›®å½•ï¼‰å‘å¤–çš„é¡ºåºæ‰«æï¼š<br>å…ˆæ‰«ææœ€é‡Œå±‚çš„ d0_d1 ç›®å½•å¾—åˆ° d0_d1_f0ï¼Œæ‰«æå®Œ d0_d1 ç›®å½•ä¹‹åæ‰«æ d0_d1 ç›®å½•ï¼Œä¹‹ååˆ° d1 ç›®å½•ä¸­çš„ d1_f0ï¼Œæœ€ååˆ° f0 æ–‡ä»¶ã€‚</li></ol><blockquote><p>å½“ <code>topdown</code> ä¸º <code>True</code> æ—¶ï¼Œè°ƒç”¨è€…å¯ä»¥å°±åœ°ä¿®æ”¹ <code>dirnames</code> åˆ—è¡¨ï¼ˆä¹Ÿè®¸ç”¨åˆ°äº† <a href="https://docs.python.org3/reference/simple_stmts.html#del"><code>del</code></a> æˆ–åˆ‡ç‰‡ï¼‰ï¼Œè€Œ <code>walk()</code>å°†ä»…ä»…é€’å½’åˆ°ä»ä¿ç•™åœ¨ <code>dirnames</code> ä¸­çš„å­ç›®å½•å†…ã€‚è¿™å¯ç”¨äºå‡å°‘æœç´¢ã€åŠ å…¥ç‰¹å®šçš„è®¿é—®é¡ºåºï¼Œç”šè‡³å¯åœ¨ç»§ç»­ <code>walk()</code>ä¹‹å‰å‘ŠçŸ¥ <code>walk()</code> ç”±è°ƒç”¨è€…æ–°å»ºæˆ–é‡å‘½åçš„ç›®å½•çš„ä¿¡æ¯ã€‚å½“ <code>topdown</code> ä¸º <code>False</code> æ—¶ï¼Œä¿®æ”¹ <code>dirnames</code> å¯¹ walk çš„è¡Œä¸ºæ²¡æœ‰å½±å“ï¼Œå› ä¸ºåœ¨è‡ªä¸‹è€Œä¸Šæ¨¡å¼ä¸­ï¼Œ<code>dirnames</code> ä¸­çš„ç›®å½•æ˜¯åœ¨ <code>dirpath</code> æœ¬èº«ä¹‹å‰ç”Ÿæˆçš„ã€‚</p><footer><strong>os.walk,</strong><cite><a href="https://docs.python.org/zh-cn/3/library/os.html#os.walk">docs.python.org/zh-cn/3/library/os.html#os.walk</a></cite></footer></blockquote><p>æˆ‘ä»¬æ”¹å†™ä»£ç ï¼š<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> top_down <span class="keyword">in</span> top_down_args:</span><br><span class="line">    print(<span class="string">f&#x27;Top_down is <span class="subst">&#123;top_down&#125;</span> â€¦â€¦&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> root, dirs, files <span class="keyword">in</span> os.walk(ROOT_PATH, topdown=top_down):</span><br><span class="line">        <span class="keyword">if</span> dirs:</span><br><span class="line">            print(dirs, <span class="string">&#x27;=======ddd=========&#x27;</span>)</span><br><span class="line">            dirs[:] = [dirs[<span class="number">0</span>]]     <span class="comment"># æ³¨æ„æ­¤è¡Œ</span></span><br><span class="line">            print(<span class="string">f&#x27;==after=slice====ddd=====<span class="subst">&#123;dirs&#125;</span>====&#x27;</span>)</span><br><span class="line">            <span class="keyword">for</span> dir_item <span class="keyword">in</span> dirs:</span><br><span class="line">                print(<span class="string">f&#x27;dir is:<span class="subst">&#123;dir_item&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> f_item <span class="keyword">in</span> files:</span><br><span class="line">            print(<span class="string">f&#x27;file is <span class="subst">&#123;f_item&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure><br>è¿”å›ç»“æœï¼š<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># topdownä¸ºTrueæ—¶</span><br><span class="line">Top_down is True â€¦â€¦</span><br><span class="line">[&#39;d0&#39;, &#39;d1&#39;] &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;ddd&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">&#x3D;&#x3D;after&#x3D;slice&#x3D;&#x3D;&#x3D;&#x3D;ddd&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;[&#39;d0&#39;]&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">dir is:d0</span><br><span class="line">file is f0</span><br><span class="line">[&#39;d0_d1&#39;] &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;ddd&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">&#x3D;&#x3D;after&#x3D;slice&#x3D;&#x3D;&#x3D;&#x3D;ddd&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;[&#39;d0_d1&#39;]&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">dir is:d0_d1</span><br><span class="line">file is d0_f0</span><br><span class="line">file is d0_f1</span><br><span class="line">file is d0_d1_f0</span><br><span class="line"></span><br><span class="line"># topdownä¸ºFalseæ—¶</span><br><span class="line">Top_down is False â€¦â€¦</span><br><span class="line">file is d0_d1_f0</span><br><span class="line">[&#39;d0_d1&#39;] &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;ddd&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">&#x3D;&#x3D;after&#x3D;slice&#x3D;&#x3D;&#x3D;&#x3D;ddd&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;[&#39;d0_d1&#39;]&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">dir is:d0_d1</span><br><span class="line">file is d0_f0</span><br><span class="line">file is d0_f1</span><br><span class="line">file is d1_f0</span><br><span class="line">[&#39;d0&#39;, &#39;d1&#39;] &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;ddd&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">&#x3D;&#x3D;after&#x3D;slice&#x3D;&#x3D;&#x3D;&#x3D;ddd&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;[&#39;d0&#39;]&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">dir is:d0</span><br><span class="line">file is f0</span><br></pre></td></tr></table></figure><br>å¯¹æ¯”ç»“æœï¼Œæˆ‘ä»¬å‘ç°å½“<code>topdown</code>ä¸º<code>True</code>æ—¶ï¼Œd1 ç›®å½•å¯ä»¥é€šè¿‡åˆ‡ç‰‡ç­‰æ“ä½œï¼Œå¦‚ï¼š<a href="https://stackoverflow.com/questions/31015780/python-os-walk-topdown-true-with-regular-expression">regex - Python os.walk topdown true with regular expression - Stack Overflow</a> è¢«åŸåœ°ä¿®æ”¹è€Œè¿‡æ»¤æ‰ï¼›ä½†æ˜¯å½“<code>topdown</code>ä¸º<code>False</code>æ—¶ï¼Œå³ä½¿ä¸Šé¢çš„ä»£ç ä¸€æ ·ï¼Œd1 ç›®å½•è¿˜æ˜¯ä¼šè¢«æ‰«æåˆ°ã€‚æ‰€ä»¥è¯´<code>topdown</code>ä¸º<code>True</code>æ—¶å¯ä»¥<em>ç”¨äºå‡å°‘æœç´¢ã€åŠ å…¥ç‰¹å®šçš„è®¿é—®é¡ºåº</em>ã€‚</p><h2 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="headerlink" title="æ¨èé˜…è¯»"></a>æ¨èé˜…è¯»</h2><p><a href="https://treyhunner.com/2018/12/why-you-should-be-using-pathlib/">Why you should be using pathlib - Trey Hunner</a><br><a href="http://ominian.com/2016/03/29/os-walk-for-pathlib-path/">os.walk for pathlib.Path | Refactored scope</a> </p>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> TODO </tag>
            
            <tag> os.walk </tag>
            
            <tag> pathlib </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æŠŠä¸¤ä¸ª Git ä»“åº“åˆå¹¶èµ·æ¥</title>
      <link href="blog/2020-12-07/merge-repos-with-git/"/>
      <url>blog/2020-12-07/merge-repos-with-git/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h2 id="ç¼˜èµ·"><a href="#ç¼˜èµ·" class="headerlink" title="ç¼˜èµ·"></a>ç¼˜èµ·</h2><p>æœ¬äººä¸»é¢˜ä½¿ç”¨ <a href="https://github.com/jerryc127/hexo-theme-butterfly">hexo-theme-butterfly: ğŸ¦‹ A Hexo Theme: Butterfly</a> ï¼Œä½†æ˜¯åœ¨æ­¤åŸºç¡€ä¸Šåˆåšäº†ä¸€äº›è‡ªå®šä¹‰ã€‚ç”¨è¿‡ä¸€æ®µæ—¶é—´ä¹‹åï¼Œä½œè€…çš„æºä»“åº“å¯èƒ½æ›´æ–°äº†å¾ˆå¤šæ²¡æœ‰çš„åŠŸèƒ½ã€‚ä¹‹å‰çš„æ—¶å€™ï¼Œæ¯æ¬¡éƒ½æ˜¯æ‰‹åŠ¨ compare å¹¶åˆå¹¶çš„ï¼Œä½†æ˜¯å®è·µäº†ä¸¤æ¬¡ä¹‹åï¼Œå‘ç°å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š</p><ol><li>æ¯æ¬¡å‡çº§<strong>ååˆ†</strong>è€—æ—¶</li><li>è‡ªå·±å®šä¹‰çš„åŠŸèƒ½åœ¨åˆå¹¶æ—¶å¯èƒ½ä¸¢å¤±æˆ–é—æ¼</li></ol><p>é‰´äºæ­¤ï¼Œæœ¬æ–‡å°è¯•ä½¿ç”¨ä¸€ç§è¾ƒä¸ºæ™ºèƒ½çš„æ–¹å¼è§£å†³ä»¥ä¸Šé—®é¢˜ã€‚</p><h2 id="TL-DR"><a href="#TL-DR" class="headerlink" title="TL,DR"></a>TL,DR</h2><p>è¦æƒ³å°†æºä»“åº“ï¼ˆorigin repoï¼‰åˆå…¥ï¼ˆdest repoï¼‰ä¸­ï¼Œé‚£ä¹ˆå¯ä»¥å°†ï¼ˆorigin repoï¼‰ä¼ªé€ æˆï¼ˆdest repoï¼‰ä»“åº“çš„ä¸€ä¸ªåˆ†æ”¯ï¼Œç„¶ååˆå¹¶åˆ°ï¼ˆdest repoï¼‰ä»“åº“ä¸­çš„æŒ‡å®šåˆ†æ”¯ï¼ˆæœ¬æ–‡ä¸º devï¼‰ã€‚</p><h2 id="å·¥ä½œæµç¨‹"><a href="#å·¥ä½œæµç¨‹" class="headerlink" title="å·¥ä½œæµç¨‹"></a>å·¥ä½œæµç¨‹</h2><ol><li>æœ¬åœ°æ–°å»ºç›®å½•<code>butterfly</code></li><li>å…‹éš†ç›®æ ‡ä»“åº“<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/imoyao/hexo-theme-butterfly.git imoyao</span><br></pre></td></tr></table></figure></li><li>å…‹éš†æºä»“åº“<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/jerryc127/hexo-theme-butterfly.git</span><br></pre></td></tr></table></figure><img src= "/img/loading.svg" data-lazy-src="https://cdn.jsdelivr.net/gh/masantu/statics/images/20201207222903.png" alt="å…‹éš†ä¸¤ä¸ªä»“åº“åˆ†åˆ«ä½œä¸ºå­ç›®å½•"></li><li>å°†æºç›®å½•ï¼ˆjerrycï¼‰ä½œä¸ºè¿œç¨‹ä»“åº“æ·»åŠ åˆ°ç›®æ ‡ä»“åº“ï¼ˆimoyaoï¼‰ï¼Œå¹¶å‘½åä¸º<code>jerryc</code><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git remote add jerryc ../jerryc</span><br></pre></td></tr></table></figure></li><li>ä»æºä»“åº“ä¸‹è½½æ•°æ®åˆ°æœ¬ä»“åº“<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git fetch jerryc</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">remote: Enumerating objects: 139, done.</span><br><span class="line">remote: Counting objects: 100% (137&#x2F;137), done.</span><br><span class="line">remote: Compressing objects: 100% (28&#x2F;28), done.</span><br><span class="line">remote: Total 58 (delta 45), reused 43 (delta 30)</span><br><span class="line">Unpacking objects: 100% (58&#x2F;58), done.</span><br><span class="line">From ..&#x2F;jerryc</span><br><span class="line"> * [new branch]      dev        -&gt; jerryc&#x2F;dev</span><br><span class="line"></span><br></pre></td></tr></table></figure><div class="note success modern"><p><strong>git fetch</strong><br><a href="https://git-scm.com/docs/git-fetch">Git - git-fetch Documentation</a></p><blockquote><p>git-fetch - Download objects and refs from another repository<br>git fetch æ˜¯å°†è¿œç¨‹ä¸»æœºçš„æœ€æ–°å†…å®¹æ‹‰åˆ°æœ¬åœ°ï¼Œç”¨æˆ·åœ¨æ£€æŸ¥äº†ä»¥åå†³å®šæ˜¯å¦åˆå¹¶åˆ°å·¥ä½œæœ¬æœºåˆ†æ”¯ä¸­ã€‚</p><p>è€Œ git pull åˆ™æ˜¯å°†è¿œç¨‹ä¸»æœºçš„æœ€æ–°å†…å®¹æ‹‰ä¸‹æ¥åç›´æ¥åˆå¹¶ï¼Œå³ï¼šgit pull = git fetch + git mergeï¼Œè¿™æ ·å¯èƒ½ä¼šäº§ç”Ÿå†²çªï¼Œéœ€è¦æ‰‹åŠ¨è§£å†³ã€‚</p></blockquote></div></li><li><p>æŸ¥çœ‹æ­¤æ—¶ä»“åº“ä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git <span class="built_in">log</span></span><br><span class="line">commit 88b1cc553ce3c2b5e53dccb2ff259ddb078c333b (HEAD -&gt; dev, origin/dev, origin/HEAD)</span><br><span class="line">Author: Jerry &lt;***@gmail.com&gt;</span><br><span class="line">commit 88b1cc553ce3c2b5e53dccb2ff259ddb078c333b (HEAD -&gt; dev, origin/dev, origin</span><br><span class="line">/HEAD)</span><br><span class="line">Author: Jerry &lt;***@gmail.com&gt;</span><br><span class="line">Date:   Sat Nov 21 00:27:01 2020 +0800</span><br><span class="line"></span><br><span class="line"><span class="comment"># çœç•¥å†…å®¹</span></span><br><span class="line"></span><br><span class="line">commit 88b1cc553ce3c2b5e53dccb2ff259ddb078c333b (HEAD -&gt; dev, origin/dev, origin</span><br><span class="line">/HEAD)</span><br><span class="line">Author: Jerry &lt;***@gmail.com&gt;</span><br><span class="line">Date:   Sat Nov 21 00:27:01 2020 +0800</span><br><span class="line"></span><br><span class="line"><span class="comment"># çœç•¥å†…å®¹</span></span><br><span class="line"></span><br><span class="line">commit 7f03c3f71696fde1f1d3f1e969844ecde3d7f805</span><br><span class="line">Author: Jerry &lt;***@gmail.com&gt;</span><br><span class="line">Date:   Tue Nov 3 22:20:16 2020 +0800</span><br><span class="line"></span><br><span class="line"><span class="comment"># çœç•¥å†…å®¹</span></span><br><span class="line"></span><br><span class="line">```plain</span><br><span class="line">7. å°†æºä»“åº“ä¸‹è½½ä¸‹æ¥çš„ dev åˆ†æ”¯ä½œä¸ºæ–°åˆ†æ”¯ checkout åˆ°ç›®æ ‡åˆ†æ”¯`updatedev`</span><br><span class="line">```bash</span><br><span class="line">git checkout -b updatedev jerryc/dev</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Switched to a new branch &#39;updatedev&#39;</span><br><span class="line">Branch &#39;updatedev&#39; set up to track remote branch &#39;dev&#39; from &#39;jerryc&#39;.</span><br><span class="line"></span><br></pre></td></tr></table></figure><div class="note info modern"><p>æ­¤æ—¶åˆ†æ”¯çŠ¶æ€<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git branch</span><br></pre></td></tr></table></figure><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">  dev           # æˆ‘çš„å¼€å‘åˆ†æ”¯</span><br><span class="line">  master        # æˆ‘çš„ä¸»åˆ†æ”¯</span><br><span class="line">* updatedev     # ä½œè€…å’Œæˆ‘çš„fetchä¹‹åçš„åˆ†æ”¯</span><br></pre></td></tr></table></figure></p></div></li><li><p>åˆ‡æ¢åˆ°æˆ‘çš„<code>dev</code>åˆ†æ”¯</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git checkout dev</span><br></pre></td></tr></table></figure><div class="note info modern"><p>æ­¤æ—¶åˆ†æ”¯çŠ¶æ€<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git branch</span><br></pre></td></tr></table></figure><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">* dev</span><br><span class="line">  master</span><br><span class="line">  updatedev</span><br></pre></td></tr></table></figure></p></div></li><li><p>åˆå¹¶<code>fetch</code>çš„åˆ†æ”¯ä»£ç åˆ°æˆ‘çš„<code>dev</code>åˆ†æ”¯</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git merge updatedev</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Updating 88b1cc5..dc1c7c5</span><br><span class="line">Fast-forward</span><br><span class="line"> _config.yml                                        |  6 +-</span><br><span class="line"> languages&#x2F;default.yml                              |  6 +-</span><br><span class="line"> languages&#x2F;en.yml                                   |  2 +</span><br><span class="line"> languages&#x2F;zh-CN.yml                                |  4 +-</span><br><span class="line"># ä¸­é—´çœç•¥</span><br><span class="line"> source&#x2F;css&#x2F;_mode&#x2F;readmode.styl                     | 19 +++--</span><br><span class="line"> source&#x2F;js&#x2F;main.js                                  | 91 ++++++++++++++++------</span><br><span class="line"> source&#x2F;js&#x2F;utils.js                                 | 13 +++-</span><br><span class="line"> 31 files changed, 374 insertions(+), 169 deletions(-)</span><br><span class="line"> create mode 100644 layout&#x2F;includes&#x2F;third-party&#x2F;newest-comments&#x2F;twikoo-comment.pug</span><br><span class="line"></span><br></pre></td></tr></table></figure><div class="note warning modern"><p>è¡¥å……ï¼šå¦‚æœé‡åˆ°å¦‚ä¸‹æŠ¥é”™ï¼š<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">fatal: refusing to merge unrelated histories</span><br></pre></td></tr></table></figure><br>é‚£ä¹ˆå¯ä»¥<code>git merge</code>æ—¶åŠ ä¸Š<code>--allow-unrelated-histories</code>åç¼€ï¼š<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git merge repo1 --allow-unrelated-histories</span><br></pre></td></tr></table></figure></p></div></li><li><p>æŸ¥çœ‹åˆå¹¶åä»£ç </p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git <span class="built_in">log</span></span><br><span class="line">commit dc1c7c5efdbb92de10a44cec2e15d16b84823ce7 (HEAD -&gt; dev, jerryc/dev, updatedev)</span><br><span class="line">Merge: 02af307 97fe932</span><br><span class="line">Author: Jerry Wong &lt;***@gmail.com&gt;</span><br><span class="line">Date:   Mon Dec 7 21:17:09 2020 +0800</span><br><span class="line"></span><br><span class="line"><span class="comment"># çœç•¥å†…å®¹</span></span><br><span class="line"></span><br><span class="line">commit 97fe932ad9c22fa4b5690d38b33242eed11742f0</span><br><span class="line">Author: é›¶åº¦å†·å’–å•¡ &lt;***@outlook.com&gt;</span><br><span class="line">Date:   Mon Dec 7 08:25:02 2020 +0800</span><br><span class="line"></span><br><span class="line"><span class="comment"># çœç•¥å†…å®¹</span></span><br><span class="line"></span><br><span class="line">commit 01e7929c02a5fd018ab3171a381487a78f2df05c</span><br><span class="line">Merge: 7c3945f 02af307</span><br><span class="line">Author: é›¶åº¦å†·å’–å•¡ &lt;***@outlook.com&gt;</span><br><span class="line">Date:   Mon Dec 7 08:22:17 2020 +0800</span><br><span class="line"></span><br><span class="line"><span class="comment"># çœç•¥å†…å®¹</span></span><br><span class="line"></span><br><span class="line">commit 02af3077e71d02071ad3c7e8b159149310597513</span><br><span class="line">Author: Jerry &lt;***@gmail.com&gt;</span><br><span class="line">Date:   Sat Dec 5 22:28:54 2020 +0800</span><br><span class="line"></span><br><span class="line"><span class="comment"># çœç•¥å†…å®¹</span></span><br><span class="line"></span><br><span class="line">commit 88b1cc553ce3c2b5e53dccb2ff259ddb078c333b (origin/dev, origin/HEAD)</span><br><span class="line">Author: Jerry &lt;***@gmail.com&gt;</span><br><span class="line">Date:   Sat Nov 21 00:27:01 2020 +0800</span><br><span class="line"></span><br><span class="line"><span class="comment"># çœç•¥å†…å®¹</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src= "/img/loading.svg" data-lazy-src="https://cdn.jsdelivr.net/gh/masantu/statics/images/Snipaste_2020-12-07_23-04-14.png" alt="ç‚¹å‡»å¯æŸ¥çœ‹å¤§å›¾"></p><p>æ¨ªå‘æ‹¼å›¾å‚è€ƒ <a href="https://jingyan.baidu.com/article/b0b63dbf2eb2264a483070f0.html">æ­¤å¤„</a></p></li><li><p>åˆ é™¤æ— ç”¨çš„<code>fetch</code>åˆ†æ”¯<code>updatedev</code></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git branch -D updatedev</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Deleted branch updatedev (was dc1c7c5).</span><br></pre></td></tr></table></figure></li><li>æäº¤åˆ°è¿œç¨‹ä»“åº“<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Administrator@PC201803221826 MINGW64 /h/mycode/butterfly/imoyao (dev)</span><br><span class="line">$ git add .</span><br><span class="line"></span><br><span class="line">Administrator@PC201803221826 MINGW64 /h/mycode/butterfly/imoyao (dev)</span><br><span class="line">$ git commit -m <span class="string">&#x27;updatedev&#x27;</span></span><br><span class="line">On branch dev</span><br><span class="line">Your branch is ahead of <span class="string">&#x27;origin/dev&#x27;</span> by 4 commits.</span><br><span class="line">  (use <span class="string">&quot;git push&quot;</span> to publish your <span class="built_in">local</span> commits)</span><br><span class="line"></span><br><span class="line">nothing to commit, working tree clean</span><br><span class="line"></span><br><span class="line">Administrator@PC201803221826 MINGW64 /h/mycode/butterfly/imoyao (dev)</span><br><span class="line">$ git push</span><br><span class="line">Total 0 (delta 0), reused 0 (delta 0)</span><br><span class="line">To https://github.com.cnpmjs.org/imoyao/hexo-theme-butterfly.git</span><br><span class="line">   88b1cc5..dc1c7c5  dev -&gt; dev</span><br></pre></td></tr></table></figure>åŒæ ·çš„é“ç†ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ<code>master</code>åˆ†æ”¯ä¸åŸä½œè€…ä¿æŒåŒæ­¥ã€‚è¿™ä¸ªç•™ç»™è¯»è€…å»å®è·µç»ƒä¹ ã€‚</li></ol><h2 id="æ›´ä¸Šä¸€å±‚æ¥¼"><a href="#æ›´ä¸Šä¸€å±‚æ¥¼" class="headerlink" title="æ›´ä¸Šä¸€å±‚æ¥¼"></a>æ›´ä¸Šä¸€å±‚æ¥¼</h2><p>æŠŠæˆ‘è‡ªå·±ä¿®æ”¹çš„åˆå¹¶åˆ°æˆ‘çš„ä»“åº“ä¸­ã€‚</p><ol><li>æ‹·è´ç›®å½•åˆ°åŒçº§ç›®å½•<br><img src= "/img/loading.svg" data-lazy-src="https://cdn.jsdelivr.net/gh/masantu/statics/images/20201208003600.png" alt="ä¸‰ä¸ªåŒçº§æ–‡ä»¶å¤¹"></li><li>åˆå§‹åŒ–ä¸ºä»“åº“ï¼ˆå¦åˆ™æ— æ³•æ‰§è¡Œ git åˆå¹¶ï¼‰<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ git init</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Initialized empty Git repository in H:&#x2F;mycode&#x2F;butterfly&#x2F;masantu&#x2F;.git&#x2F;</span><br></pre></td></tr></table></figure></li><li>åœ¨ masantu ä»“åº“ä¸­ add å¹¶ commit ä»£ç ä½œä¸ºä¸€æ¬¡æäº¤<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">&#x27;init mycode to repo&#x27;</span></span><br></pre></td></tr></table></figure></li><li>æ·»åŠ è¿œç¨‹ä»“åº“<code>masantu</code>å¹¶å‘½åä¸º<code>masantu</code><br>å…³äºè¿™æ¡å‘½ä»¤çš„è§£é‡Š<a href="https://git-scm.com/docs/git-remote#Documentation/git-remote.txt-emaddem">Git - git-remote Documentation</a><blockquote><p>git remote add [shortname] [url]<br>Add a remote named <name> for the repository at <url>. The command git fetch <name> can then be used to create and update remote-tracking branches <name>/<branch>.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git remote add masantu ../masantu</span><br></pre></td></tr></table></figure></blockquote></li><li>å°†<code>masantu</code>ä»“åº“çš„ä»£ç æ‹‰åˆ°<code>imoyao</code>ä»“åº“ä¸­<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git fetch masantu</span><br><span class="line">warning: no common commits</span><br><span class="line">remote: Enumerating objects: 261, <span class="keyword">done</span>.</span><br><span class="line">remote: Counting objects: 100% (261/261), <span class="keyword">done</span>.</span><br><span class="line">remote: Compressing objects: 100% (259/259), <span class="keyword">done</span>.</span><br><span class="line">remote: Total 261 (delta 18), reused 0 (delta 0)</span><br><span class="line">Receiving objects: 100% (261/261), 259.62 KiB | 1.08 MiB/s, <span class="keyword">done</span>.</span><br><span class="line">Resolving deltas: 100% (18/18), <span class="keyword">done</span>.</span><br><span class="line">From ../masantu</span><br><span class="line"> * [new branch]      master     -&gt; masantu/master</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>ä»¥<code>masantu/master</code>ä½œä¸ºåŸºå‡†æ–°å»ºåˆ†æ”¯<code>upmst</code>(updatemasantu çš„ç®€å†™)</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git checkout -b upmst masantu/master</span><br><span class="line">Switched to a new branch <span class="string">&#x27;upmst&#x27;</span></span><br><span class="line">Branch <span class="string">&#x27;upmst&#x27;</span> <span class="built_in">set</span> up to track remote branch <span class="string">&#x27;master&#x27;</span> from <span class="string">&#x27;masantu&#x27;</span>.</span><br></pre></td></tr></table></figure><div class="note info modern"><p>æ­¤æ—¶åˆ†æ”¯çŠ¶æ€<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git branch</span><br></pre></td></tr></table></figure><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">  dev</span><br><span class="line">* upmst</span><br><span class="line">  master</span><br></pre></td></tr></table></figure></p></div></li><li><p>åˆ‡æ¢åˆ†æ”¯åˆ°<code>dev</code></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git checkout dev</span><br><span class="line">Switched to branch <span class="string">&#x27;dev&#x27;</span></span><br><span class="line">Your branch is up to date with <span class="string">&#x27;origin/dev&#x27;</span>.</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git branch</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">* dev</span><br><span class="line">  upmst</span><br><span class="line">  master</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li>åˆå¹¶<code>masantu</code>åˆ†æ”¯åˆ°<code>dev</code><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git merge upmst --allow-unrelated-histories</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">CONFLICT (add&#x2F;add): Merge conflict in source&#x2F;js&#x2F;utils.js</span><br><span class="line">Auto-merging source&#x2F;js&#x2F;utils.js</span><br><span class="line"># çœç•¥å†…å®¹</span><br><span class="line">Auto-merging source&#x2F;css&#x2F;_global&#x2F;function.styl</span><br><span class="line">CONFLICT (add&#x2F;add): Merge conflict in package.json</span><br></pre></td></tr></table></figure></li><li>æ‰‹åŠ¨è§£å†³å†²çª</li><li>æµ‹è¯•ï¼ˆå¦‚æœå¿…è¦ï¼‰å¹¶æäº¤åˆå¹¶çš„ä»£ç </li><li>åˆ é™¤åˆšæ‰çš„åˆ†æ”¯å’Œæ·»åŠ çš„è¿œç¨‹æº<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git branch -D upmst</span><br><span class="line">git remote remove masantu</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2></li></ol><p><a href="http://www.itmuch.com/work/merge-two-git-repo-unrelated/">åˆå¹¶ä¸¤ä¸ªä¸ç›¸å…³çš„ Git ä»“åº“ | å‘¨ç«‹çš„åšå®¢ - å…³æ³¨ Spring Cloudã€Docker</a></p>]]></content>
      
      
      <categories>
          
          <category> åšå®¢ä¸ªæ€§åŒ– </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> Butterfly </tag>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…è´¹ä¸ªäººåšå®¢å›¾åºŠè§£å†³æ–¹æ¡ˆ</title>
      <link href="blog/2020-12-06/images-hosting/"/>
      <url>blog/2020-12-06/images-hosting/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å†™åšå®¢çš„æ—¶å€™éœ€è¦å¼•ç”¨å¾ˆå¤šå›¾ç‰‡ï¼Œä¸€ç§å¸¸è§çš„æ–¹å¼æ˜¯åœ¨ä»“åº“ä¸­æ–°å»ºä¸€ä¸ªç›®å½•ç„¶åå¼•ç”¨ã€‚ä½†æ˜¯è¿™æ ·çš„è¯åœ¨ç½‘é¡µæŸ¥çœ‹æ—¶ä¼šæœ‰ç‚¹æ…¢ã€‚æ‰€ä»¥æœ¬æ–‡è¯•å›¾å¯»æ±‚ä¸€ç§ç›´æ¥ã€æœ‰æ•ˆã€æ–¹ä¾¿ã€å…è´¹ï¼ˆå°½é‡æˆ–è€…å¾ˆå®æƒ ï¼‰çš„å›¾åºŠæ–¹æ¡ˆã€‚</p><p><img src= "/img/loading.svg" data-lazy-src="https://cdn.jsdelivr.net/gh/masantu/statics@master/images/20180915163013.gif" alt="é±¼å’Œç†ŠæŒï¼Œä¸å¯å…¼å¾—"></p><h2 id="è‡ªå»ºå›¾åºŠ"><a href="#è‡ªå»ºå›¾åºŠ" class="headerlink" title="è‡ªå»ºå›¾åºŠ"></a><del>è‡ªå»ºå›¾åºŠ</del></h2><p>è¿™ç§æ–¹æ¡ˆå¯æ»¡è¶³æ¥å—å¤‡æ¡ˆï¼ˆå®åè®¤è¯ï¼‰åŠä»˜è´¹ç”¨æˆ·çš„éœ€æ±‚ã€‚</p><h3 id="åˆæ‹äº‘"><a href="#åˆæ‹äº‘" class="headerlink" title="åˆæ‹äº‘"></a><del>åˆæ‹äº‘</del></h3><p>éœ€è¦åŸŸåå¤‡æ¡ˆ</p><h3 id="ä¸ƒç‰›äº‘"><a href="#ä¸ƒç‰›äº‘" class="headerlink" title="ä¸ƒç‰›äº‘"></a><del>ä¸ƒç‰›äº‘</del></h3><ol><li>https å›¾ç‰‡å¤–é“¾æ”¶è´¹</li><li>éœ€è¦åŸŸåå¤‡æ¡ˆ</li></ol><h3 id="é˜¿é‡Œäº‘-OSS"><a href="#é˜¿é‡Œäº‘-OSS" class="headerlink" title="é˜¿é‡Œäº‘ OSS"></a>é˜¿é‡Œäº‘ OSS</h3><p>é˜¿é‡Œäº‘ OSS è®¡è´¹ç”±å››ä¸ªéƒ¨åˆ†ç»„æˆ: å­˜å‚¨è´¹ç”¨ + æµé‡è´¹ç”¨ + è¯·æ±‚è´¹ç”¨ + æ•°æ®å¤„ç†è´¹ç”¨</p><h2 id="å…è´¹å›¾åºŠ"><a href="#å…è´¹å›¾åºŠ" class="headerlink" title="å…è´¹å›¾åºŠ"></a><del>å…è´¹å›¾åºŠ</del></h2><p>ï¼ˆä¸å¤Ÿå®‰å…¨å’Œæ–¹ä¾¿ï¼‰</p><h3 id="sm-ms"><a href="#sm-ms" class="headerlink" title="sm.ms"></a>sm.ms</h3><p><a href="https://sm.ms/">Image Upload - SM.MS - Simple Free Image Hosting</a></p><blockquote><p>5 MB max per file. 10 files max per request.</p></blockquote><h3 id="èšåˆå›¾åºŠ-å…è´¹æ— é™å›¾ç‰‡ä¸Šä¼ "><a href="#èšåˆå›¾åºŠ-å…è´¹æ— é™å›¾ç‰‡ä¸Šä¼ " class="headerlink" title="èšåˆå›¾åºŠ - å…è´¹æ— é™å›¾ç‰‡ä¸Šä¼ "></a><a href="https://www.superbed.cn/">èšåˆå›¾åºŠ - å…è´¹æ— é™å›¾ç‰‡ä¸Šä¼ </a></h3><blockquote><p>å•å›¾æœ€å¤§ 5Mï¼Œ1000 ä¸ªæ–‡ä»¶</p></blockquote><p>é™åˆ¶æ¡ä»¶<a href="https://www.superbed.cn/vip">è§æ­¤</a></p><h3 id="è·¯è¿‡å›¾åºŠ-å…è´¹å›¾ç‰‡ä¸Šä¼ -ä¸“ä¸šå›¾ç‰‡å¤–é“¾-å…è´¹å…¬å…±å›¾åºŠ"><a href="#è·¯è¿‡å›¾åºŠ-å…è´¹å›¾ç‰‡ä¸Šä¼ -ä¸“ä¸šå›¾ç‰‡å¤–é“¾-å…è´¹å…¬å…±å›¾åºŠ" class="headerlink" title="è·¯è¿‡å›¾åºŠ - å…è´¹å›¾ç‰‡ä¸Šä¼ , ä¸“ä¸šå›¾ç‰‡å¤–é“¾, å…è´¹å…¬å…±å›¾åºŠ"></a><a href="https://imgchr.com/">è·¯è¿‡å›¾åºŠ - å…è´¹å›¾ç‰‡ä¸Šä¼ , ä¸“ä¸šå›¾ç‰‡å¤–é“¾, å…è´¹å…¬å…±å›¾åºŠ</a></h3><blockquote><p>å…¨çƒ CDN åŠ é€Ÿ, æ”¯æŒå¤–é“¾, åŸå›¾ä¿å­˜, æœ€å¤§å•å¼ æ”¯æŒ 10 MB</p></blockquote><p>é™åˆ¶æ¡ä»¶<a href="https://imgchr.com/page/tos">æœåŠ¡æ¡æ¬¾ - è·¯è¿‡å›¾åºŠ</a></p><h3 id="æœçˆ±å›¾åºŠ"><a href="#æœçˆ±å›¾åºŠ" class="headerlink" title="æœçˆ±å›¾åºŠ"></a><a href="https://i.sofever.com/">æœçˆ±å›¾åºŠ</a></h3><blockquote><p>åˆä¸€ä¸ªé çˆ±å‘ç”µçš„å…è´¹å›¾åºŠ</p></blockquote><h3 id="å›¾åºŠæµ‹è¯•"><a href="#å›¾åºŠæµ‹è¯•" class="headerlink" title="å›¾åºŠæµ‹è¯•"></a>å›¾åºŠæµ‹è¯•</h3><p>ä¸ºäº†å®éªŒä¸Šè¿°å…è´¹å›¾åºŠçš„æœ‰æ•ˆæ€§ï¼Œæˆ‘åˆ†åˆ«ä¸Šä¼ äº†ä¸€å¼ å›¾ç‰‡ä»¥ä¾›æµ‹è¯•ã€‚å¦‚æœä»–ä»¬çš„æœåŠ¡å¯ç”¨ï¼Œåˆ™å¯ä»¥åœ¨ä¸‹æ–¹çœ‹åˆ°å›¾ç‰‡è¢«æ­£å¸¸åŠ è½½ã€‚å¦‚æœåªæ˜¯ä¸´æ—¶ä½¿ç”¨ï¼Œå¯ä»¥ç‚¹å‡»å›¾ç‰‡ç›´è¾¾ä½¿ç”¨ã€‚</p><p><a href="https://imgchr.com/i/DXaxFs"><img src= "/img/loading.svg" data-lazy-src="https://s3.ax1x.com/2020/12/06/DXaxFs.jpg" alt="è·¯è¿‡å›¾åºŠ"></a></p><p><a href="https://www.superbed.cn/"><img src= "/img/loading.svg" data-lazy-src="https://pic.downk.cc/item/5fcc7602394ac5237839e4bf.jpg" alt="èšåˆå›¾åºŠ"></a></p><p><a href="https://sm.ms/"><img src= "/img/loading.svg" data-lazy-src="https://i.loli.net/2020/12/06/ZODeJTQL7vpSBaW.jpg" alt="Image Upload - SM.MS - Simple Free Image Hosting"></a></p><p><a href="https://imgkr.com/"><img src= "/img/loading.svg" data-lazy-src="https://static01.imgkr.com/temp/77df24ba89314c24bff7750f10b4d187.jpg" alt="å›¾å£³"></a></p><p><a href="https://postimages.org/"><img src= "/img/loading.svg" data-lazy-src="https://i.postimg.cc/tRNvCQQR/image.jpg" alt="postimages"></a></p><p><a href="https://i.sofever.com/"><img src= "/img/loading.svg" data-lazy-src="https://i.sofever.com/dispatch/3f32f1602f93c974f59d15bef9d27e13" alt="Snipaste_2021-01-19_20-16-37.png"></a></p><h3 id="å¼€å‘è€…"><a href="#å¼€å‘è€…" class="headerlink" title="å¼€å‘è€…"></a>å¼€å‘è€…</h3><p><a href="https://github.com/0xDkd/auxpi">0xDkd/auxpi: ğŸ­ é›†åˆå¤šå®¶ API çš„æ–°ä¸€ä»£å›¾åºŠ</a><br><a href="https://github.com/staugur/picbed">staugur/picbed: åŸºäº Flask çš„ Web è‡ªå»ºå›¾åºŠï¼Œæ”¯æŒå­˜å‚¨åˆ°åˆæ‹äº‘ã€ä¸ƒç‰›äº‘ã€é˜¿é‡Œäº‘ OSSã€è…¾è®¯äº‘ COSã€GitHubã€Gitee</a></p><h2 id="çœŸçš„å…è´¹"><a href="#çœŸçš„å…è´¹" class="headerlink" title="çœŸçš„å…è´¹"></a>çœŸçš„å…è´¹</h2><h3 id="æœåŠ¡æä¾›å•†-jsDelivr"><a href="#æœåŠ¡æä¾›å•†-jsDelivr" class="headerlink" title="æœåŠ¡æä¾›å•† jsDelivr"></a>æœåŠ¡æä¾›å•† jsDelivr</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// load any GitHub release, commit, or branch</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// note: we recommend using npm for projects that support it</span></span><br><span class="line"></span><br><span class="line">https:<span class="comment">//cdn.jsdelivr.net/gh/user/repo@version/file</span></span><br></pre></td></tr></table></figure><p>æ¯”å¦‚ï¼Œæˆ‘ä»¬åœ¨ç”¨æˆ·åï¼ˆimoyaoï¼‰ä¸‹åˆ›å»ºä»“åº“ï¼ˆstaticsï¼‰ï¼Œåˆ™åˆ†æ”¯ï¼ˆmaster/mainï¼‰ä¸‹çš„æ–‡ä»¶ï¼ˆfile_path_with_nameï¼‰å¯ä»¥é€šè¿‡ CDN è·å–ã€‚<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F;å›¾ç‰‡ä¸ŠåºŠåˆ°Githubä»“åº“çš„åœ°å€</span><br><span class="line">https:&#x2F;&#x2F;github.com&#x2F;&#123;imoyao&#125;&#x2F;&#123;statics&#125;&#x2F;tree&#x2F;&#123;master&#125;&#x2F;&#123;file_path_with_name&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;jsdelivré“¾æ¥åœ°å€</span><br><span class="line">https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;gh&#x2F;&#123;imoyao&#125;&#x2F;&#123;statics&#125;@&#123;master&#125;&#x2F;&#123;file_path_with_name&#125;</span><br></pre></td></tr></table></figure></p><h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><h3 id="å®ç°æ€è·¯"><a href="#å®ç°æ€è·¯" class="headerlink" title="å®ç°æ€è·¯"></a>å®ç°æ€è·¯</h3><ol><li>å€ŸåŠ© GoodSync/freefilesyncï¼ˆå¾…éªŒè¯ï¼‰å®ç°ä¸»ç«™ã€åšå®¢ã€wiki ä¸­çš„å›¾ç‰‡å¤‡ä»½åˆ° static ç›®å½•ï¼›</li><li>å›¾åºŠç›®å½•ä¸­çš„å›¾ç‰‡å…¨éƒ¨è¿›è¡Œæ— æŸå‹ç¼©ï¼›</li><li>å°† post ä¸­çš„å›¾ç‰‡é“¾æ¥æ›¿æ¢ä¸º jsDelivrï¼›</li></ol><h3 id="æ–‡ä»¶å¤¹åŒæ­¥è½¯ä»¶"><a href="#æ–‡ä»¶å¤¹åŒæ­¥è½¯ä»¶" class="headerlink" title="æ–‡ä»¶å¤¹åŒæ­¥è½¯ä»¶"></a>æ–‡ä»¶å¤¹åŒæ­¥è½¯ä»¶</h3><h4 id="GoodSync-vs-freefilesync"><a href="#GoodSync-vs-freefilesync" class="headerlink" title="GoodSync vs freefilesync"></a>GoodSync vs freefilesync</h4><blockquote><p>å…³äºå¤‡ä»½ï¼Œæœ‰ä¸¤ä¸ªæä¼˜ç§€çš„è½¯ä»¶æˆ‘ä¸å¾—ä¸æâ€”â€”Macrium Reflect å’Œ GoodSyncã€‚å¦‚æœè¯´ Macrium ä¸ºæˆ‘æä¾›äº†æ•´å¥—çš„ç³»ç»Ÿä»¥åŠç£ç›˜å¤‡ä»½çš„è§£å†³æ–¹æ¡ˆï¼Œé‚£ä¹ˆ GoodSync å¯ä»¥è¯´æ˜¯åªè¦æœ‰æ­£åœ¨è¿è¡Œçš„ç³»ç»Ÿï¼ˆå®ƒä¹Ÿå¯ä»¥è¿è¡Œåœ¨ U ç›˜é‡Œï¼‰å­˜åœ¨ï¼Œå®ƒå¯ä»¥è§£å†³ä»»ä½•çš„å¤‡ä»½ã€åŒæ­¥ã€ä¼ è¾“éœ€æ±‚ã€‚</p><p>å®ƒæ”¯æŒä»»æ„ï¼ˆå¯ä»¥éæœ¬æœºï¼Œå¯ä»¥åœ¨å†…ç½‘ï¼Œå¯ä»¥æ˜¯äº‘å­˜å‚¨ï¼‰æ–‡ä»¶å¤¹åˆ°ä»»æ„æ–‡ä»¶å¤¹å¤‡ä»½ä¸åŒæ­¥ã€‚</p><p>åŒæ—¶å®ƒè¿˜æ”¯æŒè‡ªåŠ¨æ‰§è¡ŒåŒæ­¥ã€å¤‡ä»½åŠŸèƒ½ï¼Œé€šè¿‡æ£€æµ‹æ–‡ä»¶å¤¹çš„å˜åŠ¨ï¼Œæ‰€ä»¥å®ƒå¯ä»¥æ»¡è¶³æˆ‘ä¸Šè¿°çš„ä¸¤ä¸ªéœ€æ±‚ã€‚</p></blockquote><p>å‚è€ƒé˜…è¯»<a href="https://www.appinn.com/goodsync-2019/">æ–‡ä»¶åŒæ­¥å·¥å…· GoodSync é™å…åˆæ¥äº†ï¼Œè¿™è´§åˆ°åº•æœ‰ä»€ä¹ˆç”¨ï¼Ÿ - å°ä¼—è½¯ä»¶</a></p><p>æœ€ç»ˆé€‰æ‹©ï¼š<a href="https://freefilesync.org/download.php">FreeFileSync</a></p><p><img src= "/img/loading.svg" data-lazy-src="https://cdn.jsdelivr.net/gh/masantu/statics/images/20201206160024.png" alt="é…ç½®è‡ªå®šä¹‰è§„åˆ™"></p><div class="note warning modern"><p><strong>æ³¨æ„</strong></p><p>åŒæ­¥é…ç½®æ—¶é€‰æ‹©<em>è‡ªå®šä¹‰</em>ï¼Œä¸Šæ–¹é€‰æ‹©æ–‡ä»¶å¯¹æ¯”æ—¶å¯èƒ½å‡ºç°çš„æƒ…å½¢ï¼Œä¸‹æ–¹é€‰æ‹©å½“å‡ºç°é…ç½®æƒ…å½¢æ—¶éœ€è¦åšçš„ç›¸åº”å¤„ç†åŠ¨ä½œï¼Œæœ€å¥½ä¸è¦æŠŠå³ä¾§é•œåƒç›®å½•çš„å›¾ç‰‡åˆ é™¤ã€‚å¦‚æœå¯¹è‡ªå·±çš„é…ç½®ä¸ç¡®å®šï¼Œè¯·ä¿è¯å›æ”¶ç«™å¯ç”¨çš„åŒæ—¶å¯¹å¤„ç†é€»è¾‘è¿›è¡Œæµ‹è¯•ï¼</p></div><p>ä½¿ç”¨æ•™ç¨‹ï¼š<a href="https://zhuanlan.zhihu.com/p/140026821">å¼ºå¤§çš„å¤‡ä»½è½¯ä»¶ FreeFileSync - çŸ¥ä¹</a></p><h3 id="å‰ªåˆ‡å›¾ç‰‡ç›´æ¥ä¸Šä¼ ä»“åº“"><a href="#å‰ªåˆ‡å›¾ç‰‡ç›´æ¥ä¸Šä¼ ä»“åº“" class="headerlink" title="å‰ªåˆ‡å›¾ç‰‡ç›´æ¥ä¸Šä¼ ä»“åº“"></a>å‰ªåˆ‡å›¾ç‰‡ç›´æ¥ä¸Šä¼ ä»“åº“</h3><p>ä½¿ç”¨ PicGo ç›´æ¥ä¸Šä¼ ä»“åº“ï¼Œå‚è§ï¼š<a href="https://github.com/Molunerfinn/PicGo">Molunerfinn/PicGo: A simple &amp; beautiful tool for pictures uploading built by vue-cli-electron-builder</a></p><h3 id="å®šæœŸå¯¹å›¾ç‰‡è¿›è¡Œæ— æŸå‹ç¼©"><a href="#å®šæœŸå¯¹å›¾ç‰‡è¿›è¡Œæ— æŸå‹ç¼©" class="headerlink" title="å®šæœŸå¯¹å›¾ç‰‡è¿›è¡Œæ— æŸå‹ç¼©"></a>å®šæœŸå¯¹å›¾ç‰‡è¿›è¡Œæ— æŸå‹ç¼©</h3><p>æŒ‰éœ€æŸ¥æ‰¾ï¼š<a href="https://tinypng.com/third-party">TinyPNG â€“ Third-Party Solutions</a><br>æ’ä»¶ç‰ˆï¼š<a href="https://plugins.jetbrains.com/plugin/11573-tinypng-image-optimizer">TinyPNG Image Optimizer - IntelliJ IDEs | JetBrains</a><br>æ›´å¤šå‚è§ï¼š<a href="https://www.zhihu.com/question/20432364">æœ‰æ²¡æœ‰ä¸€ä¸ªæ‰¹é‡å‹ç¼©å›¾ç‰‡è½¯ä»¶ï¼Ÿ - çŸ¥ä¹</a><br>Github Action<a href="https://github.com/marketplace/actions/tinify-image-action">Tinify Image Action Â· Actions Â· GitHub Marketplace</a></p><h3 id="å›¾ç‰‡å»é‡"><a href="#å›¾ç‰‡å»é‡" class="headerlink" title="å›¾ç‰‡å»é‡"></a>å›¾ç‰‡å»é‡</h3><p>ä½¿ç”¨<a href="http://www.bigbangenterprises.de/en/doublekiller/download.htm">DoubleKiller - Download [english] (Big Bang enterprises)</a>å¯¹ä¸Šä¼  Github ä»“åº“çš„å›¾ç‰‡è¿›è¡Œå»é‡ã€‚<br><a href="https://www.zhihu.com/question/35069783">å¯»æ‰¾ä¸€æ¬¾æ¸…ç†ç”µè„‘ä¸­é‡å¤æ–‡ä»¶çš„è½¯ä»¶? - çŸ¥ä¹</a></p><h3 id="è§†é¢‘"><a href="#è§†é¢‘" class="headerlink" title="è§†é¢‘"></a>è§†é¢‘</h3><p>è§†é¢‘æ–‡ä»¶è¾ƒå¤§ï¼Œæˆ‘ä»¬ä¸è¦ä¸Šä¼ åˆ° Github ä»“åº“ä¸­ï¼Œç›´æ¥ä½¿ç”¨è§†é¢‘å›¾åºŠå³å¯ã€‚<br>å‚è§ï¼š<a href="http://imgbed.cn/">å›¾åºŠ - å›¾ç‰‡ä¸Šä¼ , å¤–é“¾, é«˜æ¸…åŸå›¾, æ°¸ä¹…å…è´¹, æ”¯æŒè§†é¢‘ä¸Šä¼ </a></p><p>ç”±äºä¸Šé¢çš„ç½‘ç«™åªæ”¯æŒæœ€å¤§ 5M çš„è§†é¢‘ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ OneDrive ç½‘ç›˜å­˜å‚¨æˆ‘ä»¬çš„æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨ä¸‹é¢çš„ç½‘ç«™è§£æç›´é“¾ä½¿ç”¨ï¼š</p><p><a href="https://onedrive.gimhoy.com/">OneDrive ç½‘ç›˜æ°¸ä¹…å¤–é“¾åœ°å€ç”Ÿæˆå·¥å…·</a></p><h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><ol><li>åšå®¢å°½é‡å°‘åŠ å›¾ç‰‡</li><li>å°½é‡å°†å›¾ç‰‡æ”¾åœ¨åšå®¢ç›®å½•ä¸‹ï¼Œä¸ä½¿ç”¨å›¾åºŠ</li><li>å¯¹äºä¸é‡è¦çš„å›¾ç‰‡ï¼Œå¯ä»¥ä½¿ç”¨å…è´¹å›¾åºŠ</li><li>å¯ä»¥è´­ä¹°ä¸€äº›ä»˜è´¹çš„ä¸“é—¨çš„å›¾åºŠæœåŠ¡</li></ol><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://sspai.com/post/40499">å—¯ï¼Œå›¾ç‰‡å°±äº¤ç»™å®ƒäº† - å°‘æ•°æ´¾</a><br><a href="https://sspai.com/post/55032">æ— éœ€æ³¨å†Œã€æ‰“å¼€å³ç”¨ï¼Œè¿™ 8 ä¸ªå…è´¹å¥½ç”¨çš„å›¾åºŠå·¥å…·å€¼å¾—ä¸€è¯• - å°‘æ•°æ´¾</a><br><a href="https://www.jianshu.com/p/2b14396a6eb2">æ›´æ¢åšå®¢å›¾åºŠ - ç®€ä¹¦</a><br><a href="https://yi-yun.github.io/%E5%9B%BE%E5%BA%8A%E7%9A%84%E9%80%89%E6%8B%A9/">å¯èƒ½æ˜¯æœ€ä½³çš„å…è´¹å›¾åºŠ | æ–¯æ˜¯é™‹å®¤ï¼ŒæƒŸå¾å¾·é¦¨</a><br><a href="https://glumes.com/post/life/blog-image-migrate/">åšå®¢å›¾åºŠè¿ç§»è®°</a><br><a href="https://wdd.js.org/the-hard-way-of-markdown-insert-images.html">markdown åšå®¢å›¾åºŠä¸Šä¼ çš„è‰°è¾›ä¹‹è·¯ | æ´é¦™æ˜¥</a><br><a href="http://tengj.top/2019/08/18/tuchuang/">åšå®¢å›¾åºŠæœ€ä½³è§£å†³æ–¹æ¡ˆ | å˜Ÿå˜Ÿç‹¬ç«‹åšå®¢</a><br><a href="https://v2ex.com/t/551634">å„ä½ v å‹ï¼Œä½ ä»¬åšå®¢çš„å›¾åºŠéƒ½é‡‡ç”¨ä»€ä¹ˆæ–¹æ¡ˆå•Š - V2EX</a></p>]]></content>
      
      
      <categories>
          
          <category> å–„ç”¨ä½³è½¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åšå®¢ </tag>
            
            <tag> å›¾åºŠ </tag>
            
            <tag> è½¯ä»¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åº–ä¸è§£ç‰› | ä»»åŠ¡åˆ†è§£ï¼Œå„ä¸ªå‡»ç ´</title>
      <link href="blog/2020-12-05/browse-your-tasks/"/>
      <url>blog/2020-12-05/browse-your-tasks/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h2 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h2><ol><li>èŒƒå›´ç¡®å®š<br>æœ‰æ‰€ä¸ºæœ‰æ‰€ä¸ä¸ºï¼Œå…ˆç¡®å®šä¸»è¦çŸ›ç›¾æ˜¯ä»€ä¹ˆã€‚</li><li>ç›®æ ‡åˆ†è§£ </li><li>ä¼˜å…ˆçº§ç¡®å®š </li><li>å¯æ‰§è¡ŒåŒ–ä»»åŠ¡åˆ†è§£ </li><li>è¿›å…¥è·Ÿè¸ªç³»ç»Ÿ</li></ol><h2 id="ä½œç”¨"><a href="#ä½œç”¨" class="headerlink" title="ä½œç”¨"></a>ä½œç”¨</h2><ol><li>æŠŠå¤§ä»»åŠ¡åˆ†è§£æˆå°ä»»åŠ¡ï¼Œå·¥æ—¶ä¼°è®¡ä¼šæ›´åŠ å‡†ç¡®</li><li>é¢å¯¹ä»¥å‰æ²¡åšè¿‡çš„éœ€æ±‚ï¼Œé€šè¿‡ä»»åŠ¡åˆ†è§£éå†ä¸€æ¬¡ï¼Œç†Ÿæ‚‰åº¦æå‡ä¹‹åå°±ä¸ä¼šææ…Œ</li><li>åå¤æ¨æ¼”ï¼Œå…¨ç›˜è€ƒè™‘ï¼Œé¿å…è¿”å·¥</li><li>å…³æ³¨å½“ä¸‹ï¼Œåªåšæœ‰å®é™…æ„ä¹‰çš„äº‹æƒ…</li></ol><h2 id="å¦‚ä½•å®è·µ"><a href="#å¦‚ä½•å®è·µ" class="headerlink" title="å¦‚ä½•å®è·µ"></a>å¦‚ä½•å®è·µ</h2><p>è¿™é‡Œç»™å¤§å®¶æ¨èä¸€ä¸ªå°æŠ€å·§ï¼Œå¿ƒç†å­¦ä¸Šå«åšæ¿€åŠ±ã€‚æˆ‘ä»¬å¯ä»¥æŠŠåˆ†è§£å®Œçš„æ­¥éª¤ç½—åˆ—åœ¨è‡ªå·±çš„ç¬”è®°æœ¬ä¸Šï¼Œç„¶åæ¯å®Œæˆä¸€ä¸ªæ­¥éª¤å°±æ‹¿ç¬”åœ¨åé¢æ‰“ä¸€ä¸ªå‹¾ï¼Œè¿™æ ·åšèƒ½ç»™è‡ªå·±å¸¦æ¥ä¸€å®šçš„æˆå°±æ„Ÿå’Œæ»¡è¶³æ„Ÿã€‚</p><p>ç›¸å¯¹äºå°ä»»åŠ¡æ¥è¯´ï¼Œå¤§ç›®æ ‡è§„æ¨¡æ¯”è¾ƒå¤§ï¼Œéå¸¸æœ‰å¿…è¦å¯¹å…¶è¿›è¡Œåˆ†å±‚å¤„ç†ã€‚éƒ½è¦æœ‰ä¸€ä¸ªä¸­å¿ƒæ€æƒ³ã€‚è¿™ä¸ªä¸­å¿ƒæ€æƒ³ä¸‹é¢ï¼Œå¯èƒ½ä¼šæœ‰å‡ ä¸ªä¸»åˆ†è®ºç‚¹ï¼Œè€Œæ¯ä¸€ä¸ªä¸»åˆ†è®ºç‚¹ä¸‹é¢å¯èƒ½è¿˜ä¼šæœ‰å‡ ä¸ªäºŒçº§ä¸»åˆ†è®ºç‚¹ï¼Œä¸€ç›´ç»†åˆ†åˆ°æ¯ä¸€ä¸ªå­è®ºç‚¹ã€‚</p><p>æˆ‘ä»¬åœ¨åˆ†è§£å¤§ç›®æ ‡çš„æ—¶å€™ï¼Œå°±å¯ä»¥å€Ÿé‰´ä¸Šé¢è¿™ç§åˆ†å±‚æ€æƒ³å»æ“ä½œã€‚</p><p>ä»¥ä¸ªäººæˆé•¿ä¸ºä¾‹ï¼Œæˆ‘ä»¬çš„æ ¸å¿ƒç›®æ ‡å°±æ˜¯æˆä¸ºä¸€ä¸ªæ›´å¥½çš„è‡ªå·±ã€‚é‚£ä¹ˆè¿™ä¸ªæ ¸å¿ƒç›®æ ‡å°±å¯ä»¥åˆ†è§£æˆæ€æƒ³ï¼ˆå­¦è¯†æ›´æ¸Šåšï¼‰ã€ç»æµï¼ˆè´¢åŠ¡è‡ªç”±åº¦æ›´é«˜ï¼‰ã€å¥åº·ï¼ˆèº«ä½“ç´ è´¨æ›´å¥½ï¼‰ã€äººé™…ï¼ˆè·Ÿèº«è¾¹äººç›¸å¤„å¾—æ›´å¥½ï¼‰å››ä¸ªä¸»ç›®æ ‡ã€‚å°±ç»æµä¸»ç›®æ ‡è€Œè¨€ï¼Œæˆ‘ä»¬åˆå¯ä»¥åˆ†è§£æˆå¼€æºï¼ˆæå‡èµšé’±èƒ½åŠ›ï¼‰å’ŒèŠ‚æµï¼ˆæå‡ç†è´¢èƒ½åŠ›ï¼‰ä¸¤ä¸ªæ¬¡ä¸»ç›®æ ‡ã€‚æ¥ä¸‹æ¥è¿˜å¯ä»¥æŠŠèŠ‚æµç›®æ ‡å†æ¬¡åˆ†è§£ï¼Œåˆ†è§£æˆç†è´¢ï¼ˆå‚¨è“„å’ŒæŠ•èµ„ï¼‰å’Œæ¶ˆè´¹ï¼ˆç†æ€§æ¶ˆè´¹ï¼‰ä¸¤éƒ¨åˆ†ã€‚å°±è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­ç»†åˆ†ä¸‹å»ï¼Œä¸€ç›´åˆ°äº†ç°å®å½“ä¸­å¯æ“ä½œçš„æ¯ä¸€ä¸ªåŠ¨ä½œã€‚</p><p>é€šè¿‡ç›®æ ‡åˆ†è§£ï¼Œæˆ‘ä»¬ä¼šæ„è¯†åˆ°è¿™äº›äº‹æƒ…è™½ç„¶å¤æ‚ï¼Œè¦åšå¥½çš„éš¾åº¦æ¯”è¾ƒé«˜ï¼Œä½†æ˜¯å¹¶éä¸å¯ä¼åŠã€‚å…ˆå°†å¤§ç›®æ ‡åˆ†è§£æˆå°ç›®æ ‡ï¼Œç„¶åå†ä¸€æ­¥æ­¥é€šè¿‡å®ç°å°ç›®æ ‡çš„æ–¹å¼ï¼Œçœ‹åˆ°ä¸€æ¡æœ‰å¸Œæœ›å®ç°å¤§ç›®æ ‡çš„é“è·¯ã€‚</p><h2 id="å†™åœ¨æœ€å"><a href="#å†™åœ¨æœ€å" class="headerlink" title="å†™åœ¨æœ€å"></a>å†™åœ¨æœ€å</h2><blockquote><p>å…³äºäº§å“æœ‰ä¸¤ä¸ªä»¤äººä¸å¿«çš„äº‹å®ï¼š<br>çœŸç›¸ 1ï¼šæˆ‘ä»¬è‡³å°‘æœ‰ä¸€åŠçš„æƒ³æ³•è¡Œä¸é€šã€‚<br>çœŸç›¸ 2ï¼šå³ä½¿æ˜¯å¥½ä¸»æ„ï¼Œä¹Ÿè¦ç»è¿‡å¤šæ¬¡è¿­ä»£æ‰èƒ½å˜å¾—å¯è¡Œã€‚</p><footer><strong>eBay åˆ›å§‹å›¢é˜Ÿæˆå‘˜é©¬è’‚Â·å¡æ ¹ï¼ˆMarty Caganï¼‰</strong><cite><a href="https://mgadams.com/the-founders-guide-to-actually-understanding-users-c68feaecac44">mgadams.com/the-founders-guide-to-actually-understanding-users-c68feaecac44</a></cite></footer></blockquote><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://zhuanlan.zhihu.com/p/29117340">ä»»åŠ¡åˆ†è§£çš„äº”ä¸ªæ­¥éª¤ - çŸ¥ä¹</a><br><a href="https://www.cnblogs.com/levenyes/p/10783861.html">2019 å¹´ç¨‹åºå‘˜æœ€å€¼å¾—å­¦ä¹ çš„æ€ç»´åˆ©å™¨â€”â€”ä»»åŠ¡åˆ†è§£ - LevenYes - åšå®¢å›­</a></p>]]></content>
      
      
      <categories>
          
          <category> Projects </category>
          
          <category> FMP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> TODO </tag>
            
            <tag> é¡¹ç›® </tag>
            
            <tag> OKR </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•å°†ä»£ç æ‰“è¡¥ä¸ï¼ˆpatchï¼‰ï¼Ÿ</title>
      <link href="blog/2020-11-04/git-patch-apply/"/>
      <url>blog/2020-11-04/git-patch-apply/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨åŸºäºå¼€æºé¡¹ç›®åšäºŒæ¬¡å¼€å‘çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šåœ¨æŸä¸€ä¸ªç‰ˆæœ¬å·ä¸Šå¼€å§‹ï¼Œç„¶ååšå¼€å‘ã€‚å½“å¼€å‘è¿›è¡Œä¸€æ®µæ—¶é—´ä¹‹åï¼Œè¿œç¨‹ä¸Šé¢çš„ä»£ç å¯èƒ½å·²ç»å’Œæˆ‘ä»¬çš„ä»£ç å¤§ç›¸å¾„åº­äº†ï¼Œè¿™ä¸ªæ—¶å€™æƒ³è¦åˆå¹¶å°±ä¼šå˜å¾—ç›¸å¯¹æ¯”è¾ƒå›°éš¾ï¼Œæ‰€ä»¥åœ¨æ­¤è®°å½•ä¸€ä¸‹æµç¨‹ã€‚</p><h2 id="å·¥ä½œæµ"><a href="#å·¥ä½œæµ" class="headerlink" title="å·¥ä½œæµ"></a>å·¥ä½œæµ</h2><h3 id="æŸ¥æ‰¾-patch-å¼€å§‹çš„-id"><a href="#æŸ¥æ‰¾-patch-å¼€å§‹çš„-id" class="headerlink" title="æŸ¥æ‰¾ patch å¼€å§‹çš„ id"></a>æŸ¥æ‰¾ patch å¼€å§‹çš„ id</h3><p>ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬äºŒæ¬¡å¼€å‘æ—¶ä¼šå…ˆæ‹‰å–åˆ†æ”¯ä½œä¸ºæœ¬åœ°ä»“åº“ï¼Œå³ç¬¬ä¸€æ¬¡ git init çš„å†…å®¹æ˜¯å’Œå¼€æºæŸä¸€ä¸ªåˆ†æ”¯æˆ–è€… tag ä»£ç å®Œå…¨ä¸€è‡´ã€‚<br><img src= "/img/loading.svg" data-lazy-src="/images/Snipaste_2020-11-04_18-08-50.png" alt="init æäº¤"><br>æ‰€ä»¥æˆ‘ä»¬éœ€è¦æŠŠ init ä¹‹åçš„ç¬¬ä¸€æ¬¡ä»£ç ä½œä¸ºè¡¥ä¸çš„å¼€å§‹ç«¯ï¼ˆè¯¥ä»“åº“ç¬¬äºŒæ¬¡æäº¤ï¼‰ï¼Œæ‰¾åˆ°è¯¥æäº¤çš„ commi idã€‚</p><h3 id="ç”Ÿæˆ-patch-æ–‡ä»¶"><a href="#ç”Ÿæˆ-patch-æ–‡ä»¶" class="headerlink" title="ç”Ÿæˆ patch æ–‡ä»¶"></a>ç”Ÿæˆ patch æ–‡ä»¶</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git format-patch 703ae2b80580e1xxx3f718d428572b50</span><br></pre></td></tr></table></figure><h3 id="åº”ç”¨-patch"><a href="#åº”ç”¨-patch" class="headerlink" title="åº”ç”¨ patch"></a>åº”ç”¨ patch</h3><ol><li>ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>git am</code>å°±å¯ä»¥å°†è¡¥ä¸åº”ç”¨ä¸Šå»<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">imoyao@DESKTOP-NIQS11K MINGW64 /d/Gerrit/dashboard (master)</span><br><span class="line"><span class="meta">$</span><span class="bash"> git am ../patches/0029-fix-bug-16115-fix-bug-16117.patch</span></span><br><span class="line">Applying: fix bug 16115:å…³æœºä¹‹åæ— æ³•ç‚¹å‡»å¼€æœº;fix bug 16117:æ‰¹é‡ç‚¹ç¯ä¹Ÿéœ€è¦ä¼ èŠ‚ç‚¹åç§°;</span><br></pre></td></tr></table></figure>æ²¡æœ‰ error åˆ™è¡¨ç¤ºè¡¥ä¸æ‰“æˆåŠŸäº†ã€‚ä½†æ˜¯ï¼Œæœ‰çš„æäº¤é‡Œé¢éš¾å…ä¼šæœ‰å†²çªï¼Œè¿™ä¸ªæ—¶å€™<code>am</code>æ‰“è¡¥ä¸ä¼šæŠ¥é”™ï¼š<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">imoyao@DESKTOP-NIQS11K MINGW64 /d/Gerrit/dashboard (master)</span><br><span class="line"><span class="meta">$</span><span class="bash"> git am ../patches/0031-fix-bug-16115-1.-socket-host.patch</span></span><br><span class="line">error: patch failed: controllers/host.py:13</span><br><span class="line">error: controllers/host.py: patch does not apply</span><br><span class="line">error: patch failed: controllers/ipmitool.py:484</span><br><span class="line">error: controllers/ipmitool.py: patch does not apply</span><br><span class="line">Applying: fix bug:16115:xxx</span><br><span class="line">Use &#x27;git am --show-current-patch&#x27; to see the failed patch</span><br><span class="line">When you have resolved this problem, run &quot;git am --continue&quot;.</span><br><span class="line">If you prefer to skip this patch, run &quot;git am --skip&quot; instead.</span><br><span class="line">To restore the original branch and stop patching, run &quot;git am --abort&quot;.</span><br></pre></td></tr></table></figure>å¦‚æœç›´æ¥<code>am</code>æŠ¥é”™ï¼ˆä¸Šä¸€æ­¥ä¸å¯è·³è¿‡ï¼‰ï¼Œæ­¤æ—¶æ“ä½œæµç¨‹å¦‚ä¸‹ï¼š</li><li><p>å°è¯•ä»¥ apply çš„æ–¹å¼ç›´æ¥ <a href="https://git-scm.com/docs/git-apply#Documentation/git-apply.txt---reject">reject</a> åˆ°æºç ä¸Šã€‚</p><div class="note info modern"><p><strong>reject</strong><br>ä¸ºäº†æ»¡è¶³åŸå­æ€§ï¼Œ<code>git apply</code>å‘½ä»¤é»˜è®¤åœ¨æŸäº› hunks æ— æ³•åº”ç”¨æ—¶ä¼šç›´æ¥è¿”å›å¤±è´¥ä¸”ä¸ä¼šåˆ›å»ºå·¥ä½œæ ‘ï¼Œè¯¥é…ç½®ä½¿è¡¥ä¸å¯ä»¥éƒ¨åˆ†åº”ç”¨åŒæ—¶å°†é‚£äº›è¢«æ‹’ç»çš„å†…å®¹ç›´æ¥ä¿ç•™åœ¨<code>*.rej</code> æ–‡ä»¶ä¸­ã€‚</p></div><blockquote><p>For atomicity, git apply by default fails the whole patch and does not touch the working tree when some of the hunks do not apply. This option makes it apply the parts of the patch that are applicable, and leave the rejected hunks in corresponding *.rej files.</p></blockquote><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git apply patches/0002-1.-2.-disk-host.get-api-3.-4.-utils-5.-conf.patch --reject</span><br></pre></td></tr></table></figure></li><li>æ‰‹åŠ¨è§£å†³å†²çªï¼Œæ‰¾åˆ° rej æ–‡ä»¶ï¼Œç„¶åæŠŠå†²çªå†…å®¹æ‰‹åŠ¨æ·»åŠ ä¸Šå»ï¼Œä¹‹åæ‰‹åŠ¨åˆ é™¤ rej æ–‡ä»¶ã€‚<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git status | grep rej</span><br><span class="line">rm xxx.rej</span><br></pre></td></tr></table></figure></li><li><p>ä¹‹åæäº¤ä»£ç ï¼Œä½¿ç”¨<code>git am</code>åº”ç”¨è¡¥ä¸ï¼š</p><div class="note info modern"><p><strong>â€“resolved</strong><br>è¡¥ä¸å¤±è´¥å(ä¾‹å¦‚ï¼Œè¯•å›¾åº”ç”¨å†²çªçš„è¡¥ä¸)ï¼Œç”¨æˆ·å·²ç»æ‰‹åŠ¨åº”ç”¨å®ƒå¹¶ä¸”ç´¢å¼•æ–‡ä»¶å­˜å‚¨åº”ç”¨çš„ç»“æœã€‚ä½¿ç”¨ä»ç”µå­é‚®ä»¶æ¶ˆæ¯å’Œå½“å‰ç´¢å¼•æ–‡ä»¶ä¸­æå–çš„ author å’Œ commit æ—¥å¿—å¯¹å†…å®¹è¿›è¡Œæäº¤ï¼Œç„¶åç»§ç»­ã€‚</p></div><blockquote><p>After a patch failure (e.g. attempting to apply conflicting patch), the user has applied it by hand and the index file stores the result of the application. Make a commit using the authorship and commit log extracted from the e-mail message and the current index file, and continue.</p></blockquote><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git add .</span><br><span class="line">git am --resolved</span><br></pre></td></tr></table></figure></li><li>æŸ¥çœ‹æ—¥å¿—ï¼Œä¹‹å‰æäº¤çš„å†…å®¹åº”è¯¥å·²ç»ä½œä¸ºè¡¥ä¸åº”ç”¨åˆ°æ–°ä»£ç ä¸Šé¢äº†ã€‚<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git log</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><a href="https://git-scm.com/docs/git-am">Git - git-am Documentation</a><br><a href="https://git-scm.com/docs/git-apply">Git - git-apply Documentation</a><br><a href="https://blog.csdn.net/sinat_20059415/article/details/80598347">git æ‰“è¡¥ä¸æ–¹æ³•æ€»ç»“_JT çš„ä¸“æ -CSDN åšå®¢</a></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> å¼€æº </tag>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python ä¸­åŠ¨æ€è°ƒç”¨å‡½æ•°æˆ–ç±»çš„æ–¹æ³•</title>
      <link href="blog/2020-10-15/python-call-method-dynamically/"/>
      <url>blog/2020-10-15/python-call-method-dynamically/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h2 id="ä½¿ç”¨exec-æ–¹æ³•"><a href="#ä½¿ç”¨exec-æ–¹æ³•" class="headerlink" title="ä½¿ç”¨exec()æ–¹æ³•"></a>ä½¿ç”¨<code>exec()</code>æ–¹æ³•</h2><ul><li>ç¤ºä¾‹ä»£ç <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># module.py</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">foo</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;this is foo.&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">bar</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;this is bar&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">baz</span>():</span></span><br><span class="line">    print(<span class="string">&#x27;bazâ€¦â€¦&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>åœ¨ main ä¸­è°ƒç”¨ï¼š<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># main.py</span></span><br><span class="line">module_name = <span class="string">&#x27;module&#x27;</span></span><br><span class="line">exec(<span class="string">&#x27;  &#x27;</span>.join([<span class="string">&#x27;import&#x27;</span>, module_name]))</span><br><span class="line">a = module.A()</span><br><span class="line">a.foo()</span><br><span class="line">a.bar()</span><br><span class="line"></span><br><span class="line">module.baz()</span><br></pre></td></tr></table></figure></li><li>ç»“æœ<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">this is foo.</span><br><span class="line">this is bar</span><br><span class="line">bazâ€¦â€¦</span><br></pre></td></tr></table></figure></li><li>è§£é‡Š<br>è¿™é‡Œè¯·å‚é˜…<a href="https://docs.python.org/zh-cn/3/library/functions.html#exec">exec() å®˜æ–¹æ–‡æ¡£</a>ï¼Œç›¸å½“äºä½¿ç”¨<code>exec()</code>æ‰§è¡Œäº†ä¸€å¥<code>import module</code>è¯­å¥ï¼Œåé¢çš„ä¹Ÿå°±ä¸ç”¨è§£é‡Šäº†ã€‚<blockquote><p>è¿™ä¸ªå‡½æ•°æ”¯æŒåŠ¨æ€æ‰§è¡Œ Python ä»£ç ã€‚object å¿…é¡»æ˜¯å­—ç¬¦ä¸²æˆ–è€…ä»£ç å¯¹è±¡ã€‚å¦‚æœæ˜¯å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆè¯¥å­—ç¬¦ä¸²å°†è¢«è§£æä¸ºä¸€ç³»åˆ— Python è¯­å¥å¹¶æ‰§è¡Œï¼ˆé™¤éå‘ç”Ÿè¯­æ³•é”™è¯¯ï¼‰<br>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå®é™…ä¸Šå¯¹äº exec() çš„æ­£ç¡®ä½¿ç”¨æ˜¯æ¯”è¾ƒéš¾çš„ã€‚</p></blockquote>å…³äº<code>exec()</code>çš„ä½¿ç”¨è¯´æ˜è¯·é˜…è¯»æ­¤å¤„<a href="https://python3-cookbook.readthedocs.io/zh_CN/latest/c09/p23_executing_code_with_local_side_effects.html#id4">å¦‚ä½•æ­£ç¡®ä½¿ç”¨<code>exec</code>æ–¹æ³•</a>ã€‚<blockquote><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œexec() ä¼šåœ¨è°ƒç”¨è€…å±€éƒ¨å’Œå…¨å±€èŒƒå›´å†…æ‰§è¡Œä»£ç ã€‚ç„¶è€Œï¼Œåœ¨å‡½æ•°é‡Œé¢ï¼Œ ä¼ é€’ç»™ exec() çš„å±€éƒ¨èŒƒå›´æ˜¯æ‹·è´å®é™…å±€éƒ¨å˜é‡ç»„æˆçš„ä¸€ä¸ªå­—å…¸ã€‚ å› æ­¤ï¼Œå¦‚æœ exec() å¦‚æœæ‰§è¡Œäº†ä¿®æ”¹æ“ä½œï¼Œè¿™ç§ä¿®æ”¹åçš„ç»“æœå¯¹å®é™…å±€éƒ¨å˜é‡å€¼æ˜¯æ²¡æœ‰å½±å“çš„ã€‚</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; def test1():</span><br><span class="line">...     x &#x3D; 0</span><br><span class="line">...     exec(&#39;x +&#x3D; 1&#39;)</span><br><span class="line">...     print(x)</span><br><span class="line">...</span><br><span class="line">&gt;&gt;&gt; test1()</span><br><span class="line">0</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure></blockquote><h2 id="ä½¿ç”¨-import-é­”æ³•æ–¹æ³•"><a href="#ä½¿ç”¨-import-é­”æ³•æ–¹æ³•" class="headerlink" title="ä½¿ç”¨__import__é­”æ³•æ–¹æ³•"></a>ä½¿ç”¨<code>__import__</code>é­”æ³•æ–¹æ³•</h2>å•ç‹¬ä½¿ç”¨<code>__import__()</code> å¯ä»¥ç›´æ¥åŠ è½½æ¨¡å—ï¼Œä½†æ˜¯å½“éœ€è¦åŠ¨æ€åŠ è½½ç±»ã€å‡½æ•°æ—¶ï¼Œå°±éœ€è¦é…åˆ getattr æ¥å®ç°ã€‚<br>å®ç°æ­¥éª¤ï¼š</li></ul><ol><li>è·å–æ¨¡å—å(module_name)</li><li>ä½¿ç”¨<code>__import__(module_name)</code>å¯¼å…¥ Python æ¨¡å—</li><li>ä½¿ç”¨ <code>getattr(module_name, class_name/function_name)</code>è·å–ç±»ã€æ–¹æ³•çš„å¯¹è±¡</li></ol><ul><li>ç¤ºä¾‹ä»£ç <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># module.py</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">foo</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;this is foo.&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">static_method</span>():</span></span><br><span class="line">        print(<span class="string">&#x27;this is static.&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bar</span>():</span></span><br><span class="line">    print(<span class="string">&#x27;barâ€¦â€¦&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">baz</span>():</span></span><br><span class="line">    print(<span class="string">&#x27;==baz==&#x27;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># main.py</span></span><br><span class="line"></span><br><span class="line">module_name = <span class="string">&#x27;module&#x27;</span>  <span class="comment"># æ¨¡å—å</span></span><br><span class="line">class_name = <span class="string">&#x27;A&#x27;</span>  <span class="comment"># ç±»å</span></span><br><span class="line">class_method = <span class="string">&#x27;foo&#x27;</span>  <span class="comment"># ç±»ä¸­æ–¹æ³•åç§°</span></span><br><span class="line">func_name = <span class="string">&#x27;bar&#x27;</span>  <span class="comment"># å‡½æ•°å</span></span><br><span class="line">module_obj = <span class="built_in">__import__</span>(module_name)</span><br><span class="line"><span class="comment"># è°ƒç”¨æ¨¡å—ä¸­çš„ç±»</span></span><br><span class="line">class_of_module_obj = <span class="built_in">getattr</span>(module_obj, class_name)</span><br><span class="line"><span class="comment"># å®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line">instance_of_cmo = class_of_module_obj()</span><br><span class="line"><span class="comment"># è°ƒç”¨å®ä¾‹çš„æ–¹æ³•</span></span><br><span class="line">method_of_cmo = <span class="built_in">getattr</span>(instance_of_cmo, class_method)</span><br><span class="line">method_of_cmo()</span><br><span class="line">instance_of_cmo.static_method()</span><br><span class="line"><span class="comment"># è°ƒç”¨æ¨¡å—çš„å‡½æ•°</span></span><br><span class="line">func_of_mo = <span class="built_in">getattr</span>(module_obj, func_name)</span><br><span class="line">func_of_mo()</span><br><span class="line"><span class="comment"># ä¹Ÿå¯ä»¥ç›´æ¥è°ƒç”¨ï¼ˆåƒçœŸæ­£importæ¨¡å—é‚£æ ·ï¼‰</span></span><br><span class="line">module_obj.baz()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨-importlib"><a href="#ä½¿ç”¨-importlib" class="headerlink" title="ä½¿ç”¨ importlib"></a>ä½¿ç”¨ importlib</h2>è¿™ç§æ–¹å¼å…¶å®æ˜¯<code>__import__()</code> æ–¹å¼çš„æ‰©å±•ã€‚<code>Python</code>å®˜æ–¹æ–‡æ¡£æ¨èç¨‹åºå¼åœ°å¯¼å…¥æ¨¡å—æ—¶åº”è¯¥ä½¿ç”¨ <code>import_module()</code> è€Œä¸æ˜¯<code>__import__</code>ã€‚<br>è¿™é‡Œæˆ‘ä»¬ç»§ç»­ä½¿ç”¨ä¸Šé¢å®šä¹‰å¥½çš„<code>module.py</code>æ¨¡å—ã€‚<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># main.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> importlib</span><br><span class="line"></span><br><span class="line">module_name = <span class="string">&#x27;module&#x27;</span></span><br><span class="line"></span><br><span class="line">module_obj = importlib.import_module(module_name)</span><br><span class="line">class_of_module_obj = module_obj.A()</span><br><span class="line">class_of_module_obj.foo()</span><br><span class="line">class_of_module_obj.static_method()</span><br><span class="line">module_obj.bar()</span><br></pre></td></tr></table></figure>æ–‡æ¡£å‚è§æ­¤å¤„ï¼š<a href="https://docs.python.org/zh-cn/3/library/importlib.html">importlib â€” import çš„å®ç° â€” Python 3.9.0 æ–‡æ¡£</a><blockquote><p>importlib åŒ…çš„ç›®çš„æœ‰ä¸¤ä¸ªã€‚ </p><p>ç¬¬ä¸€ä¸ªç›®çš„æ˜¯åœ¨ Python æºä»£ç ä¸­æä¾› import è¯­å¥çš„å®ç°ï¼ˆå¹¶ä¸”å› æ­¤è€Œæ‰©å±• <code>__import__()</code> å‡½æ•°ï¼‰ã€‚ è¿™æä¾›äº†ä¸€ä¸ªå¯ç§»æ¤åˆ°ä»»ä½• Python è§£é‡Šå™¨çš„ import å®ç°ã€‚ ç›¸æ¯”ä½¿ç”¨ Python ä»¥å¤–çš„ç¼–ç¨‹è¯­è¨€å®ç°æ–¹å¼ï¼Œè¿™ä¸€å®ç°æ›´åŠ æ˜“äºç†è§£ã€‚</p><p>ç¬¬äºŒä¸ªç›®çš„æ˜¯å®ç° import çš„éƒ¨åˆ†è¢«å…¬å¼€åœ¨è¿™ä¸ªåŒ…ä¸­ï¼Œä½¿å¾—ç”¨æˆ·æ›´å®¹æ˜“åˆ›å»ºä»–ä»¬è‡ªå·±çš„è‡ªå®šä¹‰å¯¹è±¡ (é€šå¸¸è¢«ç§°ä¸º importer) æ¥å‚ä¸åˆ°å¯¼å…¥è¿‡ç¨‹ä¸­ã€‚</p></blockquote></li></ul><h2 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h2><p>æˆ‘ä»¬åœ¨ä½¿ç”¨ redis çš„æ—¶å€™ï¼Œæœ‰æ—¶å€™éœ€è¦æ·»åŠ ä¸€ä¸ªä»£ç†ç±»ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RedisClient</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">init_con</span>(<span class="params">self, *args, **kwargs</span>):</span></span><br><span class="line">        <span class="comment"># do init things</span></span><br><span class="line">        <span class="comment"># like connect redis</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><br>ç„¶åå¸Œæœ›ç›´æ¥é€šè¿‡è¿™ä¸ª RedisClient æ‰§è¡Œ redis ç›¸å…³æ“ä½œ, æ¯”å¦‚ set, get, hgetâ€¦<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">rc = RedisClient()</span><br><span class="line">rc.<span class="built_in">set</span>(...)</span><br><span class="line">rc.get(...)</span><br><span class="line">...</span><br></pre></td></tr></table></figure><br>è¿™æ ·è°ƒç”¨çš„è¯, å°±éœ€è¦å°† pyredis ä¸­çš„æ‰€æœ‰å‡½æ•°éƒ½åœ¨ RedisClient ä¸­å†™ä¸€é, é‚£å°±æœ‰ç‚¹å¾—ä¸å¿å¤±äº†ã€‚</p><p>è¿™é‡Œå®é™…å°±æ˜¯å¸Œæœ›èƒ½å¤Ÿåšåˆ°åŠ¨æ€è°ƒç”¨, å°† RedisClient ä¸­çš„æ“ä½œ, æ ¹æ®æ“ä½œå, ç›´æ¥æ˜ å°„åˆ°å®é™…çš„ pyredis æ“ä½œä¹‹ä¸Šã€‚</p><p>æ‰€ä»¥, æˆ‘ä»¬åœ¨ RedisClient ä¸­ï¼š<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RedisClient</span>:</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__getattr__</span>(<span class="params">self, func_name</span>):</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">func</span>(<span class="params">*args, **kwargs</span>):</span></span><br><span class="line">            <span class="comment"># è¿™é‡Œçš„ getattr å®é™…å°±ç›¸å½“äºredis_con.&lt;func_name&gt;äº†</span></span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">getattr</span>(self.redis_conn, func_name)(*args, **args)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    redis_client = RedisClient()</span><br><span class="line">    redis_client.init_con(...)</span><br><span class="line">    redis_client.<span class="built_in">set</span>(<span class="string">&#x27;key_name&#x27;</span>, <span class="string">&#x27;key_value&#x27;</span>)</span><br></pre></td></tr></table></figure><br>è¿™æ ·ï¼Œå°±å®ç°åŠ¨æ€è°ƒåŠ¨ pyredis çš„æ“ä½œçš„ç›®çš„äº†ã€‚</p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://threezh1.com/2019/07/12/Python%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BD%E6%A8%A1%E5%9D%97%E7%9A%84%E5%87%A0%E7%A7%8D%E6%96%B9%E5%BC%8F/#1-exec">Python åŠ¨æ€åŠ è½½æ¨¡å—ã€ç±»ã€å‡½æ•°çš„å‡ ç§æ–¹å¼ - Threezh1â€™s blog</a><br><a href="https://www.u3v3.com/ar/1313">python ç±»æ–¹æ³•çš„åŠ¨æ€è°ƒç”¨ - u3v3</a></p><h2 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="headerlink" title="æ¨èé˜…è¯»"></a>æ¨èé˜…è¯»</h2><p><a href="https://python3-cookbook.readthedocs.io/zh_CN/latest/c08/p20_call_method_on_object_by_string_name.html">8.20 é€šè¿‡å­—ç¬¦ä¸²è°ƒç”¨å¯¹è±¡æ–¹æ³•</a><br><a href="https://python3-cookbook.readthedocs.io/zh_CN/latest/c09/p23_executing_code_with_local_side_effects.html#id4">9.23 åœ¨å±€éƒ¨å˜é‡åŸŸä¸­æ‰§è¡Œä»£ç </a></p>]]></content>
      
      
      <categories>
          
          <category> ğŸPyTricks </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> ç¼–ç¨‹ </tag>
            
            <tag> magic </tag>
            
            <tag> exec </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•ä½¿ç”¨ Python å¯¹æ–‡ä»¶è¿›è¡ŒåŸå­æ€§ï¼ˆatomicï¼‰è¯»å†™æ“ä½œï¼Ÿ</title>
      <link href="blog/2020-09-23/atomic-writing-to-file-with-python/"/>
      <url>blog/2020-09-23/atomic-writing-to-file-with-python/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æˆ‘ä»¬çŸ¥é“ï¼šPython ä¸­ä¸€åˆ‡ç±»æ–‡ä»¶æ“ä½œçš„æœ€ä½³å®è·µéƒ½æ˜¯ä½¿ç”¨<code>with</code>è¯­å¥ã€‚ï¼ˆå¦‚æœå¯¹äºè¿™ä¸ªè¯´æ³•æœ‰ç–‘æƒ‘ï¼Œè¯·å‚è€ƒé˜…è¯»ï¼š<a href="https://stackoverflow.com/questions/3012488/what-is-the-python-with-statement-designed-for">language features - What is the python â€œwithâ€ statement designed for? - Stack Overflow</a> ï¼‰åœ¨ç¼–å†™<a href="/blog/2020-07-22/alua-with-drbd/">ä»²è£æœåŠ¡</a>æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å°†ä»²è£æœåŠ¡å™¨çš„ä¿¡æ¯è®°å½•è¿›é…ç½®æ–‡ä»¶<code>referee.conf</code>ã€‚åŒæ—¶ï¼Œä¸å¯é¿å…åœ°éœ€è¦å¯¹è¯¥æ–‡ä»¶è¿›è¡Œæ›´æ–°ã€‚ç”±äºç³»ç»Ÿéœ€è¦å¯¹æ–‡ä»¶åœ¨æŸä¸ªçº¿ç¨‹ä¸­è¿›è¡Œè¯»ï¼Œä¸æ­¤åŒæ—¶å¦ä¸€ä¸ªçº¿ç¨‹å¯èƒ½æ­£åœ¨å¯¹å…¶è¿›è¡Œä¿®æ”¹ã€‚æ­¤æ—¶ï¼Œä½¿é…ç½®æ–‡ä»¶æ“ä½œä¿æŒåŸå­æ€§ä¾¿è‡³å…³é‡è¦ã€‚</p><h2 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h2><p>æ¯”å¦‚æˆ‘ä»¬è¦å°†<code>enable</code>ç”±<code>True</code>æ”¹ä¸º<code>False</code>ä»£è¡¨ç¦ç”¨è¯¥åŠŸèƒ½ã€‚åŒæ—¶å¦ä¸€ä¸ªçº¿ç¨‹è¯»å–ä»²è£æœåŠ¡å™¨çš„<code>ip</code>ä»¥ä¸åœæ¢æµ‹ä»²è£æœåŠ¡è¿è¡ŒçŠ¶æ€ã€‚åˆ™å¿…é¡»ä¿è¯æ–‡ä»¶ä¿®æ”¹æ“ä½œå…·æœ‰åŸå­æ€§ã€‚å³ä½¿ä½¿ç”¨ with æ‰“å¼€ï¼Œè¿˜æ˜¯ä¼šæœ‰ä¸€ä¸ªçª—å£å¯¼è‡´æ–‡ä»¶è¢«æ‰“å¼€ä½†æ˜¯æ–°å†…å®¹æ²¡æœ‰è¢«åˆ·å†™ï¼Œæ­¤æ—¶æ„å¤–æ‰ç”µæˆ–é‡æ–°è¿›å…¥çª—å£ï¼Œåˆ™å¯èƒ½ä¼šå¯¼è‡´ï¼šæ•°æ®ä¿®æ”¹å¤±æ•ˆã€æ–‡ä»¶è¢«æ¸…ç©ºç­‰ï¼Œå³æ— æ³•é¿å…ç«æ€æ“ä½œã€‚</p><h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><p>ä¸€ç§å¯è¡Œçš„æ–¹æ¡ˆæ˜¯è®©æ–‡ä»¶çœŸæ­£è½ç›˜ï¼Œç„¶åå¯¹æ–‡ä»¶é‡å‘½åã€‚å‚è€ƒä»£ç ï¼š<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> tempfile</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> tempfile</span><br><span class="line"><span class="keyword">from</span> contextlib <span class="keyword">import</span> contextmanager</span><br><span class="line"></span><br><span class="line"><span class="meta">@contextmanager</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tempfile_cmgr</span>(<span class="params">suffix=<span class="string">&#x27;&#x27;</span>, <span class="built_in">dir</span>=<span class="literal">None</span></span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot; Context for temporary file.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Will find a free temporary filename upon entering</span></span><br><span class="line"><span class="string">    and will try to delete the file on leaving, even in case of an exception.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Parameters</span></span><br><span class="line"><span class="string">    ----------</span></span><br><span class="line"><span class="string">    suffix : string</span></span><br><span class="line"><span class="string">        optional file suffix</span></span><br><span class="line"><span class="string">    dir : string</span></span><br><span class="line"><span class="string">        optional directory to save temporary file in</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    tf = tempfile.NamedTemporaryFile(delete=<span class="literal">False</span>, suffix=suffix, <span class="built_in">dir</span>=<span class="built_in">dir</span>)</span><br><span class="line">    tf.file.close()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">yield</span> tf.name</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            os.remove(tf.name)</span><br><span class="line">        <span class="keyword">except</span> OSError <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">if</span> e.errno == <span class="number">2</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">raise</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@contextmanager</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">open_atomic</span>(<span class="params">filepath, *args, **kwargs</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot; Open temporary file object that atomically moves to destination upon</span></span><br><span class="line"><span class="string">    exiting.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Allows reading and writing to and from the same filename.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    The file will not be moved to destination in case of an exception.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Parameters</span></span><br><span class="line"><span class="string">    ----------</span></span><br><span class="line"><span class="string">    filepath : string</span></span><br><span class="line"><span class="string">        the file path to be opened</span></span><br><span class="line"><span class="string">    fsync : bool</span></span><br><span class="line"><span class="string">        whether to force write the file to disk</span></span><br><span class="line"><span class="string">    *args : mixed</span></span><br><span class="line"><span class="string">        Any valid arguments for :code:`open`</span></span><br><span class="line"><span class="string">    **kwargs : mixed</span></span><br><span class="line"><span class="string">        Any valid keyword arguments for :code:`open`</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    fsync = kwargs.get(<span class="string">&#x27;fsync&#x27;</span>, <span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> tempfile_cmgr(<span class="built_in">dir</span>=os.path.dirname(os.path.abspath(filepath))) <span class="keyword">as</span> tmppath:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(tmppath, *args, **kwargs) <span class="keyword">as</span> file:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="keyword">yield</span> file</span><br><span class="line">            <span class="keyword">finally</span>:</span><br><span class="line">                <span class="comment"># make sure that all data is on disk ç¡®ä¿æ•°æ®åˆ·å†™åˆ°é“¶ç›˜ä¸Š</span></span><br><span class="line">                <span class="comment"># see http://stackoverflow.com/questions/7433057/is-rename-without-fsync-safe</span></span><br><span class="line">                <span class="keyword">if</span> fsync:</span><br><span class="line">                    file.flush()</span><br><span class="line">                    os.fsync(file.fileno())</span><br><span class="line">        os.rename(tmppath, filepath)</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>è¯¥æ–¹æ¡ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼š</p><ol><li><code>rename</code>æ“ä½œçš„åŸå­æ€§åªé’ˆå¯¹<code>POSIX</code>ç³»ç»Ÿï¼›</li><li>æ“ä½œçš„æ–‡ä»¶ç³»ç»Ÿéœ€è¦ä¿æŒä¸€è‡´ï¼Œå³ä»£ç ä¸­åœ¨åŒä¸€ä¸ªç›®å½•çš„ç›®çš„ï¼›</li><li>åœ¨ç”µæºæ•…éšœï¼Œç³»ç»Ÿå´©æºƒç­‰æƒ…å†µä¸‹ï¼Œæ€§èƒ½/å“åº”èƒ½åŠ›æ¯”æ•°æ®å®Œæ•´æ€§æ›´é‡è¦ï¼Œåˆ™å¯ä»¥è·³è¿‡<code>os.fsync</code>æ­¥éª¤ï¼›</li></ol><p>å…³äº<code>os.fsync</code>çš„è¯´æ˜å‚è§å®˜æ–¹æ–‡æ¡£ï¼Œ<a href="https://docs.python.org/zh-cn/3/library/os.html#os.fsync">æ­¤å¤„</a>ï¼š<br><div class="note info modern"><p>å¼ºåˆ¶å°†æ–‡ä»¶æè¿°ç¬¦ <code>fd</code> æŒ‡å‘çš„æ–‡ä»¶å†™å…¥ç£ç›˜ã€‚åœ¨ Unixï¼Œè¿™å°†è°ƒç”¨åŸç”Ÿ <code>fsync()</code> å‡½æ•°ï¼›åœ¨ Windowsï¼Œåˆ™æ˜¯ MS <code>_commit()</code> å‡½æ•°ã€‚<br>å¦‚æœè¦å†™å…¥çš„æ˜¯ç¼“å†²åŒºå†…çš„ Python æ–‡ä»¶å¯¹è±¡ fï¼Œè¯·å…ˆæ‰§è¡Œ <code>f.flush()</code>ï¼Œç„¶åæ‰§è¡Œ <code>os.fsync(f.fileno())</code>ï¼Œä»¥ç¡®ä¿ä¸ f å…³è”çš„æ‰€æœ‰<strong>å†…éƒ¨ç¼“å†²åŒºéƒ½å†™å…¥ç£ç›˜</strong>ã€‚ </p></div> </p><ul><li>ä¸è¦é€ è½®å­ </li></ul><p>ç›´æ¥è£…åŒ…ï¼š<a href="https://github.com/untitaker/python-atomicwrites">untitaker/python-atomicwrites: Powerful Python library for atomic file writes.</a>ï¼Œç„¶åä»£ç è¿™ä¹ˆå†™ï¼š<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> atomicwrites <span class="keyword">import</span> atomic_write</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> atomic_write(<span class="string">&#x27;foo.txt&#x27;</span>, overwrite=<span class="literal">True</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">&#x27;Hello world.&#x27;</span>)</span><br><span class="line">    <span class="comment"># &quot;foo.txt&quot; doesn&#x27;t exist yet.</span></span><br></pre></td></tr></table></figure><br><div class="note warning modern"><p><strong>æ³¨æ„</strong>ï¼š<br>å¦‚æœæ˜¯ json/pickle æ–‡ä»¶å¯ä»¥ä½¿ç”¨<code>rb</code>æ ¼å¼å†™ï¼Œè¿™æ ·æ‰æ˜¯åŸå­æ€§çš„ï¼Œå‚è§<a href="https://github.com/untitaker/python-atomicwrites/issues/29">Can it work with pickle.dump/json.dump instead of text only ? Â· Issue #29 Â· untitaker/python-atomicwrites</a></p></div></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> atomic_write(mode=<span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(json.dumps(info, indent=<span class="number">4</span>).encode(encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br></pre></td></tr></table></figure><h2 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="headerlink" title="æ¨èé˜…è¯»"></a>æ¨èé˜…è¯»</h2><ul><li><a href="https://blog.gocept.com/2013/07/15/reliable-file-updates-with-python/">Reliable file updates with Python â€“ gocept blog</a></li><li>ä¸Šæ–‡ä¸­æ–‡ç‰ˆï¼š<a href="https://www.oschina.net/translate/reliable-file-updates-with-python">ä½¿ç”¨ Python è¿›è¡Œç¨³å®šå¯é çš„æ–‡ä»¶æ“ä½œ - OSCHINA</a></li><li><a href="https://stackoverflow.com/questions/2333872/atomic-writing-to-file-with-python">atomic writing to file with Python - Stack Overflow</a></li><li><a href="https://mozillazg.com/2018/05/a-way-to-atomic-write-or-safe-update-a-file.html">é€šè¿‡ä¸´æ—¶æ–‡ä»¶å®ç°å®‰å…¨çš„/åŸå­æ€§çš„æ›´æ–°æ–‡ä»¶ - Huang Huang çš„åšå®¢</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> æ–‡ä»¶ </tag>
            
            <tag> åŸå­ </tag>
            
            <tag> å¹¶è¡Œ </tag>
            
            <tag> ä¸Šä¸‹æ–‡ç®¡ç†å™¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¼€ç¯‡ | åŸºé‡‘ç®¡ç†è®¡åˆ’</title>
      <link href="blog/2020-09-17/hello-fmp/"/>
      <url>blog/2020-09-17/hello-fmp/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="æŠ±æ­‰, è¿™ä¸ªå¯†ç çœ‹ç€ä¸å¤ªå¯¹, è¯·å†è¯•è¯•ã€‚" data-whm="æŠ±æ­‰, è¿™ä¸ªæ–‡ç« ä¸èƒ½è¢«æ ¡éªŒ, ä¸è¿‡æ‚¨è¿˜æ˜¯èƒ½çœ‹çœ‹è§£å¯†åçš„å†…å®¹ã€‚">  <script id="hbeData" type="hbeData" data-hmacdigest="a3c0ccd01e82a41124eb8f646277fa351fdfa0bb52b38e8f1f4314f20ddc336e">4f15ddc76047ef172570bf424968b26d0bfa38a2d42a8fddbc707eedd0d9d1370630a42cba6cf932a02072c4b36de10ab1f6891a0c4ac791ac39c8aede60923052c4060af5bab78f6a0add796e77bed5d39bbb408ba23d0889a80d9d292bab335cda59b29b652c5cdd9012c6440ca522e593ac0dee091f276bcdd8108f3812c11955a1a845afce4bb3515fa36d2ddb3a64641d4002e9474a44133ba9a35eb1c4dbd5d098fe5643aeefcf207579a644226407d53760582a2eeb5f6877e522a362cf305a36922be33b6876d4c9af76cd79cb2d20e8a6724a013553ed3c60a7eb168e7fd5cc0bfc93461d3bd0b565a9005abae675f21c5bda00dd2e74e51a48ea5effff13ccfdc42beb477ebd36b8b626d62ff8b5f5a4a52788b28d5ccdd032fa3712d7d0ab19c7add3b5eddaf7d5258feddc34af661a474d91e1721643b3405fc31c0073901016afb400394b27b10ade0017d62f06fe84306848eefe3d2231ba2f9f12f343b960f9ec3f0356a13a116e9e2416fe41275a7a870d7e94e0d86f6c9fef872cca2e43c9cb13eadc66a79b5173eede3792fbe42755357ce1b912d5c66e918e1d4acc4d237bf4799ae0e4a86ffb170d755f9664663434d94885a6b2e844cd8fdf37584093c7a9c2ecd7c2dc9334f2e798801973f64a5c0ee1dbebef933ee28a5048c6104c17c5b0b612c9e72950ab4c8d67ff7c5e00a4aec4ae2d63197a20f3dd2671405c993f26fe38e2f45ce7e2bfcfac3afed0f8742a5ff7077d1bc2709bc7b9dd83b3061a5c1c583b4c53f86903ea73fd63746623b6bf22662d66d1a56b1e190b862fed3c7242df04bf90195ba527b205a821c444d48e5268d5b6421f5c99fc909a6ef732c960c0e0b101a8deffebb80bacca7169415de13b33f5f3fec9bacce71f8b3e8ee52ff427ca06db737749f30e48afc24e85619f664a58e40b6084ee8b706fc3239ea0908edd41110fd7025a3a382a444bb90af8d4c2b8d5f7624b5e5dd41f401580b8a76ca343cb47e1d198a1badd4312ff14c2e09892cb0e21ae29c8027ecc265e8cd72c417f032d240928370eb7cde21081bed3ea154122d60b3bed2950af03a7794f2e4ef2983faaeb20997edeb8bfbdaa24c66b3dc6b745a3d811a0cfd0d7b32e06dc48a5531d3112801250ea61209116c4f3aebb5ab9723fe27f9857a9c9e8dcd0fdc6302d8865e9c39b9770b5e113c38dcc093ab8ee18c63deb45d3473f6fee5ccded25ccb06eff5f28e86ed22388f3d6878eab23dfd514547deb6c27feb9ae4a64f23282c6e757bff954fa9f214e94dc5b1d72492749a4cf38c6e2c305fb9093cf4e2b0a3259d852d56325014604702e751ab2c3352d7eed6beab33449fbab9c7335943fcd0bb2e9ac93553d242f4d2788e42d4d02731adbe06cae76901a6f6d24044aaa7a9c350907be7c38199eb04a96a6dbe91de8f9b4ed54b99cf7f2835636c34f853d4db7cdb6a423d79f61ac9ee7446e8b4d70138c1031b9ef25c0b002d538bbb2cbbb1adae725fec7355f23d362e40b49e82ffb1bfefd5f6ce04153fed7d1a55c80f4204203c76955edf7f0a1f3276c1ba7e50bc0adec17c9bb989648a96206c68ed3e88115cb6022ecc4c92c0cdd12d15db2443f8c2955b1dd824e6b3d4883b92e0bd8a061f9dfada075aa741dc18a35fe367b675d1a52e7fd3763288335a2382516a91f6bf3c26a19899ab0565d2f1b51a5e6f0ba27a20cab6c1c5c83d88fbd615912925cdf2f1e86ad6501afc99081929d5211126e3173c39a1f37bba4cfec44a36fee68420ebfc584dc58f7e05b449ba993d1e9ffdb1f97ca4352171d8d7d0ae9ecb5cf8abd900cd6610328afde10d08a79621853dd6e46b0b18dc2f10a318a26a5c6bf3ff43c8b33e3bad52d350aa959cfb5b343f354c05a068865dddd89f6b33186134f508068d4969616dd3814fc7e899ee94901fbb1861d0d8cb26a87cbf16964e0fef0141b6175f17cbb372ff94c8b4d5ddf9b35fabb335a67a4ca5957a8f3e2d7091b05c599e794ae969b98f133f9381ccc561d00f0baa5ae5328030c7a581a0968288f0de265453230e2753606622e58cf7851ea250e4d6cf2456127a1569db410acccdeab40568447471e3512751110c95365e081ea82278a148b12b5482fcaf6ec6021c1ad994392eede78a359259cbcb5ec008863efdbffa0ce4f8c419755786977e688a1f566bf35d62937025da21f42186a50d1e712be0eddfb7db9025584cde5cb3f513f429a04c009e437c93c986a268f53fe1bbed680b61465a6a020a429ff3513afaeb3d9eb3ba1754ad8879d22efd18828544b34d99adfd229562cee32769d2ef4643b5e7583e0dfe5ee5fd084400b5f5c4aea2f17ada2a3f1da11a9ea512a5d0d56077d6284e9959a563eb0b060adc544bfd6ac945a0ddab9a9a9a3ec773cc8aa8d41e4eb50acb6792118d7d229fc1eefa86f96bfb130a132a3a7305a00da5e1bff18861a275f08411915d98022624c2e846fc69be830cee89ba95ad0f5b2bbe528413eedfe8f8083e25d7672712837a14765c72d42cbb4d78032bad1e72c104048db507274a4d7713c8cca73087cf5b2975a16c28747cbef46f099eff3840f5a673d8c5412dbf0e461ceac905b40a2f40b2a4436ab645c2532458ff52c58764f56be90d9bf7520789207bc29191d9bbba1d2030b6da53c4695fc0840f7d904c7939a94138ba96d44d90f776d34afbeb35183b0d2fcb17b9515304067ca0d758459e76c417f0ef7f46bfb87f80b0da6dec57c59da3adac503b39d2badd80012871b2d540f8ee0ad5be0b9af35b07d136637a284f85b9c3c15d446a1216ca86f2dfb53f2b0d5a0c0fb5144f97452897cd3c5eda41e9fae5a4491836d8c019c8bdc30e8f63af31ae0b13be4ee623054167546b72c7691839495dba945f3efea614a0c6498c1c4faac18007cc47e44fbf0cc8df46d715f7fd204a1817005df819fd63a04aa5a2d8496646684db2ed8b02576025ab4a1f7071a29d7dfa541c11c3161d9f73285ac63609949f1b0121cea20779b98fdbf2e21ab33bf04a1403fd8e511f23374bfb69ef00c7a7343d998ea3a87d84d9c7e1cd0736f3e8b498115449b197c04f2dcff16a3ce4dbe6ec16b827db0ecadda4a1b1d55f511393b2ce039f6a032f3c5c08774d03c753daabe1306949db32e0d7dcd3bc1fdffaabee3a428999af2cc7b40ab41dbff97165f7c9083f3a18d7f1641957be10dc5ce60261c1ce7aac03f559e4637ce356625016e6629c4637569cd4257784d63efdbee96b617944c4d372b3b7b5de190366a372c72e567c39fdbbc8550</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">æ‚¨å¥½ï¼Œè¿™é‡Œéœ€è¦å¯†ç ï¼Œå¦‚æœæƒ³æŸ¥çœ‹è¯·å’¨è¯¢åšä¸»ã€‚</span>      </label>    </div>  </div></div><script src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> Projects </category>
          
          <category> FMP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> TODO </tag>
            
            <tag> FMP </tag>
            
            <tag> åŸºé‡‘ </tag>
            
            <tag> FundMate </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸‰æ€è€Œåè¡Œï¼šè°¨æ…ä½¿ç”¨ä½ çš„è£…é¥°å™¨</title>
      <link href="blog/2020-09-03/use-python-decorator-prudently/"/>
      <url>blog/2020-09-03/use-python-decorator-prudently/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><p>åœ¨å­¦ä¼šä½¿ç”¨è£…é¥°å™¨ä¹‹åï¼Œæˆ‘ä»¬å¯èƒ½æ—¶ä¸æ—¶åœ°åœ¨å¿ƒç†æš—ç¤ºä¸‹ä½¿ç”¨å®ƒï¼Œä¸‹é¢æ˜¯æˆ‘ä¸ªäººæ€»ç»“çš„ä¸€äº›ä»£ç å®è·µä¸­é‡åˆ°çš„é—®é¢˜ï¼Œä¸»è¦å‚è€ƒ <a href="https://stackoverflow.com/questions/739654/how-to-make-a-chain-of-function-decorators/1594484#1594484">è¿™ä¸€ç¯‡</a> ä¸­å…³äºè£…é¥°å™¨é“¾å¼è°ƒç”¨ä¸­è®¨è®ºçš„é—®é¢˜ã€‚</p><blockquote><p><strong>æœ€ä½³å®è·µ</strong></p><ul><li>Decorators were introduced in Python 2.4, so be sure your code will be run on &gt;= 2.4.</li><li>Decorators slow down the function call. Keep that in mind.</li><li>You cannot un-decorate a function. (There are hacks to create decorators that can be removed, but nobody uses them.) So once a function is decorated, itâ€™s decorated for all the code.</li><li>Decorators wrap functions, which can make them hard to debug. (This gets better from Python &gt;= 2.5; see below.)</li></ul></blockquote><div class="note info modern"><p>ä»¥ä¸‹æ¼”ç¤ºåŸºäº Python3.7 è®¨è®ºï¼Œæµ‹è¯•ä»£ç æ—¶è¯·æ£€æŸ¥ä½ çš„ Python ç‰ˆæœ¬ã€‚</p></div><h2 id="è¯·ç¥å®¹æ˜“é€ç¥éš¾"><a href="#è¯·ç¥å®¹æ˜“é€ç¥éš¾" class="headerlink" title="è¯·ç¥å®¹æ˜“é€ç¥éš¾"></a>è¯·ç¥å®¹æ˜“é€ç¥éš¾</h2><p>è£…é¥°å™¨ä¸€æ—¦è¢«ä½¿ç”¨ï¼Œå°±å¾ˆéš¾è°ƒç”¨æ²¡æœ‰è£…é¥°å™¨çš„åŸå‡½æ•°ã€‚</p><h3 id="æ”¹å–„å»ºè®®"><a href="#æ”¹å–„å»ºè®®" class="headerlink" title="æ”¹å–„å»ºè®®"></a>æ”¹å–„å»ºè®®</h3><ol><li>åœ¨<a href="https://python3-cookbook.readthedocs.io/zh_CN/latest/c09/p03_unwrapping_decorator.html">9.3 è§£é™¤ä¸€ä¸ªè£…é¥°å™¨ | Python-cookbook</a>ï¼Œæºç ï¼ˆ<a href="https://github.com/dabeaz/python-cookbook/blob/master/src/9/unwrapping_a_decorator/example.py">dabeaz/python-cookbook</a>ï¼‰ä¸­ï¼Œä½œè€…æåˆ°ä¸€ä¸ªæ–¹æ³•ï¼š<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> wraps</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">deco_it</span>(<span class="params">func</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    å®šä¹‰è£…é¥°å™¨</span></span><br><span class="line"><span class="string">    :param func:</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"><span class="meta">    @wraps(<span class="params">func</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span>(<span class="params">*args, **kwargs</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;----inner of wrapper before func----&#x27;</span>)</span><br><span class="line">        ret = func(*args, **kwargs)</span><br><span class="line">        print(<span class="string">&#x27;----inner of wrapper after func--&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@deco_it</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span>():</span></span><br><span class="line">    print(<span class="string">&#x27;Hello,World!&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    foo()       <span class="comment"># è¢«è£…é¥°çš„è°ƒç”¨</span></span><br><span class="line">    foo.__wrapped__()       <span class="comment"># è§£é™¤è£…é¥°çš„è°ƒç”¨</span></span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">----inner of wrapper before func----</span><br><span class="line">Hello,World!</span><br><span class="line">----inner of wrapper after func--</span><br><span class="line"># åŸå‡½æ•°</span><br><span class="line">Hello,World!</span><br></pre></td></tr></table></figure>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ç§æ–¹æ³•æœ‰ä¸¤ä¸ªç¼ºé™·ï¼š<ol><li>è£…é¥°å™¨å‡½æ•°å†…éƒ¨å¿…é¡»è¢«<code>functools.wraps</code>è£…é¥°æˆ–è€…ç›´æ¥è®¾ç½®äº†<code>__wrapped__</code>å±æ€§ï¼›</li><li>å¤šä¸ªè£…é¥°å™¨æ—¶ï¼Œè¿”å›ç»“æœæ˜¯ä¸å¯é¢„çŸ¥çš„ï¼›è¯·çœ‹ä¸‹ä¾‹ï¼š<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">another_deco_it</span>(<span class="params">func</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    å®šä¹‰å¦ä¸€ä¸ªè£…é¥°å™¨</span></span><br><span class="line"><span class="string">    :param func:</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    print(<span class="string">&#x27;This is another deco.&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @wraps(<span class="params">func</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span>(<span class="params">*args, **kwargs</span>):</span></span><br><span class="line">        ret = func(*args, **kwargs)</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@another_deco_it</span></span><br><span class="line"><span class="meta">@deco_it</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span>():</span></span><br><span class="line">    print(<span class="string">&#x27;Hello,World!&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    foo()</span><br><span class="line">    print(<span class="string">&#x27;origin func under below.&#x27;</span>)</span><br><span class="line">    foo.__wrapped__()</span><br></pre></td></tr></table></figure>è¿”å›ç»“æœï¼š<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">This is another deco.</span><br><span class="line">----inner of wrapper before func----</span><br><span class="line">Hello,World!</span><br><span class="line">----inner of wrapper after func--</span><br><span class="line">origin func under below.</span><br><span class="line"># åŸå‡½æ•°å®šä¹‰ï¼ˆå®é™…ä¸Šï¼Œæ­¤æ—¶å¹¶æ²¡æœ‰è§£é™¤æ‰@deco_itè£…é¥°å™¨ï¼‰</span><br><span class="line">----inner of wrapper before func----</span><br><span class="line">Hello,World!</span><br><span class="line">----inner of wrapper after func--</span><br></pre></td></tr></table></figure>ç”šè‡³ï¼Œå¦‚æœæˆ‘ä»¬è°ƒæ¢è£…é¥°å™¨çš„ä½ç½®<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@deco_it</span></span><br><span class="line"><span class="meta">@another_deco_it</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span>():</span></span><br><span class="line">    print(<span class="string">&#x27;Hello,World!&#x27;</span>)</span><br></pre></td></tr></table></figure>è¿”å›çš„ç»“æœåˆæ˜¯ç¬¦åˆæˆ‘ä»¬é¢„æœŸçš„ğŸ˜¯ï¼š<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">This is another deco.</span><br><span class="line">----inner of wrapper before func----</span><br><span class="line">Hello,World!</span><br><span class="line">----inner of wrapper after func--</span><br><span class="line">origin func under below.</span><br><span class="line"># åŸå‡½æ•°å®šä¹‰</span><br><span class="line">Hello,World!</span><br></pre></td></tr></table></figure></li></ol></li><li>é‰´äºä¸Šé¢è¯´åˆ°çš„ç¼ºé™·ï¼Œæˆ‘ä»¬å°è¯•ä½¿ç”¨ <a href="https://wiki.python.org/moin/PythonDecoratorLibrary#Enable.2FDisable_Decorators">è¿™é‡Œ</a> æåˆ°çš„æ–¹å¼ç»§ç»­æ”¹å–„ï¼›<br>æˆ‘ä»¬è¯´<code>Pythonä¸­ä¸€åˆ‡éƒ½æ˜¯å¯¹è±¡</code>ï¼Œæ‰€ä»¥å¯ä»¥å°†æˆ‘ä»¬çš„è£…é¥°å™¨æ˜¯å¦ä½¿ç”¨é€šè¿‡ flag ä¼ é€’ç»™è°ƒç”¨å‡½æ•°åï¼š<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enable_deco</span>(<span class="params">func</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    ä½¿èƒ½è£…é¥°å™¨</span></span><br><span class="line"><span class="string">    :param func:</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @wraps(<span class="params">func</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span>(<span class="params">*args, **kwargs</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;----inner of wrapper before func----&#x27;</span>)</span><br><span class="line">        ret = func(*args, **kwargs)</span><br><span class="line">        print(<span class="string">&#x27;----inner of wrapper after func--&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">disable_deco</span>(<span class="params">func</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    ç¦ç”¨è£…é¥°å™¨</span></span><br><span class="line"><span class="string">    :param func:</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @wraps(<span class="params">func</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span>(<span class="params">*args, **kwargs</span>):</span></span><br><span class="line">        ret = func(*args, **kwargs)</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GLOBAL_ENABLE_FLAG = <span class="literal">True</span></span><br><span class="line">depend_with_flag = enable_deco <span class="keyword">if</span> GLOBAL_ENABLE_FLAG <span class="keyword">else</span> disable_deco</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@depend_with_flag</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span>():</span></span><br><span class="line">    print(<span class="string">&#x27;Hello,World!&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>æˆ‘ä»¬é€šè¿‡<code>GLOBAL_ENABLE_FLAG</code>åˆ†åˆ«å®šä¹‰çš„<code>bool</code>å€¼å¯ä»¥å°†è£…é¥°å™¨å¯ç”¨æˆ–è€…ç¦ç”¨ã€‚è¿™ä¸ªæ–¹å¼ä¹Ÿé€‚ç”¨äºå¤šä¸ªè£…é¥°å™¨çš„æ—¶å€™ï¼Œåªä¸è¿‡æˆ‘ä»¬éœ€è¦å®šä¹‰æ›´å¤šçš„ bool å˜é‡æ¥æ§åˆ¶è€Œå·²ã€‚<br>å®è·µä»£ç å¯ä»¥å‚è€ƒæ­¤å¤„<a href="https://medium.com/@AuthorVivek/leveraging-the-power-of-decorators-in-pythons-unit-test-framework-5ae0285d0d27">Leveraging the power of decorators in Pythonâ€™s unit-test framework | by Vivek Shrivastava | Medium</a>ï¼Œæ³¨æ„æ–‡ä¸­è¯´åˆ°çš„ <em>second point</em>ã€‚<h2 id="å‡¡æœ‰å¯¼å…¥ï¼Œå¿…ç•™ç—•è¿¹"><a href="#å‡¡æœ‰å¯¼å…¥ï¼Œå¿…ç•™ç—•è¿¹" class="headerlink" title="å‡¡æœ‰å¯¼å…¥ï¼Œå¿…ç•™ç—•è¿¹"></a>å‡¡æœ‰å¯¼å…¥ï¼Œå¿…ç•™ç—•è¿¹</h2>è°ƒç”¨è¢«è£…é¥°å‡½æ•°ä¼šå¯¼è‡´è£…é¥°å™¨å‡½æ•°å¤–éƒ¨é€»è¾‘çš„æ‰§è¡Œã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š<br>æˆ‘ä»¬åœ¨ç¬¬ä¸€ä¸ªæ¨¡å—ä¸­ç¼–å†™ä¸€ä¸ªè£…é¥°å™¨<code>deco</code>ï¼š<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># deco_module</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> wraps</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">deco</span>(<span class="params">func</span>):</span></span><br><span class="line">    print(<span class="string">&#x27;out of real wrapper.&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @wraps(<span class="params">func</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span>(<span class="params">*args, **kwargs</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;-----inner of wrapper.----&#x27;</span>)</span><br><span class="line">        time.sleep(<span class="number">5</span>)</span><br><span class="line">        ret = func(*args, **kwargs)</span><br><span class="line">        time.sleep(<span class="number">3</span>)</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@deco</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">do_func</span>():</span></span><br><span class="line">    print(<span class="string">&#x27;hello world&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>åœ¨ç¬¬äºŒä¸ªæ¨¡å—ä¸­ï¼Œæˆ‘ä»¬å¯¼å…¥<code>deco_module</code>ï¼š<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># foo</span></span><br><span class="line"><span class="keyword">from</span> deco_module <span class="keyword">import</span> do_func</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">invoke_deco_func</span>():</span></span><br><span class="line">    do_func()</span><br><span class="line">    do_other()</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">do_other</span>():</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">do_foo</span>():</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    do_foo()</span><br><span class="line"></span><br></pre></td></tr></table></figure>æ­¤æ—¶ï¼Œä¸ç®¡æˆ‘ä»¬æ˜¯å¦çœŸæ­£è°ƒç”¨è¢«è£…é¥°çš„å‡½æ•°<code>do_func</code>ï¼Œè£…é¥°å™¨<code>deco</code>ä¸­<code>wrapper</code>å¤–é¢çš„å‡½æ•°éƒ½ä¼šè¢«è°ƒç”¨â‘ ã€‚å‡å¦‚å®ƒæ˜¯ä¸€ä¸ªè€—æ—¶çš„æ“ä½œå‘¢ï¼ŸğŸ˜•<br>ç¬¬ä¸‰ä¸ªæ¨¡å—ä¸­ï¼Œæˆ‘ä»¬å¯¼å…¥<code>foo</code>æ¨¡å—ï¼š<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># main.py</span><br><span class="line">from foo import do_foo</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    do_foo()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>åŒæ ·åœ°ï¼Œåªè¦æˆ‘ä»¬ä»<code>foo</code>ä¸­è¿›è¡Œå¯¼å…¥ï¼Œä¸ç®¡æˆ‘ä»¬æ˜¯å¦åœ¨<code>main</code>ä¸­è°ƒç”¨<code>invoke_deco_func</code>ï¼Œä¸Šé¢æåˆ°çš„æ¶ˆè€—â‘ éƒ½ä¼šè¢«æ‰§è¡Œã€‚ğŸ˜£<div class="note primary no-icon modern"><p>æœ‰åŒå­¦ä¼šä¸¾æ‰‹å‘è¨€äº†ï¼šå—³ï¼Œä½ è¿™è£…é¥°å™¨å†™çš„ä¸å¯¹å•Šï¼Œæˆ‘æ‰€çœ‹åˆ°è£…é¥°å™¨çš„é€»è¾‘éƒ½æ˜¯å†™åœ¨<code>wrapper</code>å‡½æ•°é‡Œé¢çš„å‘€ï¼é™ˆç‹¬ç§€åŒå­¦è¯·åï¼Œä½ åœ¨ç¬¬ä¸€å±‚ï¼Œæˆ‘åœ¨ç¬¬äºŒå±‚ã€‚<br>æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬ä¸ºäº†è£…é¥°å™¨æ›´åŠ çµæ´»ï¼Œæ—¢éœ€è¦å®ƒå¯ä»¥ä¸ä¼ å‚æ•°ï¼Œåˆéœ€è¦å®ƒå¯ä»¥ä¼ é€’å‚æ•°ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦ä½¿ç”¨åå‡½æ•°çš„å®šä¹‰ã€‚<br>è¯·çœ‹ä¸‹é¢çš„é“¾æ¥ï¼š</p><ol><li><a href="https://stackoverflow.com/questions/10294014/python-decorator-best-practice-using-a-class-vs-a-function">Python decorator best practice, using a class vs a function - Stack Overflow</a></li><li><a href="https://github.com/dabeaz/python-cookbook/blob/master/src/9/defining_a_decorator_that_takes_an_optional_argument/example.py">9.6 å®šä¹‰å¸¦å¯é€‰å‚æ•°çš„è£…é¥°å™¨ | Python-cookbook</a></li><li><a href="https://github.com/dabeaz/python-cookbook/blob/master/src/9/enforcing_type_checking_on_a_function_using_a_decorator/example.py">9.7 åˆ©ç”¨è£…é¥°å™¨å¼ºåˆ¶å‡½æ•°ä¸Šçš„ç±»å‹æ£€æŸ¥ | Python-cookbook</a></li></ol><p>å½“ç„¶ï¼Œæˆ‘ä»¬éƒ½åœ¨æœŸè®¸ç¬¬äº”å±‚çš„è€å¸ˆèƒ½ç»™æˆ‘ä»¬æŒ‡å¯¼é‡Šç–‘ã€‚</p></div></li></ol><h3 id="æ”¹å–„å»ºè®®-1"><a href="#æ”¹å–„å»ºè®®-1" class="headerlink" title="æ”¹å–„å»ºè®®"></a>æ”¹å–„å»ºè®®</h3><ol><li>è£…é¥°å™¨<code>wrapper</code>å¤–é¢ä¸è¦å†™å‡½æ•°ï¼›å¦‚æœéè¦å†™ï¼Œåº”è¯¥æ˜¯å¾ˆå°çš„æ“ä½œã€‚ä¸€ä¸ªå‡½æ•°ä¸€æ—¦è¢«è£…é¥°ï¼Œå®ƒå°±ä¸æ˜¯<code>å‡ºèµ°åŠç”Ÿå½’æ¥ä»æ˜¯å°‘å¹´</code>çš„æ¨¡æ ·äº†ã€‚æ‰€ä»¥ï¼Œå°½é‡ä¸è¦æŠŠè¿™ç§å«æœ‰<code>wrapper</code>å¤–åšé€»è¾‘å¤„ç†çš„è£…é¥°å™¨åˆ°å¤„å¯¼å…¥ã€‚</li><li>å†™è¿›ç±»é‡Œé¢ï¼›<br>å¦‚æœä½ ç±»è£…é¥°å™¨å†™å¾—æ¯”è¾ƒå°‘ï¼Œå¯ä»¥å‚è€ƒä¸‹é¢çš„é“¾æ¥ï¼š<ol><li><a href="https://python3-cookbook.readthedocs.io/zh_CN/latest/c09/p08_define_decorators_as_part_of_class.html">9.8 å°†è£…é¥°å™¨å®šä¹‰ä¸ºç±»çš„ä¸€éƒ¨åˆ† â€” python3-cookbook 3.0.0 æ–‡æ¡£</a>ï¼›å‚è€ƒ <a href="https://github.com/dabeaz/python-cookbook/tree/master/src/9/defining_decorators_as_part_of_a_class">æºç </a></li><li><a href="https://python3-cookbook.readthedocs.io/zh_CN/latest/c09/p09_define_decorators_as_classes.html">9.9 å°†è£…é¥°å™¨å®šä¹‰ä¸ºç±»</a> ï¼›å‚è€ƒ <a href="https://github.com/dabeaz/python-cookbook/tree/master/src/9/defining_decorators_as_classes">æºç </a><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># deco_module</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Deco</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, func</span>):</span></span><br><span class="line">        self.func = func</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span>(<span class="params">self, *args, **kwargs</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;out of real wrapper.&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        ret = self.func(*args, **kwargs)</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Deco</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">do_func</span>():</span></span><br><span class="line">    print(<span class="string">&#x27;hello world&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span></span><br></pre></td></tr></table></figure>æ­¤æ—¶æˆ‘ä»¬åœ¨è£…é¥°å™¨å®šä¹‰æ¨¡å—ä¸­æ‰§è¡Œè¿”å›:<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">out of real wrapper.</span><br><span class="line">hello world</span><br><span class="line"></span><br></pre></td></tr></table></figure>åœ¨ä¸åŒ…å«è£…é¥°å™¨çš„æ¨¡å—ä¸­å¯¼å…¥ä¸Šè¿°æ¨¡å—:<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> deco_module <span class="keyword">import</span> do_bar</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">do_foo</span>():</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    do_foo()</span><br></pre></td></tr></table></figure>æ­¤æ—¶ï¼Œå¦‚æœä¸è°ƒç”¨è¢«è£…é¥°å‡½æ•°ï¼Œåˆ™å¯ä»¥é¿å…å…¶è¢«è¿å¸¦å¯¼å…¥ï¼›å½“ç„¶ï¼Œå¦‚æœä½ å¯¼å…¥å®ƒï¼Œé‚£è‚¯å®šè¿˜æ˜¯ä¼šæ‰§è¡Œã€‚ğŸ¤“</li></ol></li></ol><h2 id="æ‰§è¡Œé¡ºåºå’Œè°ƒç”¨é¡ºåºä¸ä¸€æ ·"><a href="#æ‰§è¡Œé¡ºåºå’Œè°ƒç”¨é¡ºåºä¸ä¸€æ ·" class="headerlink" title="æ‰§è¡Œé¡ºåºå’Œè°ƒç”¨é¡ºåºä¸ä¸€æ ·"></a>æ‰§è¡Œé¡ºåºå’Œè°ƒç”¨é¡ºåºä¸ä¸€æ ·</h2><p>è°ƒç”¨æ—¶ä»ä¸Šåˆ°ä¸‹ï¼Œé€»è¾‘æ‰§è¡Œæ—¶ä»ä¸‹åˆ°ä¸Šã€‚å‚è€ƒæ­¤æ–‡ï¼š<a href="https://gist.github.com/kirsle/bf24622fc5f255256c6e">Python decorator order</a><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> wraps</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_has_set</span>(<span class="params">func</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    æ˜¯å¦è¿›è¡Œäº†æ¨¡å—é…ç½®</span></span><br><span class="line"><span class="string">    :param func:</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    print(<span class="string">f&#x27;out of func: <span class="subst">&#123;sys._getframe().f_code.co_name&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @wraps(<span class="params">func</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span>(<span class="params">*args, **kwargs</span>):</span></span><br><span class="line">        print(<span class="string">f&#x27;inner of func check_has_set.&#x27;</span>)</span><br><span class="line">        ret = func(*args, **kwargs)</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_has_enable</span>(<span class="params">func</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    æ¨¡å—æ˜¯å¦å¯ç”¨</span></span><br><span class="line"><span class="string">    :param func:</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    print(<span class="string">f&#x27;out of func: <span class="subst">&#123;sys._getframe().f_code.co_name&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @wraps(<span class="params">func</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span>(<span class="params">*args, **kwargs</span>):</span></span><br><span class="line">        print(<span class="string">f&#x27;inner of func check_has_enable.&#x27;</span>)</span><br><span class="line">        ret = func(*args, **kwargs)</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_has_execute</span>(<span class="params">func</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    æ¨¡å—æ˜¯å¦æ‰§è¡Œï¼Œè¿™æ˜¯ä¸€ä¸ªè€—æ—¶æ“ä½œï¼Œå¹¶ä¸”éœ€è¦ä¸€å®šçš„æ¡ä»¶æ‰å¯ä»¥æ‰§è¡Œ</span></span><br><span class="line"><span class="string">    :param func:</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    time.sleep(<span class="number">5</span>)</span><br><span class="line">    print(<span class="string">f&#x27;out of func: <span class="subst">&#123;sys._getframe().f_code.co_name&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @wraps(<span class="params">func</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span>(<span class="params">*args, **kwargs</span>):</span></span><br><span class="line">        print(<span class="string">f&#x27;inner of func check_has_execute.&#x27;</span>)</span><br><span class="line">        ret = func(*args, **kwargs)</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@check_has_execute</span></span><br><span class="line"><span class="meta">@check_has_enable</span></span><br><span class="line"><span class="meta">@check_has_set</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span>():</span></span><br><span class="line">    print(<span class="string">&#x27;I can do it only when has_set and has_enable and before has_execute&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bar</span>():</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># foo()</span></span><br><span class="line">    bar()</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬æ‰§è¡Œä¸Šè¿°å‡½æ•°ï¼Œå¾—åˆ°è¿”å›ç»“æœï¼š<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">out of func: check_has_set</span><br><span class="line">out of func: check_has_enable</span><br><span class="line">out of func: check_has_execute</span><br></pre></td></tr></table></figure><br>è¿™ä¸ªç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸï¼Œå› ä¸ºè£…é¥°å™¨ç±»ä¼¼äºè¿™ç§å†™æ³•ï¼š<code>check_has_execute(check_has_enable(check_has_set(foo)))</code>ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœŸæ­£è°ƒç”¨è¢«è£…é¥°å‡½æ•°ï¼Œå³æ”¾å¼€æ³¨é‡Šï¼Œå°†æ— å…³çš„è°ƒç”¨<code>bar()</code>æ³¨é‡Šï¼š<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">out of func: check_has_set</span><br><span class="line">out of func: check_has_enable</span><br><span class="line">out of func: check_has_execute</span><br><span class="line">inner of func check_has_execute.</span><br><span class="line">inner of func check_has_enable.</span><br><span class="line">inner of func check_has_set.</span><br></pre></td></tr></table></figure><br>æ³¨æ„çœ‹è¿”å›ç»“æœä¸­çš„å‰ä¸‰è¡Œå’Œåä¸‰è¡Œã€‚æ­¤æ—¶å…ˆå»æ‰§è¡Œäº†<code>check_has_execute</code>ä¸­çš„æ“ä½œï¼Œè€Œåæ‰ä¼šæ‰§è¡Œ<code>check_has_enable</code>å’Œ<code>check_has_set</code>ï¼æ­¤æ—¶æˆ‘ä»¬åšçš„æå‰è¿”å›çš„é™åˆ¶å°±æ— æ•ˆäº†ã€‚</p><h3 id="æ”¹å–„å»ºè®®-2"><a href="#æ”¹å–„å»ºè®®-2" class="headerlink" title="æ”¹å–„å»ºè®®"></a>æ”¹å–„å»ºè®®</h3><p>å¦‚æœåªæ˜¯è°ƒç”¨é¡ºåºå¯¼è‡´çš„é—®é¢˜ï¼Œåº•å±‚å‡½æ•°ä¸ä¼šæœ‰ç‰¹åˆ«è€—æ—¶çš„æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ç…§æ¡ä»¶çš„å…ˆåå»è£…é¥°<code>foo()</code>å‡½æ•°ï¼Œè®©å…¶æŒ‰ç…§é¢„å®šçš„é¡ºåºæ£€æŸ¥:<br>å³<code>if check_has_set</code> &gt;&gt; <code>if check_has_enable</code> &gt;&gt; <code>if not check_has_execute</code>ï¼Œåªæœ‰æ¡ä»¶éƒ½æ»¡è¶³é‡‡å–çœŸæ­£æ‰§è¡Œã€‚<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">@check_has_set</span><br><span class="line">@check_has_enable</span><br><span class="line">@check_has_execute</span><br><span class="line">def foo():</span><br><span class="line">    pass</span><br></pre></td></tr></table></figure><br>å±€é™æ€§ï¼š<code>check_has_execute</code>ä¸­é•¿è€—æ—¶ä¼šæ‰§è¡Œï¼Œæ­¤æ—¶ä¼šæ‹–æ…¢ä½ çš„ç¨‹åºï¼å¦‚æ­¤å¤„<a href="https://stackoverflow.com/questions/10294014/python-decorator-best-practice-using-a-class-vs-a-function">Python decorator best practice, using a class vs a function - Stack Overflow</a>2018 update ç« èŠ‚å¤„æ‰€ç¤ºçš„å†™æ³•ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>To be continue.</p><h2 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="headerlink" title="æ¨èé˜…è¯»"></a>æ¨èé˜…è¯»</h2><p><a href="https://wiki.python.org/moin/PythonDecorators">PythonDecorators - Python Wiki</a><br><a href="https://dbader.org/blog/python-decorators">Python Decorators: A Step-By-Step Introduction â€“ dbader.org</a><br><a href="https://realpython.com/primer-on-python-decorators/">Primer on Python Decorators â€“ Real Python</a><br><a href="http://witkowskibartosz.com/blog/python_decorators_vs_inheritance.html">Python decorators vs inheritance - Anselmos Blog</a><br><a href="https://stackoverflow.com/questions/739654/how-to-make-a-chain-of-function-decorators">python - How to make a chain of function decorators? - Stack Overflow</a><br><a href="https://python3-cookbook.readthedocs.io/zh_CN/latest/chapters/p09_meta_programming.html">ç¬¬ä¹ç« ï¼šå…ƒç¼–ç¨‹ â€” python3-cookbook 3.0.0 æ–‡æ¡£</a></p>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> TODO </tag>
            
            <tag> è£…é¥°å™¨ </tag>
            
            <tag> decorator </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•é€šè¿‡ç½‘å¡åç§°è·å–å…¶æ‰€å¯¹åº”çš„ IP åœ°å€</title>
      <link href="blog/2020-08-11/how-to-get-the-physical-interface-IP-address-from-an-interface/"/>
      <url>blog/2020-08-11/how-to-get-the-physical-interface-IP-address-from-an-interface/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><p>å¦‚æœé¡¹ç›®ä¸­æœ‰ç”¨åˆ° netifaces æˆ–è€… psutil åº“ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•ï¼š</p><h3 id="ç›´æ¥è°ƒç”¨ç¬¬ä¸‰æ–¹åº“"><a href="#ç›´æ¥è°ƒç”¨ç¬¬ä¸‰æ–¹åº“" class="headerlink" title="ç›´æ¥è°ƒç”¨ç¬¬ä¸‰æ–¹åº“"></a>ç›´æ¥è°ƒç”¨ç¬¬ä¸‰æ–¹åº“</h3><ul><li>netifaces<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">via_netifaces</span>():</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    è°ƒç”¨ç¬¬ä¸‰æ–¹æ¨¡å—netifaces</span></span><br><span class="line"><span class="string">    :return: </span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    ip_list = []</span><br><span class="line">    <span class="keyword">for</span> interface <span class="keyword">in</span> netifaces.interfaces():</span><br><span class="line">        <span class="keyword">if</span> interface <span class="keyword">not</span> <span class="keyword">in</span> [<span class="string">&#x27;lo&#x27;</span>, <span class="string">&#x27;sit0&#x27;</span>]:</span><br><span class="line">            b = netifaces.ifaddresses(interface).get(netifaces.AF_INET)</span><br><span class="line">            <span class="keyword">if</span> b:</span><br><span class="line">                <span class="keyword">for</span> link <span class="keyword">in</span> b:</span><br><span class="line">                    ip_list.append(link[<span class="string">&#x27;addr&#x27;</span>])</span><br><span class="line">    <span class="keyword">return</span> ip_list</span><br></pre></td></tr></table></figure></li><li>psutil<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_net_ipaddr</span>():</span></span><br><span class="line">    ip_list = <span class="built_in">set</span>()</span><br><span class="line">    dic = psutil.net_if_addrs()</span><br><span class="line">    <span class="keyword">for</span> adapter <span class="keyword">in</span> dic:</span><br><span class="line">        snic_list = dic[adapter]</span><br><span class="line">        mac = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        ipv4 = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        ipv6 = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> snic <span class="keyword">in</span> snic_list:</span><br><span class="line">            <span class="keyword">if</span> snic.family.name <span class="keyword">in</span> &#123;<span class="string">&#x27;AF_LINK&#x27;</span>, <span class="string">&#x27;AF_PACKET&#x27;</span>&#125;:</span><br><span class="line">                mac = snic.address</span><br><span class="line">            <span class="keyword">elif</span> snic.family.name == <span class="string">&#x27;AF_INET&#x27;</span>:</span><br><span class="line">                ipv4 = snic.address</span><br><span class="line">            <span class="keyword">elif</span> snic.family.name == <span class="string">&#x27;AF_INET6&#x27;</span>:</span><br><span class="line">                ipv6 = snic.address</span><br><span class="line">            ip_list.add(ipv4)</span><br><span class="line">        print(<span class="string">&#x27;%s, %s, %s, %s&#x27;</span> % (adapter, mac, ipv4, ipv6))</span><br><span class="line">    <span class="keyword">return</span> ip_list</span><br></pre></td></tr></table></figure>å¦‚æœè§‰å¾—åªæ˜¯ä¸ºäº†ä¸€ä¸ªå°åŠŸèƒ½å¼•å…¥ç¬¬ä¸‰æ–¹åº“æœ‰ç‚¹å¤§æå°ç”¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå·±é€ è½®å­ã€‚</li></ul><h3 id="æ ‡å‡†åº“"><a href="#æ ‡å‡†åº“" class="headerlink" title="æ ‡å‡†åº“"></a>æ ‡å‡†åº“</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">std_get_ip_list</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_ip_address_of_iface</span>(<span class="params">ifname</span>):</span></span><br><span class="line">        s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)</span><br><span class="line">        ip_addr = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            ip_addr = socket.inet_ntoa(fcntl.ioctl(</span><br><span class="line">                s.fileno(),</span><br><span class="line">                <span class="number">0x8915</span>,</span><br><span class="line">                struct.pack(<span class="string">&#x27;256s&#x27;</span>, <span class="built_in">bytes</span>(ifname[:<span class="number">15</span>], <span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">            )[<span class="number">20</span>:<span class="number">24</span>])</span><br><span class="line">        <span class="keyword">except</span> OSError:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">return</span> ip_addr</span><br><span class="line"></span><br><span class="line">    all_eth = os.listdir(<span class="string">&#x27;/sys/class/net/&#x27;</span>)</span><br><span class="line">    ip_list = []</span><br><span class="line">    <span class="keyword">for</span> eth <span class="keyword">in</span> all_eth:</span><br><span class="line">        <span class="keyword">if</span> eth <span class="keyword">not</span> <span class="keyword">in</span> [<span class="string">&#x27;lo&#x27;</span>, <span class="string">&#x27;sit0&#x27;</span>]:</span><br><span class="line">            ip = get_ip_address_of_iface(eth)</span><br><span class="line">            ip_list.append(ip)</span><br><span class="line">    <span class="keyword">return</span> ip_list</span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç çš„åŸå§‹å‡ºå¤„æ˜¯<a href="https://stackoverflow.com/a/27423915">è¿™é‡Œ</a>ï¼Œæˆ‘ä»¬ä¸»è¦å°è¯•è§£é‡Šä¸€ä¸‹å®ƒçš„å·¥ä½œåŸç†ã€‚</p><h2 id="åŸç†è§£é‡Š"><a href="#åŸç†è§£é‡Š" class="headerlink" title="åŸç†è§£é‡Š"></a>åŸç†è§£é‡Š</h2><h3 id="socket"><a href="#socket" class="headerlink" title="socket"></a>socket</h3><p>Python çš„ socket æ¨¡å—æä¾›äº†æœ‰å…³ç½‘ç»œæ¥å£çš„åº•å±‚æ§åˆ¶æ–¹æ³•ã€‚<code>socket.socket</code> å‡½æ•°ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ socket å¯¹è±¡ã€‚å®ƒçš„ç”¨æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">socket.socket(family&#x3D;AF_INET, type&#x3D;SOCK_STREAM, proto&#x3D;0, fileno&#x3D;None)</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªå‚æ•° <code>family</code> æŒ‡å®šäº†ç½‘ç»œåœ°å€çš„ç±»å‹ã€‚æœ€å¸¸ç”¨çš„å€¼æœ‰ä¸¤ä¸ªï¼šé»˜è®¤å€¼ <code>AF_INET</code> å¯¹åº” IPv4ï¼Œ<code>AF_INET6</code> æ˜¯ IPv6ã€‚</p><p>ç¬¬äºŒä¸ªå‚æ•° <code>type</code> ä»£è¡¨äº†ä¼ è¾“å±‚åè®®çš„ç±»å‹ã€‚é»˜è®¤å€¼ <code>SOCK_STREAM</code> æ˜¯æˆ‘ä»¬ç†ŸçŸ¥çš„ TCP åè®®ï¼Œè€Œ <code>SOCK_DGRAM</code> åˆ™å¯¹åº” UDP åè®®ã€‚</p><p>å› æ­¤ï¼Œ<code>s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)</code> çš„å«ä¹‰æ˜¯ï¼Œåˆ›å»ºä¸€ä¸ªä½¿ç”¨ IPv4 ç½‘ç»œå’Œ UDP åè®®çš„ socket å¯¹è±¡ <code>s</code>ã€‚</p><p>ä¸ºäº†è·å–ç½‘å¡çš„ IP åœ°å€ï¼Œåˆ›å»º TCP socket æˆ–æ˜¯ UDP socket æ˜¯æ²¡æœ‰å·®åˆ«çš„ã€‚ç”±äº <code>socket.AF_INET</code> å’Œ <code>socket.SOCK_STREAM</code> éƒ½æ˜¯ <code>socket.socket</code> å‡½æ•°çš„é»˜è®¤å‚æ•°ï¼Œæ‰€ä»¥è¿™ä¸€è¡Œå®é™…ä¸Šå¯ä»¥ç®€å†™æˆ<code>s = socket.socket()</code>ã€‚</p><p>socket å¯¹è±¡ <code>s</code> åˆ›å»ºåï¼Œå¯ä»¥é€šè¿‡ <code>s.fileno()</code> è·å–è¿™ä¸ª socket çš„æ–‡ä»¶æè¿°ç¬¦ï¼ˆfile descriptorï¼‰ã€‚</p><p>å¦å¤–ï¼Œä»£ç ä¸­çš„ <code>socket.inet_ntoa</code> å‡½æ•°æŠŠä¸€ä¸ª 4 å­—èŠ‚ IP åœ°å€ï¼ˆå³ <code>struct in_addr</code>ï¼‰è½¬åŒ–æˆç‚¹åˆ†åè¿›åˆ¶çš„å¯è¯»å½¢å¼ã€‚ï¼ˆç½‘ç»œå­—èŠ‚é¡ºåºçš„æ•´å‹å€¼ -&gt;å­—ç¬¦ä¸²å½¢å¼çš„ IP åœ°å€ï¼‰</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥æ¨æ–­å‡ºï¼Œä» <code>fcntl.ioctl</code> åˆ° <code>[20:24]</code> è¿™ä¸€å¤§æ®µå†…å®¹ï¼Œæ˜¯ç”¨æ¥è·å–ç½‘å¡å¯¹åº”çš„ 4 å­—èŠ‚ IP åœ°å€çš„ã€‚</p><h3 id="fcntl-ä¸-ioctl"><a href="#fcntl-ä¸-ioctl" class="headerlink" title="fcntl ä¸ ioctl"></a>fcntl ä¸ ioctl</h3><p><code>fcntl</code> ä¸ <code>ioctl</code> æ˜¯ UNIX/Linux ç³»ç»Ÿä¸­ç”¨äºæ–‡ä»¶æ§åˆ¶å’Œ I/O æ§åˆ¶çš„ä¸¤ä¸ªç³»ç»Ÿè°ƒç”¨ã€‚Python åœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œäº†å°è£…ã€‚å‡½æ•° <code>ioctl</code> çš„ç”¨æ³•å¦‚ä¸‹ï¼Œå‚è€ƒ<a href="https://docs.python.org/zh-cn/3.7/library/fcntl.html#fcntl.fcntl">æ­¤å¤„</a>ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">fcntl.ioctl(fd, request, arg=<span class="number">0</span>, mutate_flag=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p>å‚æ•° <code>fd</code> æ˜¯æˆ‘ä»¬æƒ³æ§åˆ¶çš„æ–‡ä»¶çš„æ–‡ä»¶æè¿°ç¬¦ã€‚åœ¨ UNIX/Linux ç³»ç»Ÿä¸­ï¼ŒI/O è®¾å¤‡ä¹Ÿç”¨æ–‡ä»¶æ¥è¡¨ç¤ºï¼Œå› æ­¤è¿™é‡Œéœ€è¦ä¼ å…¥ socket çš„æ–‡ä»¶æ“ä½œç¬¦ã€‚</p><p>å‚æ•° <code>request</code> æ˜¯æˆ‘ä»¬æƒ³è¦è¿›è¡Œçš„æ“ä½œã€‚è¿™ä¸ªæ“ä½œç”±ä¸€ä¸ªé¢„å®šä¹‰çš„ 32 ä½æ•´æ•°è¡¨ç¤ºã€‚</p><div class="note info modern"><p>ä»£ç ä¸­ä½¿ç”¨çš„ <code>0x8915</code> åœ¨ <code>/usr/include/linux/sockios.h</code> æ–‡ä»¶ä¸­å®šä¹‰ï¼Œå®ƒå¯¹åº”çš„ç¬¦å·æ˜¯ <code>SIOCGIFADDR</code>ï¼Œæˆ‘ä»¬æ­£æ˜¯é€šè¿‡è¿™ä¸€æ“ä½œæ¥å–å¾— IPv4 åœ°å€ã€‚</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[root@VM_0_16_centos ~]# cat &#x2F;usr&#x2F;include&#x2F;linux&#x2F;sockios.h |grep</span><br><span class="line"></span><br><span class="line">0x8915#define SIOCGIFADDR0x8915&#x2F;* get PA address     *&#x2F;</span><br></pre></td></tr></table></figure><p>æƒ³è¦æŸ¥è¯¢ <code>ioctl</code> æ”¯æŒçš„æ‰€æœ‰æ“ä½œï¼Œå¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ <code>man ioctl_list</code>ã€‚</p></div><p>ç¬¬ä¸‰ä¸ªå‚æ•° <code>arg</code> æ˜¯æ“ä½œæ‰€éœ€çš„å‚æ•°ï¼Œè¿™é€šå¸¸æ˜¯ä¸€ä¸ª 32 ä½æ•´æ•°æˆ–ä¸€æ®µäºŒè¿›åˆ¶å†…å®¹ã€‚<br><div class="note info modern"><p>æ ¹æ®<a href="https://man7.org/linux/man-pages/man7/netdevice.7.html">æ–‡æ¡£</a>ï¼Œä½¿ç”¨ <code>SIOCGIFADDR</code> æ—¶éœ€è¦ä¼ å…¥çš„å‚æ•°æ˜¯ç»“æ„ä½“ <code>struct ifreq</code>ã€‚<code>struct ifreq</code> çš„å®šä¹‰ä½äº <code>/usr/include/net/if.h</code></p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[root@VM_0_16_centos ~]# cat &#x2F;usr&#x2F;include&#x2F;net&#x2F;if.h | grep IFNAMSIZ</span><br><span class="line"></span><br><span class="line"># define IFNAMSIZIF_NAMESIZE</span><br><span class="line">char ifrn_name[IFNAMSIZ];&#x2F;* Interface name, e.g. &quot;en0&quot;.  *&#x2F;</span><br><span class="line">char ifru_slave[IFNAMSIZ];&#x2F;* Just fits the size *&#x2F;</span><br><span class="line">char ifru_newname[IFNAMSIZ];</span><br><span class="line"># define _IOT_ifreq_IOT(_IOTS(char),IFNAMSIZ,_IOTS(char),16,0,0)</span><br><span class="line"># define _IOT_ifreq_short _IOT(_IOTS(char),IFNAMSIZ,_IOTS(short),1,0,0)</span><br><span class="line"># define _IOT_ifreq_int_IOT(_IOTS(char),IFNAMSIZ,_IOTS(int),1,0,0)</span><br></pre></td></tr></table></figure><p>åœ¨æˆ‘çš„è®¡ç®—æœºä¸Šï¼Œ<code>IFNAMSIZ</code> çš„å€¼æ˜¯ 16ï¼Œå³ç½‘å¡åç§°æœ€é•¿ä¸º 15 å­—èŠ‚ï¼ˆç¬¬ 16 ä¸ªå­—èŠ‚å¿…é¡»æ˜¯ <code>\0</code> ç”¨æ¥è¡¨ç¤ºå­—ç¬¦ä¸²çš„ç»“å°¾ï¼‰ï¼Œè€Œ <code>struct ifreq</code> çš„å¤§å°æ˜¯ 40 å­—èŠ‚ã€‚å¯¹äº <code>SIOCGIFADDR</code> æ¥è¯´ï¼Œåªæœ‰å‰ 16 ä¸ªå­—èŠ‚ <code>ifr_name</code> æ˜¯æœ‰æ„ä¹‰çš„ï¼Œåé¢çš„å€¼éƒ½å¯ä»¥è®¾å®šä¸º <code>0x00</code>ã€‚</p><p>æ“ä½œ <code>SIOCGIFADDR</code> è¿”å›çš„ç»“æœä¹Ÿæ˜¯ <code>struct ifreq</code> ç»“æ„ä½“ã€‚å…¶ä¸­ï¼Œç½‘å¡çš„ IPv4 åœ°å€ä¿¡æ¯åŒ…å«åœ¨ <code>struct sockaddr ifr_addr</code> ç»“æ„ä½“å†…ã€‚è¿™ä¸ª 4 å­—èŠ‚çš„ IP åœ°å€ä½äº <code>struct ifreq</code> ç»“æ„ä½“ 20-23 å­—èŠ‚å¤„ã€‚æ‰€ä»¥æˆ‘ä»¬ä¼šçœ‹åˆ°ï¼Œ<code>fcntl.ioctl</code> è¿”å›çš„ç»“æœåé¢æœ‰ <code>[20:24]</code>â€”â€”åªéœ€è¦æŠŠè¿™ 4 ä¸ªå­—èŠ‚æ‹¿å»è½¬æ¢å°±å¯ä»¥äº†ã€‚</p></div></p><p>åˆ°ç°åœ¨ä¸ºæ­¢ï¼Œåªè¦æˆ‘ä»¬å¯ä»¥æ­£ç¡®ç”Ÿæˆ 40 å­—èŠ‚çš„ <code>struct ifreq</code> ç»“æ„ä½“ï¼Œå°±å¯ä»¥é€šè¿‡ <code>ioctl</code> æ‹¿åˆ° IPv4 çš„åœ°å€ã€‚ç”Ÿæˆç»“æ„ä½“éœ€è¦ç”¨åˆ° Python çš„ <code>struct</code> æ¨¡å—ã€‚</p><h3 id="Python-struct-ä¸-unicode-string"><a href="#Python-struct-ä¸-unicode-string" class="headerlink" title="Python struct ä¸ unicode string"></a>Python struct ä¸ unicode string</h3><p>Python çš„ <code>struct</code> æ¨¡å—ç”¨äºç”Ÿæˆå’Œè§£æäºŒè¿›åˆ¶å†…å®¹ã€‚<code>struct.pack</code> çš„ç”¨æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">struct.pack(fmt, v1, v2, ...)</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå‡½æ•°æ¯”è¾ƒåƒ <code>printf</code>ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ç”¨äºè®¾å®šæ ¼å¼ï¼Œåç»­çš„å‚æ•°ç”¨äºå¡«å……å†…å®¹ã€‚</p><p><code>struct.pack(&#39;256s&#39;, ifname[:15])</code> ç”¨ ifname çš„å‰ 15 ä¸ªå­—èŠ‚å¡«å……æˆäº†ä¸€ä¸ª 256 å­—èŠ‚çš„äºŒè¿›åˆ¶ç©ºé—´ï¼ŒæœªæŒ‡å®šå†…å®¹çš„ç©ºé—´ä¼šç”¨å­—èŠ‚ <code>0x00</code> å¡«å……ã€‚äº‹å®ä¸Šï¼Œç”±äº <code>struct ifreq</code> çš„å¤§å°åªæœ‰ 40 å­—èŠ‚ï¼Œå°† <code>256s</code> æ¢æˆ <code>40s</code> ä¹Ÿèƒ½å¾—åˆ°æœŸæœ›çš„ <code>struct ifreq</code> ç»“æ„ä½“ã€‚</p><p>æœ€åæˆ‘ä»¬æ¥è®²ä¸€è®²å­—ç¬¦ä¸²çš„é—®é¢˜ã€‚Python 2 æ˜¯ä¸åŒºåˆ† <code>str</code> å’Œ <code>bytes</code> çš„ï¼Œæ‰€ä»¥ <code>ifname</code> è¿™ä¸ªå­—ç¬¦ä¸²å¯ä»¥ç›´æ¥æ‹¿æ¥å½“ä¸€ç»„å­—èŠ‚ç”¨ã€‚ä»£ç ä¸­çš„ <code>ifname[:15]</code> æ˜¯ä¸€ç§é˜²å¾¡æ€§çš„æªæ–½ï¼Œå³åªä¿ç•™å‰ 15 ä¸ªå­—èŠ‚ã€‚å¦‚æœç¡®ä¿¡ç”¨æˆ·çš„è¾“å…¥åˆæ³•ï¼Œç›´æ¥ä½¿ç”¨ <code>ifname</code> ä¹Ÿå¯ä»¥ã€‚ä½†æ˜¯åœ¨ Python 3 ä¸­ï¼Œç”±äºå­—ç¬¦ä¸²ä¸èƒ½éšå¼åœ°å½“ä½œä¸€ç»„å­—èŠ‚ç”¨ï¼Œæ‰€ä»¥éœ€è¦é¢å¤–çš„è½¬æ¢ã€‚å…·ä½“æ¥è¯´å°±æ˜¯æŠŠ</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">struct.pack(&#39;256s&#39;, ifname[:15])</span><br></pre></td></tr></table></figure><p>å˜æˆ<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">struct.pack(&#39;256s&#39;, bytes(ifname[:15], &#39;utf-8&#39;))</span><br></pre></td></tr></table></figure><br>å…¶ä¸­ utf-8 æ˜¯å­—ç¬¦ä¸² ifname çš„ç¼–ç æ–¹æ³•ã€‚</p><h3 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> fcntl</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_ip_address_of_iface</span>(<span class="params">ifname</span>):</span></span><br><span class="line">    s = socket.socket()</span><br><span class="line">    ip_addr = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># æ‹¿åˆ°ç½‘å¡åç§°(15æ¥è‡ªLinuxåº•å±‚å®šä¹‰ï¼Œä¸æ“ä½œç³»ç»Ÿæœ‰å…³)å¹¶æˆªå–ä¹‹åè½¬åŒ–ä¸ºutf-8çš„byteså­—ç¬¦ä¸²</span></span><br><span class="line">        ifname_str2bytes = <span class="built_in">bytes</span>(ifname[:<span class="number">15</span>], <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        <span class="comment"># æ„é€ `struct ifreq` ç»“æ„ä½“ï¼Œå¯¹bytesè¿›è¡Œå¡«å……è‡³256ä½é•¿åº¦</span></span><br><span class="line">        struct_ifreq = struct.pack(<span class="string">&#x27;256s&#x27;</span>, ifname_str2bytes)</span><br><span class="line">        <span class="comment"># å‘èµ·æ“ä½œè¯·æ±‚ï¼Œæ‹¿åˆ°è¿”å›ï¼Œæˆªå–å…¶ä¸­4ä½é•¿åº¦çš„IPåœ°å€ä½œä¸ºæœ‰æ•ˆå€¼</span></span><br><span class="line">        sockaddr_ifr_addr = fcntl.ioctl(s.fileno(),<span class="number">0x8915</span>,struct_ifreq)[<span class="number">20</span>:<span class="number">24</span>]</span><br><span class="line">        <span class="comment"># å¯¹4ä½çš„ipè¿›è¡Œè½¬æ¢</span></span><br><span class="line">        ip_addr = socket.inet_ntoa(sockaddr_ifr_addr)</span><br><span class="line">    <span class="keyword">except</span> OSError:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">return</span> ip_addr</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://www.cnblogs.com/my_life/articles/9187714.html">è¯¦è§£ Python è·å–ç½‘å¡ IP åœ°å€ - bw_0927 - åšå®¢å›­</a><br><a href="https://stackoverflow.com/questions/6243276/how-to-get-the-physical-interface-ip-address-from-an-interface">python - How to get the physical interface IP address from an interface - Stack Overflow</a></p>]]></content>
      
      
      <categories>
          
          <category> å·¥ä½œæ—¥å¸¸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> ç½‘ç»œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python å¦‚ä½•å®ç°è·¨ä¸»æœºæ–‡ä»¶ç›®å½•åŒæ­¥ï¼Ÿï¼ˆåŸºäº watchdog å’Œ rsyncï¼‰</title>
      <link href="blog/2020-07-22/monitor-files-for-changes-with-python/"/>
      <url>blog/2020-07-22/monitor-files-for-changes-with-python/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="æŠ±æ­‰, è¿™ä¸ªå¯†ç çœ‹ç€ä¸å¤ªå¯¹, è¯·å†è¯•è¯•ã€‚" data-whm="æŠ±æ­‰, è¿™ä¸ªæ–‡ç« ä¸èƒ½è¢«æ ¡éªŒ, ä¸è¿‡æ‚¨è¿˜æ˜¯èƒ½çœ‹çœ‹è§£å¯†åçš„å†…å®¹ã€‚">  <script id="hbeData" type="hbeData" data-hmacdigest="84b3269a32f0bbf80fdba0f07ff0120f8be67a215831b9f1934e2636ffc5572c">b48514d55716e1a96c0f8f9b1f5ab687bc24b20bab4bf27a5424100432dc17499d87a6a657eb6d2669993aea908eff6edbc2ba82e80644a5a8337e90c5497d1446aec5f960044108004d073123e4fa06f8aa998e30009406230b2f96b419e52dbb9c745a5d57163b1308d9b9fe6bb90fcf13b07555bbb93af18dd5590877acb82b85d6a1f01c5ac7c818e813f558e9796921da1ed1eb08d5a03cd99f610e7b5ab4f2db116a2e6171a35eb9e7d83bf5b343b7d8fdffaa309e2098bec235746e3d2378aec5b19871216f8b9849ec201cc434242d216b93da727d9574f5ebe462e138f8bf3dac3f10d36325d9071af36ac254f29f3c882e775a0fb2fd843dc242b6eacac98e2931e3a6d95b4536b913d13c52cdcdc78f65b26ab4b2972d206d6115870142e2540d528087b63db3e0be15231ee83ec38389c5230413cf91f001f17224f428c73b1d247fedf0f83f13994bf22f0530471ee9b3df64fd05043c55a35cf0364eef3339f5cb82ef9ae024057204dac952e9c78ed7b44555dec17a093a2e2ede3e4285493ce147b35f7a7500f514611dfcd024224fb5901cbb6ef700db564b615f0351ada77c457e220d3a6c3825133cd9957490c6d65c58ec315c8b23eb44cb2489c9634f2f3128516d54eb396eb535a393ef9cc8eb2caadb238baa14d273d9d88c432b9f456cd220b98e6676a95416b0818bce56e385edfd13cf8b6bb96471b5f6af29f38032746786dde61514370953cda49707280aba6b56a23d68479f4433eda69b3114b4e40b8ae82fded3d84059ae5ac494cb2b0df314c7222b0598e5a8270f4d6ff175bc5a47dde1ac3ce24fda0c353396ea972abc1fdcc72c3f0d443bdf2f0ae4002579fca1658cab2ae154be7af60b9614c403293d0d53738ae098e1df016470960a2b9875ccd69cf5fe17f518c5a05870ac93d4eb59bc40e910fa6124f2cc05636260ea3cba2b4d9a61d24873a6f3a7952cb657181239cb304a3b56c5a76509927e2c3a64366bc1a8c92dd3865180497df310cb06dfcd2b73e73ec3cca6eb7cb203487256802b0f4822dadd878d342d9e2669a526556b5b590ac394cb4b1a3fe99c1d6e3ed1dfef2af07ecd77ce259f97e33df7c0b063b2375af59f734e3b39c68fe5254fc7f26e8b89fc98ea1d2a932a4a34fc431b563f84152c3fb4233910794e320f92a0d1a93358495a264f4b46dfdde3ae28cd5c6dd7d5a08152362601203978ad0524ead50c82a1f2c15a57924254ec960027e89e568fb7b18138d2ce3865741113ca72de13691f35d4873051a4d018a0dbb4b789797989f6b7e65ec4ebeaabca854c1cd5004d069869940452ddafe95c4c65d6939c6bbd8bc3d77a2ed687d4539582966c0239567bc4cf4d4a7faa1751e193166ae48944688f9886bbfc3dff496dcc13e00aa25ef9bc33ea9ffe307bf32781a40d0a041db1c6f618c38301e99baa3f223b8ad2d414457a112207cf5ccb009755a8898721c38a1eb8da2887c80e6add0cc50c65cf659d687834b6aa5d0e213e9af901bcce4d45bee56e853fd44e1d0b47ca29070da583e250965e16b8d9bdb70b9ba7bf43bc41ce825553f8a00768be21bd908eddd090cb929657cd3dd8d0140d2026ddef5fc2df1ab38d8e2d2dadd916f6d9626249bfb6febe3adecf580ef81958fa852efed637da9c024ca1f5f2dc2af7e32ee21ed3cb2b9a87939db6e398c6774672bedd230ed945e9303e580569ccb72ec9b4901a8303a5212932d6a740e24724fd4844716dc44c33987fb00666c014ed918d0ecbc54dd893911355abf7f90af3be0a228ccf4801fd49e3662e5566971497ed9313dde2b2298fec266a76326bdaccd1ce8ac84520df2df6b62a72408613752227e82772d5dd075c3f059a3dd03c1ee718a84957b03b7ce8516b158627c4d593cf2179b092db4422b41cfb64773c2ea14cc5610f6f4d7ce1112d0eb2a128f252cb0b552e8d5ca308140b83348abb10805bab5727a20b5780b868c690abc1277661128d67fb6c5e0d766fbfc93c514263e5edf77c39d68d11e1cf1174a8da447e5c904a817573933c803d76948f85771014509f9846ecbed1862e71744dd669a9c9e2976f9df269f83c3fb261bfd235dd0214709839059b4442e00201ac96096fb4f6d7054f5fd085314777c0f6559940a3cd88ef3d2ba9b7dcff30deab6ffd010952a9b1dfe201bb272b0e8a7693fb7ebad94e95f5a6468ec2ba63c24afd797f59a04869f90088b6274ea02907691253cb85ac03bf3cba76cd350e9c567bd69027ce2b10389fd2337e07a7777f63afc2b7f6e8363903945dcf5228e20d130b51380386dce96171c6b0becd6317fe84b8a100acc53569289d53a1c25e9ccc58971143214c2012d2c488c5471ea4b645bc90402aa61da11d00fe6ab9e00d277c1ab42942ff1238fa5c0caec672105649ddc8b1cdac9cc16dd3c2da3cba8b4cd084351525804385c2a0f185bb921cd0e7e5472151dfae4e9af08b210c35e88509673c7fed483b3b42977bcb6b354d1cac0476f77504e5b7ffe3a05775cbe48d95c434f6539cb7fb6c2c21e29734e725bcb6452267f960f86f6fb30ebd44e32fd599b65a2a48f3cf3ceec4ce385c876f75a4c8871c948a0af976922648be791e8cbd53e66ff1ed0f8089a910f15ac83bb6109e09844ddecd9dee6a6cfa31a09ebff9ad248aee29453fb484a63908e367dd7326fee47cb518721e47ce12d5e8dff1bd73a0b2481808d37b33e18a9df6c6300dc7a98b7d74d036f72e311f3c0aaa17abf35788aaf01c4ee893fe8dcfd858c1f131621c6cc85baf42bc884eaeca1bd6cd4bdc3de1eaa155e7ef2240217623b818d162fbf73228e4e70c091150e3c6a7a75c30eb07f4e1ba4f51c5dc691064dad98805d7cacc201f9802ad9824779fbe2053f54941f9c5379367cbf39eea5a727de5cd9f98eb3830f4fbb5b11f58c3576c119a52ff07e80f1aacc5e43d0e1584eef2a666f281161250197625fbd46861bd421367cd5efbf0d97ed3a0e112e6c8ab86181bb5fc0efa95c7e00b63f9ea7c9d364b3bef48aeadffe216f7ad4d7d39fe82b6361b9694f2e2a859b7f0f955743fde87c729b5a9664fb0ed489f0d24fc26db4e9238d7df0d6c87dd38657fbacd9f47be895d57093ece0797bc86a645ed07d6123fc77eaa70439149639a9ad438156efee0ca31e9ce0633e65845de4aea73c4f7b5554c7e17c4c946265ae60f09166f66942c0b81e92eb2da33ee3cbb31ecf1a2ced08ac65c3303ed15e75399a02431fd2b86ec95895ab74711a77fa4062f81a9dc9b2144c005e76db8ab7bbfaf7806b9682880ec144e426835b9b56e82fd5d5100396c0ed74f1db5a8e450e84e01307ce7c6bcd197b84e04b1d348da830fcf678af18f0791cde2c81a1402e68caff72c58b8075a05439c1fbc6abcb32e0819d410b16c1f2d650bc169fe9b4cab5b74ca8899580840b100dc41ef14b9948d6e4fa263fa1b1e7124b102008bac0c88765dda9109c8c55dc7c728600683d9e85fbbc60475e0e56ac1d12280fd004703bcae3a09f045ae373808c198cd6c85a852c5c0c31eb11dd5306f8737782be2275b77d2178493c1e28d5d8a57e3887fe2be2db0a9800d113eae496f77dfb47e3486af00e2e83228398b050228b93da5f75f206678965a82200fd76cb15ccec6b9ec4ce1fb0b2f507019dd7fb6536633c525c963a716583be3cea331ad7d12b1f6780d67718baf5a8ce95e87a58ad672f198f8827e486e2d474de8284c86faa01fb38de7b1499b28e923c0444ca22bb62a8a3bbe81422a3fe0b3fa4654de21a4a73d55bab7b256b456ccebe5679619c572c99c3ff50d436e902b0364f1314678825c82710aefbb4e67c456a3ac3071ca6633a5dbfdc71fdaad9824c5bb45b0e582c306d0edceade24f6834fe96e8aadbd42e1323a0cf2fde6e4c28cb3e10fd868a1f417fdd0be601b4211b559fa05ee63e9d3ea02da753b9f60c2f9a602e4e2c90fc8e82c0488c02c8c5879cbc270711f7070bef7f19fb97b322603f96a60ef93ab25275a7d30f414ae9b0e8069007a9d8e8c3a02e9ddee96e511c5de36a9f4681a3cd00f8f88cc8a87096001b3d587dd0b7a97968743d7d7742ce2c4a93841117919ed204c8b5ec265c874ca8a9d445dbfdbe9b7e833853e19d5f6d6fc08d33f87460fda93869255027641f310495fcfa54984a5027c99a2f0f0d65ef7a38be830283c1e470ec23e2b0c74b187d5c1bb22929dcd9bf8a39402664989fd83337d59558ab9602462004183978060e30c85cfafc7f99d8638ec86cadb44028325afc999ade743a1988b1deb2984352c92c71cd5edefad359263c7da65df2f7c59f0997421318cd474ea687041a6c981d07fd1cc961a37db7f83fcf937819ff314d1e43eaabf30b8f95624e5a80befbbe0fa8a27a4815f2089d20b060d27cfed685c771811f71f915aa6ba89e641b4643120cbb33160846540649672a544a7d4f81134de8ee18b0718e102570c36070ca896eb2252889cd58d6ab68b0f588d0af1138b8a99a8444b4f7c0434ff45c8d52f375c4f4d17cb870bc0609b4a8fb263cd93f7a6f41def82f6a0b2e4ae0f151db85f18e4ce0c13ec4e8939b3f23a2a41d3892e7c209c3e4f0c4f8d6970972d3be77e768de293c459fc7e8d890f224cfdccab41d717fd6d08e1df5ca2e016f5cf3acd09dcf20b75d23d532e88b955a60e0810ea50769a5a0dab503118f4dcc81fb7aa75b84e2112a8371945cf4ae11e691652c880e5fae4b22df31ccfcce2aa37c1ce436807464e0b65d991b31f749e247171903b226018e6ecbef2a9e1dc00c371b57675a1813a150044ac8d5a3a8744965ef1b3c70b18ea4fab45b3a03fc23ca38f8042f8a1383ede4e0611850bf088e0aeb9052367649dcdb969d8a55bc31729eedcd619281a407ad7c3a532a16c280361c46bd8d0267748dc8acaa586e1d3a0cbc66bdbbc4f52d16f9240f7d2af26ad7b64382261abc06d4e7afbdf27f50b87ec4a1e310b21c1ea55006558df13bdd376720d8923aca18b8123d02bcf2285d7e09b3f9cc617545e6ea2b054549ffae3cb99bb08ee848bf41973229b79b53cf137ca7fe04ab1de87b5f588f6df82e7fdc09b58e7e5006be2d74f02f0f768a5d25866f0cfe915510cb84c54e3110ce1d6a903d3c185e365a39c83402d3bd00d5623052cc747f85eaaba7b60f990c45f0c2daf3dc8582b2fa3a30dfba599b4e00e7c0a89b26b3eb807bb1e02b41ddeec4cfed30c6023d0f65bea9222b4115f862de0245cde0ade13e5014b8774b9d07e1a7994414fdeac01ae0261fb13bccfc4f9cf77e20385f50c6b2e8d57c3ce166b131c4a45dc90af6f1a0d1c3bc91293fec5823054820197312376e1421a9d5fbfca874d6217e5470649fac39c3a3d419c0998f2900545ac1ca6715065538384ca7ae278a95271c7e3049fead60b8b504d3b7e664999d56607efe739206a91932d7d094f0148ea3c8a4d499fd6329ffaa63d2c92cfd8ff9d7dee6479ca3b4578f16ad40df94988fbf071fd5019c5847fe49a251e93952a414fdd1475befbf721086cb1c212104bbb4c48430113e02838502ac6fc8e4ea55f174dc6434b854b162030d2be29b540b5f99817821f742f261ca0358928c9b0be3e60d1e3e4dbeadc09a13b3368eb69921e2cc84761cd2dd85b871cc1f69be56b8eeefc36005c081413d161432570704897e1b629175686ecc8855629e132ad5572a5854aeb3dfc85657acf11f6958ec4974564ca3207e312c7e80805588c2b4ccbda485ecc368ab2226f0e36eeacff38ac5e1ab24da4f03f995e57ecccfa228d21cb706c14bdbe5bee913e68a2d9af25512ae62974dcd81800fe98fd63bfee48f54a9cf8705c9d31dcbabbc6acbfde65d44d1a76502b1a68e978e485e560a1e64afcf0042e2a31a1eff7f6c5a5f547cc30768be31b2d3b6a3f9224178770b5ba43f86ed6802ea7a330d065e3e17b0aba5584264a8dfb36b025f80ad177f21530f6a69e6e05490ec62b9eaedb82d30dae032b6e200cd39b2d442757ab224b2e24683aa4fc7626d05ac00d71248b478b0fe0944d059af2818336f906ecff9b331ac9844cf12445a803e823b1a199d8dbc493aec5ee3d668421f0a653c5b8898df5260ea01a403258b4cd4a1cc185441bca4e2103581c9d9010ec5286c03ced7fc3cf68cffae248fcad62600db5da23980ac7d9e1dfb586f963ffd5112166ebe54cb901887c97b55813940652100d0f9614ef2d06d9cdbed868961878eaa584c71827231889f6bb716f3f4a442b9aaf6040a851192531c0f5301d493e7b9d7eaad708c8ed1adc37233abe8a96e112a98cc18dbe259d98f52a66407f118cec12ac21ba6da5e2e839b0c7bac38fd75489a94b60a007cf43ac1ad7724932b77095f2ef43a7aea4e923c60b420443abbde4cad161959fa639978783038f970828360d92e72afae4dafd650d0c826500878a99b6cf32791b8a303d44ce5766a23071b37bf33be1f27190de9d17526e634ab48e4829c14d17a5764951fe398648a2f032aac108764d37648d3037dd4cebf1bc15cbef80e7f573bc3dececcfd2a675aeb9e0c09b7fc3cb6fe5f312080ebda1bd4af2404b386bf712414f0fa0dbcb1b4ce35c80569370d5b4374e4e5cf6392d3e9aedfdf51f83a394cc38a0fa4f1024dae1fa3b492f79000463b236a3aad15aafb9791fec1e8c382f945d25bf1d943fe1830e4e2042daadc51507a33110219c49fc168c2fb5a478c4dc6158cca34287901694369c393370f15356a7e0c9e6b3dae37faefbe6e03b26da83747f1b17d1ed6bd471e7d1a989ad12bf121f2c8b01cb93c6d66b36d244dfd84ab49cd90ffb1c0903e45bb4b35998e8be7f3431874e5ca37afdcd388c27bb0e9bd70213d47c8872eb323452acfad3497baa261c477572a893f5fb2c2254bf6880f0654290151cd895fdfbc0036bf93c58de5b23a4c4797b052b3b8d22665d0eb75e17fc6e728202e0f7a25e41cb56c985192ac004d6779cf1f89db47d0f7dfed51f8d447ef0e34955590e354d4d9ccd75b4e88adcd705d7d66ef6fc6bb7630b464c97d3ba6e509cad9c1df0ea3976f8e09154230b9eca7aef9c10fe3c2c8a8213c15eab37ad921c0ae08ff99d81aa8eae78667501c4593c5a5bd1f12078062c78222cc44f599100f91f9789090edb872e029286bd6962374df046abae9a518027012895fa91cfd3dbfc928a908092334a46b611aa4c4fdfe3bde191200ab3f5809031ea72e08402542962d7b7dfed83599b4dbfd2ada3f383c2d50e799cd6c1b522b8d160ea943f41002a820c5b4f6877bf2be32397308e266e75772770fbe11e91486f6945f81fe8b3768187593c704d2ebf5fbf4faf752204310df347f20b07d0b1eb8f970f79b102811b16e703fa08bec1cb39cd8212f046017a6600882038a0c8c64693cbade287d1931b48b0c7ffca062116e3f002a0f1af3c0aeb34688d8565889cb2dd4dfeb224e7f5590a0379d1e200b647fd43f057c614b9014a17c76a7c2c8d410e851db5457f6a6b05ab1714412087b2de1a98d6678a1a04f7777b0a928c494e34807abf932efc0ded7a6b930a79408cba3791929fc7bf92175fbb344e392053238e69d3b99ea7e6e3419f61fe91e0da01f786f6241753061fcc6c91ecda6dbb727bfacc208d5c65343db3dda54709658252cc8436fb6f94986af9beb110af2de070c1c6727c814e3dd2d1a9df2eea99d912ef4676819790e73cfd04a995cbdaf729c4c764be6f896b045f1df1102096089e9032830e1095a3a07f097cdfe17cb8f39796a21165abaf8e17c9224e392531ee9ad753e80a628e95d537658bb62ea9172aa1b58235c52ce47a4dd1abe3369cc00d92b0a6341c3ca2f52d109223b771d67f0b5f2c5e5b4eaa8be810f439f90add764efa4600fddc0abbc702c59419947b6b2c0ee40d563c1a037a7ca99da5236b2910438fd99d6392c6d93b3326ccc3b0f01b6aeb8c3a3941f1bf617426cb30ee8b32c5a41418e606f53986efb8343da73d1667089d4ecbd9168e7e4e9464c44ab4b183bdbffa7e10ef5fb3787d7c7a918ffd32da70efd997a6a3c2b3f7c5e9da2253740591347f5fbad60af7caaeab663fa796dc8958af7ff96361c0b7668feea37c5ed346a4a5655c79a72b404e4bab603e55ea9b5fd29f454628bf1a97aef0034b60cf5e2cd14ba9db768b6632e296c75df0b63e66d7cf54bf508682f6b2832271c5743f8797ff0e14ecb4aa282e0c06ba17ddcca6e018c1a162f3eb4638b188ac25bb0aab66c6539be96ebf7b5b64fc0e16ed29f4bfef164c3bdcd79ba43d95f45d7618fbddcc0f9c6f192fd97f09949d3bf1962f70f9d7248c3916ed91b8b07a62c9faee05d4962464ee654d32103e8ea415f0a136e543178e610396a63d6bbe55c5de5f64921b4ccafa049f0a4a3c15646353b5feba446878fa5f3e2dc6845fb176c3934379e7d53787ca42d5d862c09e69209b98dbce16b8e3ecfd8efad55fe7b755a4ee3e8dfa108ac7c1b5f5d483717611e67f6a83fdb1101b568315352e0b3f226d307393a6ffc756f4dc634696c3d3616f6d11d6fc6dff3d46e70895b6b89916e24c8424954a6998e91645b7c77f0adee28beb528feee898db6c52467bd579f7587215ce8a1bb6d2245ad859bee609c6958ccd7c3aa4a8a2b7ac8d147ec8c317aaad3a223b85ae7b5d5846309c2f0035aab1b0f1ae8cbd6b3a57d0c0a3ac2373f51ce87d96644ea15d5a7f61ae5f9798599430cbdd920724c2dc09ec12933e774123868e94d2f1a90ea74e0fd7acb0631983b8fa7bbfdf5dceeb67e715be4d4248fbe1639a069b7b4dd5eff5d95cd5c28134fb280c4e8ec809726a853b1621337687781fbae5dee6553fa4c4860d9e6c12a03f42dd64eb3f2acfde84db9f6cb422e927693aa39b64c273fa400c91a8994bac1afa2837d1ca1d721d8d929ec589cc54958e287a5955662759e023dcc68eea986d5c5abeec1f29e4d2b73ec1f6e5241ca9464528e8cdbc5188537e973500bc24d76b6f6c3dfe03498dcbe2119c15d3a15b6ac47fbbf1e20c83cccbaf5f30ed802bba71e5b4fb1909dd74b68446806de7d3bb1efbf6d8393e8351ed2da94d7ae8bdb40eda7d2f3a84ab9704cdbdf88c60c9435d8d5bbb9955d77f7ecce9b47f5203b505dcbaca21381092f07f5f10588f1f10dfe433d581e2a196567473f6ba0e1d026756bcac979f14ca28b92da11f36c806ab9520a12fd64843906d1ca38b63bbc059aa62f2ea5dc3b8d324d3ab99c9bb86c36325570653ad1326922c51bcdb4238729bea5a37e35ed571cb9704d1ebe91eea68937aa734db8a874c8efc3bf8ec04ef85c3582339a1b0e280f57f08cd7fd73bd0e21f5e6c0ef0f716210b766f22f87fcc4a5957eec100598875812aa7254c13a7063d7922472bbcab5c883e16fbdca7ce2a43d050fdb5cbc5b576bc745042038501f50359d1e79f25027f4454ffda511fe783af3e9a22962ef637fa8b8b0a1efb819a784dfbea0c7ccd719bcd415d164ca33d8cef695f61780ce4caf22bcc3ddfc0625c319d912d8b4a4f79fcd2bece32fc899bf3b6f3fdc2d941f2c9a8e3bf9023d734de30a816cecad6876915930128da8012b79f35b4f4b459692fb1301ee505f60f8b1c32f7ee7982055b78bb4f3bfb708caefbeb15f606717dd6dab758a8f4b613d7995048005e22c7ea1a271eb02315cd6bf0fdf11b7670360adce0fbbf7fe71cf47f333e12827a546c263ab1e62e408c6a2f5c4061b2fb9c50206c60bc45a930cb2b5d8f890eae67fbfb6167e908e7f63bccb3974e924d2a65089d812770c17caf7f8892895814668bb1de49d18b8f51a4d1fcafacaace44c21479dd358e5c53c0e012c14bbfe5b7cb03d27c09d372f4a4a63fea25e380a9e794f0d90d1454b9757a600c43c0851be1fb0c68c9eec320f73b65de46706f6404f604b8d1bd8b4a28871b2465d9af26f35695dbd7dea67ffba8b5eab5af92c6ac4de014e01562e640dfece63ca3e8cde2eb2b67b041ddfb47086bd1e75e10a3531e9888fa414a51f63d21a0a78427545bd6e4769faaacc3a8aadea0345260f55bedabbbe8afd65ebd468dcbbca4fea021a31c9851a484f812790ff68e46455a7c6a5b9ca39288a8c01e186e48ad5ab8d328a832d6fd4a79fc976c2f03709242fa56030a681000460d7999ca905e25d2de3e5559f628acf50a69119374593ed8ffc077540a915fcdcf6f31bcf7fa2069431f5bc507728ec9fe4fb8c51a8bdbe991081c122ddcc0820ca0fdf0b3dc711dffc138c799cffed9267e12c5883163b5e607f42682b9676e9083a1e7a852915e2450b1c459ce2e679ecc23f73b786f362f3f9863a4d40fd8fd212252b6fc0419e229475d3bfe3efb04ceb24c0611560a5f9392d3fee494ac741f64d1c21114b112cee66c9319752e9a98da81e4fe5ef2281206d45d1a5d5f7f5760fc11286bd46137d0dc8c7be30ab62292f25f0998ae222303ebf2eb419729f4b62a884e0600362453de2cc6a39d77df4b51234b4cb3ac09a8f55fa84003598275a9d1ec1143c6108d3fe5de3bfa882aed5054590d22e10bc59e91fa0ecefbcfe76120e7a6b6b8b8a448336241b0fa2b9e3ad37170e07c371534d7eef6158fdc0a846b0bbb9eabe42007c9b948e8085b0b400c0713011cac838d95f63c1d3215b494b80f556c30163b647c1b2bcc8c7cd56c0a5f8ee061c00a201832d623080cc8ca10b732edc0ceb802fcfb2332c054583acfb255108ece22d64389910f78d4be9c4e2e5c8a08161794b6c9376700fa2cb4a8bce451518a52f2c1be4f3cc83d5da0eba782e47b3678b4939b00d48b421f4eda001d5b0609f563ad9d569a2f3f2b6517dfb345c343fd55b462c08c02440744748fbcd2eab66b949256014f6182b6a0e7f6c8dc6e09aec09c717992b43575a38349730f19453d955c5c06cc4e889b32edf30459497f24b0ed5d5a631b1feaec3f622c90d052bc7587bee0d448a2a776c9af5466b0830c7192a66ed50bac1b0cad81d3fa5ac18e040c876f3e245c87bcd03070ed0472c57fe3d1940af3514229f49d8dfdd57d953effbee5ae7984e719285b547d72e56b2b97c67f55d40f1fc2bb3098ca512861663d86c861b7948e2d8357e83a247d10bfeedd04bfdd732f14fbd62cc03fba9fb256ba3b7f375eafdaba03a12338017406e6c61eb470a2cae2ba7211b65ede20278630fa3e4b862dc591852c713f76363176dccc8b27ef7966d49e6b7fb7800991e603d652e9d78de1f4c192623601baa9237895c70251c47108bbe525552aadb81485336197b6033612c9c0985c8b519e0ecf33bd912caa9eca6c98472c4e21b6c1c958898ab94b9d30a579c8405e5f75876804da5b2533ecac7ce0b002477a478be476e5c0162239c7866d46c193057d835b64bb37a45cc3bdd39414909f252bcca0fa0f62ff687701828d7040c6c66b8a26eac2359d40b205aee5a2fc104d72ac0a570dc65cad803532d8e63887aa7b6f5b74e2979191250e81d04eb5b27988d7afab0c70ebc8edd7caae5293a807b1bcccb58909482cb9f7b90db080f8380794b3685e1ab3079d3cfbbd6a5a96e9d6dcdf0371bc045b4e1d30038887e1324ac6c3e2c20bd6f53120bb2e85f1b7a8f3e8fb9ba2290d8fcfe5e19c52aee8535148beae5b605310a212aa560f3865ac98df686b4d3cf8bf699a388a4cc82a20279b178a6cfe6893634bdfd9e89828ef40896a9ed6189ee69f5a8c85fc9d14e1dff29a6be1cdc4f53ae8298eff238cb95c8b5778c753f6aa9e34446e28868aee3afb8ee89366ebd24c6b1fc3f28381ac720b8e26fac5a51622a65647fd63b094a8c80602592b66b17dff12ae87677049ebfe02cbc7c22d2304863bb379ecf5ac2ca358078ab20f051b6678456723da1c163f2ac4371a2ebbc5fc2e28ecb468778a90fa0a3302c113eabd374e2c218efb06eba9ef81454509ad10e5932e0cfaecf9f34ef70d9c2aaf1fe3894e4ebe156127ad265b1350c79b0980ab367ce6ca2e23e56827d13da39a35b8cc25f95889c4a782bd99fb8f1d971939e950c8533939fb2a4b8edba063a6ddbaaa513a0679f2437c3cba5adae7096c45a9bc51a587b2e10b69b7433e424f0427f42ee77baa5b71ad8092acd95d2f1fc084ef86f76cb9ecf6314977ddded2e2c4ff51d21b01ef6f6df74c1198a9478762974ccd055f2b86fe7bccef889b0ed7ee347a8fdfacacbe64eb8f670414214bc1cf93f0dc26b644d88176b922b03926454c31fbe21382cb3bfabad89e83c9498cf4ccfb3b7b02aefaf40addbb88f6ceecb7e6cf638e128bdc1371933502ab65aab28985953e0835c84bbc97216ddf9d973b926e147a04699c057c327c29ce6ed505a7a820cdeddcf5a69adae0ad8ee7f88949d08f669ef422ace6fbedf2d3884a7ce1e28011d674d8106d8209d9e81324cb51fbd4cd0c816951a9301554df5d8a27636e1bd3e1562a68b20cfc9a83a1cb639cab07f0c4ca836debb3bd0214557ba60e56b7a8c4a780bce8d75e14309fe14d7306ceff079662cf03f095b3eac2c263b6a5fcbb4f2947adb72ad045698c4af0df2b90c24dba5720aa70f8d3b8fb645bbe52decd40b5ce2f3801988279dd41fcd2b5941601d1442d46825badbee9bdb18eedd7e99ac6e20c808909da88c34ceaee28a86039ff2c2400b94aad2ffe51590079d74859ec22e3a379678381b546aca5eca3b3ca90359bced0038787443220920881c1c4b82c55e4b4e6d0193097be19e8d0630236dd3e2f3f8f35679dec3fef2ce719fdf3ff16728250b3236d9e0b67451454ccb955a3b6ebad0f589fb8992ff58085952565e394939eeaa0510a38b1c9631ca5c7a85cac4939729d6bd8261f0dcb751254d412bef0d2f685063919928621c18e4015205752ff5db671526ceadfcf9896823eb1b6217ef28dae8905840fc5e97a85c6790cda2febb21fbec89c578694b6107744cc75dd4ea99e2af3b841c0e99dbd63dd222092bddb8fe0f2d6d4e460452ae59416120341aa3666189208be021f25ab6ea8c3f31edcf68bc4ae2c14fdd74b769c03d92958823eb2e7eb63211ace462bb649391ed58787cdd2844fcf32a4b303ace1f0d6de838fd96a5a5cd7c1721bef80ea21d19c9ee95a896dae84bbd6470b08216a237b672b117a21bb93293dc03edcccd4a59840fc6771caf87d336f99e4b2cf0efe162857a0851242f5b8e20a27820d4fe051c712a621bd6dcc380fcb6b4c44accda812fb46dd99913cad2c6b172a08b7ab1e58cd8952996018546a152f60b8ccce9693c75a2f5ada2ea79c0db9319f91abd4fb199495ac82e9e8297deb6b1bf92576d231db0b5bdf82e97baa06d1a44dc66c5b5224e011e2724c3cf8c9a3e96b64d61ef3ab15c13464f52c2b1876b35356a67a1015aa0330215a228a03de8a747dfb843713cfa304948a4b7ca2423a5c4a2364bf4f339ebfd5d8128f4d81c5bc49e30bfd8b857d03b67bddf2f5bafc0ac580f033c4048524f481848e288e89d798131313340b1935fed89f32e219bae9b6f3a565142f99ff7a25902a8b5094101d1af86978b61f683bf295c8aa88e4348cffc8e1c15f23a77f8352e43021f2fb0d640cfa1b1e50ab125fc4751d04306527c6a69cc579861dead765eeb84f438be564d451fcd897324a5c87d2fe00d97315c43714587888397135ba2e1483d0d4cf9babcf2b17fda885c7ed3af28449bba09fc424a9662a9b8b0491d701270a2b9443ff1ddb38867a2cafd99329ba5e0dd7d68d178d2bf4ca328c278c2e06736d367579c3a53bf83ec14292f2eddc9f9e51bb69bf5948ba595e631b48307063f458172b309499b66a16a7dc973a9312139e37e5800dda8603b46ea545dce29a216970b2198d0bb3a6e519f0fbcbb99e5ad7aec2ef33418c3c10696e4198c1b307bdcc85e7983a5cdfee10b0f561e4d000caa0713135b235d83e3cec2640cc0c4b767c4c2f805a81b9f6e95ab22477382ab07e6d597a023a78d6a31117076acf07435a83bec269aefa589eb92d5ede5b0900ed8723b4c6116b2873f039f14b3e937eb21f13856227a42670fcc22de441d0d0349d50aae04d108c504ac318100f4a054be7bb624f00cbd39a9e198732848954e6b0c3827d3db2f97f90d08cdf1b573af655fba555dad7185c6aa23951bb79b02430020313c19febeb8ebc7de7dc3a33cb3bf71b4b1744392cafdd938855bda354e15b615f8dd30f2b2484ebe93ca0b4e4084d328f85898e118bdcdfcfca620d6b717670008add4f00c4320e7d98277b8c266963e06554515907d6424e6952def7de403323df0f3c9deb930f906d9a766565fc8d61d21eb3e76a2102926141e85ed807655b2c365eaa084f05c0bf8922487f11d3fdce76c82d8fe39982b693257c7c4be153bda4d213d197e4e7df11762b375a0f820cf29e0d69ec4385a8c68bc6c473c2e6578ccb81ffb4d08ea271367ee6f8864b75d806e4c8f0183d8d1a4b7cd7204aa4385a1ee46f30ad806a8feef5308545755cdf690a746ec75038d6839ee953a308756e3877a02e898729d26dbbded08da007dd47041adbd2b032579f5ede94729d66a67032e63bd568776c4807e0aecb7bb1f8da07c8a021d0acfd4369fcc552d33a51b4b3b03714506b9df5aea7163ad8c3e03b22f86754e4a4cebd70286e9a072e1aabea8548c11746f811cc68016418fd796a9f7080830c08939a9813473fdfd1f56dbe40f3b50bff0a132002f21b48491d025dc7656b262245b21b8438c035294e717da6fdbf057d4706ca0b454a2c7e428f83b5c27c857fa31b68f2f0781ea1b360b8c83021af77a376ba01728d195a411a87d3cc2d7b74d3942092307c6f732825d9ccc792c4decb456e8571496c0142b2cdd7a7f6404904c9180910cb249afc2d847e2e3f38e4796107fb0029a466e70b2bf8ad2dd280f1d21e5279df583e7085437ed7e104cea73aeb91bb90a4ce2b6fd6e490c26c56843ddb09318303016ccb683ac07ece44641909cacd4c2ec853b921e8494288012029d9cf552613eabeeb25a82cbd3bbfaebf62e7d228a1c1ba1bb5ce0d125a94406619b52a75949a5fb190caecd0ca4bea8c79fcf113d9ac2dfd141ef80622915b27f885abbbfa9d8a610e7c6de3ea6c0c92aba1890da680077b990a2332b3110e496e47445f36f0df15affcd34c10ae267896df5ab0f6b97cde01008aae3268b7e84fb4b01040eea0cfa9afcbff313318b4a47c704ecc1c3a27fc147d56c78a6f9d2f75ac8e639a72ba4584cad304d53ce8e9524105ad6d59dfdd8b44c691312c993d5f23031d58fad6441bdce62df0ee99eda9fa58ce1ad002fc045398959e0ac4b862a388b7e51a56367289878b4eed331607c6243643f8e81308a9d605593ebb547c4d333b614c7e2209d8ebfab1bfc1e1bef8b136f785e8791d1f85fa9009f3c131bea50d4a69f92b3b7d01d7d5c64b1b4d46eca054654b15161784829543aa6d7d576f6fa53de2fad4d8158bac2c984361156db73a3fdbafba81c1d833b7e20f0e4b089c18d0bcbe2c142db6b71c78d3f42644c824c0458367ede108ec8285d40e1568762bba5444f69b193002441fb5a9d9867c3b2f19ae1462d91d2f31c9d7164769946a008fc6d3106616e987368f719b13dea8d2f534f14742f36d3e0cd4fdfdd63f1d571d45ab1904e9ec07a8ca88b35268f31b2efa4514ce8ca008f93adce80be5e7d562af4e7483624e14cad14ae64c1ef1cb099fa7916f137c64ecf74a06195916b7177ae7e78f75d695e8144995b6817b82ae5f10c29efb693356cc5eede0513950a784c6ff1e8787e2a92feee21c107befc9ecada06142af920a91f7c8b5c2514bf05c2ba89da99d330a5034068a4d8c279441f6d1c20711480222311c81954f3dd38d8ad6f206d40e27ea15d9475d7daf5965cf27c71304fb0e7dd682f05b62ac857458ceb8603e43c07ae2299b974060a67257d6b10b44c103db0594d3528d9e200b0c28b9c47a35a42b188ba25d1d7fbcc7fb33826fe5b70ebbaefbfe4157d682d90da541b9816d67c9da39c11965997bb02e5e33ee8eba12087dd88f07180c5774c18bfc0a70defe11cd7465a2c578119a0d9a29568c303a30729f19fc76d5b4862cf897c90088bcff02c43264610333ef4effca27af8521514217e7dbd7548f847a22108076771d7da490cf671b1ed43fc61de63d43edb2f7617669ec474caecc3cbfd5403adbec9b65d96869b9d8f1756a4aaf96981af2080a55fc99acfb665ae9750fc51b20315ce31faba77d34c847dc4a2e5392396582588f27d1b30a3781825d6425cba0fc46f2e2939cf5730a6cf502b41e1fc50ca6bf7cd5a05cdb7658049916ea9e564742249468965ffd446f3dc3f0a8248508a3aff6ffa6a50c8dcc2924adcb7fb07c6dceb9284f9d5bf551852a972559bcaafe3e92b4c0aee700168c673a3429964e1d4cba7d3160e6b5764a2010374a8831d7d5c3e25feb6936ac8366944be7af701e8cc7537c29bdc23874059402524fc99972e3fcd4d82c54dc6d802eace56272489a252141bfec0c6ad6d8662f70a4234ec6ff360151eced5fcf4906e1b316d2670dc34d629582f45d4a1cfd20fa9c081d03847bb570145d00629a120bcccb8c83840e4cf5a9d0d98e78a8cc9b8d5421958ccafad1c91d27b72b780dab4462d05fe58cececf2a695daf8371e35481192528ab8ccaa5b8b055ea86d6d7d8a93b76de311957664d14556216f3865bbea4c2ff39946ea308206981b44fa3068f6954a1d802d4e4dbba38b2963977cecc4ea613fbe0ff7635f79b41c7fd5f2d6fb167b1873d07c8946d24157a4c8b49704b40d9d8175e76bfcd5eb903667af43b401fa2ab9c2de2f3a987eb19a86356b5b7e349dee7be6c60d205d18ee0f2afd99c188ffe647a2391c5a62c0f2f60c538fcbbb3f626bebaf79ec5891186ca6c248c367c2f8778b15a2027b173a124c3da03380e3021b997b0d0ecbc05e9bd4e97bf572dca4976d1f14414ad53d110cefcc5833e02445d61001b00bfd0ae3904af5a906c00299cd2f95e4607adb95afc872da57cb1a39e855328f7a427e61fd9bbe7c07f859cfac67e662622481a1d0af4f09c6809aa39878973facea2b82ac51a04596bc7722aa6df4d8b7833145fc76752d5c7f2bced015bfb684e5ac909cd089596dd767758ef58c3ec7835992e78dbd0f91460a199eb3709044e59c4c9da7ce9d8051d475c9fe9c4b8d6f24ba44fd61701a4fc98b7850231412132babb3ef8c8feeb1e992848eca51890ed989578c8faeb9b384effa91e72c6251c6ece3a74db14c1cfef1b984ba40814b320546b4ebe3ecc03e39171d558eec2b2de91b93ed407c07941207c3e5fb289076883021d7640077e3ca0383ccfb1f1ae9005866b6e57d654e8d7928a017a0fc8bbd90cc523eb8f9da4a8cb0695fe8871e9ed741f52fbf73ae229c6f26343ae30d69d1f6d5aaa97db8cd03e0e83ca0637c1273ed9a09f91f5187cc374869399d0cf6eacc59602560be257ce9bd40747a78d3162a94515fd7c9edf590fbdc80e2441afd0d713075ec962a8758f13fa1647debd97caee14a96381d3b1f9bb68338a9190b5f9181ef307b8125250dade2d604aed83c7c9531ad846c30a72c5d285ed540090599a858c50fc0e3332ad31f451b84077ea8e4901658063a5c4832df52b41a7f33b543e9a57000852aba841c60c98cbbf4382535cc6d9d8b6b59ff17c86d669c054837d4accd4d0eda8eeed1fcba02a7d7a5758341c768bca4d80bf25b188b949af2aa876c4c1758b25c70598f68396cf982f425105cfd456526c6a30f352c8c52a3409d8995de7ebec364b4ea4ac470a66e7f96dcd5efd8f743c2bf845a819b4cf8f061c5d9c6ce9a01a4c9dcb6b5763bfd97eed8944def9d30c56e8a6f98eefc00e73167ca53e26b39814643f0eababd29f69000913e8035b6b97c37433c876ecaacc18a620b295924e3df3eaec52271ebc0a182ff1f334c5684cd06d8e7983cbd1d966a60f592c395574a3d078b21bdd001831887de841f7b543fef4e9cd7853560b01b679b64deb505f325bcbbf433def64ce41e6e079222a4524462f6c04bfedf6690fccbf985c32883cc67b39002877fc46290e03b37767f1cfb7057e588de0edfef9a707c8bb54c6e65aa266c7d050c7b9f19f0d8087d1fc206ee2c5a6a1dbea70ea223298b20f039367ca175fbe4d3109b5a59e2e5a808f16dc5e2f2b07a95c5a5ea8a2750cca1cd6e4bb4fb1b6f01a8358ca0385964d7d7b05adae0d8ef26d437b21f922f13f0a75eb786963791a691d665f48bcb8ac77bcee931b2080948263ff72451436dbd469f290c71dff7d95bf8de2e7234a210db1d4ad9683bab9e10e0dee1ae032b758d0f64e23beb7a64f37387ada00420e87f1c886bec89e21c758f72fd985350570c61c19023d465509da83a1f68e3beea3d341f158f51e887953504cab2c7d0ed1d7fee27a6afa06fbe19202484d1976ab0928b46bbc3fc9a4989ec6ad885c298d8670560892938bb1d74ffbb478d222dd3fe78fab92fa6b12d2a89e31bb5e701ac4c267b30d62e12272b2dfac72b7146f6b04019f336494ac20b19aba02440186d99875ab9174c9c87a991dd9b6879eb45b8b81cf976102275ef74760b5182a39b8086a622dabd83ae9ece52d6ea0e2fcdf9d6e2503cf2895b488a5481794047e63cb73e3cbd6d231f522bdc468a074bae5fac196d087d8880818bc3425b03e72d081c192f569b051b7ee50c4984cc117fa04034944c7ee03948331f39a975ea04937591cb0e4f8dd846d353acddeed6306a43e904c9d55beccdbd18699204b80a9802f737b124013a66ced5ba751032550ec53383d6c02a1fd26141bbc8c829e230e702eb119ac769d67ccf6a51c4e6a2c96cc941aa0555e078c8349feb417eceecb4cee7829634bcba9b94073f105490aad90ad0bf633216e4edaca3cfadf7d76829766815736d050948f7d9b89a6e3b57fa5595fb5f38a05a530970c9a1f8e63376134a8b84c8ac6b0dcf6ee92df354c95f1bc4bcd3f238d6e7dd8bda115d3829b92cde4c365952dcc817ee27d662e4dbe992dd57a927a5a69ca5c5e99b8e664721d7889c5fbd82796d896214b97310619f9efae7a10690de23aa24185085ddec79527e0100e8c563c21b0be00bb02fe521cb04e0a89c71e81f9043e34ea461b0e1562c0f55667a1688c9a65e94879e790a5ea73103550e0cb3bd58ee8d14aea4f13afe3763d2ef02725d398d167badc715644d5e857ab9aeeb7e2f01296bffdce61c6e6d88188c0a4b2fb08c416f12146a761deb26fc1e837ddf7c4261894c2c4bc9e140cba8bf2b8c7651cd6f4367ada21c3097a84fd22d33982502a46e0abee59562c6fa05cee56a6049a02ceb1e0eb006dac662d96f8540e4446595ce6473cd421fb0d177c9b3d490e457afee78fc439b1200df4d402045be17eb6e6bd22ebc0e6bf13fbb56dae160a85e5719d778cfcfd31daafdb80a3d65497ff55cd10354efcd5a73c429269e876fa43e0dcba96f3561cc55607e47caab6cac6943ae330d16718464de0e07c753f3139bd4bca017e793a60554bac7e1fbddbef7e20f77e8feb384efd5327deaf71f98c5dd24932bef28a03bd7b06a300ecb7ac2f1721215aac9f24d9d52f80ee2871e0154d8bce4c5bebb3df466d478784ce18fed4e0aad9918658a67e34779afafeaf00f0a035ffb38e7a0778f20b2144ad4210606ed87ecd10d4d1cb550948ad94cae44d3fc2ef089c789482c5d6522fc5ae3b8d53360e9402d71a906e1909a99d0ccab94b92a455b313be3399bc6d8763b9e08f2458930703228ef7ed0887ae1af19cde355ee96afcedacf36e51344f8bcd8ec621d91f573838b2f36c60319f713867235c8bad5b9548c1b57f5264ec9c1ee8df197a0c7a51f674dc0a452771974dd3654abd14534439417d32b0565b3ab3199ec278e3bf1dc00e7e7282fa6b9c50eae09a822446f1b50e1ac4d3e9f05d231c0c7043e799c7e823707af51222f03f8cf800bd7b0af79be2d6bffd54f61ff26e6e7636755a14e1ee425e825dcf31ee5803b6231ba37947f5d3e16bf35c8c8c6c7ce29b60ae08d9e13ea60bf1b67a4b077ed5765aad03c705aaeb661e01f233037a1608aa206716d90858a8d44d6d8a946507b01f9b5286534fc4b32ba02d7779e34f6cc6c94f1791c320ba358f76e6e7074f230986023e88aa0a0e8c4aef153f497d6e7f9b4c005800b324cd49066af972a3889c46dd706d0465366b831e696f735ffb01450e0c63ccdf4e6165455c3d11cef20f1b5f7e77376bb619569cdd8ef9f4fee1af789d765538b5f9d95a16998fa90d914d49618b34c2b6291fc1d54fedaa744490c1d32262b23cdb1d47c85a18507e5f813c41c05b659fdcd211d946c3096d08bf921b36ee980cc415da62d39d2f9385de71fce1dfac78c2dab4b184f986fc86009286ec6f81d536892d0ce7f6dffbcb288fc0eb690fcc8f6637b21c73fb7966158a5ac2fb2c95023f58614e3d1de7289003ec69296fde9bbe559c2f9057d41d1b080603b6c668b4f1ff8b868949cada7046899f549df52b60a4fc2be1c184e44bd62d46d3be39f06ad0ac77e59167ff4903d0b02fde15b517f083e69326ca4106d928e7696c6765cec71151472cf6358c9ff0fb4c5a7f9abd8e949aeb729b75d06c9bdb85efb70e69dd46aea752da831aef61492260cbab99159681a5b39ea60d12f3e112ccfe0c13933329b17a8579340c91ce2c1eda671c034de98748aa4caf06facf28dbef172308c99649dda61b26d1f18d33a04e374cfe09e7455fff08b06403b224530012897195d0dd07a5576d9b243e882856d22fe2c070d0522189b4155d4735e7f5fa3f6da142efc05280d5dc008b007ac81199b46045f0c2669956f5f7350c74ff036790e0a3459574b79279fab760cada40370f4270245d0e97dc24ffda5a559b243e65bb92b8e95554ada924840857727e3f7841be2f35cd0bc66f8912267c7a64003bef50c5aeb8188c023e1b2a97e8d7384cd746e26f5e61084972f3bbbbd2ad16279d3aea0c2441e1992b53b64e848f72dbdb70ae922dab1129300b4a31512cbe273d019d27ebdfc73511390a4e1001dbc095a6bf036b26d1d05a23e92e46ca1537821e86dd0a052636d401fa06db13b82a459bb3c50ca92c79f56ebe5bae43cab0223f303a94c2da9ad8bd85bdcf98e645b749c04bec762264659cf3ce6e9022be50aaa4edf92b85655d0bfbb8e1d988387e523bc824e471c6f01f97e66b322d1e84d6fc37204bb8b533cc0bf42de6e9ebd72993ca1ff645a3f82f5a52930643cf0186c73d8ba629cf43ce2b2e165eca568d97f53de2dc8c94d853c0b849c21ddc4a0e855f4145606f8bb1d665ad86933159391a1248d7300ae9bd8944eeefd25b7293e1343063c7daf80526b90c2f8775c3096b0a11869b5958e8ee4561c95ea358c487a770d802fc575b3d7ed0f95e9241f5ce220d8732cf58350801471509a90a8dd4f0096974c8a5c96ec8e8907b163d475d09c4ad5796ab6444f0ab5308b66ffc65a3081b0cea0129ac2fb55d1f5ee6d44a961bebe4693446237145a31b9d77d3eb1c123ea1b91b64169a74ed018dea587b7a083c09e14ad717eff7e9aae203acc650fbfcf0bf6d3dc58dca76bbedc078952499d72f2146d106456ae4fbc880445720be4899063864f02d5694a1ed4caaa896fdfebeb20c1e5c6af655f804c9e2ab2bfd9baa60420528c6d27da3a9a41f9bd2063f104c012f170f98aabf9503b74711a094ee1e6b8ddae195b3933ba81ffa2bb120858bf936573fc26d48b652e64ffcc6e5917be0992c34865bcd9de1d6462838a7229b3ee277a9351f4a9854f884add884fab3f39fc3704047f1947234a3b7a20585cbc7668d0854e534ad299d2672dd27bcd9c3d17a705c611dfd4acff8063b3cca9ca54e7f977994d972e769610ba2dd47bf9b0e3c17e8ee625f4ac1d0caec1a641be785609554eae7ce1796ec67d4b8454e592e84b57a54e4bd45ba2e84af4f00b762a4fc72abf4325d77f7fa56dc2d2e3928ef48e79ade87117527f3cdfa0f3801c1478c31cd80fe81e30407e572a46a48e338ae7ebe9a75712affc30be0fb92569ed9c4d89e00efa6cafa23d17f05b3468abcb1c573def6fd7c303a88f12332928de3cdffbecac199b2b4139160dbb7452336dba571ad74b6bbc5a47e2bb80eeed12c18241df6b43c766d2371b1704a934e6dace8fb0097164f8a563cb7c4296c25e778b8ac96f7625dfdd51858260981b000dea97bd340726c4a44cd1220bbb65fd7e4809048749a203893571c855cd6da2ef7c64747712d1f720070eb75e7c20a95c3f48007d580592eb79c7e2ff9d0519c309e8379fa25e4c73bafbe3a1a4ff88f396e5c040a475d42b3ceab85e77a14f0cfc57980fb35271b0745a2f18483f99b39ea67e547dae482b82ef58a6dbd867cd80fb2e32fcdc87ed95bcbff6dcd7c340975ea0a3bfcda2ea81aa44d35c86b6aeb175e71f2db0d09bd03e6598b5d4e2caa841ba307230f25b9101ae1316553a8c1e46432206fca567ce2e10689850b7ab230293333c7f6af4404e44bf8ea7fed1e9b520528611ea9e72dcd850fa7b41d8fb02d01d2fe21d3f3973b7d10e71364f26a20f489ba96dec0f91311058101646fe4d7a88d206313efffc543e84749e8564c8844b445f8e2ff788ceb8d2ac166a2ef07f84dddee63a20b3ee2e55adb63ec2bc9c1c3ebbed19470429b48055b1c908a744579a422d253f715ad34a51a7e70ce2e3c61d466190b4d411a21a0e627b56852578dc5770c14ef5ed662324b764cae3f7222f2033fc06e7e9752c2b0c9966bd946ee0d5cfc61cbb70d0fc6daf16e9a4fe78a13713023fe175edcf3b3ba0dda1619a176d9219683c46b4b4085370abce20d881d2185a7c5230a3240b3e6d6f208d2cc7ebb72980970ff019136bcc5389cf4bc9a3637d01d8866ed7fad005519cc04caf4c5644c5a2cf0f94e70c456068f765f8286423efce6536912ca21fce7965a01608c29d7e9c643546868916c6ef76e30450225db2f25456be02c52a58344d8d7b0df0e9851ae1b6a43d9c3c2d3e58216cf22b4666b385775cb25896719b9e8906e59be2316f31d5e7235b13bb02a82380a9b6d19724e77bee3aa912f6614d37b4f8fff2026770a0f24d0bf830c267a95d016a473692531ce767c27efd0e73349a786d9330c533915a25285e3f158cbf4a9da3d0984f0eaed020fd395f8e7cbdd9ba30ba5f1f8d5059af514abcf232c5b950c7b57aea068a18285494564919a3f38efc25b955e0dc50413c9c31d565b2264272ea98fb3826fc7504aa6e8f4264ddad6eafdc1e548933e13641e781f207aad24ceeaf3193b70be4966869efe3ffc28c7758ab0f94299a199c8f1896766f615a27e611227c4d6a515368e4cc84904090153c523dde04ce3c7af833b321734684323b913bff2547845ec192f5a0bcfa8f514fe469308dce21e0f8bcb06592569b01705afd997c369d9016bde9e19d8102c9e64da9d62c8d6ab822b734eccd486175f7552abe2fd4058d5e5a702d5acfee6e4c2c9d40823c96062a86ca3b14ae9f4ad1ee567290eba99c42ed115650cb8d2c72ba49ef08fac26567d4b76ff358acebc8cafd15329f9bc216ff514a2f20e410b49b2cb6d4822dc593280dc13904db2ed1803341a46e284810f806d9eb696ccfe31fe0f6ff6383339f986b74de34de0d62753871f00dc8082c31d413bd18d6ba7fa987edd9d31c267893a3533ec11036cd6acf6d67cd4960fb68c5efeaa49d4953bc870e65908dc2568e4f867c8a91b9cc5e15998d2edcc84056416db74e38f9eb1676eb65cf974a2a29420a74e36f622411367631789f91a0f14130af2718952bbce734128cbae968449f47b7ac0cb10d8ee218aa59d79bff02d0a2d296da4d27238a8d5393860bc1a1b7c16d96aa5b573cbcaa8ebfc7a5d554ae53e5136b2320c006fe6c6c08bafce77767392676c4d82b56a1688333aedb59e96586ddc8e3786839f5dbc3eb3d75b664725752d6437c5b8000054d8eaa758e708dc496b2a34cfc5e8ba86d007b07af1af54dcf1af087ad27fba7c2e6de01a83ea7a3bde22f9bac0eff4ce8b2d7441b37c6bfd01766c756f33e61472c9c510a13c48cc02aa25567ca6157c3abcf7ef5afa2bd30a560a9112aa92174fa739fb1700a7ab84b930ee1a564f34f472df171ff37de5857e64f716a1cc62e54d79d5bd4f412877c899a78f364d08ac8ef60f479e50c5d5a499d93e7ba3690f28f994458cd597d119c4a94b96bbf06d1c74fb490908a2087ac46e5b6974d815d4690f0d1c29f34f2afa256d83d64fb0021556ec6a31ef20feac5bf2e140259089958fcd138a8dafbd75cb3cd70f8040a8d6fa4a29d7ea89a86cdfdf8f330b3e4eeb1f1a0383726391590d5a18c1e281ed56c7ac07b55ffaddace7c3fca3b50d57ebb1109d96d62105d970be3e3860cd346e9d707a41800cc702a33bc23ecdf75128ce29d7de25f2c325982ad9a3a476c8d2f3166a2b8afea25dfab254f87bb18098a17d1fdef0697f9d573be563cf13932627e3767c3deecd93e5db81376e093a073edb8af08496168f362bcaca1ea9963d952fdb8ed617dc28a9c3f0de32a08ff0a9154d02c8ba39290b073fd7ade7cef6023a8c109d094fcfda548b4e56a151b7db9c51dd6992cf875b3e4c5ed48d05da5ea4272b9471914c85542cdca962848f5e020cd7f66a5df45140194607660860bbd4589847f100c5b9a66543c95961aa924bac65fed244ceb5a754fa7e396c410b6022709cd1c360640626b30529b3cbec8f93da873593caa837265b77cf5bbac510443dc51b4c50ba2e0d204fee6fcc120e3a4eecea295c024d2dca4edea390b8d7ae2b40aa65e22eec2cda6cbfbe4d16ae457b30936e490658cb40fd810db82ab12d963e43b0c75cdd961f65d966efc4ea18ecbd1b0ba0c8812709647eb6b773114ece27b08be559537c91f999a6226b82d6af356640943ecaaa6ddc76039546d63599d5c6a7f3cc498a4a9bdba7b08518df8a67c68319859b3ceeedac7d3bbad7ee728f9c156c6c1ac068baee5fda6f55843c18b29720bedb855934259c3480e42f1b2f8f2aa5c9276cf522df2c20b3356ff9a7bc117d06c24c17a2f34ab07371788f3cfcfd7a03dd82939fb535583c9e0499406d984fdfe27c9a4dd1ea8da3bd75a2569d0226e2f28b7eda94460d54b553b8497f5ebbd21e4c5d92858176a7c80ea8e7cbf704c14338a5dc7e4dc48637b40f7c08bb94cdd68e6b77ac40d40269b4a5e57a3c107018a28156ea99fa6f4fb5afdec4b0d2a313eb2e8deb95f1e65e7b7db9453cd55a9fb43eb0b99695d407fa9e1202ded3ede9ba954a966e47574bebaf795cd96f4006d819daa8c46f73af44a6ba15829d76223794162ac7dee46401b62a8164cc4520b61f93b65614eb7d697654791f19ef55014d76018aa39e34ece8c5875ca8eaba558b6c576550b65f93fdb1b9e6e3e332dc536116b1ff0651a051264c3324460c3ca560b241584c52a0ae30f1d07d453f8027943db94e01c400b3107ecf8c4dec8d7ac9caa7911b3228968313215fb5ea47da0c1b26fd381c21cb71d4a7d418ce0cbeb701814ed146060d2ff314df98e875695f1b24d4fd826e32162407837f5b65f3d5474ee1de45c74f400840192b8f1e0b71b231f0d7be5d21d993625acc2bfc9e347051ed431ea58f1db9910e182051b57780c81e5657a117313e3532198087ad7a2a70ecb51c4d9dd502f9f68d63eb8f846432ffeefc5063cfc3bd76001b0151c03cc6089185305c88edd78b36b5b921887031829e9f9585b09434c135d5380e2bd17ab7bf3aa7d8b44b656a0cdd5682f1acc90ea9e6ef29ea48e397d67a90bd5f314733fe643ad531134d5a997c06e45f48d5a44d83234c9b7ad3b8f11ed9b5cb2e1c3f3ed515e19aff0b933938586e589ea7b6210b63ecd22f0901a1254ce6a8a4d28ef5122ad98844da943e572d074f2d34841b7c44c5a4ebad28dbef9ccc1b71ec805c8439f6dc66f0e73dadac736ac465c4c94eabdf372f4d2d8306664d4cc4df02d1ca6194a572ff431e65ce3582063325116b97a17bb82f2bc1921c565c0b884b78d22c3b40a5bd99299786343ec29f3c4f673f18499bed2ca794e008c07bf0220bd975d60c109c1564b13ad20f892e3680f5fb8128867ba2083185c06fbf3c42ffe7c03971a256bc818861487d74fbc993e837be7001525b7b75730061b2ca3146200f7ef898ba116073bfea1d0a77c2f378288935648c00cc6964ec6f489ebb59c0619c648800eb0f611813bbfe5f3675cad293c7bdbf75fb5ca3eebd08668d826278c03c3a7e8c3afdf9778078f132c5387b5e4e9e9a53f9ff9c031093a06515a1f464b3004c16f2bbf6a32a4c7012fb565960f3385b6e79be6092b69513b365f6c67e9c07bbd66e48051eb281797f2906500ae291b9959924b382f4d947770d35e1a6e3b1fd3bca433b054d5ead2b6d867ac0ba61268321627b604a6503258ee9364114ee6508e847f5a618c32b4e054d09a6afc1420734998267dc5736a17eb989328b9cf27ab90dacf44dc86b0a4364d2f386b67b8cc878d8a5d344d7278eb20e525a44906bd79fa51ab5684c2ea0bc4cadee8491830f5cf3bcdfc3a0272bfb1b6b0240a501c7951eb0b2348365a29206003754f40eb5ea1ddc74cf51436911e3d7049f3a4ffc5d4e4ca6c5b84e312c8eab370661f9080fb033c2a17ddd011f54bc1a816fb7e48440bb0dcd141128e8d24509ddee0bcf98ebdf1351ab33d212f932602656382c6b20d007a16b3d234ce849026e368b274579208590a75ba3a506d51d829af09dbe39c9db5936f02e721118237c6c089052f7a20cfdc30779786b25275f07570dff8a4eb5b41bd2bfc6a5584b1ad1ff67de622b605fb92e6a8e3919a8c04e34110e0d87225e4a60c064d101bbc103952a10bf3b0bd82167f1f0dc8bbca9c92f918e82e1bf82c91a96de9ff2bd195a95d67e3c8edeb4eda10e68723e41fa6f86f59c3b0aca35b82e1b4f1b2123d1ceb3f42bd8be98a62b23283167895b8afd6508b24423e414c63c0dcf296212d2d50ba6b1d2c1f3cfb7825d0532d162038e03e6a566fd84a6530ae255628a4a72f8f2b14962d3f22c548efe7fc8d5f4ac8d4ce53bc09b28b2311698db06bf786666e8177dd0551f5c1e82f04a23879299067b9fc007de485bbf291eeb6ac969b8b43a7c005ccc0e73bf56e0f962d18dd62bd3e22927d3de1e9dc578aa349b924538678c586b39395b036daa6c5c68c7f74fef023c623d48bc1791c425b90454c4942b36e28ae61def623eea786a603de0b90ecb09210ba4610db1ff1024310c46de920d083ca6a6e9dfaa98694ebfbeeaab03f19d682d696c1fc5a6181c3dc7b0518a8d16361c868d61cb18b5f037231f65b8994fcf82a94da3230c889b0c3a46787e0860451ed8e743c1e6b49024bee67daae5dc1cfdccd84d70f7612c1ac74fece63336a325c5911ec0f5c0fdaf0eea90820747d405dd1b8f3f6f22da6b7186773164427e988b5a43b7b183dff08906175400c0fe8207a38e0165f251c21d50e680787e5d09f0b6f53bd56c1005157725396eaf6ff6d86e9acc43e842383923d6201fafdb793fd1d8059b3e1c0abc09abfea9d840fc2a0150a09a2d6250da0148690e01fd78d2b14048c496eb4c82e4b333edfc713b1f0a4b8eccb27db0e23dfffdb8ab15dff8d6de86e1cd6e3631152c870bb722669e53f49864b1f8a3dbcef256dd1e7dbe5722cc0ae8c867bfb5b5f04df71bfa163396030f7912e5f66fd43e600e1c6b96598f9c6056cf90bc1adc99ef1799d8057d1fbb9cc7af0d6f17791f374f4d5b8059752e52b84881f958815f9c5ab14dccc44771e77f7c0dde1aeebd93f70bcec4c70b4fa151bc958e671867cc463fda2dc4294174e604c6ee8ecbdee204fd2291b33a2ce5d3a70a4a86ec280e7de883afa27c506a7ebf86d2b8dc1fcdbcc0e218a28e5e458a27c7b32682d2582bc97743e640737cb972304dd698eab10da1b756c31537ac461b0c5ea13a12e59c4657b46f71e646f4c0b12e6f6976ab870d5b2233b129b388195998bed5df1a5133929327656978d97270c72e7eadb0f68e6c13d5f522ee895a4815da75959eed2f95fca504f9919ef8de91fdafc6b9e4f560c5a2cc209dece409e2f01f90be650481a797324ed53613c4c988481e71330e36e9a6f9813128ecc8d887d50bb853ff6763a329d391f4457e31a52ac75a54b2d36784446d5f3dd56d2aa5e707c72d70782b47b2c8634560d65f585769676b9a7a15e01f39bf42efd3cdf1a082b77f5326f5383c9b2b2bf30793699d539a9ec1866db3f7b847408a06c3183f8524b15f928eb779117d9a8f6adb228dd7798ad668632d6e0ed8988e8163afb0da382ca1f12e901b6edffd8e0300ee0c168876a13ff18dfe601214281b9f392712c18aa91d77c51ba6dc1491127960e837db56adc7216b184fbc824f9d73dd0635629f16e720c90609ebcb7381ac06804719d0f532196088a69ede6829a950529339eca0269f36fa339dd70d8d183b8eb6d6f4cb905a9eebef071b660e783f6275c689759f664517565ccc15f4d05355b9b2697c36b77e47532c9d669ceaded1a73c159707a3b9a778a9b4b4fcb89e6b5e930fea8ca872147c22900fdfa6145209f051100da23373e490a8f1150c74327acb468234d54da9f472aef25c5d342973d6bab6c20f00de8780300a6804ffd5ca25fab8b6e1972ccc0423a2d75fb05ae72ddbe59cbfad2d4d27c3858e5ec8a939ede2a653e499114771998e211918da06f552401c82d0be46523175b0480306fbc8f08873971d1bd96d979b04922ad4ac0b5beef0090746655b85d4084e0eb48e2f1e6879c85ab64f1938b48d3f850d0ffe55ac9ee1897bf0e7c92687b93d81a08c7e2791d7289bc3815e8ba44af634b282fed9ab00f5376a67c5549e9510a4c5f2c5c1cff707db065583fda00b5f902f8c4453f77c03d2856e9457aee7cb34a755f4b27abea36bfa77d543523d57a62cba9f6ebd792909123a49976ab79530176b30ec0ebd976124f4eb4eb74ba066d4b2ea05efeffdd2104931d8d79709aefff8b545138d7f5e279a8bbdb1654b4479d533c8b3b3c5cc9ace50d13ab549221f8e73a7fc85fb467fe20f0474c1eb45c3a9523443b4aaa08543dee1e7ade68d3119055d261960358027130a4680f0b06559c01f6c4d4fb81232a817d0bd04c7e55b86e95ef0b616eb5df3b83075c44114251a3d5cba02a2547905e76f8a9f93d071e3016e528a00a6548600ceb8ac9a8c65afd502ccb7b6826a1883413696c7e83d4f0daab85ff0c4bcb9cbea4a506fffb949bea5b055db83048c67d1081f2a8501e60474d1</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">æ‚¨å¥½ï¼Œè¿™é‡Œéœ€è¦å¯†ç ï¼Œå¦‚æœæƒ³æŸ¥çœ‹è¯·å’¨è¯¢åšä¸»ã€‚</span>      </label>    </div>  </div></div><script src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> é¡¹ç›®ç›¸å…³ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ–‡ä»¶åŒæ­¥ </tag>
            
            <tag> pyinotify </tag>
            
            <tag> watchdog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€ç§åŸºäº DRBD å®ç°çš„ ALUA è§£å†³æ–¹æ¡ˆ</title>
      <link href="blog/2020-07-22/alua-with-drbd/"/>
      <url>blog/2020-07-22/alua-with-drbd/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="æŠ±æ­‰, è¿™ä¸ªå¯†ç çœ‹ç€ä¸å¤ªå¯¹, è¯·å†è¯•è¯•ã€‚" data-whm="æŠ±æ­‰, è¿™ä¸ªæ–‡ç« ä¸èƒ½è¢«æ ¡éªŒ, ä¸è¿‡æ‚¨è¿˜æ˜¯èƒ½çœ‹çœ‹è§£å¯†åçš„å†…å®¹ã€‚">  <script id="hbeData" type="hbeData" data-hmacdigest="78b3d8c2431101ebe936281d7f3f3d25b6d65aee752a85bcb19bf2fab2fa2bae">b48514d55716e1a96c0f8f9b1f5ab687bc24b20bab4bf27a5424100432dc17499d87a6a657eb6d2669993aea908eff6edbc2ba82e80644a5a8337e90c5497d14dfeccf93a2a75123c4f3db79007d32843c6f72112270d3016d8a4fec7c6369bff9fbcced5d2710c1e3eb27cec86ff4f03fb94f4bad26fedaa7924f865d5cd203383c8e11be1c2c5b032d536a70896ca2fdd348ec6c9787e6ffd5849db2d7680f678cb151d66e039e1532b7f3beacc73989b93cfdfffb8873b3db537a0fdf866bbd6a5f7d1f3067fb4432216489969106386dc7eaee8beb9ca6800bbc7108bb27f4f4a1b298c840ab615eebb156b769e558f02c228f1a8672e78630944719e5c30c66b5393829e55738e44f59366da679f8d696eaa871252d4b19913304e54f218d6a0e195d4b4d25eb350a97b6e3846d568175e1e2e12b7401700c94b66813e3862300888c5893c681bfb734a226482ba84c4be3e36747f9af644218888fcffcc8167c504a503c317ef292ab6ba54c5f3ea29f717370b63b236ea36e162d52357179084fff6b642a74f25f5095fac8b85c086cb78a9149dc48047f06ef5c1613470db18fc95794681b424fa278d69605ba1a9610464b9a9747df11991f2583934a5218dd106fe8b46d1bc171460ecd946ebc456898d41680e2f395d3ee2310aa375d92a731f87ff39f30eb5febe459cd218e4b12e0dcd930268c9d864157f5f47e273b9409e01a80a0ba76de5c300f0700f12568092f0447bf39065775b372c6481eb79a27a7226ec458deb53bc8578140fc1beddeffc754a26f905e55ed8d020e6330fde3ea3c5543abf35a66e2aba143bc84b9c6bc55dd4c418e9bca8c2ae7c5b54ae43cdb6334bbb70c6f4ec51d8100b05f421fad77f56f5818bd7c56260c9fe9830c75c95aa3a03de50a1504e6d07c4be7feb3ec500d917f5f35072ad3b44401fbab3c32a08a23df34401940d3fd14ee58495eb8be565813ce548e9822476794fd321d7b850e997905ab720c4e98a1885a81b625adc9f9e881e179cf5ff2ae5e9833ecb06a478bbec6f02d5f3eb1653add3342c8098a07ead679232812b624f1f846d671a0b8772f56c629c5cc5966932de60ddb0c5220642e237f576607b6138450aa4d9423899a2ce8670459562f78a34ba13d5b90948d4614938a87822dfd5ed624adb8aef3205f387013d87a8d50bfb7c28151502cd82f04a3d4fbd1a48e857e66fe0a696dfaf73ffae9adfc5df9bdca6ac092ec7c511c5e73afadf1b3a0dd36d59a720263546eb2b43e913171bb7f7e1b9eecd8b81730cd6aed0e0e707d642a265ce628439211b017647f9356479b5b416ebb7e28bf280c550207cc713d275ee26a126d8d4ec3e78f2940d081bf09211623920050bc4da7fe16a283ed481451474f15dfcd48427d09c30f7dd2da539aca847de915743f0cb3fb4ebfef50971ee62d682f408c2b5187b890825cc810a16cbaa2d0fee4f16a39b8a475c51684b20ea648d7b9373b9be9550642424377bea8ec2bf7b329b3b8f1b57f0ba83a1e84b9259b9fdff153912f975c13bc726ca3cfba83734c5dccb66cdb575171b73400f213cffcd3455916309904ac45751bbd91450ee222b659704daf4bb9bb02cfb164671fc45be22b818a7f5632d5fbdb372c737bd16e1a1fb05041cdf08ca88dba7d1945d04a11a5b59254237ce302e0af8dec7643294e3f286dab50e903f1923b6b48f954680314e72983bb5a8717e1603268938aac1bc4fd2c7b2a187646948c5223e5b838bca2c5a969f32830fdfeaf402d2bedb6412246386c381e3eda8a00cbe80d7b8a7ce0d6f7b60671fea3a744a3595a2f50f7d4d326a01c68d7a5c9999cba495d6bf664391d52dafbd4a922d0a2984edbeae7d8a8cc4ff93f81e4700c32441aa2625eaf2b970eadece26cb3016b2f0b2132681346968a7df2f3d1d57e24f9827b833a8ac2befe5cd6d428e82ec1954652819601507705234e1063fce806dbfd5671fbd08a54259d7b23f289f728a2141ec8dc08da0fc9f36250cafbaa59e6108a84e07093edb41b042184e43ea90c0ed6da28a379790ccdaeb666016d6dfd072acebc0c510b2c23225dc09c1304867ed23506a8b6aaa95e9525113169ddd400a844d1f99a842faf78fb1434caef4ba031e69a075dc7f58e927a1a52696a9c909c4048b1d9a6a0ee7ee930c5fc5a5166acdfb5b2389dfb4788c802d8a969ae74b87b5c39c38460981c40b583395934d2083e4e2227391e1c75eaf72a3e36701d79023097a8255d51baaff81fc9100a0e5961a7600ca7e7f3c54c8d980d3a16dd24cbd1ad6e590e721e78beb0f22aef14689d563062346ec1858063d8a6d23cad9c0635f3feff0e2f6861611e50f8eae741a7cd91bac8e1607459f7bb1ac5256646d0b11656d996692368eeb7f9d7af76a23ecd72889f88707adb482c9e3a90a49a2d0286451101c6541ce5b09ec30557d0c31252303a80178381ce260ae274566a382452eb31026dbd771b2f99edd7f91ac09dacc32b202b448727823e0234236039684db49cc9759545019c8282848c1e924611211ba3f1da0aa75696721ff8157c6b69ef3064aac265edb31b5205e3707ca88c14d158be72e9664e2ea843beb5bb99377a053b908def34e42262f0706d0c7bc5fec394ed2ba666eaffab8bbd16c9323d319899408a66706e8cde71647ec499729861e432ea2548cd19ca7483721126bc6b045a17e4f9a1112ea366d065a7e4e489cdaa1ca80322d11069c47ab136cde0a33245e610c85270d0aa06e19af8c1863018be81cb7a28015b6574d47550713a7a6e1585e7adb8fbe5c90c507db76bb9cc6fad5e07c81fbd1812ec68a8b85c9e59c5f1bdd5b38f3d407c7b2a88e2bea473139d79c7415cbcf29f8bb7372b7feb50d2d4ca1d2367e80916c22d2871e6f91e237ef5f89f03855ca8d9c5f717538e6a462638a1939927782713da57518ceea471d1a7488c4692f1fe1865747df463ca24379649c76b9ecdb57b05cc79f747c5b1e0993551075d5d74b353fce85d2bfa7ce94b5b953f0d284f836575932f8ebc1a4ca60d2cfce930c67311b2e3e0a4196a6e6f391c3693c582a78036414b5da7064cd71eb7d20e1b8e4a745cd924db6a260b5930205f929963f3e3448b48dea1e63f0f57e59ead4c6491f2f59475043eb96b05836e2abbf108eb9b5abf8e7970e23d0c7fe0c80d22c105ecb1be567beebd215640c73ff259c1e51eed9a1a021907164b2e38781ead5647bd7cdc74d2a58cb02820c84a502fd48302437cd37b5bc9b12152a0902b5b3279f582a73e055a3587e37a5a126e1139f6aad5191947bf09798401d09358547c9469448a0eec470f210a47ae90b254c9922e1f1aa05c71447d4075bdaa004c82e8f4357e09a438cde6e9ae0e213c8a2bd8b4f84f3cb711bb568301c61566ec1fb54860e4aeeb4a0c66445b11e9d4e7e28d9231bf17d067ae60bf89a4d5217c1b7bc36ecd0fa5e027f68e040ed3946e95c75ba42a9d8efa155c64304f42bacacd9cffa1d9a04ff22e0003ade4ec30cd190cc6f4b8ca8d293a53af20e7236ec2521eb26e50a0cc93b885ea94c4150ebfc3cb66f36195800d44a766d0655d6aa74447328a9eb43fa5027998f6b11bfc670e6977e90d569242624d49c5baabd39845fb35939a01ffbdef1d693f7321f06477b45d2f2a7fc5e9ae71a82f39ac5450161a9369d71342276593df334e9d6f212ac0c69e892a24d06651a4115fa7c112f43fa142eeccacd6510281548ce074ddf9933d6afce824de060d30da00f56ff5dbae8ff1ba1ed838cfb995d5d1beb9e9fc02e0978dde3861b35a644a74305170088673683e2b6291ddee688239b55107fdc659640a78c7f11df17b8901c9c869ac56c0fc6afe46789a4daca6bc85efac6e5fe40a654c9a42ee931ed35568a39ba722554e51a60c764eb1d8047ebdb6ab634b429dc5ab55126b97a9e2888936478f58de273727a3213677bc9cdc7fcf7d70b1643fe21788219a83983e5dd1375e8ccd11d1c34a0f6032818679763dfead4222c42a9d548c521d26c1dfaf4a8daf2e87f436ee0ef01b1536ab03840e6740cbee025f5e177213518a80a576bd47b4c10d2112204d9c664677b34f9d08137660405b1cc017d66ebcd2ab125611926f3803475585bb2f9666e9ed8b20c261e76e992a708b68fa3be3c8841b9a6aa253b4a525a292bea897b5ed11d1b869f88aa42f9fefcbe143fb9e9a07b88b1eb3962c7c5480b26b90cdd0a60f189bd12728886f36e0c55f9c694654cf0809b48fac920c6af88b7b6e27f4962c4609ada65f19d82df13e57f96c61d6dd36a32782b2d5ecad7783268147d295dd5fcb629a630f007bd3115e78ee89be8f52803885d35fdf5de85908436b9a5bc2e245b6336d65967200b5e47b617f6cc3d47e127b6e649a8af4da6aa761d2f434276d891c6a7c78292a441552121a31a1ca6fdfa176c09bbff0878507d942bbedbf2a24b5b865b3eba242e529aaed366409412e55060dee04c2fe7b687ff3dda68fa9c09590aeec0d3d6ee970891a1c745f3422ebe3b890eadce5ed07efebb87d70c6c9ea60cbfabc5d1aa471a0058990cba1f1566b2807f525294dfad7731ae31fa7a95369c21d11be2f91c5925f9749b8e4140a2c1cd89330c84ddbcd132fb06171b91f6c69a1db86aada1ab28ddccf4f41f491c1a5da88baec6fe1fadf2ab3ed7c8bc179ee4276741760dd0519691907d8689acefd75e5d1c1771f030e5ce6ca54191de2cbbba0184c52284768c9002e7a2477706fc60bcdfd8ba5b680777fa54860e3350b9d054e895079ad7f965fad9135858d8a8a5ee1a1445422031e0b711658807ccc77fc533f2aa0a66e3a1470bdbc6589fbe583796ebc3e9186e1c2432d385e45ddc7e51ed2fad6c8419e77a992a7d2f461f6d9c1d630601830e61ac22893a9200e19b37e7d9788ab31c5184625b4ada5ba4a7806c01c4f49b12731cf5b41847b71c29edff6adf9003410cfc80414234b7f862bb820e1509d8ac2f322ecfb0644853601b76ab3b78b4bb95d72ffcc8e64039dbb7786d53733aad60907686750eb27e59b1d28e9c7136dbce37644d3e5c9ece1861186096beaaada94a28a8bed23f8ec3c50b6ddb17202534be0f05ab2e7aeaefb1711b538fabe4e385f4fd5b05dfbf2dc42b1fcc29b24d9d68ebc22c6b21e86276775ee630af0fde9e58eff003aca538d6663c71926ddb5be1cf2e43edbb889615ee56efdbebe831667e18ef059b00b5dcf8b08be22fc4c1b1ecf2775542798c137c3e0e39300bb4b2b0f13307c12a4ad7a2aaeab079be79f259435167dbfcaf35a3bafba529aa0567650d80156909e43361a22831f1bbe4a491f6f6ae60af54aa634622983b40637e906451c75209b93917597e4c9fc1a21126823fdcf99d4179a2dbe4b6d0e7d8215ab0baf8ca51c32c7b3185e7e722960b525efac754310ed4e8f61a4281e40ede7cc378c1c4631787fbd72c34ce698fc35c819a3bc50e97ce8efb094c9e0492fb536a65292e10a045c10004e936668d33b19f7ec64ea8a0c49abc964fa0f6975d53aa72079e39291e8dc8b42d260d52e6d1304fd9dc047ea2d8de4c7a946fd1758cae14bc5582693bcd53bb443bb1cd1b707bd15e9b3deff9681d8b298f8f5f52a6291c3f14873d9fa8e132408c23efdbdf8f2037734275082c4f1ef3dcbef0a4f8d08f2d95bb48cc8edcafc02f5ebeb98a8bc259da19ce0ae74f8f9f86f18d5806586f7419757626995b218c0198b8f2e1b4852a7b4a3bd60d4a70487848d5bcd8b28e2a18fa33093a6a042eea4c5fa692e993a0b34401d7f1edf89a8abee890c8ce245f32b11e6735fc648a6fd6c28d92ee49524b9cf7cb9446e02e649dd286401e4b3feb647b87c163de66d9dbc0544d7f1be89fc4e1887e086942f60544ab532f7671f9cb75c41a4f271331373d78662e7c36123982b6126e31fab81397719c8d3764c299da5f5f19a766d237579532ef87ad29db887b3ca3c5272ca1e2d8ad13e749a5b10c973a84ec588d56673a54d0284dcc6a83c8c77bb064cd446270fb0abad54213a3c0bb9c5d58b80596851e5743ef5f83e8fe6e77fe616c590f504859683cea9d396b38c90b4aa7f62508e05b8909e687fea689efa9c07d875b0480a4f308fbdc4a1e2dff9df72fe2ac605dafc2824d04c2574a1389b6d157052685ab880f88ae7da317f968de818eed9bd93b59b5b3345dc1e5e8370ea8256ebd904aad6ba97053b76916740395b6e39b0b0545cffeb74acc4107e6171d7e291069ac264910fa4509cbe5f5907bfd207b19ea1b1e5eebebe4a5aa97cc8271f54d53c098000068dc86b3514b484c9e4b49184b71a67abe1874f3f99069d8f65332eb398b4bc5dc20a08f24a5de20729b272717cd6e23646a42c2f8b0259c832072e1f1bd7162084aea1f5751a3f30037c9d578e8f0dd5c507e2ac7a6af9f0c2ae78c0f6a8dfe064eb26fb28019aa178fb88a9c1d8277e85262a39ad5b845b6b07e24e8c5b998b21832a61413d282a572e34d2e34621b6923dfee482301568c26b10d23058250f61d82b1bf2ae6c2e655b8671b0521d669daf2a0e3b1358c50202c45b258e36ce99d76e8e2241fc29fa73c28b4af99c017a3bf76b92bf808fdefdc73b165abbb909ef902f191748d60612346e8d97a1b52185d7720ada9541e9c7be901b8a23d22598c94359419b561150884dbe388d7a457fb144c0d7a1f24ee6269dd2e4f467fa6b567539eb4e4727a0f49ba970d3a81d6a0990cda006fc1c4b332609e0393a92a7e9f3c22bc9761ba4a0f39df7e665a924a3c72ae413c0228104ad8296d299e3d672256dfc11249c30e68b12cb894b189617a5c7e64f369089f9a14edf655aec8af3004f4da6f53bc56bcd27bdda8e3ffcd6035494855783dd14281cb076779570b331d79c42208cae71282bf80797ab1a2e43cc553469af305452f1fd6c526f230e8c1ab0c9279707a172acdd58c3cdeaa533d08f7ae11353e2d5e56a480201bd5944e66dc2d477a4f6ccc5d77d502686f94f5cf605b646d834d294106635b3fe52d1faac322c3efcfd3f7998fc5ad23bd9abc68a0e452af4a9b49c0153746f78f0dc2d3fd34ddc688962c9a7a9772b94eb6c6567dfa9414bb71659c898f3699d4fb9aeaf11738fce3df959da6aed4b7770e9a8efc989218de9df6a892ee826fa73a8b1fd2018bfa138d9382d6d2e86a18d33034456d89075d1f82d08d79912271d2c4d6572f383fe7dd297c980734cbc3ebc73a3fff0eb417e7c3856b1df9ff104c689603f20855e5280867a5d96370394bbd114808485982c517a1d8b32e2ac5596b9b84748d46e256d2f30167cf5ffddce649c094b3342c2bb868bccba3a9a004aedd76f5bac67b86ea9a55a9c15c5a103a3437b04863fc042ff330d49d563ebd6a25fa269614db86e7a837f865efa94e9ba7046b172672aa4730ad26904426d4fab1593e0678a134c0516e96f34493e0eb49c9e77113847d0eecc8b6c3ad8d3060ad4c5c4b25e24ffbb782284cb270fde33e8f9b9fe6ea3cbd230e5ca6578a01850d291a52e5f4ab7a6d275ffcd83340d1bff471b472799872ab74c12505dfed3fce225347020afee089fd3c7513d6e2df3df56649a2b48a0a89ccd7d2426bbf64e4138f87b768d97b5ec8f097b43759fa75493b3f91a1519335349ea02bd1d32c10bf414625f26f5663fed9082aa99a229667a877170ebdab08d18154a18f124bdc0afc467d0cc712288e1acdba6482ffb6d52d8ed314435b3e38edc0a5fadb803f6b07b74361db7f410257822d396b16a64a259c68fb563e6defacfb9d142fc1940ca99fa611ad9912769061f7407a18a813771db74f0fc3d8ec04ff573ab53a719189a7fd16397e55d96b1641aaf56eeeb461665ff3452f29d6d089cc6842d13deaacb97a4e319cd19f8a241381ea02a8ea0fc4da6340f8e73e876862bb5e05f4014cd31c569f4d6bc94288b9445953de26602f2621ffa1747a13ccb9f1a84e6a20f7edb1e4fca37d1f7d63abe8ae5e9bd676d542d66dad4b0e924753447ab2a727c3010d02c12afbd20ef8adeb3c786690a996dd6a92bbe55e852680ec1e13583849a6ea3d65aec4c6f5850452b56a8b928a501a030e53c6c827e2ffc6dbbb4bd4e7b066a80961d33cc00ee556c95c3b8d9cba90c3e669d0f0be611e20a78aa4a26e6bd0c01572412c4997ef03980aba7b64fe975ae94822a09f468325df06559b348c1ee7eacd648c60330767c1fa2a7cb85180b8b704b54e77e408ff99f57502c462e64f5f5bc6841274fcf243b8d7135e1857c521e546e5999c9e277b27e904aff11acf6721f06647b68bb91ca53e070a120641fd566f89499bcc170ae7fda4444632a2a3aaf66917e038e8f79ed9a3821b7312d26df932379146696923798797a65687dca94c72287b0bd977e489de7ceecb7a830cd47a92e3358231b3afd3ce747dee2838bf66b306764f6d5d39ada299e4f2c6b1b8a42d18eadcb549357686b11354d95974ec679120b04ede73f1ddf95da55c9f513ead5adb0de4c89dd62a0c95ebc13691c8a22f0ec7efe4dd56e5d1028e2c9d38a8a83e13d041e16ea2a689875e6aa40e310ab7b73596d28f0c61b7be72a552f99e8d43033bef2c384d8c91864dbc1f7dabcfa49ac655719fe302b35df48b160ab3b52e765dd999d10a22865bfd1c621c9a9c8c0e1ead72725ad42ef2b49863a67e80c263def4e54b93fb47ad2c5eaea3c3bc9176007b1f5ee42a559ef216605871718bb509037b1c8d8bd4a59b0c0a036fe13316a1656c662cc1cc66de00e00ee6ca1d8eec4df1200cfb086c087895f0efa766e659627809f7f51513afa1b6e33f93cb5c72944d0ee2d84c4720fdb340535ff7fabaf121457e0546c518fde47f59f07572d2f94ae6074ab04dba424f16f85a32c4ce87834eecb3c287765a4a7548ef3e852bce26ff6bf0874b9d125bfce915cdac45594312a0e985be91e8a5c92984bbdfbef670e52a824bafc4dc5293ca0ebc492f35c1b120e332ff2fbd218e8d65912a0dff2b9ecf1be873062d01b6b5c66ee2023d3fd5a10c695bd75457f0390f067b5bef638a93d4be301376f206c4037d160fa810947596b13dcfab24d485c6b3b3df289f4b5c083955ccc1e6ce28bb28d919375f03b6101a83cf6ea006c307f3629777ff01e5c0531b1f30b15e259e451b35ce358f68feba19407700ec3a111c109f135ff5d2ae872d3988c778c21cb863f2d17aeceedf046dcd0f70412813ff93fea574384a572d57612a9b975200741eaed0849dade020d66308639ca074918c8c410ddb6f2532a293af2340324c258e2464bd88d2d542e515bd1456ade937043bc7b45374774bd703020c837e57bd19986a519516a3c91c527f5373ed2f5ca628f0b0fe277172783e45fdf19375514e0d821c6ed855d4ee25124e32e7b396cc6960dfbba109417ce3937cbd2bc1cf98abefc106db1632c6ea30e0f9091512d8efd20eefb467e1c7f5109f52ed2349b79d4777ee420663a1eedd01c3c46bd588088b70d597cc13bbd1af3664f86f2fecc77d892173468e1e86a915e5601f4354b041dbc7121c46f0eeb406c41aa7dcc74d01b8553a6797061f0090e7658e07d423369a0e5eedec078674a6bf97ca36015c40df4906e0f1b9edb7b274c78992869f5e5a297ad8dfeb74f471ec25efef712893835e94768cad210fc625b55ff7dd4e0cd84e5a9af25689fa04645d67366978578e6521c7035ff8a749ff2d56b2080586d78eed8996aa46b2b3bc2be4cc3bd80aacfe5d9e286b49453ada3f698a82284c4ab7c11eaf1c15cb18e9d495a7dc881dc5b9ebdb868edb4d723bf8fcf59c095afc1285805a6f461d7292213389127e2895bf178701559d08b01a11f15ff8596c56cbe2f8164ddc816679d8f368d9126673ec816d496c1c5c893bd1c53d2a5e078703ab9c39011ebbe6598acc1d2b6d04935c97c5fc42b7f21db1f41ca3b7150662a05571be84e3504f3fb66ee06090040068ab94ddb66faf8a8c0bac3ccd362ca573d3f4046e7754d8b02a8a297c32ecfa49b9ab69f28944e37845218eed4f597640807fb0ccb7865fb7be0bff96878411332f73e5e5b1508a51b1733b1e9f2ff972264471034eaee09276e1a930bf76c1f3dc937db178454c0d4726a9ac7b18dc0537aa7e489d2ce5ba0b5b15e4f6529bbfd38921b2673adca87c2e296440004958a7edde135f2955cd3fa7d10317699abd799e77e63eddd8f98b72cc31df8cc50ab41855f06eb5b66e88181eab33d3f83ca73442e1a42e8397021cd2f105fa64f316530f4bdeb63614d2e417684d83c36dad97ce580909cd0aa4ab9f4b8aae53070db7576fe67bce1f123e48d7cb3ceaed80c895bb5e8841bb3d3749e5c0f7dd6bc64f4498cfaea5e5d90e9192a5326828de41f79646d4b8f67d99cbd389292f79cb516b8bc277c135bc2a5cc7090abedea1433cebcc38a21572518a813dde3fc74d1eb13d5ae3b5592e8b3d2167a35a5c65943dbe4c529128af3b7a74cdbe8a8961f7751945089f0df52ce4cba692fbc9cfa4b34ac72f3b1dfcb666c14921aa0e42fc0b53a5d5f6347d6eafa79c914acffdf4685f0c9ba2fa0b8dfcad3bbe4f1fe342342c0911237353c8ba343f6e188e01370b088c93bb8babd7d1e19cb14aa78b01daee095a4ff5faacdb27fba30706353828f1df1a95bd75d2f30fe1498ac17b8333076500b388114b109667238679f081e14ef95bc938dce6bcfbe3be18599d1caba2b57dba0f3dde149d2001f93a01c74172c0955928c3534157511330f4fbdd8a1be6fef104ea706bd93d994dd835532fa3597c42aa637c5c0ed5b72ead0818ca3968cb0659b2023d9425a08efbd143229c32508be25696f3c5624e7449bb919bfbb03ada3cb44c80a6a2ae2aeebfcf25028986dbb16f20a9404dd1fa9d79d813e0c25a51c0dfb61b7c1a00eee8309711dd15319c717784038128c653477b8907982441e7b90571dbe56a942569555ca7f9e161cf24800005f867034626be562ac4b3dcd836a164fc8bd3b34e78f9d53861164d1c383be3076e7d740a1a204eb11018f81e50f043a21a4b5870debfb8fdc85c43087496da423953ed5603fd24e8528e63aa2c0eee3f384f622c54ca6ce46f7061d36d3b78009895ced8620e121c474784dc105fe22da84730988db84e12f9af5b13adf1ab77b860e1a5fa30b9d2394fab6c01c90e5f75ac49190bd914db5e233b0b7ab6caf0e4924791e270529c96f2fdd9ebfa47fd3bf0fde5976446946322be025f10448038922030acbaaa85636a5825f5a1be71d22917a8e6fcf8d5832c10fffab9e6bf14f9f0c96c2d5cbde769e04908fcb850ab8cd7030308626e04fba5ceea0efa639d3c464acde21a095250a2d6b9f55e5a71745bf0aa5c9d370f79f1bb25d6e036ee1cff4b4757d8b7ddc48d61848ded340e28db5218ca5ac94dac56fdb216834bc677bfde14e114009a2c1598065c8c4b3dd109f63a23728ebfad2ff3ca3883c222708871eff398e22b5751b17645e377341aa0b0eaef11d346bea92d524ecd5a2eb3c02e33eaa6b7dc3237d861213028845adbaebf00a8862d4d1518d092bcd754bdadf3c779d1ddb292dfe95d4751bf8cf987e4568b7c5ef02f7d8f2505c4b66a8295f187e397820b080489a6220fc67c0017ed4e3e78938bc923f012e8f3de71d889322fda1591c994a12c455604dbf7ce3cda987d1509bc071476ac4b5fb3e58b34fa45c6e863ea317dc672dad39ab93bc2375c7404375420be2669b5bc4843b46b26255c4d20462d921035be04dd508cbef3430d81643cb50ad9f467c9f479c88dba1b62690b276a9e2309f60101d81a7da6b614592a0ca7cd85bef80cc8b2663563c0d2874f66a01f89f3060f499d8546d7fba77f3dd4a3cc9b0830374c1261feca265f555803ea213496d70cbbcab613b1dd3c7ff37cc4d42cd192a239454e1e6a257e6de0d1bd6046c0f84b362d0b4f5fb26be5b738dac2d8eabdbde3263f70db7ae29699bd85e0bbee5b8624d5858000a54577aa13460429780bc0a10c37d10d5568c79b8e008b983a0eae0be76fd16ba8b874f9941e069487c4c4e715fd61bf8a7d65ca9f961f2b228b4321d5add1c9786ad6b0baac654614d904a1614d0ae7412587de4cf3baa6e5a3f9953c5f2fd8a200bd6a6887adf28f14d622182daa6998144cd2254f0522e81c8544d576f4866eba4c81661fb4eaa679dac0f3624fdbde7bb448c79707afeca27a5d5738c181731e65067b35470ab505acefd72f1ba6409c838d8e4680be97b28b4c0867747e0e85a2db58e3784d815b02e8bd1010ae9459feb9b6b0cfb76128180a0525e994bde8c4aaaa928ecca27832a993863a55fe5001116e612ad24c20e11e77e704847a3ca848b7c21e3a113888ab02b545b33b65367f6a97ece314419f72f389332585be2949bdb77aaf9d6e4042eb57d097945babe0212cfb20104cafa07e02bb7425a3b21f51bf5cebffa37c03ddfa7c0922fe3d86a25bac8f056e604857e10846c966b9a71c4678363ed6576ccdc0651565057afd87cca6faf2d65adec36e34216e43c02c6e4bf9b5a9436c75157f4bdecec0a88655768f1e98ef48cf92e0a210c7fac10ef3ef0be48c8d1b69a8d8c94e64859d00fb2f6112ebe939995c2caab4e10083e4cb291394cd1843fa88da39836a62f7f2bb4e749d91181e46b5d4b2de88c4906673d3db7ef38c0f66be8b908b0d3638dae89322a5a930118d15589f92a6c5be65d1debb8234e0f2a7ef7c9b35642546f8722c72e98b486c3efa4e89f318e16156a40ccbaa1df51eb0a8fe23edcff1bf181aaf24380f78d32c109875634241bc507f7f3688729cbf8f56067ee791ebe0d087091f0d3c99c611ac1ce53c537d292444b8acdf699bff5a09a00ebb304d3d10cc4435ad5ea98ec7c3acc4a8590966c316433988da9b132bd6a2071e75563b6e754dea409c5abce0e821a6a8af347c814a962ce52b2c7ca97604a90fa8a3d32ef6a7f4b0fcca48715f7fe9a7c8e646cf437cbc4964a8b662e67f551a4604c0ba5ab5fa3beb0c36f2b27598bfcd1c0e38d1c5d914a26773cbce449c15b88fde52bceb4cd167aa0de3e80d14bb3ed6b4ab14835dcce697789b3d9a55537a04e76a873184d91f1dd1c2f00ce75ce831068127f81a3abbfcaf0b20675b575a5c2967fa610a3ed9831aea7ce7b2a6accfd7b916a0eb27a4d737cca34e9e9a052644cd65cae809317dd7b82c2428598b533f44034ee01c526facb6d29b942417089ff37b244eb4a7d5058f213dd396524245398c53225ed1928183d2ee9ae772f8c349bce2bbfafe4bc19822be7062f6493febaf6e39a9205120b3be3ba8d6033a9b2ce3b55243f6de053ba0034c050aa030d7e230983b1093201bf07138c32c86ff6118f007ae8deded5ec7128f5be95380574dfdaa5810be9917308a20be4ebd058e8578e4265307a19e930c7d1fadd0fe410f345ef5dfd45e8acb57fa49fddb9bfd5b69feb960b385ffe8a0738927975fecf7d4c3f941066e4f41d8e8cc7fe7e5d5624a0360cd5974b7cd400215dcf100b8176835f220c2497f9bb6f133f766bcf7e5850782303112d49a53da9593ef980a220c1ad15380b83965cd85e4621769a24f2616b2af5666305ee8b0860e5dbb623b02c192fdbbf093e06cd197016da7f476fc12929345db65bb283daf11a223bbb88cac8601e1997f2a78609053011d8b7d43900c5e216ba23fd35fd85dd7611e2accde971fda0fdb2718defe3a12bf959b797345533bb809638ea3563766f4d89e6782f373c8f5a2eebfc698e7d747e3e82d09771f49143bce892972236d7e8add8e8afc8801927c401e00a375e446ed91b11bc3dc9307e0252fe86578b057624d2bcd1d60436b7113cb1bd99a1289fc0aa6070772607ca37054e4e93c25d8a6ec64e4a6663aab0741f22b8cf1100eca2e6c0c93c4d0c3dee2440d0a16c9dd7f8e289d55f739aed4f7e0d45a49311f10eb9003e8a43f45670de5bd6d777ae3fb55ab5625b571164d4adcc9b4733f2b95db319a6e55f933ac752cff7026cfaf0ab25f9d941b50f8e41169c59dda2cabfe32667304ffdfdeec18943cf59bb2b41972c08e23f34d352cddf34aa41280a1a46a626dc65c42a9e12a5d683d4c88d76f757ddd8f38990300c1a1a2464f8a55ff6e8527337674fb78abbb9304ba8423d8f0198ed61a8b62bfdd23e9df3c2c37944bd685f88fe87b16689ea060f85b4805cbaa8d78014c00de992c74feee74838d5fdb603f32756d9706a178f5299c43237f740904418e91e63ee0fcd39696ae183648e3ff5a80f41da05646737b0130d74fbb38a6562eb2f7e06fb7f9afce2239277f68ab9d2f8a5a529a730899d283fd9bcb369f7f03d9fc9dfa8011619426c74ec97951d4195f226624d2e020b4e1ba3cf6044e54cf232c36b2636e7c8f77ad7317dc0ebed2c21a656a5a6c7dfab306c7c4a28990ae597d30c07906b9876571aa986a274c1ce2d11acdf36e3b0ea022e987b02bdd603e230cd76ba38e6cc229d96e1bf95ebd4ddf06a734bb04bd497edc42bbaff95e14e110554da163af1c4cc7765d178bcf2a4db18926cdd3fd60dca5fd145a280de234cc92f4afb1661b57c61dbcee69937acdad75238a1876e533adc2622a28934529a1f4d1cd20d0530c2207b8da644d4aa2d08b628316731684c33b0aaf27f2c51ba209bf4b62953d8f08cb9fe17d770c756cef1e8319c91b091a7e34823f74f4f9a5fc8e05c539f69260cb23dcbddec4ff80e627370ebf2ae47406843b4c23bbeff974bb1c196689074ccb23c5a383f3b1539dc6e65f4471bc58d75109c02e50073d419ce108cc9002ff6b6dff37fd4514d5dd870eb5750ab4bd13d0e4ff479476010f25fef0d3027fdd0e98916b4c36bb167b8f25efc3f5da48227bd835e1f88b9b8ce818e62abc7cfa3692ec70cc87b38b96b27c1902beb47b67045c48a71e3d8d72b7ec8199817342c09152fab364c48a72ba33ecc8d90a5db833e27bf24e09c055f513662c402ed6ea97bbaf3f720fdb724f080e15137eea3ba11699f03841a37c8a8adaa98f172f724c28d0f7b8a615e8854c16d8e92e7a3796eb721461fd4fe37ab9f311958d79d76405dd7be6be0db7d597060b5d9de2cae735c02e34e11ee8dfad7aaad6cee0b25dba227dbe7b9fbd3ac80b870b56eb67a6a78a9ffe901ed5690119693ae255e54c53026a4f4510926686f188c3ad68212dc4baa9a515a011e93cc1fce624c607427336269e6527ab7541af2ce26c149708d9ab2c80df4cc39560fceb21372725009bda63b3762a418b14c16f392c2e3e26fa02ef3be7cef7c90e42abd91b9c20deea5fd431882094ac4e8e0ea57a0519959b6bb4f5759e3d4d88389e6d9106fe133a123b648bcdb302ddfd6fafdc2e6cdf91126ee31d2052615acb05ec0a75728b5d884f7cbf686f12cf8bba7ae9ace9c32fa4b31be504dfca11a3057481fb32b41578c467b80d753ed8f9afed9a4ebe86f6e250ea070d91f5f93aaf78321cb141b44001077a439eca5994eff3c29483a7e93391bb8b57d8f75079c44cd7ebdb29c0d03d4b6d6610d54befafc7d3fc3e3b84a98472506e49940d7a47a766a8382bbe1b36aff8c869f4a0aa1b5bf28b6d2a28221498b983a7d89f3d053f0ad803abead0f93179e5357681718a5c8ed50759ee5b0d9053de7c9dcb81b9b4a835653cc279bf66097e8060eecb17f18274a27ce4d8fa2f7a97aa7ae4a48ee804867719bc382621a7073e0b564b29c5024a6280f021ddef84b8e5fdbe17dc94d4f00ab606ce375d90643dc378f48266bf6eaefa1ce25cdc8dd221eac116bf54f467aecf86900d6ad8d8ba6eadce857812b0c3f587ea633299c922eb8ee6b03a23e3cdf4450cc31ae8191c7a4069c8fc589153a7c27960945f4fe0e5a908a39c23d78f3452b61cc1c927a0295d42e4aee58e801225b5dfc1960248d7debc1f17a990065834824c5d8d2ae152246fc0f407af28a3ed58a11f3fadc94c60af3e658c7a93edec4cbcd35ce89c1905991c3c1b9d2019c7daf8a5078f46ea4211ffd964d248423c75db0efe29e13f16c1f629cf78da9a8665ba24158f857864f798a6ff2bff5c95e764decd42e70c7b1609cabb0ddc7996f5a3c525ce13f6249fe6fa6c1a0908c2e480cb192a32236f4ae896135d3e4c28376140106cc9861cf9d527043b0361353e3cff1a4eafc790759efd660dd0269bdc401378f24e6576e0387af6972ef256eb9453897eb1b0179c61c5ce0c955e43abc7d04ec714c4f985831b8e27d36a77147fae125f5b58b45bfda67adfa8f48d176c9099acdb7338d691f4338357e979e86a0374bd13a0f10c03a4410a6621adaab774b866bf67b3b7b8017fd8b89d86f65bacac04dce5a75eef1a0d0b1d3482ce4324a10bfb6fa5ae65dd7bff63e3754109ab34bfe19010cd2869ee9d40e046b5f3fd7546bb19f55fe4a44468b677bdf469670ed2840156d3d19f95fc114236aca9e4d74dac739b996497282d7aaeb589df1382982bbb0a0b55dbff57169c067775deaeffbb90cbacc952e73166255cdc5dcc4e698f30ba089e18ac083f3ed829c2f970ae46ed1690fd9d8963eaebf8b2bd314dd14dce8dc2afd2c3ce2094291f473fa3906d5f1a3fff39c248eb9fd1363ab7ca593c54aab107dbaaf9300184fb7758eb1ad70b81300733db0c77f10eddd2ce9d20060a51c51bf73487da894a3dc39b11f76a18afa4165790de73e71f54696fc6cbdc54dc24bdcf03fad89abc71632ff8fe0e7ea39adf3aea19783641ec2a536eecb56b1d2fac3690e5b33d86659d9f935fb4706c174bcb65d35dd639a72d6d4cb102d80e66b3eb9092b4e225a73ce5b9f34fec4eb0a2e8d5f88966a1b3c6376f494f934c1aa30c79cdd7b738f74dd654e09a22d59a69a26cc3699c3dd51643ad04e614946d4c027668425936b8e186e6ee163baf682842c6d241954f4bf2f7e56c7c0e60f2b235bdda8e7ba731bb569fc20ab9f6427052b1aa0346d7e50be067d5b6811948b7c33cf2c9574e40f84dd4971c7a1cf253970969bab0a38c3c90facd381f9be09a7eee276388ba19fda918ae11be4c1484b28585bccfe85507fc900bfefb035ec9c3c0d0bef2f66885ce985966a1b21460088a9dfcab0a9e3ba5406fb54e80f08e39b27c2306361a2f91b3ed28fcbeb30e5be2cd62575f9471e10465f67967b2cb0e984d3186dd8b68a7b4f7b741a3697c97dfaf6ceeafd918e992de3cff91a95951a4fd3f99511780299a360cf8b68422e2ca2e7f8f1e46a8956298d22fd1d56676fbc21a8cfe55559f2a62cf06371d5f1bd7f8aed57eeaec5f72387be419e1fd150b42bba4e947ae45982204d1cf0a14d717adcd3cc72a5a112bb2d01e85257b0bc0d974e1886fb0325203fe5d2c12304122da0a149481c0cdfa5ee9a32aa088922d0b98c75050707a748d36a4b8f84e5c6f9096a0e7fcba06b73df5efa9ccef2c05114ad0cc4448efb2a1f53117fa13aa0e686c7845998bf34735ca5e0faa7a23a8352d8f9e417fc0a957f6903d1d659eea2352eed0a181d612dfd0e54b2b7c93edbb0c5534164c82708c1404192fd0865e6c699c9eb2cf4f2706f3ae484f2599135b247f4a193497697b4baccb6d5593886c147c2c922f911d19f98b0791e5d4076ef761d0de288a9689067707dbdcd75676356dde86d3fdf4c283f109dc55d8898b45f197e0da63a34aa5d659d425ff8536c1acd0f71e429c3b9eaf9201cc05bac3efcdc0fc6c8fd782d6f901dc9055e82cc55feb4b03e94a8a550db3efecc32fd8906f98bc583905ba765a21b58e53b4c366a6bfe662aeee1626f1cf3fd7f539390895a25cfc0fe46a92db9231f7fbda43db496ddfa9a992757acb1272ee950ee10750dc10a7792ffe7072e8ef961bb8274afa36194a2e1c86a448548652c48428ce7ce0e2db946d915a5371b91e22879faad2db877cbbe55737998669e1eca4c3d38ea5315fe5dbed80cb26b06a9a7c52fb3738c3b5b6c10e9c3a2e3203fb78ad2b42319e3c4e01affd02de7e0c8900ae5213b9c27aebdb8f516f6afba50c2126e286332b1de0b1eb48da331d8289a66e4949d9a10059797e7e1851823f6f2c9e283959197fd56576a3480493fb2e66fcc263c061f732b0270e3b75640e30db179f7eeb005eebfb0f006e35dea672f406d5758451bf21821cf721b304115ecf029252f95eb6359897a46c3c10542f61c674c010f42d849c187b64d947b9bbfce058bb39cbacd935085fd095379a2c9bba5b016937a53d298ac95998eef49b106ec16aaca70e72fd246a3c78224f070240d7b9ad53f5d3ab563871de8a52515c8a075edd4e831a111d9171fc68bc5dc1edcd389829093b0783910d50ade613a6c975ade6d63674e8091079c227fab45268b4f0bac970f722efb70b3536cf2d3fc5f0c66cc9ea5a8b3ff743034a7ca3a01fb6c92733d1ca740f321c62dbe13345970a196aee35aafdd2c18c3ff1102a1e73e809a1b1bdb328febc01bef0d7f19ce287694502ff77ed06c2e3a4b414ff93503b2086cf46e5211f7152b9e3741b7db041186890af67207a043e2b121cf6822c0da18914b2f23c4c0ac63295d43d53aefc11212f8cc38fc15069c48cc055e700e3c5721ac687fb3dd8e84be6593faea3cfca12d24c637c95bdf72ca52d805f9c7d6034f81e213b93009278f9f7e9dd0305e445bb3866780f405b9f9ef452cf4ed9bf9f0ec33394ff4f7a60fac5364520dc2c8e7905b540039d08d2473420c8b548752c3e46f6cc5114777de5e98c11c6290387402030a4c09bcb773d6d535c4de4881d0c14481a56bfe33d8871154f8d0e9fa5b57f95999ce17863bcb13cc7aade97da1769a29c41d21ca1d794cb63fb2b973d7c65309d135b6ec141636c8d2f083292e783b0763e16b504a900170b17cf95d3f9ea30f0267579658b75b4e1a352f8170c53ecb50f1ce1c57f50a42c2c569dc64b126a910f70fd43d638f9b6f34aa9ea0be612ce83ed59a20956744f9ccaeca7c38b2af4dc102c4d71b66366ca3b57d04f1da75be3563c156bcff8a3384afe73d8941a38b418296077ea58f46e234b4d16f99a571d131fe91b6d71eb9f310d4bd2a8ef591eb066fe8026091c277966bf4e5cb391517a6e92b36138cdce9b3d29aa80a3ccc99f20b4d9f341ebd853cbe95b005cdd34d6422b82182b9bf8faab19b740fe22246bb59c2bfd25dbb8dcec608e182387ab6186ba621ec4e9e8f5ff67bd0958a1dd85b1592be159f7c47deb59d70301c78720b3f92fc37b8c4e29e1a5952e8d253be7d08f00b90041bdf9ae32ef618b131d4818db260504773177fe5fd0c0815fd5c31eeab052c6252cd92ebb302953aceddb6a5131ba929c13a81db7d537a6cc2ea17a393ae72162a66562865e357d029bec78e76e1a03ade48a33f6f17e1b5fdcda707bcaa3ddf37c95beadf28168ff7da5007f6f81c1e10abc5d6d771c7d23dbde34367597811fa8ab8f1055c98633752952662d4e0d6ed4c4f3710870f47d5d4d2ced36f3a0dfa2eed214b15e0eb6c93223c3cbba3f064b462433ebcdaffc98a11912c9ae1716198919181d8d98a34091bd1d26041e2bfb09137fde097f739abca51f3969b71ad84cc7d915607301aaeca50a10bf68e82fcffb08ccb20d78dde50e82a284fe5c6231a7074549baf1a43562abb65fb88941b29d58e8693c01a6d9ac5b29f4b35e6deb8646c189f2301885c4273e267dd14dafefc51395a6a72f2b4c86dfc9c0e3ef3085cad62b28e920c5dcb3d32a5780bc274e52e4a9619b800eb0dfd1ae25a0d765879b87c2245044055bfdd115db7780439d046bb49d7f072c7b9b3065b4a2e79fe3b80bdb7b7d52415a7255afb0114f229073fdcbf92aa63a5c895934cfb66d3bb5b5bbe3145c11bcbc70acd8f96922c5a92065a5e8773196e296e4df46661da21666ec119097efc96418eb8bac91da7b251bbdba7286d88df5acf3402586fbb1ba3959854c5fafebf49f4e1c8287872e9433707d75168296f4027aa5140eb643444b7c714de99b36905f744ad1891de1ef5ababb75b3b0d807312267a9122f909ca319adda6a356adfdf6d166596f555df81e19b4d355c91a2eab69287b6aecce17d3380a821cd7fa9cfd578195fda4a7fcadfe5707b795db7a7aed356453a69eb77ad83b1ab2f0ac30c7f15d366a3ac7ac9d95fcd4810e170eb89a32eab7255b5bf0c412def1932c842d336d4a4d3716ab2b7ee5b37511c62e790c226d5d082eef98c760a5ddf17299dccbe2c828f002accc8cbff96f90758c954cd45dc3c17b9b0d886baf6144c79ecf3287d35a2f8efb8f36fd5ac60eec1584c384ccbfecaf3029fc4126976a16664f21dd75c407760477690a1ef2462d7d961e428732f236896364d04b286afd7509f3886a39fb37afe05ac60dfb004ea50523dba235650431eaf3433710fb441e393fff3aec608a7882899f3b6f1e91a3a7508ff34484a89a8db249a4f583e2042fa009e873467670064532a2f0695dba15e479611899a0a70ad5cc9d8f73eb1265990b473e36501741a1cac9e90ed577068bc5062cdca84076ed83e896c672acf5997f750acd5114d08c2cac1d47855e2de1e04e847ec8c9d59d139b974298c89004b693d90c6f882ee791ea3855c5825b3c76636181d88a0785897419c73f3b4e5cda896a6c0aa81556e0ac28d07ad9f87505b74b882b1f9e9741bd4e515bef5ef1b5dc9e8451b34af918bf64c4c286514c56ef6563173a5b3ed306bb55c26e995f037217f420ec4b56560bbb5dd6093000c3e4b06b8601eb09748d9c0bd9e85420cc9429dd99118c01feb264280d73668346fe2948c643a89460cc7a262fe6a8aa5e1ec488c6ea4670d7c05f56537d104e9515a92767450071f230d5a23dab75196a3c7122ec3f1bf506c5b783f796b27cafef17ebc1ce052024aaa4634a2be138cb7cf3e46a15b8fd5eb9f1b8186061109fb458f2b20ff1a528f5cc14b8ab7408f123fae5d7aa12f8a4e08e5d11554443e879446630fd283efa72ab9e878aac29b3d9f2330c7986b5d64cd7769e49425c34accc00e350b516b3d1959cfbff04d4a3a9f3c243038cd771972bf199666d67c624e5c8cebf973bd415691d53b660437804abe512ad92cee2128ff952bafe670fe21256f8e4856da5c69cab5f3512eebf46200d93bd9c4e1258d5548a22469a5292cad348068a43af1a62f89b853a581920dd88f01fa44da8ac862f5ffa2d7073b14adc05da06e74f4cba4c3f56981807ddb642f183f9985b9474bc5022580604ef504f09b91eac05160d4585a832a64df1a88e3deaaeea1d0816dc9a95f421a5afbeab75ada4201ef55bfe728e4e74981aaca94d1ed3a0bad0fbf491c8d77f589bfffb86b051c7127edc256b5decd35bbe50205a448c9deedc1e7b55c521e0f3f76db7ffe614734ad620e0fc5fafa7d867eb156795f051a9bb675d48a8609ff6451f697eccba5a2432cad897ddb5734c7aa49cde5f3e4032999d7e70b874878edaa88848e1ee78ecb8f87434cca5552b69a7f04b5ff3709eb8d626cd7f4ec44a0ecd9dd9caf4d65f39060e8561edf35279476e99b4dd962f3b8859fef2726fc8429bfe1fb05fbb9522ef90a93cde231a0a2ede261797ea4c6b764964edd5257c953987088d2dad93a32d531c76d23d0b07e867c8f758352dc2eb5369e6f8743296b26ea9ec0c27c057b5a72a6e41676c5dc8107ce414a874aee8ff3f60ef1b8ccdae6fa783e84211bd5d5e87149babc18d957926cc5b72323395a432200f71a15376547e811e092f3fd5acdd0818b3056bee9aa1b11b75d6fd00f87182240d2393829a33e997edeaf7fa22151d5f6410f850ebe2ba41f80080d230609360361d09531472aa9d5a4efa46a0e5b57a8d36bf2a0e43a08a2d5ecbc9d7d4c378cab5e650c3fd2559b58154cd6163d6fe5e3db6cceaaa63c8c870bf75a22fd79e75c324c57342abca0be719f393110dfe1f783e9baaa654aa1fa14f058e465e1569e19c5d806bfb24a89500338faf211c008f38fe0040672ef8648dd9ae92b2a87c04a7ab124b84aae9ff1375b77e48e2db54d2f341f83fc92d0d1e66b98940e59f7cf4974f0d77207d7b5c0c6d47248fb318aaad0e4701ebe4c86cbbca9c9888f9bb8e5d5cadc44b3895354ea2f9628c1a0a6cf7dc941b7b3b6ffc7b542e77be13e21adf254cbafd83f6e1915a69cd2d975e390cb4911d90685e657e5aac17d3143173bbc1292ffa20be4e22d5af122c12d160de91e817b0b5850e87e0865ad5edf2cfce154b0722accf5ed4155b8806a7becdf5e581fded86ba43c29a0c8dc51b00b018660b70427f1b2ccbda3b859587c51fa88674b9c775d0446bc63066d69862229cfcb8c40a5b39519536722b0da42eb63a3f0c70c4904c2a32024c173967f3890d673be923e9c434ad67b46ffbd4be47cf39c4e149c325371876b81aace0f9015d566fc4defd2402f3b61377e0b51ced860eaadf20a99eb7c4b10414d14f39ff7b9d77600f7cb96ae5a232d2646bbaac67c03972e15ba278ce5e2d95a17677542098d5592ee401a64f92089291011520e5f787b7c88a66d65a6cc88c817cece379bd1333a4803268105feda2ce41b2d452cd2496ce832b8cbf370d71be2714af496688d24555f8a4e19ea5af55ad65243b40e4d484013b05d843ead9325fae5051d6171e9ce5536df2f7936368a34977889c4390aa01115ad83e1a1a2f2ff633670a0d213df4aaa3188834544cf4d6fff3157bf4f86d4432697d62a3ae9ee10a721dae946b5ce2bc03dce3dcafb0864475002f294559fc39df4607bdcd04f426a41f1d3fd43064cea5f2470bf14eb4bc74d78fbf4fee0fe02c03defc41cc51b78768d337d89f0f2429a15606d9e2a55171cd4478cd9ae86cc535ede37ffd02ab41f967bd0276e8b4cd39dc0e90500a9725d7977f361a43e74331bf9692919a969d8fad745fb72f7a23e28c1bace918449f36e604bb4cba5a30a9f9647ec549311bcbdd191cc8b8fb552430d78dac53d5fe985c81ff8fb3bd123953e008843a4197cd71f023b4a91775a25b4348ad52bb93b5955d648bb68bbd82742f798ff0f5aca35ee5f5cc8f0aebc93c5c3a56f45b8930d6fce1ea8b4a7a62372158a1575e73180b7fd663960343e49bc86e9515d34dd9aa60912cd88d051d1cf97e0253e4f518a7cd483082e4abee8ad8e9b72dae6d761c1a54ea72ae682ed809b2a6bc52aaf1793a1d1e7bac2f8447a6037f82edb6f94765e5be13a9a11bcd18e9361c88169cdf3ce040892deecf2a371b4c954b707cba9d7c7d4a28de79aea8c717c28664bcf00c6e8be85b8e4cc8645676b34b410951f6b81077f04fa1e35f079ac3918134b21fca30f2e54158df904dd33d3bb0388bb5a00c833bc1e03ae7c78cd9f0739b8e424dae1e46ba612639f88ecebef08cc083a3ba3f1d12983c4cf75fb85b9584bb7057bf23410b84ff76de4b387bacdaf7d8b94d8c34d35856190053358e6779c418cdaaf15f1fad4c2bcf0aa00310175091ff960841ff1d1e7e3f171ef14dc667a8c3cc08ef2f46838510cea2685f137776a1c5dba217e301bc66883410211f741b7c636301330c6a88bba1ef00f0dc392e55d8f8e80242afed753d5aadb2394de8a9e2fe6e73d2607e08754d1ebd3f7e3d057417daebc94281485af223f361fd501f2fc45e5f2921ddf5a41a1177c2a9031308dad19c79b1b2a0647c5a306b64abc947bb9ddd20ee80aec84d1cfd5dad66b007199eb638467b8e71edf45539280ac7318a0979741d4fcfaaff2bcc3a0e2b41845d02947076e753a50ebf345016dd41567ec8b5115eea8687f6f946c045ddff47f203aef2d7fcdd52d6d5f9df1f524c231712887060bc72da10db7847287bab61063ec5a0de1abb78c2f0663f9023b1e002be163aedbecb7ed70e26ec1fd6d94e410e79916094ab0616aac654d209ced72be6c4074e234c4208e676ecaaeb0587254e475914426961297c5c4c0bae49364252310850c5bd3b55cf62e6a231911a5f190d980f983ea6c48564d0e4c8fb050448b4085e272158cdb31750e01687a29b7d5c2de8900fa0e8c74744c12ee10e73e2184cbdcfa1e77232141b7f141ada21174a890ede2784c95e3bda25d01759162bb192ae24fe4b8f3383d83eea426f438b3e8ef3136fa5803baea406438fdde4f1f66ef67339a54e9693f836c5ec7e0c729d90437c4ed8751c93f047871c514e3771f59bd9455c0bc3a5a78ce7c9110e240b2bdaaa33cb0862de2b468292fc3d5c98863966834a03bd5cb78261fc3dd0a5454e6668dd46fdf1544b2a7f433398fdd55d1f9699aa5f6d61ef5d098172e6386fc9b4261f09d8c44945d852246545864c819f6412fa4b644dd2bee99f8c5a78ffbfc0a64b2b9000a0a4c9559e81fa6757576a237fb29f3e54bf522613ee0f326c7b1e9ba81d8d0d598b5c40f340f50ac2608a9fbd377aedc41777edbfa1766f61a8eec3215c949519ee6d12704a032ff5ec6921aa950af32341685b46b0b9385f2dac72d3fea866324bd4b64e8c9bc1d99df33e90c0e8f740d20254d63803890350effb0e32ef31f850612c8ffb52b4ffd8f72caf76f1c799192058c4104b62aac067f50bae3cedc6f0f2248696b9236048344d121316065ff0ab2a97d34af792eb0a08812e48e1c17b50d1e24b575dbf85a6c7545d1ba792357931d938a00ad05173f642ac2d6f46650b7a0fcd9b1476a82db78bf7a5a78b1432bd472114656937b1e6c31d590a93a2bd6065762878ede7ad9d0c57481e866e9a01a71410742453ec87a36eb6face23b9f3603880775dee5b78aaf451f13a4a07d1c30a94074ea7021014b6c7bfb5291b5093d845c135b88d29e4480e9b9c30f6eab892c3a7d71980414297fbec66df53e3dbd345e74b346ad9f0cd64c318dcbcd696b42b257e1db3d64e31ecb25fb98f5357f4a204da1d27651b9114477ff108f72ed0bbac534f3bafd4c6a928962b58b60adddae596977acf8d02df255d40c19cdf69e02df3fd16f10b120e8e192e2468f0724d5c726d4506b377d9dfcf45bdba4d402f8e24fa0107790abf5b68c6bc89f568632b2f2fb99abbfd98e7328a19d93c7329ed56ab3e1a07492f42a49d7f27d793143c7cad7a293fc9953567a319efc85992389ccdd500bf781c43653e14de85067ccb8bece8bb5bd4892d0ae1b7176ceabf0f11cb5cc7207d42d68d76d89f991598cad6ef6b7fe0972b2e516c41d3df76a9adb32c7fa7a214cd30b8c80d8ce9ad070657bdca9964e8881ec3c9f078ee87cabb368ee6600f6e65e59004bd996e5daca2d23f40c67c2a6379294f466b48d2cc75ab138394c91eb3f165ffae3b9f715ead6b30d7e11886e2946db003d86d684a89f3de8d68932a415c43519bc6003d9f5133e7d6460bece765d57a3190f30a54deeae2b678eabcdf16fbc8c086bc61e7fd9186141d5152b1cdc183ea57d4614349e76c650add8150c1da9f73b7a7487e2bf088ff0357ad0704e6668b21d28ef1fd6f493c6a2d09995e0e232c446a007f26ef837bc0c9c3e6d40d30595377b8a23888d2bdac241d05e7806d107006103d54cc12767c49991807946a0670138bb1d77c59de4b7284341d3941949c5f6ef86a73c350091049fc0bfbfc6382f465f2743b7be67fd0c7259eb9801e3d970d89101b26f2be255e1854d5637e8bcb5329e87767ef1d170e8bbcc43b5f544556cff278d8bff5afe66cdd02065cc234588adeec97e7eca9c4af669767129195ff65f5f3cdcb34389ada7da1a6fdbd0a7864dce14841d1df8085051c65473c25bde05bfdcc8652d300808fc95e97f9ae2c2fce0abc722c08b31bf8496f00513281c8817ed9a2fa061842a72e831adfdc71c6c61c06e519692f2254825f43b50343f15a03788b7f60f18830b86731b98876d96d671129b8c2241bddc8cd47a4de75890785bc4e50ff640cea5024b9d1eb32a692752a0d046499e7c05e587a22cd857364071f34d0337e455ce75c8a61152d2a7cbd1937d992ca021d9e21bf192a76d1595e9552321705331e7160176942ff14eeec69ede1975c54f7716ecc0f67acf6358f2ce2e41a2d9f11642cffc23c53241c3b6cc2804bffe814c5062043bb2d44b284eef1a9a0d591c3cf7c713ebc85adf2b7193b33c46475cf14465c8077948ba2fbcb11c9ed626e9e9b4325bd52452f6a6fa1a04d752b8b2a27134543ed4c3b139d830ec5ef6828dbfa7fadae9b34fc645e437e192b34e1787553e1b2fa032b9f7006271b718c0745dba8e4a7ba6dec1094ea3caed1c7bc0dd3d3b655e7091bcfd3cb7e7e26b00fea5a4d672f6794b1ff36236288a73a59c64d59c3003222a564af4e5d61e1711d9f2b75d1ccb60be70feef882c6a66f411bc843882ec023f5e191995f6ff6f716dde89c4862b1ff698b9e0a02b398982f3eb20a6e47d61eeea6f58d0509d2f901425f407450212e79097ca88e9717438b92afcb99c90ca7b346f4ddf6a5c83d512057c10c45f78291c0e17b0f55479ff285708e0d16106b1cd45f0f03435f6a6830456df0241a45294994bc3c04e235972248b120af45109223ac116942cf25ce603a44950752f47dcdf8a36b58fa119987c25de20415957e9691960eee51c28083e676afd871d338db00804e2b759158fc8ca20a50f265edbbb70a39a85521da21858f313894c043b4d9495963e8a5e832351f296b4a2dd70f49d685df17a3f59a2c884e47b37afe9594e80d37bd418d858fcbf3e9ce308ff1537b6946925a60222fca64f8178446ba86831d18b54835357f42c7acc79fa8d9e9434633abb449c468b3dd66941e09571409dca90172842a528f97c02d16b3df7df2b424f897b06a18d44b0470e47146d999566ff41526d03b7e7e87a8c29364787b7aacecd84b04dbc5e969c1ead096c3cd61ae2720fd149dadae771c9eb00226c388122ee5d923c08f4a8dc34e576f8ce70523178f4da90643248d81da69da967ea5ec004ee070869558c7b3476224d497a9cb0bcb35c2deb16ac322589c58753c6f810e80abe8289f5619d1af15f6a59019bcdf7f99af9f781f14ee273cbe0bb2f50bd49f238617d87d9b12ad9560640c11c4c23039b97b17884b78ecaa85531b1d3fe2cde50b244847dcd098b2f23cc55fb154c417710f7abed77fff5df16e257c73114bab5187047a2750c3c17b0e9d504bfea67130494129a962e44adf99c7c71be39870637442408d38e77fadc92154de9afab7470e1bd6a1904912cb559f2c9c88d45aaff63086282ee3665b0fb6ee33b66aaf3c08c2c68cfa755377df3aae8cceaed63cd582fb7450f526739934e66b3f630144a72a79abbece23f19fbba49ec24e1713310417763fa49418c0cc2516f5586befa43b3181161ad6db6c77ec275ae16956d0b847f33293d5dbe76f56e8a4abd402633ad0133dda60c366be333a975da788d739b42914a13f5e2dc90d0b90363c1d247ea2653f98642f92c09d235c6e533c9009677fc54731daaf522ff953d15d4a70308a769b56453dc702c440f2b48880485463f0a3d287a0e98d30aff1d95a3350c02fff6d2b2dbb3c10a399b3da2dbc275dce141e8b454d8ff40f5c2c6674b84acee624757c6ca1756649b428373bc31e17126086dd146252631dce68e3c09327be3e1dd28692379e5ae7f9b5538d91c1c3bbe2b225823b22ad5e51963e07b637f8de41c472d95f793c70facf6bbda549a842e4b3046372c05ffa719ec07c82a77741f02a883313fad977d0eb40d93cf744ccbef094b8a20b024f28253429721576c0dedd48dc93d27fb37248cb2b6bd4de273eddb8f9da27c9a44a638d67a034f96d463b55ede47c9918d0df914e7cacacfd2d0f02ce024f8c4b73256a3ffb6cc2a0918c819cadc24b431173f1a6a0e19209f387abe830f5ad35ff79335c2ee4876f07ee5acf4ef700d2774948e49ae013423ba3df5f4be00658a92e0c7a12eef9eaa339084e07662debdc9b809b753a58ad897307d421619c9e5d6a3c5d9533c29f17e8eb055ee2ca563a7640182359f7c3386d472cc7c52844d280568f1f97f83a095b78069f9d9706044d68f4f49104ec5d53aa902d55bda816becab613c27bcd4f3c89a7debfb3a3ac090bcf4c37e1f31b39362ea41e7affb4e87cf7fc2435fa9980dc2a932570b448746a9d17ec79ebefad1f3ba9d77577efc6de81c11c878475500e795746ce17055fbdb240f7dc75d9cc83a62002afb478f3a737c7ca8cb5cb64425953f277d07bef5769dc99fd891ccbd6b574cb0ff634f8c3933a1a565cc9233825c5d54b8a90546e706a2ad6ee676c80753e02d34eee2f8e5d0a0950870d8c486b06c33880f834d17fea7e042c06f347b41fc696596262d5d90812b20edd22b14bc5d9f50efe680564a5f32a6436c9a4c8988f9646f869ec50dba5b9f53af7dc1304d693dc8b4c9bf0e462fbb2ec19f39ef3ede2ff1d7479373b44c191372b1bdf206c8471236159f3240253b07e460ed1f668fecc999c864c1f9e4d45b806fb712d8778968e7ac56e8f5d1a4cb8ad83857a53c81ab6a49819866ce5841d3279961f9cdb4f34dce5dc45fb28c0890a5d821f35ed30b269da4db5adc6bb98b31168bb8ea296095b6e6388d691e6ab78a8e7ffb3e343d3fb16f3ee7c1c676e1b51d3b84015a56af36421d0ee6a269bc60715a5291f81f05b8f421a15c0d62b24fc2ae7faa0090bc47fc483a249fac36bce675341035487146aa3a5741828b1015aa15abaa02a4ebe6dae130e754d8672a273f6e80e11ae5513e0710bf8a6449e84e74ec184b0b52e754f6fd9863e1f2898f6199e4d0f9006a88a5619be12014f4dea6992c39a86e95a145e092378177c42664cdc88cb893f83605c9edb9c30611288bd6252e6f10e608cac7997d7ef4c028fdb56902d77fd468bf9b80e92901051df3b183080ec8a753879554729f51aefae20727bc702e26a39f0fa7ff660e40fe58dc3883af0e0f320d8e39819c684fa454f5ed90572d2cdd848cd1e779abeb899f1f11626ae8b518072721eae65e48d0b537a14329db3a5d2a08988d776af2d84a216cbb814302df9a42b514435a99a0c48edc8322ea0ea79e3d2b13e86442e567fdf8b13bbbd18bcaa54638328f0e5aab2e34b241bbc80f262796e3144124916e125c3403232596e8844071afd1d25a9897e0e4cc48f6de31ff7a4d4e6f150ace364537a58fb091b5ab76208d6e546e24bf1e57e9967b56e1da6f7fde8706e39c804ef9b46db2afbfcf44cf3354dea6d62189d0be05f69aecd342a775194e086e5034a878fde6677064d9fe42c0ee847c16598f8d3f3d2f28105f411453ce10529ae8b23a5bf54f13683f448890d5facf3d75164738bcde8bebc122ac6dcc35dd5af061fb6e86e3c018a6855df6758a4c62a8c874b9f454f4fde40c70f9ac672dd7ab96db840da7e573bc0a8025f6092c10e74eb3e0755513710dd16d7e7c846967b459620e8a6748775f0cb8f85e33a3a0c181187df0daad992fc3f227a319d8ce336fdb1a97ac9fe5051e545fa78a8f9418e112af44cb2cf55d6290caf44e914512c29b0b0fadd07dbe943a338577073d154f6fdc4f569d914a72ccbdad44c9b46edcbafa36fe613ea0967b0713cbf283151107ce93ab3e0d20ea905e5d0fa3dd300b3986b850e3c90ec8311795c39bf2fc8697edcbb9705a08e5d25392ab34ccb9da2d38094159397b73075143a64fae741e2c13e9ab91bc176b1c7e33ea9f8bb13b766717236a4102f6a354cd61fa65ab9722a8968f8f7c7190969f756c10234bf535a5a5fb37473deae21dc000267c177c06fd1eacbf58628eac1eb588be01a6b293b5d0f8a09dcefcad24ac7da96285c4f4393f9e59710d4737175b668e17e01aadf3fe6b51b651ef9f49e0c5450bbe1b7289af5efa4e0ed26287d8267b3dc58695a1426fc386bd848bf66f6208b654e3a8343a91d566610a59d0ba9ddf8850018407b89516bcbed870986b6761630c0c6e5d5409d2701c3a38a2e4e2641583c6e749a5a03422d959e24d1223ce319372a2b9b5aeb90ff3f1c41ed5dccb2322b331f904a91d8e0324dcbbe8a3f9168df010f8817ae886c8929dda24fec252e0597fef6ec245e7957c130516be260e3a8c6b0c3f44bb804bde73fde69405561bb4b2761f489a9c2b0b38fa8726b90b2aaedf235efb97870845778a4d709b114f16acfe6517d983dc1717e06f7ecc7aaa4e973a82406817ad38555a26e55d218d3498519581020bc96fe8c50aa449890271677425b7d3fa1c653fe022650321bca7d65fd150cb4ead5e75e3397af0230c706ee25f772692c5e5e6dc1a69811ba90be1c1921aedf44afc4e0c722a37db452a6b99f846a74e01ca212919f6192b6f77c7996442244d8482dd976c9e8ba5589a3f25140c9a1cca0ad85e88f9758bc3ef54873defba7c5efbc9a27bba8a28179fa451d04ecade79778479a0c94eabfe3d3ba7b6937b058d7f430d7df0c93d6b93c0bef2ce3caec997528e9b0c7ce931bdc4b83a53cf4813cb0ad92d998ee990b8fe0d332a91e0766bdc724f81a350e8793114f00432e5f8a593de4307ca6347fa873ce6d4edbfe359dc26a2fdd1d753f84b774ee31be36bca738401aec508362adcdb59a87c5652e3f5def231153592848b5678db1dca9fe5480e62b86507d9e7ceb6a4dbdbcff965d4efd53a4963f132958e9a54d8083718d3eaf442a81d085880f5d8bbf5dcc8e18461a10892443e04ba157c3e91c3798255e83c632f2b12b19f62a5ea1832daff7bee878d3d861d9e50dfadd3083fa6ca645898a0714b19493b45b4afdbd6812f4a52dac37baf247bd1549e6697f1653dc158d060d5eb1782a4367cf212497176d26339dad1a3d18ba3d306b415e6a64539a4a918c14b729192a6c5dacf878e7fef97f6bb5716e0107fe4acfcc4ade77f0d12f392f54c050e9d2243f8efd9ebf083dcfa6d8614e695e3a85a23b58182d0f0c15aaef4083ab616786985a1a6c4a406d1fa899a99c7d1e8c3586876e1cbf81a0dd862911dca94e854b057708749e64901d774e6af68f68f64b5f810aab464595febdbabc8f27bf4f307c223e508acbcfdc183f916bd2eb81ed04d8b1aeb863d6ab292d088b29d157842d4772d63551fb80cd427d9ddf008ba1125c9cfe3f0dc9ac9600ca4c9b659a39f59f6ba41399fb493aa99303aff039277c25c917d3e2d4d03d1e54047010812220ac1ad01932c46e778c8b28172671ccc2c41b5b117a45104a2c864475666f3725a616987b929fefd677fcce36d9bcdd2dce886fc36af25aca8f2e506bcded64307b13c86b913f39ef17c3e87a96184d233dc3d33ad83512cf254f053af8ac7fd9d47527fee698ef485f03bd5d821bf5bcbbf030eeb2e898740a604384a803a256dc42d63d866ebd367ba3f72e67b496e00ea9160903c7a16e1088440d3e8b65255d1bab6f076ed81f3c49cfaab9a00a01fbd5ccf6e8e8ce76cc8724159a20f981d4261446bf033d35daa6e8e0bbb662b3805755ef92e09109de86edae4da2b95aa104b4aa8d8e89bdb4003df9b1ad6ab7a6524a7215c712057bec2971c3200af0aa58a58b9f425672293b43045794af1e6f61c0f067ce47a3a5871ab8a920d15f751787cb1152102e8cc0cd3e99b0a8df0c13fa0ef88559770009db435773515bbd7c9b414c027f5aade61972851d3be48c5a6205aacead31c21426c141e6233763aa851dc69a23b34524b3c1cd1d0f223b86c41988f7f96b795fda22f6fa56e0e3aa9e61f6df653b3723085fea2d3fdf46d55c6b3337ba98ca6cef40bc5d83250494d92ea9451156bafa30a134762eff484cdc6834c31b1379f9aa6f6bb7db68edbb5889e61168760f1fb8f9c0e16440af0380f9c90ba099b7b297bb2c1ecaa75796dc721b6ad36896630cfd6101beb141acba976381c6e44a26daa7451643fba5c3cc948e3d170df998eb41bc940327ff022a80c32fd0f2c995903fed097579b79d0432243679c0bffc37f73bfce63ec99eac1019341d7fe6d3da300e387da7032e91f53996dab855eb3d85c9d810d4bc4eb4113c30070dfe9610c080554cf35478179271fb035e8fbc6e991bb9669675042af76921c9dfe6f3b77f727f73334c9254a8ada19b1e6ab3d0e444738d4ceae000ebc79167baef6da722cc42e6cfc9d51d231f69bfbfe735394c9ebba94a58d6a441dffaff0a38b387f405f8c329afa66d63a5b57dbbbcb72615672600a1ef9c1c2b1f1c6b883cd944f54fe31b2ccce5ef88241e00b9cae11c00ea85b86f25123f963c15e885d38d0bd32fe974baa5ffa9d7df0e0fbd64bb2609c6e8ef3c021b51f9217b9038704d30a4c85664268d212634777a911ffc16b4f444ba9600528feec985c0fcb82b9f58961391c3f3a4b447444b4fd604621cacb4517774a3b88c5affe81bab3186365daefabea465b98c1ba989e3af8d517899a427fc7f4981c710184f8d0abd2d0b2b56a0d7255f2ae0016d69fb76d9a34b7dd27f9a79e237308e64e248774164c1a1296e1ec8ee9bb3906e7f7d9cbcf60b1951c10e73e17d28426b1abfffdc9452f5e275081622756356c51bbe8d1e1cc2bb998d7cb6780192a98d8078d087cd9837b3484e5e18f1c16fa8cc431f6c312438d2e0437a8930613593c521130db52f745e24927c459a25f51a4595f2a408e0d88aa3908851d189d065928323794fbf6742bf46a400e2eb6340f7c98a58ea225bab4be8a7b077bfd65f360f01b14c28058093aad720d265178c7a59a52b2b18cf6c89d5db77787ee609b1af65452b18524b5f520fcb35c5c44e2570c19abe25fa16115b2860931a2e16ca456ceee7056ca01fe6702b6c1a62e25e132e2bd8ed4f6e11ce2ea59bf69586486352375ebc85747a812ce882a8929c9e3c8afde07cab2bf1468f95a330ee42fe309d802e579649ac786eca26e7b48c96286624173d2c2e0f66b240278d319ab081ca0745b8e881e3aabf5d134f7443f42953cfea157adf93a90eadfbe4d204bffb86be1141a5510339740faebc340e4fd216ffea8fea367869fe37b6fbe2877d899fe498369448efa7a49f60746b55ca1d68f847acff5e441f89127f81355149557f99f2427c32cda1fdf357e8c6f342349cfa708ce51eb8938f60badb43551b99174ee36284f9b825d924cada84c1cb24bac51e18ecdb67be979f044be2bd5dc2b0ef32b58dac94f5f7a4e164e81c810040added1b79737aa3625565aa869fab461d7049b8fe7a82e08946900bd2f4f6c2754ef2c3e3a39367c8af188fa7117fda6887b957b60a626dd99430f779c129525ab1bf304c893505fc15bee78a1bfbe73a15c5868bcea3acb80a8e5a726bec4faf30cc3d0980ecf42f8684bd705cc56fb4cf6d410ac837c061e7e067dadfec19ea3eb742355d206b769885b2ec230c62631f338bc8b54d0a300535de1b58714fb38d07c359a34c23972ae8b8685730d70ce595ab987d3173194692a71ede5078b8fbf1b94f553ffdbf73bb7a9f427e9e012dcf048182b4468a595e4ca374268130ed2f05b1d0abfa66b95def96e5cb8c9c143fc78b5c5e302a04160100524ea454664e9e90c64509ad5673f2ba397a0dec350bc401bdcab0c9fde13625d94b83657abd79d9908c47a025ecf8775bc460673d03fd69899b1b56865eb9289390f24e14106980e06c6259f678ca58143f94c80b551ad8fb248686039654d015dd4185fdaa85a4d48977016d44c63df908258cc029a16bfe1c039010984b28978dec0b084976c30ad37f3405b732747293203a0f8d8d5c61fcf63447bdb31976b784cc7937ed5c325ac8faf9ae1d0204b7ebe2d80a1e8eb51e351de3a86b1b7f7aaec23bb0dedf6b6fa1a12ee4566c65a796e4e0cbdb19d068c7cf8a19dff5678a0aea338ef02d1a26d33882cfb21a9e4878ffaa99ee3243386b2e3fcc6a16c3af2b933b58a40eace7d6a25d53ea60420bf3b9d1d9bfe4d3682b98082257be951f574e84959b67e58eb992094ecdd08d72a32f66f1ea7aba7d2eb6c1d3a4cda15ffa1e3158d1481634ac25cb5b9f49e15f12f578ed88eb847ffa7f1b4a24755d1336b2327cd1fe1bda8323b9722201dd9e1473d8f654536b0ed0c9fa89d210c05b6a72c3e4533c42d577560ea4af6ced0bbaf716a3b6f07229f0853860e7e870a1da3f16be0ad6d12517bb79ad485d7e9d4bbe6276dba8fa9cd437e48f526829b0c2537dd24180a69b2eeecc116bdad0183d9eab69e91c270305ffc4e998365db0ae4eca092daf8395900725e9ec1e838fd672a1d9f574ef2b604d1e8854e6f6d5c5416d78afe96d52edcf42138b1c09fe9fb87558078853757452c914c2508fa29e72bb4143c34f2921e805e546840efc63314c24c1d9f98846f4b617165e098a564a93c83328b1d80fcc21fd8d141cf51fe847b26160cb5fffac588b25bbafb537e81430f9c4e3af727811c3b8969ff27eb8885e1ef41b35b2b2f3e253605641e5b5fee75af33f908b1dd7f457b66792bb9109930d52af7b92b62c25116d11a34e375e0a2502e18e5ee82347fe576e19fef9a3f77bc7f75b95a46865aa5497557d08c952e0c39e4cc1e673d42520f226b2d172351a39c21593387a5ddecc9e1d6ec8d9e806c2a616d84c4765482f34c26d61c9df37112a3b622bb2a36fb9aaf8673d7a3ffbbc9da342407e8d02ac91b4d15dac3238d1d77ee7f2184a397403fa176dedcbf3de4cfd34c3748061beece1d522c44e2fe4b7371438d433e626ecdd83e3436b33ae1dcfa4c9d2f1f0386a4f9b69b5db7b0ae177751dc62c9553c32098e49cd473aa855cb91567c447359da3ef78b3ab33ab09c5bbc1b0262c01286431c7a8256dfb03ac90e7b8d5b96554f31a6484dfedf19a935b0f4d87d5567fbb4eda5ac6d2491cc6dab2d551e7ddfb7e619f3b88bf71957edbaaabaaf376166b88e1f2e6cb2192587468fcaface6d5ac073df2cdaab47386df12a4855104d25956beb7d5fe36df11a3e1d964c8f106bbe22fb6850013e2cd640cfe2902824d8146d175834b30fd9785b51a4045eb0f26404906e7e536fe1a3aa5ca707817194abb226aeaac5d04545eb0b20d20f819331bd928b6b0c8eb5f5638798dd13069c98c7ec6b466749a663484426139c796807c245efee27ebd08b0536333364302901b7010e882e483dcf29f76d0f74b577bc2b795d64033b88af4bc97a6ad5b977dbb9e1d4974ce8a85bdee048057065cd82f1be0281378fb566e9ac2a28225364ca345113e135ee3987cacf447dfe41383fb90cbb3ab70bda3d3d3440a304cb89a7302491196bb9fb8c722700598d000d2ff31ac2960abbc4d1ad93b1174b7796311f41d461dc64d1cd9d9cfead6831c210b2830ef5e1b6263daf1e34e287cd3ba553f0ba7005d10799d20a4cfd9ff871720039d9f9382943eef65a9e21ad8f076b1d6ebfa50d29176c9ad25d2bef90a0d4e869b567035296f7252e6831a73e3c1f1f92554111a564e215dde5d1f9d5bbe12aa65fe4806ae97ac3fcad15e7a7db5f388e0a68528443214af9311fb01428e84c6904d85cf68c05076db7d366a996d8455d106ea719758b352aab6efdf52e2efbe063b41b83cedb51d4fb6d58265a4a1cd4046e34ae0aff271ad436203049888a7327a02c76420f80f3768d8f73b4229919d99ee977344a0c1e4096311e99f0a33ab35b12e627a64bb284e098feba91a6f83e6f872eb29a67a1f710a896318f0af6ba5e33bea614bb5e6775c6ca80f6927c0546a153f72e132436a41bf0bb03abf822d9e556bfd0178bee7adb3b6ed74731e8163ef963a73afe4097d920f11e4bd06a85ada2aafe4127c2c473acd748d532eaa4757340b0210e6cc1d0a685bf1898939a651b83be904c90344a548626a044d4f723dcde247e2ba6068d95ea11c1847113deb132f9bd5868fc57cf3aab02471d51b7cbf49de37e4ed1fbdd5eab22d0ec87cbe1704da935fb4e9728d653938188bbd675f34eab40741f99b167ba9c8e4b4357daed82251379a2881f27ed730b3eefc7f715b12e65f98842abe4c1075d169350a0a14b7f3035aeecb2dcf2cd3c6f7a45b4413f5eb9eac4b06795933b49edb725ef05a918570eea5e752602d3df3adcfd1e449912391defbc18f6f288193453743e0f5dc9a684a458cd2191a7dbf3e59979ec6ce863afb68cdc252c1d5f5b7b3f15e7572498942ca967d26c3059593a8e632052a86f190788f076c947503ec043e937f39f1f2c824aab28b54bbce3e750692188b7f21b19c0ff8a560e6072a6efcc681d0df11d3aa131cba2a934384ed71fb56fbe17d4e61d32eeb885265afcfafe92d6e15d7674570f173e72828ddb761edca1d43ddf26516d10b1fa6ad7947623d535e5225a382d53bc2b36cf18e37550ff2de427454ab88ed77f69710c1f80957c463e77ad08a96f20c3fc1ccb856b8d2fc0fc3c8e0e9ba24b7649d71496d6ae0b1c4f3257a5a3f2ceddf8b0a1c678c0e15c103bdb3735b1dc15602ca5e8d0cc6bc623dfd9e7c3622f5f0568f8bdb044582bf4493d4023ed93f0157c3ee6a9332815d15d3459590a47f9f84c88108cf47bcaa5302571e005d3e4a219314647cbc8ffc5f95024f02b95c2670d4800ad575a704399b3985041e72ec12f30adae077e411d2fb398f42185fb67f5c4b5d6126b5e756a7a273d1851aeec11a5e4c9605dbbadae10c72405b7cfa1d95ba4b62926174a36e33ab14a21969075e6e3fb6641624be3bb14bd75e0865946f9496c1d521b24c2328b998ae5d97ee5f5aa48a35e8f53ff73ac8c8b21df222da81a381ec6361fbd9977e0f6ea653b3edd25671f0521d87f8024ad2a64bcbe7758d718d61bf65ff56331062f0bdaf9007c8174c10860a1af4c8a2ba1717bf265c15de66cb45958d710ecd01436f4787aaa8bbdd7799bdd2b63459f71729ccc894d5ed5487981daa1a8d1e2a96a8c369e5ac34c5cb8eac438b78a1a6886e06870b30dd799bd5fe5e2964a274cea6d3d57d01e07342a0488e17cd266756523f51c2a167499cfd0ea57aa00aee599faada6eab25c3f4b55c8c96059a81660d90ed9f6e5b5f4d9d24f2ec6ba459c6b49bba5b5d6cb51bf5878f2ecda2a7316a8cd7c1a9146e33a53547df051c0c048fd490d3819dea98afb6ea0737522c55af4214ea7b213a637022ef8fb3cef187e70c8e3f65ef55f7f3f4c9cc92d9d615a51c51254f6e18f43831962035848ae5d50bd846a5d748e48e582a3a9986f3b9430a190397de1265758f45ad3da632497d03cd91346095d1916347eddf3544ca5512145c6dcdb63ed4ca4f8eff2bc1322e5f05d7bf472b2a509a6e545ca5f0d24d2d6c78ec26597b1c3515d913ebdf68ec56726cb005d8c40547c463b5c8f3b4f105c98d73367c338f1cfcde2ddea03b2b4dd0f0023724c794ec21d63faffa873e2d7024b9e9d748b2154dbc8bb3992f83be9640f67326c8f512dc2ab6cd21e755fc5b6bdfafd7978baaf64fb325121fdc454f165911ef8b427107c086e923074e14e979797b1f9adcf6aed6fb91356ef1f4a848faac49b233971c30379056beddc5ca68c70bf7aede7a0411314191dfdf7a5ab5c7dba0299df78d4565e07606bc2a507bb252ced8ea6e9cc9c98fc58eb30885895a70a5404bd94e7ef16a862f9f78a1fb8ac5933e1343083bf61d1b6cef5346c7ffff244f4d8b12f061bf49632e3152373aa23aeb5247cb4154f8bdc112fc28fd2aaab38ce12a3fb3789ad05fa1c7b84f36cf5441f99e9033e64083a614f8881d91fd929ebbe0b3d42dac536fbbe670d66e6af71b9f82c446881081a6053ed3477302146b246e68928cc7e90161e7d1e6df15f0c2f10b777533a6591c5d70e5a16650a458f20f5ade8e74a7f1d5ca724cc51853d4abd199c7d5e705b5baa87d936e1fa495a532437a5425c3ae567e724cba4382eb0e6ca99ff268c2053f7a65ec1f2c8894b3d91c8254753c8374653216df70840ad2a473cf37f27177f4fc6a89b0260dc1362566a41c0281ea6b762be4ef166b61df4144508a0a21ab8d7764bbc9c1e774577e8269ede800cd8ccacb3f46cd6011883ac67811b05d8cd623f31be3aeb740985830b9f8718eb2a6264f6362f57c55a69d81a62f34d476b46bbddeb107fb8c0cd21f892810e6eefe5d1126836c1e1245949bec9798120cf5289dfaf7400c0197ead96dc27301f0816666206505b5727aff4a7a2b3b84915ff5fd149b424fbdd72b05673d14513ec22484510d18647b1245c91243dfcbfed8c4e6365e6bfae26e98b253a13e6a58daa7f241e0c92397d84e1feea35470c006d4ab23a34c8f8205180aa4d0916d27e746cec0956602ca1000758c396ddc5ac12e7df3120de6fece03d9f32d6d6c77d58d020752d9d4df5251f750d77f3670d9095c4a89ea3e5c4d7004e7deee4267980fd3ae1c8915521fae5c1c098f92d19f35dbfd9fd886a301ed36f3aff3b58c66ef8018cacbe29b839ab738914124552afb8bdc815d2454f63209be8766863486c9504953a50078cf1889ec9ff80e2aaf8f90bb71115f11551d13e491ba56114512a054983810f3655ad8ca77245a2f0f01cc9781688970ff8d4c543cc7c00d671c6a1980458d4b88469d8bac64a21991e0a38940151a5cc9e42cc2964204a221dc7fb34751cfa383579362359dd1ee484cdaf577744fdbb54a04739dce3ff5c0d89f6820b5e49512369a17cf2e7855176cceb2e2460559a71c612b14c9dc0cc72d956fb488b7661bcf809dacdc65fedff74f542f5ea072e713e6d080d0fb63d3446cf17563ac5295fd5fd9fb02931a6ab0f90fbf3d8f886fbc5b85f0f2778cf4e82fb86d1a6c2c034dd16213979c3ae6482ebfdc9e2a281cae6302c9c15010e24d10d99bb375793df9ba8a79bb06f2ef29088509b068b657cb58a39dd4d5663bfeac65a34b5615b7dabdaaab3400fe6f42c5d90ce78073230eb339378ccf34de379e6e23bf0a9a8af27c092fe12cae5a2cd67274a070083fe02c279f33554ef229d0842a0f5f48ec6335cdc7749363ef1c475feace235672a10b4a26902b698603c5fa5865d6eab60a01dd5f7e9c4da2876f85383b9567cd30a07314a5e1843e34f283c5a3afb6a9ac7f814b59fa68d77442eca1f3cfb94d55ce911b7396c6075e2724693f40fd038dc6a55420982b98895b4a43ccbd37ce0266791d283ebbe3cfdf399296e6137ead854edd05167d618ab20c8212dec40a84c1bc13393cda4192933512b3cde3efa1ec308b91afd957d0dc70ac9eb0434d24baba5b0f9355c3812801df98a93ae2d23af85111862d6a0c7abf6b852f14109bc052f2b9746a1a02c5dd22060204fa34029dbbc99ef381cbe8b8f742ac4d2728be416e08e692fa0753ac703b89ee28969b677b3352722fb5a7482b04d1d09c8b75f4d3db2f9d5a5ff3a18eab3c050c19428f32040035f1c1c42946baff323a0d4ca868d9cc0fa547aa4a586ea4a1c15dea043ee4a2b26a3679cf9133765fe6c44e5a47799ac1824a9397457cbf3f4e94388734f119f961f471abb84e9edcdb9edfb550376a8a35c138e60851eca00cd721ed1a72de92214e6d54aa1a15dde545e87002ec87615ad8adbf4c942abc9b6ad1adaa8be7a08fdb6fed8fec5a0d701b84f0ce71b2c197e5c3c48eabebcfd8339d2d514f05304629cdb9777c138abdef353e858c934b749a754ab10350300904ab4b4aa0a4df5aff1b3f1f0db9a4b09ce3bccab6efa715a503320d57f2e7bf6138b6f481a2d0608d7b362834de186cc8b117844699daf7115682a2c1784b58c648d9623e4f51d1087cebbe5eb22aa7d3775b5aaf305784d25e3bc182822e6ef7ba14ab918c108a4880623c4168b41cfbe5a8d8dcf976561752369df4f5e366ceaec89fa2953c9ce4e1738d0364c39a9257d796d517cb516c4fc8e2ec1e3e623ed0f993b0469f004ec8e8b22b27dabbd3f2ab72ac65db9a746aa9c1b0deef73e2418cee567df6daadc56ae3ab97bbebd00b06e651881abe4cca878a70293646bf0afee048be1091b72bf8e63eb1d09c35a60fd00df32a111b5aaf6490b84370dbfd5bb0f1f40069390e466def616e22004d0927bf9a86b79aeb820b6a55f1af5e1370dd80434d5003a13e9c5c83a854761134b98aff0e7e0f95b8f6831b5e002349ee6a956a0c995cfc22fd31b4bc527111c5e4d30d82577658a7421458f3dd86b8055db10ef910caafa429f67eeff59743da8f5b14597a1e02adcf51094c48a594e155075d741d328120a0b0fd9e8bd609e19231cad161a49617b4249cd5eb503f27828735afb57d94424c83d32216b8868276f723ae464b834272d8626b69fa5a395651b2244a3f5c4f0b6e59d158b903e00c054c52049a15d73adeb2e95eca9e27e17a2cdf05b9a9b51984490878184e74f5007baa18cd8ebf21c474a861dc8e24d4fd09a98456a601ccfe27471eaeef8b077a0642cc784675bc22a1d287b5108d1c1f605ba031f750835857154ac88c452ce6dfde38fb1b43ea00112da203abd4c3ce23b7357cd84267bfafcd0a8f9a763fafbc09893d3a4852144ef3569fbd0a50644c52f703bf971c4de84522b8e1bc1fcc81c28ab06271363510370cd6bb187ae3a45e0c9dd98c222cd3270d47a5fad3429fb787698f68f26d3bebbe5c47a108c70d285e40aa39fb12ba21cf40eafc873810aa832764ad72fff6d8e085f57f7df8c12824ccd5d359648b98e52bab94f0ba55a007b803000bbd67a29cc7602384cf29ca53177d634710c536b6f0c812a34a381992883c86fcdeed5d75e9c19461cc0781d065ed13aad847fb9f09adb60f063c095379bbc2306378da7719f4d8a946e0e1870777436d9ffee0897a21f2bd56ea09a8b71d625cb7c7e1f08bf26c8847f37f529195b63633a0880b01bdadb0db8f9f7c1ac3603a17bd3c159526368918b3e9c9a9a8fb44608ac5811ae1885bd68a3e362372155dc54a8957551e7d1bc909ef33518177ba40524b3c9518597c27480fe5b56fd2e7b24c203920da0fe12795dbd218c9885871f6d8d055beb561e332c2d32163534c02eff630eca16bdaa75a7396fbecd695a96b9a238d37a91780efef90d2da57b40419c53a357a18b8a436539b8ec8bfafeb3fa83c3ab0a4bfee01dbd2a447daf929a450fc10bbeb4bcd862a39e19a30a605de64898447677bec4db0df8b63d7afebe2ed8e8f9cbcf255e2ebb824b256ec4a56443fd5c3a200b40728be4af4a4681653a33277d1a7827c169bb1be5aa4e82a2506d9b5fd80ce878a74491cbce043d6f31a65cbec76b4f40803248575a3debfc4652eb10e3b346ac9221e042ad9aee4ebae7376927e927ea86bcf3985903564f37c96d5df97a9570cd339fc2b5abca59ee9da1b506832ecc4549096f80b5da23b3dd3b756650f1c416fcae66ec2374cfd614363e6020b711799c59ee61dff20044c7aa636bdb6e5ea03ca08a121e951bc885be183e276943b5a33b4884db34df0f5f02624f5c844bc853a239e161a0da6ce90e8f4e225fce2cd62b9b57f0cd10b1e035b1ab10ec4ca1a4a8b354f981571a96bc0f9f48dc5269304dedf85fe6cf44c3d3c9e9c4255fd9beed05a549f436886ec6e88f9ccb5e73087c7ee0140df64a46e2144ff0a2a35d9e60ac15708ac0cf0ab7e4e725f6f9e3ea1d90309593bf0dd6fee5f0f581f1f729f9475370d01de7edfd4b94fda4f1ed67d383814981ec67d6c2961783fb169a2d1db9aea2415bd53cfaabffc7be6d12c0a1deec1b9e377cf7c757bff98342fba87eeb1121573fe482b83f764175a017e74c01e70ad94e04489de5c13ba472d4d7f0e38f23f8ac3eecb6f665da4612983e4cd934a2b65f52c9b0b128c24eae1356124e7701f812218c1bbc47918e0dc873de87b9971f82c5a411ec7d9428b66cfeea553b9a1a53668435b7729e1d38aed9a65d673abc9f0e2ff613bfc500a7210b3e89f6c0c458772f2e9870a1e5a25232fbf8e4f4b1c28cdfc2aa7de6bcacef84c5512df59938914fb67e0cb676597dd31c62c26910b1189e4a2886a68432a184d48a35694892cc6a6bc781efdf5c4c0f</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">æ‚¨å¥½ï¼Œè¿™é‡Œéœ€è¦å¯†ç ï¼Œå¦‚æœæƒ³æŸ¥çœ‹è¯·å’¨è¯¢åšä¸»ã€‚</span>      </label>    </div>  </div></div><script src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> é¡¹ç›®ç›¸å…³ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DRBD </tag>
            
            <tag> å­˜å‚¨ </tag>
            
            <tag> ALUA </tag>
            
            <tag> åŒæ´» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020 é¢è¯•è®°å½•ï¼ˆæŒç»­æ›´æ–°ï¼‰</title>
      <link href="blog/2020-06-09/interview-2020/"/>
      <url>blog/2020-06-09/interview-2020/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h2 id="å­˜å‚¨"><a href="#å­˜å‚¨" class="headerlink" title="å­˜å‚¨"></a>å­˜å‚¨</h2><h3 id="æ–‡ä»¶å­˜å‚¨å’Œå—å­˜å‚¨çš„åŒºåˆ«"><a href="#æ–‡ä»¶å­˜å‚¨å’Œå—å­˜å‚¨çš„åŒºåˆ«" class="headerlink" title="æ–‡ä»¶å­˜å‚¨å’Œå—å­˜å‚¨çš„åŒºåˆ«"></a>æ–‡ä»¶å­˜å‚¨å’Œå—å­˜å‚¨çš„åŒºåˆ«</h3><table><thead><tr><th>å­˜å‚¨æ–¹å¼</th><th>æŠ€æœ¯å®ç°</th><th>ä¼˜åŠ¿</th><th>åŠ£åŠ¿</th><th>å…¸å‹ä»£è¡¨</th></tr></thead><tbody><tr><td>å—å­˜å‚¨</td><td>è£¸ç›˜ä¸Šåˆ’åˆ†é€»è¾‘å·ï¼Œé€»è¾‘å·æ ¼å¼åŒ–æˆä»»æ„æ–‡ä»¶ç³»ç»Ÿ</td><td>æ”¯æŒå¤šç§æ–‡ä»¶ç³»ç»Ÿï¼Œä¼ è¾“é€Ÿåº¦å¿«ï¼Œæä¾›ç¡¬ä»¶å®¹é”™æœºåˆ¶</td><td>æ— æ³•å®ç°ç½‘ç»œå…±äº«</td><td>FC-SANï¼ŒiSCSI</td></tr><tr><td>æ–‡ä»¶å­˜å‚¨</td><td>åœ¨æ ¼å¼åŒ–çš„ç£ç›˜ä¸Šå­˜å‚¨æ–‡ä»¶</td><td>æä¾›ç½‘ç»œå…±äº«</td><td>ç½‘ç»œä¼ è¾“é€Ÿåº¦åˆ¶çº¦è¯»å†™é€Ÿåº¦ï¼Œåˆ†å±‚ç›®å½•ç»“æ„é™åˆ¶å¯æ‰©å±•æ€§</td><td>NFSï¼ŒFATï¼ŒEXT3</td></tr><tr><td>å¯¹è±¡å­˜å‚¨</td><td>ä»¥çµæ´»å¯å®šåˆ¶çš„å¯¹è±¡ä¸ºå­˜å‚¨å•å…ƒï¼Œå…ƒæ•°æ®æœåŠ¡å™¨æä¾›å¿«é€Ÿå¹¶å‘å¯»å€</td><td>è¯»å†™é€Ÿåº¦è¾ƒå¿«çš„åŒæ—¶æ”¯æŒç½‘ç»œå…±äº«ï¼Œå¯¹è±¡çµæ´»å®šä¹‰</td><td>ç®¡ç†è½¯ä»¶çš„è´­ä¹°ã€ä½¿ç”¨å’Œè¿ç»´æˆæœ¬é«˜</td><td>Swift</td></tr></tbody></table><h4 id="å­˜å‚¨è®¾å¤‡ä¸åŒ"><a href="#å­˜å‚¨è®¾å¤‡ä¸åŒ" class="headerlink" title="å­˜å‚¨è®¾å¤‡ä¸åŒ"></a>å­˜å‚¨è®¾å¤‡ä¸åŒ</h4><ol><li><p>å¯¹è±¡å­˜å‚¨ï¼šå¯¹è±¡å­˜å‚¨çš„å¯¹åº”å­˜å‚¨è®¾å¤‡ä¸º swiftï¼Œ<strong>é”®å€¼</strong>å­˜å‚¨ï¼ŒCEPH çš„ RADOSã€‚</p></li><li><p>æ–‡ä»¶å­˜å‚¨ï¼šæ–‡ä»¶å­˜å‚¨çš„å¯¹åº”å­˜å‚¨è®¾å¤‡ä¸º FTPï¼ŒNASï¼ŒNFS æœåŠ¡å™¨ï¼ŒCeph çš„ CephFSã€‚</p></li><li><p>å—å­˜å‚¨ï¼šå—å­˜å‚¨çš„å¯¹åº”å­˜å‚¨è®¾å¤‡ä¸º Cinderï¼Œç¡¬ç›˜ï¼ŒIPSANã€FCSANã€CEPH çš„ RBDã€‚</p></li></ol><h4 id="ç‰¹ç‚¹ä¸åŒ"><a href="#ç‰¹ç‚¹ä¸åŒ" class="headerlink" title="ç‰¹ç‚¹ä¸åŒ"></a>ç‰¹ç‚¹ä¸åŒ</h4><ol><li><p>å¯¹è±¡å­˜å‚¨ï¼šå¯¹è±¡å­˜å‚¨çš„ç‰¹ç‚¹æ˜¯å…·å¤‡å—å­˜å‚¨çš„<strong>é«˜é€Ÿ</strong>ä»¥åŠæ–‡ä»¶å­˜å‚¨çš„å…±äº«ç­‰ç‰¹æ€§ï¼Œåªèƒ½è¿›è¡Œå…¨å†™å…¨è¯»ï¼Œå­˜å‚¨æ•°æ®ä»¥å¤§æ–‡ä»¶ä¸ºä¸»ï¼Œè¦æ±‚è¶³å¤Ÿçš„ IO å¸¦å®½ã€‚</p></li><li><p>æ–‡ä»¶å­˜å‚¨ï¼šæ–‡ä»¶å­˜å‚¨çš„ç‰¹ç‚¹æ˜¯ä¸€ä¸ªå…·æœ‰<strong>ç›®å½•æ ‘</strong>ç»“æ„çš„å¤§æ–‡ä»¶å¤¹ï¼Œå¤§å®¶éƒ½å¯ä»¥è·å–æ–‡ä»¶ã€‚</p></li><li><p>å—å­˜å‚¨ï¼šå—å­˜å‚¨çš„ç‰¹ç‚¹æ˜¯ä¸èƒ½ç›´æ¥è¢«æ“ä½œç³»ç»Ÿè®¿é—®ï¼Œåœ¨åˆ†åŒºã€åˆ›å»ºé€»è¾‘å·ã€æ ¼å¼åŒ–ä¸ºæŒ‡å®šæ–‡ä»¶ç³»ç»Ÿåæ‰å¯ä»¥ä½¿ç”¨ï¼Œä¸å¹³å¸¸ä¸»æœºå†…ç½®ç¡¬ç›˜çš„æ–¹å¼å®Œå…¨æ— å¼‚ã€‚</p></li></ol><p>è¿™ä¸‰è€…çš„æœ¬è´¨å·®åˆ«æ˜¯ä½¿ç”¨æ•°æ®çš„â€œç”¨æˆ·â€ä¸åŒï¼šå—å­˜å‚¨çš„ç”¨æˆ·æ˜¯å¯ä»¥è¯»å†™å—è®¾å¤‡çš„è½¯ä»¶ç³»ç»Ÿï¼Œä¾‹å¦‚ä¼ ç»Ÿçš„æ–‡ä»¶ç³»ç»Ÿã€æ•°æ®åº“ï¼›æ–‡ä»¶å­˜å‚¨çš„ç”¨æˆ·æ˜¯è‡ªç„¶äººï¼ˆç”µè„‘å®¢æˆ·æœºï¼‰ï¼›å¯¹è±¡å­˜å‚¨çš„ç”¨æˆ·åˆ™æ˜¯å…¶å®ƒè®¡ç®—æœºè½¯ä»¶ã€‚<br> å‚è§ï¼š<a href="https://www.zhihu.com/question/21536660">å—å­˜å‚¨ã€æ–‡ä»¶å­˜å‚¨ã€å¯¹è±¡å­˜å‚¨è¿™ä¸‰è€…çš„æœ¬è´¨å·®åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ - çŸ¥ä¹</a></p><h3 id="RAID-æ˜¯ä»€ä¹ˆï¼Ÿå„ç±»å‹ä¹‹é—´çš„åŒºåˆ«"><a href="#RAID-æ˜¯ä»€ä¹ˆï¼Ÿå„ç±»å‹ä¹‹é—´çš„åŒºåˆ«" class="headerlink" title="RAID æ˜¯ä»€ä¹ˆï¼Ÿå„ç±»å‹ä¹‹é—´çš„åŒºåˆ«"></a>RAID æ˜¯ä»€ä¹ˆï¼Ÿå„ç±»å‹ä¹‹é—´çš„åŒºåˆ«</h3><p> å‚è§ï¼š<a href="https://wiki.masantu.com/wiki/%F0%9F%92%BB%E5%B7%A5%E4%BD%9C/%E5%AD%98%E5%82%A8/diff-raid/">RAID æ˜¯ä»€ä¹ˆï¼Ÿå„ç±»å‹ä¹‹é—´çš„åŒºåˆ«ï¼Ÿ | åˆ«é™¢ç‰§å¿—</a></p><h2 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h2><h3 id="å¯å˜-ä¸å¯å˜ã€å¼•ç”¨ç±»å‹-ä¼ å€¼ç±»å‹ã€æ·±æ‹·è´-æµ…æ‹·è´"><a href="#å¯å˜-ä¸å¯å˜ã€å¼•ç”¨ç±»å‹-ä¼ å€¼ç±»å‹ã€æ·±æ‹·è´-æµ…æ‹·è´" class="headerlink" title="å¯å˜/ä¸å¯å˜ã€å¼•ç”¨ç±»å‹/ä¼ å€¼ç±»å‹ã€æ·±æ‹·è´/æµ…æ‹·è´"></a>å¯å˜/ä¸å¯å˜ã€å¼•ç”¨ç±»å‹/ä¼ å€¼ç±»å‹ã€æ·±æ‹·è´/æµ…æ‹·è´</h3><p>dictã€listã€set æ˜¯å¯å˜ç±»å‹</p><h2 id="ä¸­å›½ç”µä¿¡äº‘"><a href="#ä¸­å›½ç”µä¿¡äº‘" class="headerlink" title="ä¸­å›½ç”µä¿¡äº‘"></a>ä¸­å›½ç”µä¿¡äº‘</h2><ol><li>TCP çš„ socket ç²˜åŒ…é—®é¢˜<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line">bytes_len = struct.pack(<span class="string">&#x27;i&#x27;</span>,<span class="built_in">len</span>(send_msg))</span><br></pre></td></tr></table></figure><a href="https://www.hchstudio.cn/article/2018/d5b3/">Socket ä¸­ç²˜åŒ…é—®é¢˜æµ…æåŠå…¶è§£å†³æ–¹æ¡ˆ - ä»£ç æ˜Ÿå†°ä¹</a><br><a href="https://www.cnblogs.com/liuslayer/p/5441870.html">Socket ç²˜åŒ…é—®é¢˜ - liuslayer - åšå®¢å›­</a><br><a href="https://www.cnblogs.com/staff/p/9643682.html">socket ç²˜åŒ…é—®é¢˜è§£å†³ - è¦ä¸€ç›´èµ°ä¸‹å» - åšå®¢å›­</a><br><a href="https://www.zhihu.com/question/49144553">å¯¹äº Socket ç²˜åŒ…çš„å›°æƒ‘? - çŸ¥ä¹</a><br><a href="https://www.cnblogs.com/QG-whz/p/5537447.html">Socket ç¼–ç¨‹ï¼ˆ4ï¼‰TCP ç²˜åŒ…é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ - melonstreet - åšå®¢å›­</a><br><a href="https://www.cnblogs.com/konghui/p/9804914.html#top">pythonâ€“(socket ä¸ç²˜åŒ…è§£å†³æ–¹æ¡ˆ) - å­”è¾‰ - åšå®¢å›­</a><br><a href="https://zhuanlan.zhihu.com/p/99736833">Python ä¸­çš„ç²˜åŒ…ã€socket åˆè¯† - çŸ¥ä¹</a><br><a href="https://www.zhihu.com/question/20210025">æ€ä¹ˆè§£å†³ TCP ç½‘ç»œä¼ è¾“ã€Œç²˜åŒ…ã€é—®é¢˜ï¼Ÿ - çŸ¥ä¹</a></li><li>åç«¯æ•°æ®æ ¡éªŒæ€ä¹ˆåšçš„ï¼Ÿ<br>ä¸€èˆ¬å°±æ˜¯ç”¨è£…é¥°å™¨æˆ–è€… assertï¼Œç½‘ä¸ŠæŸ¥åˆ°ä¸€ä¸ª<a href="http://json-schema.org/">JSON Schema | The home of JSON Schema</a>å’Œ Flask ä¸“ç”¨çš„æ‰©å±•<a href="https://github.com/sanjeevan/flask-json-schema">sanjeevan/flask-json-schema: Flask extension to validate JSON requests using the jsonschema spec</a></li><li><p>MySQL äº‹åŠ¡è¯­æ³•</p></li><li><p>ç£ç›˜ç‚¹ç¯å¯¹ç›˜ä½ä½¿ç”¨ä»€ä¹ˆå·¥å…·ï¼Ÿ<br><code>smartctl</code>ä¸<code>sas2ircu</code><br><a href="http://llxwj.top/post/storage/linux_disk_slot/">linux ç£ç›˜ä¸ç£ç›˜æ§½ä½çš„å¯¹åº”å…³ç³»</a><br><a href="https://support.huawei.com/enterprise/zh/doc/EDOC1000041337/75f2d44b">å¦‚ä½•é€šè¿‡ç¡¬ç›˜ç›˜ç¬¦æŸ¥è¯¢ç¡¬ç›˜æ§½ä½ - åä¸ºæœåŠ¡å™¨ ç»´æŠ¤å®å…¸ 14 - åä¸º</a></p></li><li><p>RESTful çš„ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ</p><ol><li>ä¸æ˜¯æ‰€æœ‰çš„ä¸œè¥¿éƒ½æ˜¯â€œèµ„æºâ€ï¼Œå°¤å…¶æ˜¯åœ¨ä¸šåŠ¡ç³»ç»Ÿä¸­ï¼›</li><li>çŠ¶æ€ç ï¼Œæœ‰çš„æ—¶å€™ä½ éœ€è¦â€œä¸å­˜åœ¨çš„â€ä¸€ä¸ªçŠ¶æ€ç æ¥æè¿°ä½ çš„æ“ä½œï¼›<br>ä¸€ä¸ªé€‚ç”¨äºç®€å•æ“ä½œçš„æ¥å£è§„èŒƒè€Œå·²ï¼Œæ— è§„çŸ©ä¸æˆæ–¹åœ†ï¼Œå¤æ‚æ“ä½œå¹¶ä¸é€‚ç”¨ï¼Œè¿˜æ˜¯çœ‹ä¸šåŠ¡å‘å±•éœ€æ±‚çš„ã€‚<br><a href="https://www.cnblogs.com/binlin1987/p/6971808.html">Restful çš„ç†è§£ï¼ŒRestful ä¼˜ç¼ºç‚¹ - Alan å¤§ bug - åšå®¢å›­</a><br><a href="https://www.infoq.cn/article/2013/06/rest-drawbacks">REST çš„ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ-InfoQ</a></li></ol></li><li>gRPC ä¸ RESTful æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</li></ol><ul><li>ä¼˜ç‚¹<ol><li>protobuf äºŒè¿›åˆ¶æ¶ˆæ¯ï¼Œæ€§èƒ½å¥½/æ•ˆç‡é«˜ï¼ˆç©ºé—´å’Œæ—¶é—´æ•ˆç‡éƒ½å¾ˆä¸é”™ï¼‰</li><li>proto æ–‡ä»¶ç”Ÿæˆç›®æ ‡ä»£ç ï¼Œç®€å•æ˜“ç”¨</li><li>åºåˆ—åŒ–ååºåˆ—åŒ–ç›´æ¥å¯¹åº”ç¨‹åºä¸­çš„æ•°æ®ç±»ï¼Œä¸éœ€è¦è§£æååœ¨è¿›è¡Œæ˜ å°„(XML,JSON éƒ½æ˜¯è¿™ç§æ–¹å¼)</li><li>æ”¯æŒå‘å‰å…¼å®¹ï¼ˆæ–°åŠ å­—æ®µé‡‡ç”¨é»˜è®¤å€¼ï¼‰å’Œå‘åå…¼å®¹ï¼ˆå¿½ç•¥æ–°åŠ å­—æ®µï¼‰ï¼Œç®€åŒ–å‡çº§</li><li>æ”¯æŒå¤šç§è¯­è¨€ï¼ˆå¯ä»¥æŠŠ proto æ–‡ä»¶çœ‹åš IDL æ–‡ä»¶ï¼‰</li></ol></li><li>ç¼ºç‚¹<ol><li>gRPC å°šæœªæä¾›è¿æ¥æ± ï¼Œéœ€è¦è‡ªè¡Œå®ç°</li><li>å°šæœªæä¾›â€œæœåŠ¡å‘ç°â€ã€â€œè´Ÿè½½å‡è¡¡â€æœºåˆ¶</li><li>å› ä¸ºåŸºäº HTTP2ï¼Œç»å¤§éƒ¨å¤šæ•° HTTP Serverã€Nginx éƒ½å°šä¸æ”¯æŒï¼Œå³ Nginx ä¸èƒ½å°† GRPC è¯·æ±‚ä½œä¸º HTTP è¯·æ±‚æ¥è´Ÿè½½å‡è¡¡ï¼Œè€Œæ˜¯ä½œä¸ºæ™®é€šçš„ TCP è¯·æ±‚ã€‚ï¼ˆnginx1.9 ç‰ˆæœ¬å·²æ”¯æŒï¼‰</li><li>Protobuf äºŒè¿›åˆ¶å¯è¯»æ€§å·®ï¼ˆè²Œä¼¼æä¾›äº† Text_Fromat åŠŸèƒ½ï¼‰</li><li>é»˜è®¤ä¸å…·å¤‡åŠ¨æ€ç‰¹æ€§ï¼ˆå¯ä»¥é€šè¿‡åŠ¨æ€å®šä¹‰ç”Ÿæˆæ¶ˆæ¯ç±»å‹æˆ–è€…åŠ¨æ€ç¼–è¯‘æ”¯æŒï¼‰</li></ol></li></ul><h2 id="unitedStack-åŒæ–¹æœ‰äº‘"><a href="#unitedStack-åŒæ–¹æœ‰äº‘" class="headerlink" title="unitedStack(åŒæ–¹æœ‰äº‘)"></a>unitedStack(åŒæ–¹æœ‰äº‘)</h2><ol><li>è·³å‡ºå¾ªç¯çš„æ–¹å¼</li></ol><ul><li>break</li><li>return</li><li>raise Exception</li></ul><ol start="2"><li>ä»£ç è°ƒè¯•</li></ol><ul><li>print</li><li>log</li><li>pdb</li><li>pycharm debug<br><a href="https://blog.csdn.net/xiemanR/article/details/72775737">Python è°ƒè¯•ä»£ç çš„ 4 ç§æ–¹æ³•ï¼šprintã€logã€pdbã€PyCharm çš„ debug_xiemanR çš„ä¸“æ -CSDN åšå®¢</a></li></ul><ol start="3"><li>ç´¢å¼•ä¼˜ç¼ºç‚¹</li></ol><ul><li>ä¼˜ç‚¹<br>ç´¢å¼•å¯ä»¥å‡å°‘æœåŠ¡å™¨éœ€è¦æ‰«æçš„æ•°æ®é‡ï¼Œä»è€Œå¤§å¤§æé«˜æŸ¥è¯¢æ•ˆç‡ã€‚<br>å”¯ä¸€ç´¢å¼•èƒ½ä¿è¯è¡¨ä¸­æ•°æ®çš„å”¯ä¸€æ€§ã€‚<br>åˆ©ç”¨ç´¢å¼•å¯¹æ•°æ®å­˜å‚¨çš„ç‰¹æ€§ï¼Œå¯ä»¥ä½¿æŸ¥è¯¢è¯­å¥é¿å…æ’åºå’Œåˆ›å»ºä¸´æ—¶è¡¨ã€‚<br>ç´¢å¼•å¯ä»¥å°†éšæœº I/O å˜ä¸ºé¡ºåº I/Oã€‚</li><li>ç¼ºç‚¹<br>ç´¢å¼•çš„åˆ›å»ºå’Œç»´æŠ¤ä¼šé€ æˆå·¥ä½œé‡çš„å¢åŠ ã€‚<br>ç´¢å¼•ä¼šé€ æˆæ•°æ®é‡çš„å¢åŠ ï¼Œé™¤äº†æ•°æ®è¡¨ä¸­æ•°æ®å æ•°æ®ç©ºé—´ä¹‹å¤–ï¼Œæ¯ä¸€ä¸ªç´¢å¼•è¿˜è¦å ä¸€å®šçš„ç‰©ç†ç©ºé—´ã€‚<br>ä¸æ°å½“çš„ä½¿ç”¨ç´¢å¼•ä¼šé€ æˆæœåŠ¡å™¨é‡å¤æ‰«ææ•°æ®ï¼Œé€ æˆæŸ¥è¯¢æµªè´¹ã€‚</li></ul><ol start="4"><li>class å®ç°ä¸Šä¸‹æ–‡ç®¡ç†å™¨<br>å®ç°<code>__enter__</code>å’Œ<code>__exit__</code>æ–¹æ³•</li><li>js å¼‚æ­¥ç¼–ç¨‹è¿”å›çš„å¯¹è±¡ç±»å‹<br>Promise å¯¹è±¡</li><li>ä»€ä¹ˆæ˜¯ RESTfulï¼Ÿå“ªäº›æ“ä½œæ˜¯å¹‚ç­‰çš„ï¼Ÿ<br>HTTP å¹‚ç­‰æ–¹æ³•æ˜¯æŒ‡æ— è®ºè°ƒç”¨å¤šå°‘æ¬¡éƒ½ä¸ä¼šæœ‰ä¸åŒç»“æœçš„ HTTP æ–¹æ³•ã€‚å®ƒæ— è®ºæ˜¯è°ƒç”¨ä¸€æ¬¡ï¼Œè¿˜æ˜¯åæ¬¡éƒ½æ— å…³ç´§è¦ã€‚ç»“æœä»åº”ç›¸åŒã€‚å†æ¬¡å¼ºè°ƒï¼Œå®ƒåªä½œç”¨äºç»“æœè€Œéèµ„æºæœ¬èº«ã€‚å®ƒä»å¯èƒ½è¢«æ“çºµï¼ˆå¦‚ä¸€ä¸ªæ›´æ–°çš„ timestampï¼‰ï¼Œæä¾›è¿™ä¸€ä¿¡æ¯å¹¶ä¸å½±å“ï¼ˆå½“å‰ï¼‰èµ„æºçš„è¡¨ç°å½¢å¼ã€‚<table><tbody><tr><th>HTTP Method</th><th>Idempotent</th><th>Safe</th></tr>    <tr><td>OPTIONS    </td><td>yes       </td><td>yes</td></tr>    <tr><td>GET        </td><td>yes       </td><td>yes</td></tr>    <tr><td>HEAD       </td><td>yes       </td><td>yes</td></tr>    <tr><td>PUT        </td><td>yes       </td><td>no </td></tr>    <tr><td>POST       </td><td>no        </td><td>no </td></tr>    <tr><td>DELETE     </td><td>yes       </td><td>no </td></tr>    <tr><td>PATCH      </td><td>no        </td><td>no </td></tr></tbody></table><a href="https://sofish.github.io/restcookbook/http%20methods/idempotency/">å“ªäº›æ˜¯å¹‚ç­‰æˆ–/ä¸”å®‰å…¨çš„æ–¹æ³•ï¼Ÿ - RESTful æ‰‹å†Œ</a></li><li>Python ä¸­å¦‚ä½•åŠ¨æ€è°ƒç”¨ç±»æ–¹æ³•ï¼Ÿ<br>å‚é˜…<a href="/blog/2020-10-15/python-call-method-dynamically/">Python ä¸­åŠ¨æ€è°ƒç”¨å‡½æ•°æˆ–ç±»çš„æ–¹æ³• | åˆ«é™¢ç‰§å¿—</a></li><li>é¡¹ç›®ä¸­å®é™…ä½¿ç”¨ç»§æ‰¿å’Œå¤šæ€çš„ä¾‹å­ï¼Ÿ</li></ol><h2 id="å¿—ç¿”ç§‘æŠ€"><a href="#å¿—ç¿”ç§‘æŠ€" class="headerlink" title="å¿—ç¿”ç§‘æŠ€"></a>å¿—ç¿”ç§‘æŠ€</h2><ul><li>ç®€è¿°ä¸€æ¬¡ web è¯·æ±‚çš„è¿‡ç¨‹ï¼Ÿ<br><img src= "/img/loading.svg" data-lazy-src="https://image-static.segmentfault.com/406/600/4066004169-5987d7380cd99_articlex" alt="è¯·æ±‚æµç¨‹"><br>ä¸€æ¬¡å®Œæ•´çš„ HTTP è¯·æ±‚è¿‡ç¨‹ä» TCP ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¿æ¥æˆåŠŸåå¼€å§‹ï¼Œå®¢æˆ·ç«¯æŒ‰ç…§æŒ‡å®šçš„æ ¼å¼å¼€å§‹å‘æœåŠ¡ç«¯å‘é€ HTTP è¯·æ±‚ã€‚</li></ul><ol><li>æœåŠ¡ç«¯æ¥æ”¶è¯·æ±‚åï¼Œå¯¹ HTTP è¯·æ±‚ä¸­çš„å‚æ•°è¿›è¡Œè§£æï¼ŒåŒ…æ‹¬è¯·æ±‚çš„ URLï¼Œè¯·æ±‚æ–¹æ³•ï¼Œå‚æ•°ä»¥åŠ Cookie ç­‰å‚æ•°ï¼Œå°†å…¶ç½®äºæ¡†æ¶çš„ä¸€ä¸ªå†…éƒ¨æ•°æ®ç»“æ„ä¸­ï¼Œä¾¿äºåç»­çš„ä½¿ç”¨ã€‚</li><li>åœ¨å¤„ç†å®Œè¯·æ±‚å‚æ•°åï¼Œä¼šåœ¨è¯·æ±‚æ­£å¼<em>è¿›å…¥è§†å›¾å‡½æ•°ä¹‹å‰åšä¸€äº›é¢å¤–å¤„ç†</em>ï¼Œä¾‹å¦‚ï¼šéªŒè¯ CSRF-Tokenï¼ŒéªŒè¯ç”¨æˆ· Cookie æ˜¯å¦åˆæ³•ï¼Œè¯·æ±‚çš„ IP æ˜¯å¦å¤„äºç™½åå•ä¸­ï¼Œå¦‚æœéªŒè¯ä¿¡æ¯æœªé€šè¿‡ï¼Œåˆ™ç›´æ¥è¿”å›ç›¸åº”çš„ HTTP çŠ¶æ€ç ä»¥åŠç›¸å…³ä¿¡æ¯ï¼Œå¢å¼ºç½‘ç«™çš„å®‰å…¨æ€§ã€‚åœ¨æ‰€æœ‰çš„éªŒè¯é€šè¿‡ä¹‹åï¼ŒWeb æ¡†æ¶æ ¹æ® URL æ‰¾åˆ°å¯¹åº”çš„è§†å›¾å‡½æ•°å¹¶è¿›è¡Œå¤„ç†ï¼Œåœ¨å¤„ç†è¿‡ç¨‹ä¸­å¯èƒ½ä¼šæ¶‰åŠæ•°æ®åº“ï¼ŒRedis ä»¥åŠæ¶ˆæ¯é˜Ÿåˆ—çš„ä½¿ç”¨ï¼Œå¹¶å¾ˆå¯èƒ½å­˜åœ¨å¼‚æ­¥ä»»åŠ¡çš„è§¦å‘ã€‚</li><li>ä¹‹åæ ¹æ®è¯·æ±‚ç±»å‹å’Œè¯·æ±‚ url ä¸­çš„è·¯ç”±ä¸è§†å›¾å‡½æ•°æ˜ å°„å…³ç³»è·å–åˆ°åº•è¯·æ±‚çš„æ˜¯å“ªä¸ªè§†å›¾ï¼ŒåŒ¹é…å®Œæˆä¹‹åï¼Œåˆ° view å±‚çš„å…·ä½“è§†å›¾ä¸­æ‰§è¡Œç‰¹å®šçš„è§†å›¾å‡½æ•°ã€‚åœ¨è§†å›¾æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œéœ€è¦å…ˆåˆ° template æœ«ç­å±‚æ‰¾åˆ°ç‰¹å®šçš„ html æ–‡ä»¶ï¼Œå†æ¬¡è¿‡ç¨‹ä¸­å¯èƒ½ä¼šæ“ä½œ model å±‚ï¼ˆæ•°æ®åº“ï¼‰ï¼Œç„¶åå¯¹è§†å›¾è¿›è¡Œæ¸²æŸ“ã€‚</li><li>åœ¨è§†å›¾å‡½æ•°å¤„ç†è¿‡ç¨‹ä¸­ï¼Œå¾ˆæœ‰å¯èƒ½å› ä¸ºæŸäº›æ“ä½œè€Œå¯¼è‡´å¼‚å¸¸çš„äº§ç”Ÿï¼Œæ­¤æ—¶ Web åº”ç”¨åº”è¯¥åˆ¤æ–­å¼‚å¸¸äº§ç”Ÿçš„ç”±æ¥ï¼Œå¹¶è¿›è¡Œç»Ÿä¸€çš„<em>å¼‚å¸¸å¤„ç†</em>ã€‚ ä¸ç®¡æ˜¯æ•°æ®åº“è¿æ¥å¼‚å¸¸ï¼Œè¿˜æ˜¯ç”¨æˆ·è¡¨å•éªŒè¯æœªé€šè¿‡ï¼Œéƒ½åº”è¯¥ç»™å‡ºä¸€ä¸ªç»Ÿä¸€çš„åº”ç­”ï¼Œè¿™æ ·ä¾¿äºå‰ç«¯çš„æ•°æ®å¤„ç†ï¼Œä¹Ÿèƒ½å¤Ÿè®©ç”¨æˆ·çŸ¥é“åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆã€‚</li><li>å¤„ç†å®Œä¸šåŠ¡é€»è¾‘ï¼Œæœ€åè¿”å›ä¸€ä¸ª HTTP çš„å“åº”ç»™å®¢æˆ·ç«¯ï¼ŒHTTP çš„å“åº”å†…å®¹åŒæ ·æœ‰æ ‡å‡†çš„æ ¼å¼ã€‚æ— è®ºæ˜¯ä»€ä¹ˆå®¢æˆ·ç«¯æˆ–è€…æ˜¯ä»€ä¹ˆæœåŠ¡ç«¯ï¼Œå¤§å®¶åªè¦æŒ‰ç…§ HTTP çš„åè®®æ ‡å‡†æ¥å®ç°çš„è¯ï¼Œé‚£ä¹ˆå®ƒä¸€å®šæ˜¯é€šç”¨çš„ã€‚</li></ol><h3 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h3><ol><li><a href="https://smartkeyerror.com/Flask-Web">ä¸€æ–‡ç†è§£ Flask Web å¼€å‘</a></li><li><a href="https://segmentfault.com/a/1190000010537218">ç”¨æˆ·è®¿é—® web æœåŠ¡å™¨è¿‡ç¨‹ç²¾è§£_è¾¾é¾™ - SegmentFault æ€å¦</a></li></ol><h2 id="ä½³è®¯é£é¸¿"><a href="#ä½³è®¯é£é¸¿" class="headerlink" title="ä½³è®¯é£é¸¿"></a>ä½³è®¯é£é¸¿</h2><ul><li>Python2 ä¸ Python3 åŒºåˆ«ï¼Ÿ<br><a href="https://www.zhihu.com/question/19698598">Python 2 å’Œ Python 3 æœ‰å“ªäº›ä¸»è¦åŒºåˆ«ï¼Ÿ - çŸ¥ä¹</a></li><li>è°ˆè°ˆä½ å¯¹ Pythonic çš„ç†è§£ï¼Ÿ<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> this</span><br></pre></td></tr></table></figure><a href="https://www.zhihu.com/question/21408921">æ€æ ·æ‰èƒ½å†™å‡º Pythonic çš„ä»£ç ï¼Ÿ - çŸ¥ä¹</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> é¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo åŒæ—¶ä½¿ç”¨ä¸¤ç§ä¸»é¢˜ï¼ˆåšå®¢ä¸ wiki é¡µé¢å®ç°ç»Ÿä¸€ç®¡ç†ï¼‰</title>
      <link href="blog/2020-05-23/hello-hexo-wiki/"/>
      <url>blog/2020-05-23/hello-hexo-wiki/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h2 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h2><div class="note warning modern"><p><strong>@depracate</strong></p><p>ç”±äºä¸€äº›éš¾ä»¥é¢„æ–™çš„é”™è¯¯(å¦‚é¡µé¢é”šç‚¹æ— æ³•ç‚¹å‡»è·³è½¬ï¼ˆä¸ç¡®å®šæ˜¯å¦ç¡®å®ä¸ºå­ç³»ç»Ÿå¯¼è‡´ï¼‰)ï¼Œæœ¬äººå·²å°† wiki å’Œä¸»ç«™ä½œä¸ºä¸¤ä¸ªä»“åº“åˆ†å‰²ã€‚æ‰€ä»¥æœ¬å†…å®¹ç°åœ¨åªä½œä¸ºå‚è€ƒï¼Œé‡åˆ°å…·ä½“é—®é¢˜è¯·è‡ªè¡Œæœç´¢è§£å†³ã€‚</p></div><h2 id="ç¼˜èµ·"><a href="#ç¼˜èµ·" class="headerlink" title="ç¼˜èµ·"></a>ç¼˜èµ·</h2><p>æƒ³åœ¨åšå®¢ç³»ç»Ÿçš„åŸºç¡€ä¸Šæ­å»ºä¸€ä¸ª <a href="https://wiki.masantu.com/">wiki ç³»ç»Ÿ</a> ï¼Œç”¨äºå®ç°ä¸€äº›éåŸåˆ›çŸ¥è¯†ä½“ç³»çš„ç§¯ç´¯ã€‚å½“ç„¶å¯ä»¥é€šè¿‡åˆ›å»ºä¸¤ä¸ª hexo ä»“åº“åˆ†åˆ«ç”¨äºæ¸²æŸ“åšå®¢é¡µé¢ï¼ˆä¸»é¢˜ä¸€ï¼‰å’Œ wiki é¡µé¢ï¼ˆä¸»é¢˜äºŒï¼‰ï¼›ä½†æ˜¯æ¯æ¬¡è¿›è¡ŒçŸ¥è¯†ç®¡ç†çš„æ—¶å€™å°±è¦åˆ‡æ¢ä¸åŒçš„ä»“åº“ç›®å½•ï¼Œè€Œä¸”éƒ¨åˆ†æ–‡ä»¶å¯èƒ½äº§ç”Ÿå†—ä½™ï¼ˆå¦‚ï¼šnpm install äº§ç”Ÿçš„ node_modulesï¼‰ï¼Œæ‰€ä»¥æœ¬æ–‡å®è·µåˆ©ç”¨ä¸€ä¸ª hexo ä»“åº“å†…æ¸²æŸ“ç”Ÿæˆä½¿ç”¨ä¸åŒ theme ç”Ÿæˆä¸»é¡µå’Œ wiki é¡µé¢ï¼Œä»¥å®ç°ä¸€æ¬¡éƒ¨ç½²å’Œç»Ÿä¸€ç®¡ç†ã€‚</p><h2 id="TL-DR"><a href="#TL-DR" class="headerlink" title="TL;DR"></a>TL;DR</h2><p><a href="https://hexo.io/zh-cn/docs/configuration#%E4%BD%BF%E7%94%A8%E4%BB%A3%E6%9B%BF%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">ä½¿ç”¨ä»£æ›¿é…ç½®æ–‡ä»¶-é…ç½® | Hexo</a><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hexo --help</span><br><span class="line">Global Options:</span><br><span class="line">  --config  Specify config file instead of using _config.yml </span><br></pre></td></tr></table></figure><br>root ç›®å½•ä¸‹æœ‰ä¸¤ä¸ª config æ–‡ä»¶ï¼Œé»˜è®¤ä½¿ç”¨<code>_config.yml</code>ï¼Œç”¨<code>hexo --config config_wiki.yml g</code>å‘½ä»¤æ¸²æŸ“<code>wiki</code>é¡µé¢è‡³<code>/public/wiki/</code>ï¼ŒåŒæ—¶è®¾ç½®ç‚¹å‡»ä¸»é¡µé¢<code>wiki</code>å¯¼èˆªæ åè‡ªåŠ¨è·³è½¬åˆ°<code>public/wiki/</code>ã€‚</p><h2 id="ä¿®æ”¹æ­¥éª¤"><a href="#ä¿®æ”¹æ­¥éª¤" class="headerlink" title="ä¿®æ”¹æ­¥éª¤"></a>ä¿®æ”¹æ­¥éª¤</h2><ol><li>æ›´æ”¹åŸä¸»é¡µé¢çš„ theme çš„ config æ–‡ä»¶ï¼Œå¢åŠ  navbar ç±»åˆ«ï¼ˆä¸åŒä¸»é¢˜è®¾ç½®å­—æ®µä¸åŒï¼‰ï¼›<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Wiki: &#x2F;wiki&#x2F;</span><br></pre></td></tr></table></figure></li><li>ä¸ºäº†é¿å…åœ¨ä¿®æ”¹ wiki é…ç½®æ—¶å½±å“åˆ°ä¸»é¡µé¢ï¼Œå°† root ç›®å½•ä¸‹çš„<code>_config.yml</code>æ–‡ä»¶ï¼ˆå³ç«™ç‚¹é…ç½®æ–‡ä»¶ï¼‰ï¼Œå¤åˆ¶å¹¶é‡å‘½åä¸º<code>_config_wiki.yml</code>ï¼Œä»¥ä¸‹ä¿®æ”¹å‡æŒ‡æ­¤æ–‡ä»¶ã€‚</li><li>å®‰è£… hexo çš„<a href="https://github.com/zthxxx/hexo-theme-Wikitten">Wikitten</a>ä¸»é¢˜ï¼Œå°†å…¶ä½œä¸º wiki é¡µé¢çš„ themeï¼›<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd your-hexo-directory</span><br><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;zthxxx&#x2F;hexo-theme-Wikitten.git themes&#x2F;Wikitten</span><br></pre></td></tr></table></figure>æ­¤å¤–ï¼Œä½ ä¹Ÿå¯ä»¥é€‰ç”¨å…¶ä»–é£æ ¼ wiki ä¸»é¢˜ï¼Œå¦‚ï¼š<a href="https://github.com/wzpan/hexo-theme-wixo">wzpan/hexo-theme-wixo: A wiki theme for Hexo.</a></li><li>å°† Wikitten theme ç›®å½•ä¸‹ clone æ‰€å¾—çš„ source å’Œæ¨¡æ¿ç§»åŠ¨åˆ° root ç›®å½•ä¸‹ï¼Œé‡å‘½åä¸»é¢˜ config ä½¿å…¶ç”Ÿæ•ˆã€‚<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cp -rf themes&#x2F;Wikitten&#x2F;_source&#x2F;* wiki&#x2F;</span><br><span class="line">cp themes&#x2F;Wikitten&#x2F;_scaffolds&#x2F;embed.md scaffolds&#x2F;embed.md</span><br><span class="line">cp themes&#x2F;Wikitten&#x2F;_scaffolds&#x2F;post.md scaffolds&#x2F;wiki.md</span><br><span class="line">cp -f themes&#x2F;Wikitten&#x2F;_config.yml.example themes&#x2F;Wikitten&#x2F;_config.yml</span><br></pre></td></tr></table></figure></li><li>ä¿®æ”¹ wikitten ä¸»é¢˜çš„ configï¼Œæ›´æ”¹èµ„æºæ–‡ä»¶ç›®å½•ï¼Œlogoã€favicon ç­‰ã€‚</li><li>ä¿®æ”¹<code>_config_wiki.yml</code>è®¾å®šä½¿ wikitten ä¸»é¢˜ç”Ÿæ•ˆ<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">- theme: origin</span><br><span class="line">+ theme: Wikitten</span><br><span class="line"></span><br><span class="line">- per_page: 10</span><br><span class="line"></span><br><span class="line">- url: https:&#x2F;&#x2F;masantu.com&#x2F;</span><br><span class="line">- root: &#x2F;</span><br><span class="line">- permalink: :year&#x2F;:month&#x2F;:day&#x2F;:title&#x2F;</span><br><span class="line">+ url: https:&#x2F;&#x2F;masantu.com&#x2F;wiki&#x2F;</span><br><span class="line">+ root: &#x2F;wiki&#x2F;</span><br><span class="line">+ permalink: :title&#x2F;</span><br><span class="line">+ permalink_defaults: :year&#x2F;:month&#x2F;:day&#x2F;:title&#x2F;</span><br><span class="line"></span><br><span class="line">+ skip_render:</span><br><span class="line">+  - README.md</span><br><span class="line"></span><br><span class="line">+ marked:</span><br><span class="line">+   gfm: true</span><br><span class="line"></span><br><span class="line">+ # è®¾ç½®å•ç‹¬çš„sourceæ–‡ä»¶å¤¹ï¼Œç”¨äºæ”¾ç½®wikiçš„æºæ–‡ä»¶</span><br><span class="line">- source_dir: source</span><br><span class="line">+ source_dir: wiki</span><br><span class="line"></span><br><span class="line">+ # è®¾ç½®æ¸²æŸ“åˆ°&#96;public&#x2F;wiki&#x2F;&#96;è·¯å¾„ä¸‹</span><br><span class="line">- public_dir: public</span><br><span class="line">+ public_dir: public&#x2F;wiki</span><br><span class="line"></span><br><span class="line">+ default_layout: wiki</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2></li></ol><h3 id="åˆ›å»ºåˆ«åï¼ˆå¯é€‰ï¼‰"><a href="#åˆ›å»ºåˆ«åï¼ˆå¯é€‰ï¼‰" class="headerlink" title="åˆ›å»ºåˆ«åï¼ˆå¯é€‰ï¼‰"></a>åˆ›å»ºåˆ«åï¼ˆå¯é€‰ï¼‰</h3><p>ä¸»è¦ç›®çš„æ˜¯ç®€åŒ–è¾“å…¥ï¼Œå¦‚æœä¸å«Œéº»çƒ¦ï¼Œå¯ä»¥æ¯æ¬¡è¾“å…¥æŒ‡ä»¤ã€‚</p><ul><li>Linux<br>è§†è‡ªå·±æƒ…å†µè€Œå®šï¼Œåœ¨<code>.zshrc</code>æˆ–è€…<code>.bashrc</code>ç­‰æ–‡ä»¶ä¸­æ–°å¢ alias<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">alias</span> hwk=<span class="string">&quot;hexo --config _config_wiki.yml&quot;</span></span><br></pre></td></tr></table></figure></li><li>windows<figure class="highlight dos"><table><tr><td class="code"><pre><span class="line"><span class="built_in">doskey</span> hwk=hexo --config _config_wiki.yml</span><br></pre></td></tr></table></figure>å‚è§ï¼š<ol><li><a href="https://www.zhihu.com/question/51962577">windows ç³»ç»Ÿå¦‚ä½•ç»™å‘½ä»¤èµ·åˆ«åï¼Ÿ - çŸ¥ä¹</a></li><li><a href="https://www.cnblogs.com/chenjo/p/12550207.html">Windows alias ç»™ cmd å‘½ä»¤èµ·åˆ«å - jetwill - åšå®¢å›­</a></li></ol></li></ul><h3 id="æ–°å»º-wiki"><a href="#æ–°å»º-wiki" class="headerlink" title="æ–°å»º wiki"></a>æ–°å»º wiki</h3><p>å¦‚æœè·³è¿‡ä¸Šæ­¥ï¼Œåˆ™å°†ä¸‹é¢çš„æŒ‡ä»¤ä¸­çš„<code>hwk</code>æ›¿æ¢ä¸º<code>hexo --config _config_wiki.yml</code><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hwk new &quot;xxxx&quot;</span><br></pre></td></tr></table></figure></p><h3 id="æ¸²æŸ“é¡µé¢"><a href="#æ¸²æŸ“é¡µé¢" class="headerlink" title="æ¸²æŸ“é¡µé¢"></a>æ¸²æŸ“é¡µé¢</h3><p>å…±ç”¨ db.jsonï¼ˆçŒœæµ‹ï¼‰ä¼šå¯¼è‡´ä¸»é¡µé¢ blog å†…å®¹ä¸ wiki å†…å®¹æ··æ‚ï¼Œéœ€è¦åœ¨æ¸²æŸ“å‰åè¿›è¡Œ clean æ“ä½œã€‚</p><ol><li>é¦–å…ˆæ¸²æŸ“ä¸»é¡µé¢ï¼Œç”Ÿæˆåˆ°/public/<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hexo g</span><br></pre></td></tr></table></figure></li><li>åˆ é™¤ db.json åŠæ—§çš„ public/wiki<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hwk clean</span><br></pre></td></tr></table></figure></li><li>æ¸²æŸ“ wiki é¡µé¢ï¼Œç”Ÿæˆåˆ°/public/wiki/<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hwk g</span><br></pre></td></tr></table></figure></li><li><p>æ‰‹åŠ¨åˆ é™¤ db.jsonï¼Œ<strong>MUSTï¼</strong></p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">rm db.json</span><br></pre></td></tr></table></figure><p><a href="https://stackoverflow.com/questions/25389051/db-json-file-is-created-and-added-to-gitignore-using-hexo-io">db.json file is created and added to .gitignore using hexo.io - Stack Overflow</a><br><a href="https://johnwonder.github.io/2016/10/17/hexo-flow-second/">hexo æµç¨‹æ¢³ç†ä¹‹ database | johnâ€™s tech blog</a><br>ä»¥ä¸Šæµç¨‹å†™äº†ä¸€æ®µ Python ä»£ç æ¥æµç¨‹åŒ–å¤„ç†ï¼Œç›®å‰ä»…é€‚ç”¨äº Windows å¹³å°ï¼ŒPython3.7 æµ‹è¯•é€šè¿‡ã€‚æºç è§æ­¤ï¼šâœ¨<a href="https://github.com/imoyao/imoyao.github.io/blob/hexo/tools/hexo_wiki_site_gen_all_in_one.py">imoyao.github.io/hexo_wiki_site_gen_all_in_one.py at hexo Â· imoyao/imoyao.github.io</a></p></li><li><p>æŸ¥çœ‹æ•ˆæœ</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hexo s</span><br></pre></td></tr></table></figure><h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2></li><li><p>Wikitten ä¸»é¢˜ä¼šæ ¹æ®ç›®å½•è‡ªåŠ¨ç”Ÿæˆåˆ†ç±»ï¼Œæ‰€ä»¥ä¸å»ºè®®åœ¨æ–‡ç« çš„ front matter ä¸­å†å»å®šä¹‰ categories å­—æ®µï¼Œæˆ–è€…å®šä¹‰ categories ä¹‹åç›´æ¥æ”¾åˆ°é¦–é¡µ index ç›®å½•å³å¯ï¼Œä¸ç„¶å¯èƒ½å¯¼è‡´åˆ†ç±»å‡ºç°é‡åˆã€‚</p></li><li>ä¸ºäº†ä»¥åâ€œåˆ†å®¶â€æ–¹ä¾¿ï¼ˆé™ä½è€¦åˆåº¦ï¼‰ï¼Œå»ºè®®ä¸è¦å’Œä¸»ç«™çš„å›¾ç‰‡ç›®å½•æ”¾åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œæ¯”å¦‚æˆ‘çš„ä¸»ç«™å›¾ç‰‡åœ¨<code>sources/images/</code>æ–‡ä»¶å¤¹ä¸‹ï¼Œåˆ™ wiki çš„å›¾ç‰‡å¯ä»¥æ”¾åˆ°<code>sources/pics/</code>æˆ–è€…<code>sources/imgs/</code>ç›®å½•ä¸‹ï¼Œè¿™æ ·ä»¥åå¦‚æœè¦åšæ‹†åˆ†ï¼Œç›´æ¥å‰ªåˆ‡ç›¸åº”ç›®å½•å³å¯ã€‚å½“ç„¶ï¼Œå¦‚æœä½ ä½¿ç”¨ OSS å­˜å‚¨æˆ–å›¾åºŠæœåŠ¡ï¼Œåˆ™ä¸éœ€è¦è¿™æ ·éº»çƒ¦ã€‚</li></ol><h2 id="å‘ç°é—®é¢˜"><a href="#å‘ç°é—®é¢˜" class="headerlink" title="å‘ç°é—®é¢˜"></a>å‘ç°é—®é¢˜</h2><ol><li>wiki é¡µé¢ä¸­æ–‡é”šç‚¹æ— æ³•ç‚¹å‡»ï¼</li></ol><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://konfido.github.io/2019/03/16/hexo-wiki/">Hexo åŒæ—¶ä½¿ç”¨ä¸¤ç§ä¸»é¢˜</a></p>]]></content>
      
      
      <categories>
          
          <category> åšå®¢ä¸ªæ€§åŒ– </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åšå®¢ </tag>
            
            <tag> Hexo </tag>
            
            <tag> wiki </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è§£å†³åšå®¢ idealyard æ”¯æŒ emoji æ˜¾ç¤ºé—®é¢˜</title>
      <link href="blog/2020-05-15/idealyard-loves-emoji/"/>
      <url>blog/2020-05-15/idealyard-loves-emoji/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><div class="note info modern"><h2 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h2><ol><li>ä»¥ä¸‹æ¼”ç¤ºå†…å®¹åŸºäºæ•°æ®åº“ç‰ˆæœ¬ï¼š<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mysql --version</span><br><span class="line">mysql  Ver 15.1 Distrib 5.5.64-MariaDB, for Linux (x86_64) using readline 5.1</span><br></pre></td></tr></table></figure></li><li>utf8mb4 çš„æœ€ä½ mysql ç‰ˆæœ¬æ”¯æŒç‰ˆæœ¬ä¸º 5.5.3+</li></ol></div><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æˆ‘ä»¬çŸ¥é“è¦æƒ³è®©æ•°æ®åº“å­˜å‚¨æ•°æ®æ”¯æŒ emoji æ˜¾ç¤ºå¿…é¡»å°†æ•°æ®åº“ç¼–ç æ ¼å¼è®¾ç½®ä¸º<code>utf8mb4</code>ï¼Œå¯æ˜¯æˆ‘åœ¨ä»£ç ä¸­ä¿®æ”¹äº†æ•°æ®åº“ç¼–ç è¿˜æ˜¯æœ‰é—®é¢˜ï¼Œå…·ä½“è§æ­¤å¤„ <a href="https://github.com/imoyao/idealyard/issues/6">Issues</a> ï¼Œå½“æ—¶åˆ—å‡ºä¸‹é¢çš„æ€€ç–‘ï¼š</p><ul><li style="list-style: none"><input type="checkbox" checked></input> <del>æ•°æ®åº“è®¾ç½®ä¸º<code>utf8mb4</code>ç¼–ç ï¼›</del></li><li style="list-style: none"><input type="checkbox" checked></input> <del>å•ä¸ªè¡¨æ ¼ç¼–ç æœªè®¾ç½®ä¸º<code>utf8mb4</code>ï¼›</del></li><li style="list-style: none"><input type="checkbox" checked></input> <del>ç”±äºå‰ç«¯ä½¿ç”¨<code>pangujs</code>å¯¼è‡´ä¼ åˆ°åç«¯å·²ç»å‡ºé”™ï¼›</del></li></ul><p>æ˜¨æ™šè¿›è¡Œäº†æ’æŸ¥åŠè§£å†³ï¼Œç°åœ¨è®°å½•ä¸€ä¸‹ã€‚</p><h2 id="æ’æŸ¥"><a href="#æ’æŸ¥" class="headerlink" title="æ’æŸ¥"></a>æ’æŸ¥</h2><ol><li>é¦–å…ˆæŸ¥çœ‹æ•°æ®åº“ç¼–ç æ ¼å¼<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">MariaDB [iyblog_product]<span class="operator">&gt;</span> <span class="keyword">show</span> <span class="keyword">create</span> database iyblog_product;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+----------------------------------------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> Database       <span class="operator">|</span> <span class="keyword">Create</span> Database                                                            <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+----------------------------------------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> iyblog_product <span class="operator">|</span> <span class="keyword">CREATE</span> DATABASE `iyblog_product` <span class="comment">/*!40100 DEFAULT CHARACTER SET utf8mb4 */</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+----------------------------------------------------------------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure></li><li>æŸ¥çœ‹ç›¸åº”è¡¨çš„æ•°æ®æ ¼å¼<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">MariaDB [iyblog_product]<span class="operator">&gt;</span> <span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> iy_article;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*çœç•¥*/</span></span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">15</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 <span class="operator">|</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>å…¶å®æ­¤å¤„å¤šä½™ï¼Œå› ä¸ºä»£ç é‡Œæœ‰å¦‚ä¸‹å®šä¹‰ï¼š<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MySQLConfig</span>:</span></span><br><span class="line">    MYSQL_USERNAME = os.getenv(<span class="string">&#x27;MYSQL_USER&#x27;</span>)</span><br><span class="line">    MYSQL_PASSWORD = os.getenv(<span class="string">&#x27;MYSQL_PASSWORD&#x27;</span>)</span><br><span class="line">    MYSQL_HOST = <span class="string">&#x27;localhost:3306&#x27;</span></span><br><span class="line">    MYSQL_CHARSET = <span class="string">&#x27;utf8mb4&#x27;</span>  <span class="comment"># ä¸ºäº†æ”¯æŒ emoji æ˜¾ç¤ºï¼Œéœ€è¦è®¾ç½®ä¸º utf8mb4 ç¼–ç </span></span><br></pre></td></tr></table></figure><h2 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h2>ä¹‹åé€šè¿‡æœç´¢çŸ¥é“é™¤äº†æŠŠæ•°æ®åº“å’Œè¡¨æ ¼è®¾ç½®ä¸ºæ­£ç¡®ç¼–ç ï¼Œè¿˜è¦ä¿®æ”¹æ•°æ®åº“é…ç½®ã€‚</li></ol><h3 id="å®¢æˆ·ç«¯é…ç½®"><a href="#å®¢æˆ·ç«¯é…ç½®" class="headerlink" title="å®¢æˆ·ç«¯é…ç½®"></a>å®¢æˆ·ç«¯é…ç½®</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">vi /etc/my.cnf.d/client.cnf </span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#</span><br><span class="line"># These two groups are read by the client library</span><br><span class="line"># Use it for options that affect all clients, but not the server</span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[client]</span><br><span class="line">default-character-set &#x3D; utf8mb4     # æ·»åŠ æ­¤è¡Œ</span><br><span class="line"># This group is not read by mysql client library,</span><br><span class="line"># If you use the same .cnf file for MySQL and MariaDB,</span><br><span class="line"># use it for MariaDB-only client options</span><br><span class="line">[client-mariadb]</span><br></pre></td></tr></table></figure><h3 id="æœåŠ¡ç«¯é…ç½®"><a href="#æœåŠ¡ç«¯é…ç½®" class="headerlink" title="æœåŠ¡ç«¯é…ç½®"></a>æœåŠ¡ç«¯é…ç½®</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vi /etc/my.cnf.d/server.cnf</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#</span><br><span class="line"># These groups are read by MariaDB server.</span><br><span class="line"># Use it for options that only the server (but not clients) should see</span><br><span class="line">#</span><br><span class="line"># See the examples of server my.cnf files in &#x2F;usr&#x2F;share&#x2F;mysql&#x2F;</span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"># this is read by the standalone daemon and embedded servers</span><br><span class="line">[server]</span><br><span class="line"># this is only for the mysqld standalone daemon</span><br><span class="line">[mysqld]                # æ­¤è¡Œå¼€å§‹</span><br><span class="line">character-set-client-handshake &#x3D; FALSE</span><br><span class="line">character-set-server &#x3D; utf8mb4  </span><br><span class="line">collation-server &#x3D; utf8mb4_unicode_ci</span><br><span class="line">init_connect&#x3D;&#39;SET NAMES utf8mb4&#39;</span><br><span class="line"></span><br><span class="line"># this is only for embedded server</span><br><span class="line">[embedded]</span><br><span class="line"></span><br><span class="line"># This group is only read by MariaDB-5.5 servers.</span><br><span class="line"># If you use the same .cnf file for MariaDB of different versions,</span><br><span class="line"># use this group for options that older servers don&#39;t understand</span><br><span class="line">[mysqld-5.5]</span><br><span class="line"></span><br><span class="line"># These two groups are only read by MariaDB servers, not by MySQL.</span><br><span class="line"># If you use the same .cnf file for MySQL and MariaDB,</span><br><span class="line"># you can put MariaDB-only options here</span><br><span class="line">[mariadb]</span><br><span class="line">[mariadb-5.5]</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="é‡å¯-Mariadb-ä½¿é…ç½®ç”Ÿæ•ˆ"><a href="#é‡å¯-Mariadb-ä½¿é…ç½®ç”Ÿæ•ˆ" class="headerlink" title="é‡å¯ Mariadb ä½¿é…ç½®ç”Ÿæ•ˆ"></a>é‡å¯ Mariadb ä½¿é…ç½®ç”Ÿæ•ˆ</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">systemctl restart mariadb   # å¦‚æœæ˜¯mysqléœ€è¦èµ·ç›¸åº”æœåŠ¡</span><br></pre></td></tr></table></figure><h3 id="éªŒè¯"><a href="#éªŒè¯" class="headerlink" title="éªŒè¯"></a>éªŒè¯</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">MariaDB [iyblog_product]<span class="operator">&gt;</span> <span class="keyword">SHOW</span> VARIABLES <span class="keyword">WHERE</span> Variable_name <span class="keyword">LIKE</span> <span class="string">&#x27;character_set_%&#x27;</span> <span class="keyword">OR</span> Variable_name <span class="keyword">LIKE</span> <span class="string">&#x27;collation%&#x27;</span>;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">+--------------------------+----------------------------+</span><br><span class="line">| Variable_name            | Value                      |</span><br><span class="line">+--------------------------+----------------------------+</span><br><span class="line">| character_set_client     | utf8mb4                    |</span><br><span class="line">| character_set_connection | utf8mb4                    |</span><br><span class="line">| character_set_database   | utf8mb4                    |</span><br><span class="line">| character_set_filesystem | binary                     |</span><br><span class="line">| character_set_results    | utf8mb4                    |</span><br><span class="line">| character_set_server     | utf8mb4                    |</span><br><span class="line">| character_set_system     | utf8                       |</span><br><span class="line">| character_sets_dir       | &#x2F;usr&#x2F;share&#x2F;mysql&#x2F;charsets&#x2F; |</span><br><span class="line">| collation_connection     | utf8mb4_general_ci         |</span><br><span class="line">| collation_database       | utf8mb4_general_ci         |</span><br><span class="line">| collation_server         | utf8mb4_unicode_ci         |</span><br><span class="line">+--------------------------+----------------------------+</span><br><span class="line">11 rows in set (0.04 sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¿…é¡»ä¿è¯ä¸‹é¢çš„å˜é‡ç¼–ç æ˜¯<code>utf8mb4</code>æ ¼å¼ã€‚<br><table>  <tbody>    <tr>      <th>ç³»ç»Ÿå˜é‡</th>      <th>æè¿°</th>    </tr>    <tr>      <td>character_set_client</td>      <td>(å®¢æˆ·ç«¯æ¥æºæ•°æ®ä½¿ç”¨çš„å­—ç¬¦é›†)</td>    </tr>    <tr>      <td>character_set_connection</td>      <td>(è¿æ¥å±‚å­—ç¬¦é›†)</td>    </tr>    <tr>      <td>character_set_database</td>      <td>(å½“å‰é€‰ä¸­æ•°æ®åº“çš„é»˜è®¤å­—ç¬¦é›†)</td>    </tr>    <tr>      <td>character_set_results</td>      <td>(æŸ¥è¯¢ç»“æœå­—ç¬¦é›†)</td>    </tr>    <tr>      <td>character_set_server</td>      <td>(é»˜è®¤çš„å†…éƒ¨æ“ä½œå­—ç¬¦é›†)</td>    </tr>  </tbody></table></p><p>å®é™…éªŒè¯ä¸€ä¸‹ï¼š<br><img src= "/img/loading.svg" data-lazy-src="/images/idealyard-emoji.png" alt="emoji"></p><p>æœ€åæˆ‘ä»¬å‘ç°äº†ä¸€ä¸ªæ–°é—®é¢˜ï¼ˆTODOï¼‰ï¼š<br>é“¾æ¥çš„ slug ä¸­ç›´æ¥æŠŠ emoji ä¹Ÿç»™æ˜¾ç¤ºå‡ºæ¥äº†ï¼Œæ­¤å¤„éœ€è¦å¯¹ emoji è¿›è¡Œè¿‡æ»¤æˆ–è€…è½¬æ¢ä¸ºå­—ç¬¦å•è¯ã€‚</p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://www.jb51.net/article/144079.htm">mysql å­˜å‚¨ emoji è¡¨æƒ…æŠ¥é”™çš„å¤„ç†æ–¹æ³•ã€æ›´æ”¹ç¼–ç ä¸º utf8mb4ã€‘<em>Mysql</em>è„šæœ¬ä¹‹å®¶</a></p>]]></content>
      
      
      <categories>
          
          <category> Projects </category>
          
          <category> IdealYard </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åšå®¢ </tag>
            
            <tag> idealyard </tag>
            
            <tag> utf8mb4 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸é—®è‰²å· | å£çº¢è‰²å·è·å–ä¹‹çƒˆè‰³è“é‡‘ç³»åˆ—</title>
      <link href="blog/2020-05-10/GUSCSS-lipstick-xiji-lylj/"/>
      <url>blog/2020-05-10/GUSCSS-lipstick-xiji-lylj/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>åœ¨é¡¹ç›® <code>ç»™ä½ ç‚¹é¢œè‰²ç§ç§|GUSCSS</code> çš„ <a href="https://colors.masantu.com/#/lipsticks">ä¸é—®è‰²å·</a> æ¨¡å—ä¸­ï¼Œéœ€è¦æ”¶é›†å£çº¢çš„é¢œè‰²ï¼Œæœ¬æ–‡ä»¥è¥¿é›†ç½‘çƒˆç„°è“é‡‘ç³»åˆ—å”‡è†ä¸ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•é€šè¿‡ç®€å•çš„çˆ¬è™«è·å–å›¾ç‰‡ï¼Œä¹‹åä½¿ç”¨ OCR æŠ€æœ¯å¯¹å›¾ç‰‡æ–‡å­—è¿›è¡Œè¯†åˆ«ï¼ŒåŒæ—¶è·å–å›¾ç‰‡ç‰¹å¾é¢œè‰²éƒ¨åˆ†ä½œä¸ºå£çº¢çš„ RGB è‰²å€¼ã€‚</p><h2 id="ä½¿ç”¨-urllib-request-è·å–ç½‘é¡µ"><a href="#ä½¿ç”¨-urllib-request-è·å–ç½‘é¡µ" class="headerlink" title="ä½¿ç”¨ urllib.request è·å–ç½‘é¡µ"></a>ä½¿ç”¨ urllib.request è·å–ç½‘é¡µ</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import urllib.request</span><br><span class="line">from backend import settings</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_html(url):</span><br><span class="line">    response &#x3D; urllib.request.urlopen(url)  # å‘å‡ºè¯·æ±‚å¹¶ä¸”æ¥æ”¶è¿”å›æ–‡æœ¬å¯¹è±¡</span><br><span class="line">    html &#x3D; response.read()  # è°ƒç”¨read()è¿›è¡Œè¯»å–</span><br><span class="line">    return html</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;:</span><br><span class="line">    url &#x3D; settings.DIOR_LYLJ_URL</span><br><span class="line">    print(get_html(url))</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="è¿”å›ç»“æœ"><a href="#è¿”å›ç»“æœ" class="headerlink" title="è¿”å›ç»“æœ"></a>è¿”å›ç»“æœ</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">  File &quot;&#x2F;usr&#x2F;local&#x2F;lib&#x2F;python3.7&#x2F;urllib&#x2F;request.py&quot;, line 649, in http_error_default</span><br><span class="line">    raise HTTPError(req.full_url, code, msg, hdrs, fp)</span><br><span class="line">urllib.error.HTTPError: HTTP Error 403: Forbidden</span><br><span class="line"></span><br><span class="line">Process finished with exit code 1</span><br></pre></td></tr></table></figure><p><img src= "/img/loading.svg" data-lazy-src="/images/Snipaste_2020-05-07_22-56-56.png" alt="å…¬å…±å•æ‰€å’©Â·ç”µå½±ã€Šç–¯ç‹‚çš„çŸ³å¤´ã€‹"></p><p>è¿™ä¹ˆå†™ï¼Œä¸€èˆ¬ç½‘ç«™æ˜¯ä¸ä¼šè®©ä½ çœ‹çš„ã€‚å› ä¸ºæ­£å¸¸çš„ç”¨æˆ·è®¿é—®ä¼šå¸¦æµè§ˆå™¨çš„è¯·æ±‚å¤´ï¼Œè€Œæˆ‘ä»¬ç”¨ç¨‹åºè®¿é—®æ—¶æ²¡æœ‰è¯·æ±‚å¤´ï¼Œç½‘ç«™çŸ¥é“æˆ‘ä»¬æ˜¯â€œåƒåœ¾è¯·æ±‚â€ï¼Œåªä¼šç™½ç™½æ¶ˆè€—æµé‡ï¼Œæ‰€ä»¥æ‹’ç»ä¸ºæˆ‘ä»¬è¿™æ ·çš„è¯·æ±‚æœåŠ¡ã€‚</p><h2 id="é‡åˆ°-403-æ€ä¹ˆåŠ"><a href="#é‡åˆ°-403-æ€ä¹ˆåŠ" class="headerlink" title="é‡åˆ° 403 æ€ä¹ˆåŠ"></a>é‡åˆ° 403 æ€ä¹ˆåŠ</h2><p>ä¸ºäº†è·å–åˆ°æ•°æ®ï¼Œæˆ‘ä»¬è¦å°†ç¨‹åºä¼ªè£…æˆâ€œæ­£ç»äººâ€ï¼Œå‘Šè¯‰ç½‘ç«™ï¼šæˆ‘æ¥ç»™ä½ ä»¬é€é’±äº†ï¼Œè®©æˆ‘è¿›å»åº·åº·å§ï¼Ÿ<br><img src= "/img/loading.svg" data-lazy-src="/images/urllib-headers.gif" alt="headers ä½œç”¨ï¼ˆç©¿ä¸Šç‡•å°¾æœå†å»å‚åŠ ï¼‰Â·ç”µå½±ã€ŠèµŒä¾ ã€‹"></p><p>äºæ˜¯ï¼Œæˆ‘ä»¬æˆ´ä¸Š<code>headers</code>çš„è£…æ‰®ï¼Œé—¨å£ä¿å®‰ä¸€çœ‹ï¼šè¿™ä½æ²¡é—®é¢˜ï¼Œè¿›æ¥å§ã€‚ç¨‹åºå°±é¡ºåˆ©åœ°è¿›å»äº†ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.request <span class="keyword">import</span> urlopen,Request</span><br><span class="line"></span><br><span class="line">DIOR_LYLJ_URL = <span class="string">&#x27;https://www.xiji.com/product-127266.html&#x27;</span></span><br><span class="line">HEADERS = &#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4121.0 Safari/537.36 Edg/84.0.495.2&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_html</span>(<span class="params">url</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        çˆ¬å–ä¸€æ¬¡ä¹‹åï¼Œä¿å­˜ç½‘é¡µåˆ°æœ¬åœ°</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        content = Request(url, headers=HEADERS)</span><br><span class="line">        response = urlopen(content, timeout=<span class="number">10</span>)</span><br><span class="line">        html = response.read()  <span class="comment"># è°ƒç”¨read()è¿›è¡Œè¯»å–</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;../../_data/xiji/products.html&#x27;</span>, <span class="string">&#x27;wb+&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(html)</span><br><span class="line">        <span class="keyword">return</span> html</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    print(get_html(DIOR_LYLJ_URL))</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¯»å–åˆ°çš„å†…å®¹ä¸æˆ‘ä»¬é¼ æ ‡å³é”®è¯»å–ç½‘é¡µæºç æ‰€è·å–åˆ°çš„æ•°æ®å®è´¨æ˜¯ä¸€æ ·çš„ã€‚</p><h2 id="åˆ©ç”¨-lxml-ä½¿ç”¨-xPath-è§£æç½‘é¡µ"><a href="#åˆ©ç”¨-lxml-ä½¿ç”¨-xPath-è§£æç½‘é¡µ" class="headerlink" title="åˆ©ç”¨ lxml ä½¿ç”¨ xPath è§£æç½‘é¡µ"></a>åˆ©ç”¨ lxml ä½¿ç”¨ xPath è§£æç½‘é¡µ</h2><p>è·å–åˆ°ç½‘ç«™æºç ä¹‹åï¼Œæˆ‘ä»¬ä½¿ç”¨ xpath è§„åˆ™å¯¹ç›®æ ‡å…ƒç´ è¿›è¡Œæå–ã€‚<br><img src= "/img/loading.svg" data-lazy-src="/images/Snipaste_2020-05-10_11-40-57.png" alt="xPath æå–é¡µé¢ç›®æ ‡å…ƒç´ "><br>ä¾æ¬¡è·å–åˆ°é¡µé¢ä¸­è¯¥ç³»åˆ—é“¾æ¥ã€ç¼–å·ã€åç§°ï¼Œä¹‹åå¯¹å›¾ç‰‡è¿›è¡Œæå–å¹¶ä¿å­˜åˆ°æœ¬åœ°ã€‚<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line"><span class="keyword">from</span> urllib.request <span class="keyword">import</span> urlopen, Request</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LYLJ</span>:</span></span><br><span class="line">    DIOR_LYLJ_URL = <span class="string">&#x27;https://www.xiji.com/product-127266.html&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_item_element_tree</span>(<span class="params">item_url</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        ç»™å‡ºç½‘é¡µåœ°å€ï¼Œè·å¾—ç½‘é¡µä¿¡æ¯</span></span><br><span class="line"><span class="string">        :param item_url:</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        content = Request(item_url, headers=HEADERS)</span><br><span class="line">        response = urlopen(content, timeout=<span class="number">10</span>)</span><br><span class="line">        html = response.read()  <span class="comment"># è°ƒç”¨read()è¿›è¡Œè¯»å–</span></span><br><span class="line">        result = etree.HTML(html)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">load_content</span>(<span class="params">self</span>):</span></span><br><span class="line">        result = self.get_item_element_tree(DIOR_LYLJ_URL)</span><br><span class="line">        links = result.xpath(<span class="string">&#x27;//*[@id=&quot;product_spec&quot;]/ul/li/span[2]/ul/li/a/@href&#x27;</span>)</span><br><span class="line">        item_ids = result.xpath(<span class="string">&#x27;//*[@id=&quot;product_spec&quot;]/ul/li/span[2]/ul/li/a/@rel&#x27;</span>)</span><br><span class="line">        names = result.xpath(<span class="string">&#x27;//*[@id=&quot;product_spec&quot;]/ul/li/span[2]/ul/li/a/span&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        dir_name = self.mk_dir()</span><br><span class="line"></span><br><span class="line">        img_src_list = []  <span class="comment"># å¯¹å½“å‰é¡µå•ç‹¬å¤„ç†</span></span><br><span class="line">        img_src = self.get_image_src(result)</span><br><span class="line">        current_id = self.current_item_id()</span><br><span class="line">        self.save_image(img_src, dir_name, current_id)</span><br><span class="line">        img_src_list.append(img_src)</span><br><span class="line"></span><br><span class="line">        current_names = [name.text <span class="keyword">for</span> name <span class="keyword">in</span> names]</span><br><span class="line">        links.pop(<span class="number">0</span>)  <span class="comment"># ç§»é™¤ç¬¬ä¸€ä¸ªscript</span></span><br><span class="line">        print(<span class="string">&#x27;Start get detailsâ€¦â€¦&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> img_id, link <span class="keyword">in</span> <span class="built_in">zip</span>(item_ids, links):</span><br><span class="line">            real_link = self.join_link(link)</span><br><span class="line">            result = self.get_item_element_tree(real_link)</span><br><span class="line">            img_src = self.get_image_src(result)</span><br><span class="line">            self.save_image(img_src, dir_name, img_id)</span><br><span class="line">            img_src_list.append(img_src)</span><br><span class="line"></span><br><span class="line">        item_ids.insert(<span class="number">0</span>, current_id)</span><br><span class="line">        <span class="keyword">return</span> item_ids, current_names, img_src_list</span><br></pre></td></tr></table></figure><br><div class="note danger modern"><p><strong>æ³¨æ„</strong>ï¼š<br>å¦‚æœé‡åˆ°æŠ¥é”™<code>lxml.etree.XMLSyntaxError: Opening and ending tag mismatch: link line 14 and head, line 15, column 182</code>æ˜¯å› ä¸ºç½‘é¡µä¸­ html è¯­æ³•ä¸è§„èŒƒï¼Œå¦‚æœ¬ä¾‹ä¸­çš„<code>&lt;link rel=&quot;stylesheet&quot; href=&quot;https://img0.xiji.com/themes/ecstore/images/styles_ex.css?d2019110801&quot;&gt;</code>åº”è¯¥æ˜¯è‡ªé—­æ ‡ç­¾ã€‚</p></div></p><p>æˆ‘ä»¬å¯ä»¥æ·»åŠ è§£æå™¨ï¼š<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">parser = etree.HTMLParser(encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">html = etree.parse(<span class="string">&#x27;../../_data/xiji/products.html&#x27;</span>, parser=parser)</span><br></pre></td></tr></table></figure><br>çˆ¬å–åˆ°çš„å›¾ç‰‡æ•°æ®å¦‚ä¸‹ï¼š<br><div class="justified-gallery"><p><img src= "/img/loading.svg" data-lazy-src="/images/Snipaste_2020-05-10_11-50-52.png" alt="ç½‘é¡µ"><br><img src= "/img/loading.svg" data-lazy-src="/images/Snipaste_2020-05-10_11-48-38.png" alt="æœ¬åœ°"></p>          </div></p><h2 id="æ•°æ®å¤„ç†"><a href="#æ•°æ®å¤„ç†" class="headerlink" title="æ•°æ®å¤„ç†"></a>æ•°æ®å¤„ç†</h2><p>è·å–æ•°æ®å®Œæˆï¼Œä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬éœ€è¦å¯¹å›¾ç‰‡è¿›è¡Œåˆ†æï¼Œå€ŸåŠ©<code>Pillow</code>è¯†åˆ«å£çº¢è‰²å·çš„ RGB è‰²å€¼ï¼Œä½¿ç”¨ <a href="/blog/2020-05-01/python-OCR/">ç™¾åº¦ OCR æ¥å£</a> è¯†åˆ«å›¾ç‰‡ä¸‹æ–¹çš„æ¨èè¯ä½œä¸ºå•ä¸ªè‰²å·çš„æè¿°ã€‚å…·ä½“å®ç°å‚è€ƒæºç <br>æœ€åè¿”å›çš„çš„å¤„ç†ç»“æœå¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[&#123;&#39;id&#39;: &#39;127266&#39;, &#39;name&#39;: &#39;#520&#39;,</span><br><span class="line">      &#39;src&#39;: &#39;https:&#x2F;&#x2F;img0.xiji.com&#x2F;images&#x2F;19&#x2F;01&#x2F;5b96671ae769403827ec84b8200805abb36a40a0.jpg?1577773530#w&#39;,</span><br><span class="line">      &#39;rgb&#39;: (247, 0, 83), &#39;subtile&#39;: &#39;çˆ±æƒ…æ°´çº¢æ‹çˆ±ä¸­çš„ç²‰çº¢&#39;, &#39;desc&#39;: &#39;è¿™æ˜¯ä¸€æ”¯éå¸¸æœ‰å¯“æ„çš„å£çº¢,520æˆ‘çˆ±ä½ ,è¡¨ç™½ä¸“å±è‰²ã€‚è¿™æ˜¯æ•£å‘ç€æ‹çˆ±ä¸­ç²‰çº¢æ³¡æ³¡çš„é¢œè‰²,æš§æ˜§ã€çƒ­æ‹,éƒ½æ´‹æº¢åœ¨å”‡é—´ã€‚&#39;&#125;,</span><br><span class="line">     &#123;&#39;id&#39;: &#39;127267&#39;, &#39;name&#39;: &#39;#080&#39;,</span><br><span class="line">      &#39;src&#39;: &#39;https:&#x2F;&#x2F;img3.xiji.com&#x2F;images&#x2F;19&#x2F;01&#x2F;cf3cc958da0bc2b3715b69038ad417ef29523110.jpg?1577773529#w&#39;,</span><br><span class="line">      &#39;rgb&#39;: (220, 2, 3), &#39;subtile&#39;: &#39;å¾®ç¬‘æ­£çº¢æ˜¥æ™šåŒæ¬¾è‰²&#39;, &#39;desc&#39;: &#39;è¿™æ¬¾ä¹Ÿæ˜¯æ­£çº¢åæ©˜çš„è‰²è°ƒ,çº¢å¤šæ©˜å°‘,åƒæ˜¯è¡€æ©™çš„é¢œè‰²,æ¸…æ–°è¯±äºº,æ›´é€‚åˆæ—¥å¸¸ä½¿ç”¨ã€‚æ»‹æ¶¦è´¨åœ°,å¯¹å”‡éƒ¨éå¸¸å‹å¥½ã€‚&#39;&#125;,</span><br><span class="line">     &#123;&#39;id&#39;: &#39;127268&#39;, &#39;name&#39;: &#39;#740&#39;,</span><br><span class="line">      &#39;src&#39;: &#39;https:&#x2F;&#x2F;img3.xiji.com&#x2F;images&#x2F;19&#x2F;01&#x2F;12248f21bf2a429cce01b41fcfd79b232f391e70.jpg?1577773531#w&#39;,</span><br><span class="line">      &#39;rgb&#39;: (181, 46, 24), &#39;subtile&#39;: &#39;è„æ©˜è‰²å—ç“œè‰²ç™¾æ­&#39;, &#39;desc&#39;: &#39;ç½‘çº¢äººæ°”çˆ†æ¬¾,å®åŠ›æ˜¾ç™½,é€äººé€ç¤¼ä½³å“,è¿™æ”¯å£çº¢çœŸçš„æ˜¯äººè§äººçˆ±,åšæ¶‚ä¹Ÿå¯ä»¥holdä½!&#39;&#125;,</span><br><span class="line">     &#123;&#39;id&#39;: &#39;127269&#39;, &#39;name&#39;: &#39;#888&#39;,</span><br><span class="line">      &#39;src&#39;: &#39;https:&#x2F;&#x2F;img1.xiji.com&#x2F;images&#x2F;19&#x2F;01&#x2F;003d9dd19d6612a42b107f427cea2a534c851c42.jpg?1577773531#w&#39;,</span><br><span class="line">      &#39;rgb&#39;: (220, 29, 36), &#39;subtile&#39;: &#39;ç«ç„°å¼€è¿è‰²&#39;, &#39;desc&#39;: &#39;888å‘å‘å‘,è®©äººæƒ³åˆ°çƒ­çƒˆçš„ç«ç„°,çº¢çº¢ç«ç«ã€‚å¦‚æœè§‰å¾—æ­£çº¢å¤ªè‰³ä¸½å¤§å¯é€‰æ‹©è¿™æ¬¾,æ­£çº¢åæ©˜,éå¸¸æ˜¾ç™½æœ‰æ´»åŠ›ã€‚&#39;&#125;,</span><br><span class="line">     &#123;&#39;id&#39;: &#39;127270&#39;, &#39;name&#39;: &#39;#999é‡‘å±&#39;,</span><br><span class="line">      &#39;src&#39;: &#39;https:&#x2F;&#x2F;img4.xiji.com&#x2F;images&#x2F;19&#x2F;01&#x2F;fea134055f2050c0a3c9ad992529aa377b0a722f.jpg?1577773532#w&#39;,</span><br><span class="line">      &#39;rgb&#39;: (168, 15, 9), &#39;subtile&#39;: &#39;äººé±¼å§¬æ­£çº¢&#39;, &#39;desc&#39;: &#39;å·²ç»æœ‰999çš„å°ä»™å¥³ä¸€å®šä¸èƒ½é”™è¿‡è¿™æ¬¾é‡‘å±å…‰æ­£çº¢,åå…‰çš„å¾®é—ªäººé±¼å§¬è‰²åœ¨é˜³å…‰ä¸‹ä¸çµä¸çµçš„,éå¸¸å¯Œæœ‰å±‚æ¬¡æ„Ÿã€‚&#39;&#125;,</span><br><span class="line">     &#123;&#39;id&#39;: &#39;127271&#39;, &#39;name&#39;: &#39;#999æ»‹æ¶¦&#39;,</span><br><span class="line">      &#39;src&#39;: &#39;https:&#x2F;&#x2F;img0.xiji.com&#x2F;images&#x2F;19&#x2F;01&#x2F;6efcdf3646ab405e003d3feefa2d463ac20b9d3a.jpg?1577773534#w&#39;,</span><br><span class="line">      &#39;rgb&#39;: (201, 2, 5), &#39;subtile&#39;: &#39;ç»å…¸æ­£çº¢è‰²&#39;, &#39;desc&#39;: &#39;é¢œè‰²æœ€çº¯æ­£çš„ä¸€æ¬¾æ­£çº¢è‰²,ä¸æŒ‘è‚¤è‰²,å–œåº†ç‰¹åˆ«æ˜¾æ°”è´¨ã€‚å˜´å”‡çŠ¶æ€ä¸å¥½çš„å°ä»™å¥³ä¸€å®šè¦é€‰è¿™æ¬¾,èƒ½è®©å”‡å¦†çœ‹èµ·æ¥æ›´ç¾è…»~&#39;&#125;,</span><br><span class="line">     &#123;&#39;id&#39;: &#39;127272&#39;, &#39;name&#39;: &#39;#999å“‘å…‰&#39;,</span><br><span class="line">      &#39;src&#39;: &#39;https:&#x2F;&#x2F;img1.xiji.com&#x2F;images&#x2F;19&#x2F;01&#x2F;ae4fa46845a4db70dc8fe02ed4faa214de12ad1c.jpg?1577773533#w&#39;,</span><br><span class="line">      &#39;rgb&#39;: (190, 18, 14), &#39;subtile&#39;: &#39;ç»å…¸æ­£çº¢è‰²&#39;, &#39;desc&#39;: &#39;æä½³ç¦å¢™è£‚æ¨èçš„ä¸€ä¸ªè‰²å·,æ¯ä¸ªå¥³äººéƒ½å¿…é¡»æ‹¥æœ‰,æ¶‚ä¸Šæ°”åœºä¸¤ç±³å…«!å“‘å…‰è´¨åœ°,ä¸åæ©˜ä¹Ÿä¸åç«,åšæ¶‚è–„æ¶‚éƒ½ç¾åˆ°çˆ†ç‚¸!&#39;&#125;]</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> Projects </category>
          
          <category> GUSCSS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> çˆ¬è™« </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•ç”¨ Python è¯†åˆ«å›¾ç‰‡æ–‡å­—ï¼ˆåŸºäºç™¾åº¦ OCR APIï¼‰</title>
      <link href="blog/2020-05-01/python-OCR/"/>
      <url>blog/2020-05-01/python-OCR/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><p>åšé¡¹ç›®çš„æ—¶å€™éœ€è¦ç”¨åˆ°æ–‡å­—è¯†åˆ«åŠŸèƒ½ï¼Œä»¥ä¸‹æ˜¯å¯¹ä¸€äº›æ–¹æ¡ˆçš„å®è·µï¼Œæœ€åé€‰æ‹©äº†<a href="https://ai.baidu.com/ai-doc/OCR/Ek3h7yeiq">ç™¾åº¦æ–‡å­—è¯†åˆ« API</a>ï¼Œå…¶ä»–çš„è¦ä¹ˆæ˜¯äº‘æœåŠ¡å™¨å†…å­˜å¤ªå°ï¼Œè¦ä¹ˆæ˜¯ CPU å¤ªä½ï¼Œæ²¡æ³•ç”¨ã€‚è¿˜æ˜¯ç›´æ¥æ‰¾æœ€ç®€å•å¿«æ·çš„åŠæ³•ã€‚</p><h2 id="ç™¾åº¦æ–‡å­—è¯†åˆ«-api"><a href="#ç™¾åº¦æ–‡å­—è¯†åˆ«-api" class="headerlink" title="ç™¾åº¦æ–‡å­—è¯†åˆ« api"></a>ç™¾åº¦æ–‡å­—è¯†åˆ« api</h2><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pip install baidu-aip</span><br></pre></td></tr></table></figure><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> aip <span class="keyword">import</span> AipOcr</span><br><span class="line"><span class="keyword">from</span> backend <span class="keyword">import</span> secrets</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BaiduOCR</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.client = AipOcr(secrets.APP_ID, secrets.API_KEY, secrets.SECRET_KEY)</span><br><span class="line">        self.options = &#123;<span class="string">&quot;language_type&quot;</span>: <span class="string">&quot;CHN_ENG&quot;</span>, <span class="string">&quot;detect_direction&quot;</span>: <span class="string">&quot;true&quot;</span>, <span class="string">&quot;detect_language&quot;</span>: <span class="string">&quot;true&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;probability&quot;</span>: <span class="string">&quot;true&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_file_content</span>(<span class="params">file_path</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        è¯»å–å›¾ç‰‡</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> fp:</span><br><span class="line">            <span class="keyword">return</span> fp.read()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">basic_parse</span>(<span class="params">self, fp</span>):</span></span><br><span class="line">        image = self.get_file_content(fp)</span><br><span class="line">        ret = self.client.basicGeneral(image)</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">main</span>(<span class="params">self, fp</span>):</span></span><br><span class="line">        ret_data = self.basic_parse(fp)</span><br><span class="line">        <span class="keyword">return</span> ret_data</span><br><span class="line">        </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    fp = <span class="string">&#x27;../../_data/lipsticks/mp_test.png&#x27;</span> <span class="comment"># æµ‹è¯•è¯†åˆ«æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">    bd_ocr = BaiduOCR()</span><br><span class="line">    ret_data = bd_ocr.main(fp)</span><br><span class="line">    print(ret_data)</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœ<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;&#39;log_id&#39;: 2510103433725039650, &#39;words_result_num&#39;: 2, &#39;words_result&#39;: [&#123;&#39;words&#39;: &#39;Â·å¾®ä¿¡æœä¸€æœ&#39;&#125;, &#123;&#39;words&#39;: &#39;Qä¸‰å‚»çš„ç¼–ç¨‹ç”Ÿæ´»&#39;&#125;]&#125;</span><br></pre></td></tr></table></figure><br><div class="note warning modern"><p><strong>æ³¨æ„</strong>ï¼šä¼°è®¡æ˜¯åŸå›¾å¸¦æœ‰äºŒç»´ç ï¼Œæ‰€ä»¥å¯¼è‡´è¯†åˆ«è¶…æ—¶ï¼Œè¿”å›<code>requests.exceptions.ConnectionError: (&#39;Connection aborted.&#39;, timeout(&#39;The write operation timed out&#39;))</code>ï¼›è€Œæˆ‘ä»¬æ‰‹åŠ¨ç»™äºŒç»´ç æ‰“ç ä¹‹åï¼Œæ‰å¯ä»¥æ­£å¸¸è¯†åˆ«ã€‚</p></div></p><p>æµ‹è¯•å›¾ç‰‡<br><img src= "/img/loading.svg" data-lazy-src="/images/mp.png" alt="ä¸å¯è¯†åˆ«"><br><img src= "/img/loading.svg" data-lazy-src="/images/mp_test.png" alt="å¯è¯†åˆ«"></p><h3 id="å†æ¥ä¸€é"><a href="#å†æ¥ä¸€é" class="headerlink" title="å†æ¥ä¸€é"></a>å†æ¥ä¸€é</h3><p>è°ƒç”¨è¿œç¨‹ url å›¾ç‰‡ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">basic_parse_url</span>(<span class="params">self, url</span>):</span></span><br><span class="line">    ret = self.client.basicGeneralUrl(url, self.options)</span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"></span><br><span class="line">    bd_ocr = BaiduOCR()</span><br><span class="line">    url = <span class="string">&#x27;http://img4.xiji.com/images/19/01/6efcdf3646ab405e003d3feefa2d463ac20b9d3a.jpg&#x27;</span></span><br><span class="line">    url_ret_data = bd_ocr.basic_parse_url(url)</span><br><span class="line">    print(url_ret_data)</span><br></pre></td></tr></table></figure><p>è¿”å›ç»“æœ<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;&#39;log_id&#39;: 8559002589980060578, &#39;direction&#39;: 0, &#39;words_result_num&#39;: 4, &#39;words_result&#39;: [&#123;&#39;words&#39;: &#39;è¿ªå¥¥999æ’æ»‹æ¶¦&#39;, &#39;probability&#39;: &#123;&#39;variance&#39;: 0.016349, &#39;average&#39;: 0.931602, &#39;min&#39;: 0.602039&#125;&#125;, &#123;&#39;words&#39;: &#39;è¿ªå¥¥#99æ»‹æ¶¦(ç»å…¸æ­£çº¢è‰²)&#39;, &#39;probability&#39;: &#123;&#39;variance&#39;: 7.6e-05, &#39;average&#39;: 0.99548, &#39;min&#39;: 0.969314&#125;&#125;, &#123;&#39;words&#39;: &#39;é¢œè‰²æœ€çº¯æ­£çš„ä¸€æ¬¾æ­£çº¢è‰²,ä¸æŒ‘è‚¤è‰²,å–œåº†ç‰¹åˆ«æ˜¾æ°”è´¨ã€‚å˜´å”‡çŠ¶æ€ä¸å¥½çš„å°ä»™å¥³&#39;, &#39;probability&#39;: &#123;&#39;variance&#39;: 0.00176, &#39;average&#39;: 0.988948, &#39;min&#39;: 0.788893&#125;&#125;, &#123;&#39;words&#39;: &#39;è¦é€‰è¿™æ¬¾,èƒ½è®©å”‡å¦†çœ‹èµ·æ¥æ›´ç¾&#39;, &#39;probability&#39;: &#123;&#39;variance&#39;: 5.8e-05, &#39;average&#39;: 0.996976, &#39;min&#39;: 0.97018&#125;&#125;], &#39;language&#39;: -1&#125;</span><br></pre></td></tr></table></figure><br><img src= "/img/loading.svg" data-lazy-src="https://img4.xiji.com/images/19/01/6efcdf3646ab405e003d3feefa2d463ac20b9d3a.jpg" alt="999æ»‹æ¶¦"></p><h3 id="æ›´å¤šé˜…è¯»"><a href="#æ›´å¤šé˜…è¯»" class="headerlink" title="æ›´å¤šé˜…è¯»"></a>æ›´å¤šé˜…è¯»</h3><p><a href="https://ai.baidu.com/ai-doc/OCR/Ek3h7yeiq">æ–‡å­—è¯†åˆ« - ç®€ä»‹ | ç™¾åº¦ AI å¼€æ”¾å¹³å°</a></p><hr><p>ä»¥ä¸‹æ–¹æ¡ˆç”±äºæœåŠ¡å™¨æ€§èƒ½ä¸å¤Ÿï¼Œæ²¡æ³•æ­£å¸¸è¿è¡Œã€‚</p><h2 id="pytesseract"><a href="#pytesseract" class="headerlink" title="pytesseract"></a>pytesseract</h2><h3 id="è£…åŒ…"><a href="#è£…åŒ…" class="headerlink" title="è£…åŒ…"></a>è£…åŒ…</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pipenv install pytesseract</span><br><span class="line">pipenv install tesseract</span><br><span class="line">yum install tesseract</span><br></pre></td></tr></table></figure><h3 id="ä¸‹è½½è¯­è¨€æ‰©å±•"><a href="#ä¸‹è½½è¯­è¨€æ‰©å±•" class="headerlink" title="ä¸‹è½½è¯­è¨€æ‰©å±•"></a>ä¸‹è½½è¯­è¨€æ‰©å±•</h3><p><a href="https://tesseract-ocr.github.io/tessdoc/Data-Files">tessdoc | Tesseract documentation</a></p><h3 id="ç¼–å†™ä»£ç "><a href="#ç¼–å†™ä»£ç " class="headerlink" title="ç¼–å†™ä»£ç "></a>ç¼–å†™ä»£ç </h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> pytesseract</span><br><span class="line"><span class="keyword">from</span> backend <span class="keyword">import</span> settings</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_content_from_image</span>(<span class="params">image_fp</span>):</span></span><br><span class="line">    image = Image.<span class="built_in">open</span>(image_fp)</span><br><span class="line">    content = pytesseract.image_to_string(image, lang=<span class="string">&#x27;chi_sim&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> content</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    fp = settings.TEST_IMAGE_FP</span><br><span class="line">    ret = get_content_from_image(fp)</span><br><span class="line">    print(ret)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="æŸ¥çœ‹è¿è¡Œç»“æœ"><a href="#æŸ¥çœ‹è¿è¡Œç»“æœ" class="headerlink" title="æŸ¥çœ‹è¿è¡Œç»“æœ"></a>æŸ¥çœ‹è¿è¡Œç»“æœ</h3><p><img src= "/img/loading.svg" data-lazy-src="/images/ocr-1.png" alt=""></p><p>å°¼ç›ï¼Œå‘çˆ¹å‘¢ï¼</p><h2 id="chineseocr-lite"><a href="#chineseocr-lite" class="headerlink" title="chineseocr_lite"></a>chineseocr_lite</h2><h3 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git clone -b master https:&#x2F;&#x2F;github.com&#x2F;ouyanghuiyu&#x2F;chineseocr_lite.git</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ç¼–è¯‘å®‰è£…"><a href="#ç¼–è¯‘å®‰è£…" class="headerlink" title="ç¼–è¯‘å®‰è£…"></a>ç¼–è¯‘å®‰è£…</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd psenet&#x2F;pse</span><br><span class="line"></span><br><span class="line">rm -rf pse.so </span><br><span class="line">make </span><br><span class="line">make: python3-config: Command not found</span><br><span class="line">make: python3-config: Command not found</span><br><span class="line">g++ -o pse.so -I include  -std&#x3D;c++11 -O3   pse.cpp --shared -fPIC</span><br><span class="line">make: g++: Command not found</span><br><span class="line">make: *** [pse.so] Error 127</span><br></pre></td></tr></table></figure><p>å®‰è£… g++<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">yum -y install gcc+ gcc-c++</span><br><span class="line">yum install python3-devel -y</span><br></pre></td></tr></table></figure></p><h3 id="å›åˆ°ä¸»ç›®å½•"><a href="#å›åˆ°ä¸»ç›®å½•" class="headerlink" title="å›åˆ°ä¸»ç›®å½•"></a>å›åˆ°ä¸»ç›®å½•</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd ..&#x2F;..</span><br><span class="line">pwd</span><br><span class="line">&#x2F;home&#x2F;imoyao&#x2F;chineseocr_lite</span><br></pre></td></tr></table></figure><h3 id="å®‰è£…ä¾èµ–"><a href="#å®‰è£…ä¾èµ–" class="headerlink" title="å®‰è£…ä¾èµ–"></a>å®‰è£…ä¾èµ–</h3><p>å¦‚æœå›½å†…ä¸‹è½½ä¾èµ–å¤ªæ…¢å¯ä»¥é…ç½®é•œåƒï¼Œå‚è€ƒæ­¤å¤„ï¼š</p><ul><li><a href="/blog/2018-09-21/get-some-trouble-with-pip/#è§£å†³æ–¹æ¡ˆ">æ¢é˜¿é‡Œæº</a></li><li><a href="/blog/2020-01-12/pip-install-error-Failed-to-establish-a-new-connection-Network-is-unreachable/#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88">æ¢æ¸…åæº</a><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pip install -r requirements.txt</span><br><span class="line">pip install torch</span><br><span class="line">pip install torchvision</span><br></pre></td></tr></table></figure><h3 id="è¿è¡ŒæœåŠ¡"><a href="#è¿è¡ŒæœåŠ¡" class="headerlink" title="è¿è¡ŒæœåŠ¡"></a>è¿è¡ŒæœåŠ¡</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">(chineseocr_lite) bash-4.2# python app.py </span><br><span class="line">make: Entering directory &#96;&#x2F;home&#x2F;imoyao&#x2F;chineseocr_lite&#x2F;psenet&#x2F;pse&#39;</span><br><span class="line">make: &#96;pse.so&#39; is up to date.</span><br><span class="line">make: Leaving directory &#96;&#x2F;home&#x2F;imoyao&#x2F;chineseocr_lite&#x2F;psenet&#x2F;pse&#39;</span><br><span class="line">device: cpu</span><br><span class="line">load model</span><br><span class="line">device: cpu</span><br><span class="line">load model</span><br><span class="line">device: cpu</span><br><span class="line">load model</span><br><span class="line">device: cpu</span><br><span class="line">load model</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;&#x2F;root&#x2F;.local&#x2F;share&#x2F;virtualenvs&#x2F;chineseocr_lite-GxZWTh-N&#x2F;lib&#x2F;python3.7&#x2F;site-packages&#x2F;web&#x2F;utils.py&quot;, line 526, in take</span><br><span class="line">    yield next(seq)</span><br><span class="line">StopIteration</span><br><span class="line"></span><br><span class="line">The above exception was the direct cause of the following exception:</span><br><span class="line"></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;app.py&quot;, line 125, in &lt;module&gt;</span><br><span class="line">    app &#x3D; web.application(urls, globals())</span><br><span class="line">  File &quot;&#x2F;root&#x2F;.local&#x2F;share&#x2F;virtualenvs&#x2F;chineseocr_lite-GxZWTh-N&#x2F;lib&#x2F;python3.7&#x2F;site-packages&#x2F;web&#x2F;application.py&quot;, line 62, in __init__</span><br><span class="line">    self.init_mapping(mapping)</span><br><span class="line">  File &quot;&#x2F;root&#x2F;.local&#x2F;share&#x2F;virtualenvs&#x2F;chineseocr_lite-GxZWTh-N&#x2F;lib&#x2F;python3.7&#x2F;site-packages&#x2F;web&#x2F;application.py&quot;, line 130, in init_mapping</span><br><span class="line">    self.mapping &#x3D; list(utils.group(mapping, 2))</span><br><span class="line">  File &quot;&#x2F;root&#x2F;.local&#x2F;share&#x2F;virtualenvs&#x2F;chineseocr_lite-GxZWTh-N&#x2F;lib&#x2F;python3.7&#x2F;site-packages&#x2F;web&#x2F;utils.py&quot;, line 531, in group</span><br><span class="line">    x &#x3D; list(take(seq, size))</span><br><span class="line">RuntimeError: generator raised StopIteration</span><br><span class="line">(chineseocr_lite) bash-4.2# cp &#x2F;root&#x2F;.local&#x2F;share&#x2F;virtualenvs&#x2F;chineseocr_lite-GxZWTh-N&#x2F;lib&#x2F;python3.7&#x2F;site-packages&#x2F;web&#x2F;utils.py &#x2F;root&#x2F;.local&#x2F;share&#x2F;virtualenvs&#x2F;chineseocr_lite-GxZWTh-N&#x2F;lib&#x2F;python3.7&#x2F;site-packages&#x2F;web&#x2F;utils.py.bak</span><br></pre></td></tr></table></figure>ä¿®æ”¹å¦‚ä¸‹ï¼š<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">def take(seq, n):</span><br><span class="line">   for i in range(n):</span><br><span class="line">       try:</span><br><span class="line">           yield next(seq)</span><br><span class="line">       except StopIteration:</span><br><span class="line">           return</span><br></pre></td></tr></table></figure>å¯åŠ¨æœåŠ¡<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">python app.py</span><br></pre></td></tr></table></figure>è®¿é—®åº”ç”¨ï¼š<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;&#123;&#123;YOUR_DEV_IP&#125;&#125;:8080&#x2F;ocr # æ³¨æ„åé¢çš„ocrè·¯ç”±è€Œä¸æ˜¯é¦–é¡µï¼</span><br></pre></td></tr></table></figure><h3 id="æŠ¥é”™"><a href="#æŠ¥é”™" class="headerlink" title="æŠ¥é”™"></a>æŠ¥é”™</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">  File &quot;&#x2F;root&#x2F;.local&#x2F;share&#x2F;virtualenvs&#x2F;chineseocr_lite-GxZWTh-N&#x2F;lib&#x2F;python3.7&#x2F;site-packages&#x2F;web&#x2F;httpserver.py&quot;, line 255, in __iter__</span><br><span class="line">    path &#x3D; self.translate_path(self.path)</span><br><span class="line">  File &quot;&#x2F;usr&#x2F;local&#x2F;lib&#x2F;python3.7&#x2F;http&#x2F;server.py&quot;, line 820, in translate_path</span><br><span class="line">    path &#x3D; self.directory</span><br><span class="line">AttributeError: &#39;StaticApp&#39; object has no attribute &#39;directory&#39;</span><br><span class="line"></span><br></pre></td></tr></table></figure>æ·»åŠ ä»£ç <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">class StaticApp(SimpleHTTPRequestHandler):</span><br><span class="line">    &quot;&quot;&quot;WSGI application for serving static files.&quot;&quot;&quot;</span><br><span class="line">    def __init__(self, environ, start_response):</span><br><span class="line">        self.headers &#x3D; []</span><br><span class="line">        self.environ &#x3D; environ</span><br><span class="line">        self.start_response &#x3D; start_response</span><br><span class="line">        self.directory &#x3D; os.getcwd()    # æ­¤è¡Œ</span><br><span class="line"></span><br></pre></td></tr></table></figure>å‚è§<a href="https://stackoverflow.com/questions/52439325/webpy-serving-static-files-staticapp-object-has-no-attribute-directory">æ­¤å¤„</a>å’Œ<a href="https://github.com/webpy/webpy/pull/468/files">æ­¤å¤„</a></li></ul><h3 id="å®‰è£…-leptonica"><a href="#å®‰è£…-leptonica" class="headerlink" title="å®‰è£… leptonica"></a>å®‰è£… leptonica</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">tesseract_ocr.cpp:633:34: fatal error: leptonica&#x2F;allheaders.h: No such file or directory</span><br><span class="line">     #include &quot;leptonica&#x2F;allheaders.h&quot;</span><br></pre></td></tr></table></figure><h3 id="å®‰è£…-1"><a href="#å®‰è£…-1" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">wget http:&#x2F;&#x2F;www.leptonica.org&#x2F;source&#x2F;leptonica-1.79.0.tar.gz</span><br><span class="line">tar -xzvf leptonica-1.79.0.tar.gz</span><br><span class="line">cd leptonica-1.79.0</span><br><span class="line">.&#x2F;configure --prefix&#x3D;&#x2F;usr&#x2F;local&#x2F;leptonica</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="éªŒè¯å®‰è£…"><a href="#éªŒè¯å®‰è£…" class="headerlink" title="éªŒè¯å®‰è£…"></a>éªŒè¯å®‰è£…</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">tesseract -v</span><br><span class="line">tesseract 3.04.00</span><br><span class="line"> leptonica-1.72</span><br><span class="line">  libgif 4.1.6(?) : libjpeg 6b (libjpeg-turbo 1.2.90) : libpng 1.5.13 : libtiff 4.0.3 : zlib 1.2.7 : libwebp 0.3.0</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Projects </category>
          
          <category> GUSCSS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> OCR </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ğŸPyTricks | Python ä¸­å¦‚ä½•åˆå¹¶ä¸€ä¸ªå†…å­—å…¸åˆ—è¡¨ï¼Ÿ</title>
      <link href="blog/2020-04-19/python-merge-two-list-of-dicts/"/>
      <url>blog/2020-04-19/python-merge-two-list-of-dicts/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h2 id="éœ€æ±‚"><a href="#éœ€æ±‚" class="headerlink" title="éœ€æ±‚"></a>éœ€æ±‚</h2><p>æœ‰å¦‚ä¸‹åˆ—è¡¨ï¼Œè¦å°†ä»–ä»¬æŒ‰ç…§ id åˆå¹¶æˆä¸€ä¸ªåˆ—è¡¨ã€‚<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">l1 = [&#123;<span class="string">&#x27;id&#x27;</span>: <span class="number">9</span>, <span class="string">&#x27;av&#x27;</span>: <span class="number">4</span>&#125;, &#123;<span class="string">&#x27;id&#x27;</span>: <span class="number">10</span>, <span class="string">&#x27;av&#x27;</span>: <span class="number">0</span>&#125;, &#123;<span class="string">&#x27;id&#x27;</span>: <span class="number">8</span>, <span class="string">&#x27;av&#x27;</span>: <span class="number">0</span>&#125;]</span><br><span class="line">l2 = [&#123;<span class="string">&#x27;id&#x27;</span>: <span class="number">9</span>, <span class="string">&#x27;nv&#x27;</span>: <span class="number">45</span>&#125;, &#123;<span class="string">&#x27;id&#x27;</span>: <span class="number">10</span>, <span class="string">&#x27;nv&#x27;</span>: <span class="number">0</span>&#125;, &#123;<span class="string">&#x27;id&#x27;</span>: <span class="number">8</span>, <span class="string">&#x27;nv&#x27;</span>: <span class="number">30</span>&#125;]</span><br></pre></td></tr></table></figure></p><h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><ol><li><p>åˆçº§ç‰ˆ<br>å°†ä¸¤ä¸ªåˆ—è¡¨æŒ‰ç…§ id åˆ†ç»„ï¼Œåˆ†åˆ«æ”¾ç½®åˆ°æ–°åˆ—è¡¨ä¸­ï¼Œç„¶åéå†å…¶ä¸­ä¸€ä¸ªåˆ—è¡¨ï¼Œå¹¶æŒ‰ç…§ key å°†æ•°æ®æ›´æ–°ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">l3 = &#123;x[<span class="string">&#x27;id&#x27;</span>]: &#123;<span class="string">&#x27;av&#x27;</span>: x[<span class="string">&#x27;av&#x27;</span>]&#125; <span class="keyword">for</span> x <span class="keyword">in</span> l1&#125;</span><br><span class="line"></span><br><span class="line">l4 = &#123;x[<span class="string">&#x27;id&#x27;</span>]: &#123;<span class="string">&#x27;nv&#x27;</span>: x[<span class="string">&#x27;nv&#x27;</span>]&#125; <span class="keyword">for</span> x <span class="keyword">in</span> l2&#125;</span><br><span class="line"></span><br><span class="line">&#123;key: value.update(l4[key]) <span class="keyword">for</span> key, value <span class="keyword">in</span> l3.items()&#125;</span><br><span class="line"></span><br><span class="line">&gt;&gt; &#123;<span class="number">9</span>: &#123;<span class="string">&#x27;av&#x27;</span>: <span class="number">4</span>, <span class="string">&#x27;nv&#x27;</span>: <span class="number">45</span>&#125;, <span class="number">10</span>: &#123;<span class="string">&#x27;av&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;nv&#x27;</span>: <span class="number">0</span>&#125;, <span class="number">8</span>: &#123;<span class="string">&#x27;av&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;nv&#x27;</span>: <span class="number">30</span>&#125;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¾ˆå®¹æ˜“å‘ç°é‡Œé¢çš„ l4 çš„æ˜¯å¤šä½™çš„ï¼Œé‡å¤ for å¾ªç¯ä¼šé™ä½ä»£ç çš„æ•ˆç‡ã€‚æ‰€ä»¥</p></li><li><p>ç¬¬ä¸€ç‰ˆæ”¹è¿›</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">l3 = &#123;x[<span class="string">&#x27;id&#x27;</span>]: &#123;<span class="string">&#x27;av&#x27;</span>: x[<span class="string">&#x27;av&#x27;</span>]&#125; <span class="keyword">for</span> x <span class="keyword">in</span> l1&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> l2:</span><br><span class="line"></span><br><span class="line">    l3[item[<span class="string">&#x27;id&#x27;</span>]].update(nv=item[<span class="string">&#x27;nv&#x27;</span>])</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li>ç¬¬äºŒç‰ˆä»£ç <br>ä½¿ç”¨å­—å…¸çš„<a href="https://docs.python.org/3/library/stdtypes.html#dict.pop">pop</a>æ–¹æ³•å°† id å–å‡ºæ¥ï¼Œå› ä¸ºæˆ‘ä»¬åªå…³å¿ƒ idï¼Œè€Œä¸éœ€è¦å…³æ³¨å­—å…¸ä¸­çš„å…¶ä»– key<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">l3 = &#123;_.pop(<span class="string">&#x27;id&#x27;</span>): _ <span class="keyword">for</span> _ <span class="keyword">in</span> l1&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> l2:</span><br><span class="line"></span><br><span class="line">  l3[item.pop(<span class="string">&#x27;id&#x27;</span>)].update(item)</span><br><span class="line"></span><br></pre></td></tr></table></figure>ä½†æ˜¯è¿™ç§åŠæ³•æœ‰ä¸€ä¸ªç¼ºé™·ï¼šæˆ‘ä»¬ä¼šå¯¹æ‰€æœ‰è¾“å…¥çš„å­—å…¸è¿›è¡Œæ›´æ–°ï¼Œä¸ºäº†æ¶ˆé™¤è¿™ä¸ªå½±å“ï¼Œæˆ‘ä»¬ä»ä¸€ä¸ªç©ºå­—å…¸å¼€å§‹ï¼Œæ›´æ–°æ¯ä¸€ä¸ªé”®ï¼Œå½“ç„¶ä¹ŸåŒ…æ‹¬ idï¼Œä¹‹åå¼¹å‡ºé¢å¤–çš„é”®ï¼Œå¯ä»¥ä½¿ç”¨<a href="https://docs.python.org/3/library/collections.html#collections.defaultdict">defaultdict</a>:<br>ç®€å•ä»‹ç»å‚è€ƒï¼š<a href="https://jtauber.com/blog/2008/02/27/evolution_of_default_dictionaries_in_python/">James Tauber : Evolution of Default Dictionaries in Python</a></li><li><p>ç¬¬ä¸‰ç‰ˆä»£ç </p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">result = defaultdict(<span class="built_in">dict</span>)</span><br><span class="line"><span class="keyword">for</span> sequence <span class="keyword">in</span> (l1, l2):</span><br><span class="line">   <span class="keyword">for</span> dictionary <span class="keyword">in</span> sequence:</span><br><span class="line">       result[dictionary[<span class="string">&#x27;id&#x27;</span>]].update(dictionary)</span><br><span class="line"><span class="keyword">for</span> dictionary <span class="keyword">in</span> result.values():</span><br><span class="line">   dictionary.pop(<span class="string">&#x27;id&#x27;</span>)</span><br></pre></td></tr></table></figure><p>å¦‚æœæˆ‘ä»¬è¦åˆå¹¶çš„å†…å­—å…¸åˆ—è¡¨å¤šäºä¸¤ä¸ªå‘¢ï¼Ÿç”¨è¿™ç§æ–¹æ³•æ˜¯å¾ˆå®¹æ˜“æ‰©å±•çš„ï¼Œå®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼š</p></li><li><p>ç»ˆæç‰ˆä»£ç </p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">merge_iterables_of_dict</span>(<span class="params">shared_key, *iterables</span>):</span></span><br><span class="line">   result = defaultdict(<span class="built_in">dict</span>)</span><br><span class="line">   <span class="keyword">for</span> dictionary <span class="keyword">in</span> itertools.chain.from_iterable(iterables):</span><br><span class="line">       result[dictionary[shared_key]].update(dictionary)</span><br><span class="line">   <span class="keyword">for</span> dictionary <span class="keyword">in</span> result.values():</span><br><span class="line">       dictionary.pop(shared_key)</span><br><span class="line">   <span class="keyword">return</span> result</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨è¿™ä¸ªå‡½æ•°ï¼š<code>merge_iterables_of_dict(&#39;id&#39;,l1,l2)</code>ï¼Œæ³¨æ„ï¼Œli å’Œ l2 çš„é¡ºåºä¼šå½±å“è¿”å›ç»“æœï¼Œæ›´â€œé è°±â€çš„æ•°æ®åº”è¯¥æ”¾åˆ° iterables åæ–¹ï¼ˆå‚è€ƒå­—å…¸<code>update</code>æ–¹æ³•çš„æ›´æ–°é€»è¾‘ï¼‰ã€‚</p></li></ol><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://codereview.stackexchange.com/questions/209202/merge-two-list-of-dicts-with-same-key">python - Merge two list of dicts with same key - Code Review Stack Exchange</a></p><h2 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="headerlink" title="æ¨èé˜…è¯»"></a>æ¨èé˜…è¯»</h2><p>å¦‚æœåªæ˜¯åˆå¹¶ä¸¤ä¸ªå­—å…¸ï¼Œè¯·å‚é˜…ï¼š<a href="https://stackoverflow.com/questions/38987/how-do-i-merge-two-dictionaries-in-a-single-expression-in-python/26853961">dictionary - How do I merge two dictionaries in a single expression in Python? - Stack Overflow</a>å’Œ<a href="https://stackoverflow.com/questions/2365921/merging-python-dictionaries">list - merging Python dictionaries - Stack Overflow</a></p>]]></content>
      
      
      <categories>
          
          <category> ğŸPyTricks </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> dict </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸­å›½ä¼ ç»Ÿè‰² | å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªé¢œè‰²å±äºä»€ä¹ˆè‰²ç³»ï¼Ÿ</title>
      <link href="blog/2020-04-15/tell-me-rgb-values-nearest-color-with-Python/"/>
      <url>blog/2020-04-15/tell-me-rgb-values-nearest-color-with-Python/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>åœ¨åš <a href="https://github.com/imoyao/GUSCSS/">é¡¹ç›®</a> çš„æ—¶å€™ï¼Œéœ€è¦åˆ¤æ–­ä¸€ä¸ªé¢œè‰²å€¼æ‰€åœ¨è‰²ç³»ï¼ˆå¦‚ï¼šçº¢æ©™é»„ç»¿é’è“ç´«é»‘ç™½ç°ï¼‰ï¼Œç”¨çœ¼ç›è§‚å¯Ÿå¤ªæ…¢ï¼Œç®—ä¸ä¸Šå¥½åŠæ³•ï¼Œé‚£ä¹ˆæ€ä¹ˆåˆ¤æ–­å‘¢ï¼Ÿé€šè¿‡é˜…è¯» <a href="https://www.v2ex.com/amp/t/153186">è¯¥è®¨è®º</a> çŸ¥é“äº†ä¸€ç§æ–¹æ¡ˆï¼šå°† RGB è‰²å€¼è½¬åŒ–ä¸º HSVï¼Œä¹‹åé€šè¿‡ Hue å»åˆ¤æ–­å½©è‰²çš„ç§ç±»ï¼Œç”¨æ˜åº¦å»åˆ¤æ–­é»‘ç™½ç°ã€‚å…·ä½“å®ç°å¦‚ä¸‹ã€‚</p><h2 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h2><h3 id="RGB"><a href="#RGB" class="headerlink" title="RGB"></a>RGB</h3><p>RGB æ˜¯ä»é¢œè‰²å‘å…‰çš„åŸç†æ¥è®¾è®¡å®šçš„ï¼Œé€šä¿—ç‚¹è¯´å®ƒçš„é¢œè‰²æ··åˆæ–¹å¼å°±å¥½åƒæœ‰çº¢ã€ç»¿ã€è“ä¸‰ç›ç¯ï¼Œå½“å®ƒä»¬çš„å…‰ç›¸äº’å åˆçš„æ—¶å€™ï¼Œè‰²å½©ç›¸æ··ï¼Œè€Œäº®åº¦å´ç­‰äºä¸¤è€…äº®åº¦ä¹‹æ€»å’Œï¼Œè¶Šæ··åˆäº®åº¦è¶Šé«˜ï¼Œå³åŠ æ³•æ··åˆã€‚</p><p>çº¢ã€ç»¿ã€è“ä¸‰ä¸ªé¢œè‰²é€šé“æ¯ç§è‰²å„åˆ†ä¸º 256 é˜¶äº®åº¦ï¼Œåœ¨ 0 æ—¶â€œç¯â€æœ€å¼±â€”â€”æ˜¯å…³æ‰çš„ï¼Œè€Œåœ¨ 255 æ—¶â€œç¯â€æœ€äº®ã€‚å½“ä¸‰è‰²ç°åº¦æ•°å€¼ç›¸åŒæ—¶ï¼Œäº§ç”Ÿä¸åŒç°åº¦å€¼çš„ç°è‰²è°ƒï¼Œå³ä¸‰è‰²ç°åº¦éƒ½ä¸º 0 æ—¶ï¼Œæ˜¯æœ€æš—çš„é»‘è‰²è°ƒï¼›ä¸‰è‰²ç°åº¦éƒ½ä¸º 255 æ—¶ï¼Œæ˜¯æœ€äº®çš„ç™½è‰²è°ƒã€‚</p><p>åœ¨ç”µè„‘ä¸­ï¼ŒRGB çš„æ‰€è°“â€œå¤šå°‘â€å°±æ˜¯æŒ‡äº®åº¦ï¼Œå¹¶ä½¿ç”¨æ•´æ•°æ¥è¡¨ç¤ºã€‚é€šå¸¸æƒ…å†µä¸‹ï¼ŒRGB å„æœ‰ 256 çº§äº®åº¦ï¼Œç”¨æ•°å­—è¡¨ç¤ºä¸ºä» 0ã€1ã€2â€¦ç›´åˆ° 255ã€‚æ³¨æ„è™½ç„¶æ•°å­—æœ€é«˜æ˜¯ 255ï¼Œä½† 0 ä¹Ÿæ˜¯æ•°å€¼ä¹‹ä¸€ï¼Œå› æ­¤å…± 256 çº§ã€‚<br><img src= "/img/loading.svg" data-lazy-src="/images/RGB.png" alt="RGB"></p><h3 id="HSV"><a href="#HSV" class="headerlink" title="HSV"></a>HSV</h3><p>HSV æ˜¯ä¸€ç§æ¯”è¾ƒç›´è§‚çš„é¢œè‰²æ¨¡å‹ï¼Œæ‰€ä»¥åœ¨è®¸å¤šå›¾åƒç¼–è¾‘å·¥å…·ä¸­åº”ç”¨æ¯”è¾ƒå¹¿æ³›ï¼Œè¿™ä¸ªæ¨¡å‹ä¸­é¢œè‰²çš„å‚æ•°åˆ†åˆ«æ˜¯ï¼šè‰²è°ƒï¼ˆH, Hueï¼‰ï¼Œé¥±å’Œåº¦ï¼ˆS,Saturationï¼‰ï¼Œæ˜åº¦ï¼ˆV, Valueï¼‰ã€‚<br><div class="justified-gallery"><p><img src= "/img/loading.svg" data-lazy-src="/images/HSV1.png" alt="HSV1"><br><img src= "/img/loading.svg" data-lazy-src="/images/HSV2.png" alt="HSV2"></p>          </div></p><h4 id="è‰²è°ƒï¼ˆHueï¼‰"><a href="#è‰²è°ƒï¼ˆHueï¼‰" class="headerlink" title="è‰²è°ƒï¼ˆHueï¼‰"></a>è‰²è°ƒï¼ˆHueï¼‰</h4><p>ç”¨è§’åº¦åº¦é‡ï¼Œå–å€¼èŒƒå›´ä¸º 0Â°ï½360Â°ï¼Œä»çº¢è‰²å¼€å§‹æŒ‰é€†æ—¶é’ˆæ–¹å‘è®¡ç®—ï¼Œçº¢è‰²ä¸º 0Â°ï¼Œç»¿è‰²ä¸º 120Â°,è“è‰²ä¸º 240Â°ã€‚å®ƒä»¬çš„è¡¥è‰²æ˜¯ï¼šé»„è‰²ä¸º 60Â°ï¼Œé’è‰²ä¸º 180Â°,å“çº¢ä¸º 300Â°ï¼›</p><h4 id="é¥±å’Œåº¦ï¼ˆSaturationï¼‰"><a href="#é¥±å’Œåº¦ï¼ˆSaturationï¼‰" class="headerlink" title="é¥±å’Œåº¦ï¼ˆSaturationï¼‰"></a>é¥±å’Œåº¦ï¼ˆSaturationï¼‰</h4><p>é¥±å’Œåº¦ S è¡¨ç¤ºé¢œè‰²æ¥è¿‘å…‰è°±è‰²çš„ç¨‹åº¦ã€‚ä¸€ç§é¢œè‰²ï¼Œå¯ä»¥çœ‹æˆæ˜¯æŸç§å…‰è°±è‰²ä¸ç™½è‰²æ··åˆçš„ç»“æœã€‚å…¶ä¸­å…‰è°±è‰²æ‰€å çš„æ¯”ä¾‹æ„ˆå¤§ï¼Œé¢œè‰²æ¥è¿‘å…‰è°±è‰²çš„ç¨‹åº¦å°±æ„ˆé«˜ï¼Œé¢œè‰²çš„é¥±å’Œåº¦ä¹Ÿå°±æ„ˆé«˜ã€‚é¥±å’Œåº¦é«˜ï¼Œé¢œè‰²åˆ™æ·±è€Œè‰³ã€‚å…‰è°±è‰²çš„ç™½å…‰æˆåˆ†ä¸º 0ï¼Œé¥±å’Œåº¦è¾¾åˆ°æœ€é«˜ã€‚é€šå¸¸å–å€¼èŒƒå›´ä¸º 0%ï½100%ï¼Œå€¼è¶Šå¤§ï¼Œé¢œè‰²è¶Šé¥±å’Œã€‚</p><h4 id="æ˜åº¦ï¼ˆValueï¼‰"><a href="#æ˜åº¦ï¼ˆValueï¼‰" class="headerlink" title="æ˜åº¦ï¼ˆValueï¼‰"></a>æ˜åº¦ï¼ˆValueï¼‰</h4><p>æ˜åº¦è¡¨ç¤ºé¢œè‰²æ˜äº®çš„ç¨‹åº¦ï¼Œå¯¹äºå…‰æºè‰²ï¼Œæ˜åº¦å€¼ä¸å‘å…‰ä½“çš„å…‰äº®åº¦æœ‰å…³ï¼›å¯¹äºç‰©ä½“è‰²ï¼Œæ­¤å€¼å’Œç‰©ä½“çš„é€å°„æ¯”æˆ–åå°„æ¯”æœ‰å…³ã€‚é€šå¸¸å–å€¼èŒƒå›´ä¸º 0%ï¼ˆé»‘ï¼‰åˆ° 100%ï¼ˆç™½ï¼‰ã€‚</p><h4 id="å–å€¼èŒƒå›´è¯´æ˜"><a href="#å–å€¼èŒƒå›´è¯´æ˜" class="headerlink" title="å–å€¼èŒƒå›´è¯´æ˜"></a>å–å€¼èŒƒå›´è¯´æ˜</h4><p>æˆ‘ä»¬éœ€è¦æ³¨æ„çš„åœ¨ä¸åŒåº”ç”¨åœºæ™¯ä¸­ï¼ŒHSV å–å€¼èŒƒå›´æ˜¯ä¸å°½ç›¸åŒçš„ã€‚</p><p>1.PS è½¯ä»¶æ—¶ï¼ŒH å–å€¼èŒƒå›´æ˜¯ 0-360ï¼ŒS å–å€¼èŒƒå›´æ˜¯ï¼ˆ0%-100%ï¼‰ï¼ŒV å–å€¼èŒƒå›´æ˜¯ï¼ˆ0%-100%ï¼‰ã€‚</p><p>2.åˆ©ç”¨ openCV ä¸­ cvSplit å‡½æ•°çš„åœ¨é€‰æ‹©å›¾åƒ IPL_DEPTH_32F ç±»å‹æ—¶ï¼ŒH å–å€¼èŒƒå›´æ˜¯ 0-360ï¼ŒS å–å€¼èŒƒå›´æ˜¯ 0-1ï¼ˆ0%-100%ï¼‰ï¼ŒV å–å€¼èŒƒå›´æ˜¯ 0-1ï¼ˆ0%-100%ï¼‰ã€‚</p><p>3.åˆ©ç”¨ openCV ä¸­ cvSplit å‡½æ•°çš„åœ¨é€‰æ‹©å›¾åƒ IPL_DEPTH_8UC ç±»å‹æ—¶ï¼ŒH å–å€¼èŒƒå›´æ˜¯ 0-180ï¼ŒS å–å€¼èŒƒå›´æ˜¯ 0-255ï¼ŒV å–å€¼èŒƒå›´æ˜¯ 0-255ã€‚</p><p>é‚£ä¹ˆï¼Œå¼€å§‹å†™ä»£ç å§ï¼</p><h2 id="RGB-è½¬-HSV"><a href="#RGB-è½¬-HSV" class="headerlink" title="RGB è½¬ HSV"></a>RGB è½¬ HSV</h2><h3 id="å…¬å¼"><a href="#å…¬å¼" class="headerlink" title="å…¬å¼"></a>å…¬å¼</h3><ul><li>å¸¸é‡<br><img src= "/img/loading.svg" data-lazy-src="/images/constant_HSV.svg" alt="constant"><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$$</span><br><span class="line">\begin&#123;array&#125;&#123;l&#125;</span><br><span class="line">R^&#123;\prime&#125;&#x3D;R &#x2F; 255\\</span><br><span class="line"></span><br><span class="line">G^&#123;\prime&#125;&#x3D;G &#x2F; 255\\</span><br><span class="line"></span><br><span class="line">B^&#123;\prime&#125;&#x3D;B &#x2F; 255\\</span><br><span class="line">\operatorname&#123;Cmax&#125;&#x3D;\max \left(R^&#123;\prime&#125;, G^&#123;\prime&#125;, B^&#123;\prime&#125;\right)\\</span><br><span class="line"></span><br><span class="line">C \min &#x3D;\min \left(R^&#123;\prime&#125;, G^&#123;\prime&#125;, B^&#123;\prime&#125;\right)\\</span><br><span class="line">\Delta&#x3D;\mathrm&#123;Cmax&#125;-\mathrm&#123;Cmin&#125;</span><br><span class="line">\end&#123;array&#125;</span><br><span class="line">$$</span><br></pre></td></tr></table></figure></li><li>H è®¡ç®—<br><img src= "/img/loading.svg" data-lazy-src="/images/HSV_Hue.svg" alt="H"><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$$</span><br><span class="line">H&#x3D;\left\&#123;\begin&#123;array&#125;&#123;cc&#125;0^&#123;\circ&#125; &amp; \Delta&#x3D;0 \\ 60^&#123;\circ&#125; \times\left(\frac&#123;G^&#123;\prime&#125;-B^&#123;\prime&#125;&#125;&#123;A&#125; \bmod 6\right) &amp; , C_&#123;\max &#125;&#x3D;R^&#123;\prime&#125; \\ 60^&#123;\circ&#125; \times\left(\frac&#123;B^&#123;\prime&#125;-R^&#123;\prime&#125;&#125;&#123;\Delta&#125;+2\right) &amp; , C_&#123;\max &#125;&#x3D;G^&#123;\prime&#125; \\ 60^&#123;\circ&#125; \times\left(\frac&#123;R^&#123;\prime&#125;-G^&#123;\prime&#125;&#125;&#123;\Delta&#125;+4\right) &amp; , C_&#123;\max &#125;&#x3D;B^&#123;\prime&#125;\end&#123;array&#125;\right.</span><br><span class="line">$$</span><br></pre></td></tr></table></figure></li><li>S è®¡ç®—<br><img src= "/img/loading.svg" data-lazy-src="/images/HSV_S.svg" alt="S"><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$$</span><br><span class="line">S&#x3D;\left\&#123;\begin&#123;array&#125;&#123;cl&#125;</span><br><span class="line">0 &amp; C \max &#x3D;0 \\</span><br><span class="line">\frac&#123;\Delta&#125;&#123;C \max &#125; &amp; C \max \neq 0</span><br><span class="line">\end&#123;array&#125;\right.</span><br><span class="line">$$</span><br></pre></td></tr></table></figure></li><li>V è®¡ç®—<br><img src= "/img/loading.svg" data-lazy-src="/images/HSV_V.svg" alt="V"><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$V&#x3D;C \max$</span><br></pre></td></tr></table></figure><h3 id="ä»£ç ï¼ˆRGB-è½¬-HSVï¼‰"><a href="#ä»£ç ï¼ˆRGB-è½¬-HSVï¼‰" class="headerlink" title="ä»£ç ï¼ˆRGB è½¬ HSVï¼‰"></a>ä»£ç ï¼ˆRGB è½¬ HSVï¼‰</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hue_calculate_org</span>(<span class="params">round1, round2, delta, add_num</span>):</span></span><br><span class="line">    <span class="keyword">return</span> ((round1 - round2) / delta + add_num) * <span class="number">60</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rgb_to_hsv_org</span>(<span class="params">rgb_seq</span>):</span></span><br><span class="line">    r, g, b = rgb_seq</span><br><span class="line">    r_round = <span class="built_in">float</span>(r) / <span class="number">255</span></span><br><span class="line">    g_round = <span class="built_in">float</span>(g) / <span class="number">255</span></span><br><span class="line">    b_round = <span class="built_in">float</span>(b) / <span class="number">255</span></span><br><span class="line">    max_c = <span class="built_in">max</span>(r_round, g_round, b_round)</span><br><span class="line">    min_c = <span class="built_in">min</span>(r_round, g_round, b_round)</span><br><span class="line">    delta = max_c - min_c</span><br><span class="line">    h = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">if</span> delta == <span class="number">0</span>:</span><br><span class="line">        h = <span class="number">0</span></span><br><span class="line">    <span class="keyword">elif</span> max_c == r_round:</span><br><span class="line">        h = ((g_round - b_round) / delta % <span class="number">6</span>) * <span class="number">60</span></span><br><span class="line">    <span class="keyword">elif</span> max_c == g_round:</span><br><span class="line">        h = hue_calculate_org(b_round, r_round, delta, <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">elif</span> max_c == b_round:</span><br><span class="line">        h = hue_calculate_org(r_round, g_round, delta, <span class="number">4</span>)</span><br><span class="line">    <span class="keyword">if</span> max_c == <span class="number">0</span>:</span><br><span class="line">        s = <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        s = delta / max_c</span><br><span class="line">    <span class="keyword">return</span> h, s, max_c</span><br></pre></td></tr></table></figure>å¦ä¸€ç§è®¡ç®—æ–¹å¼æ¥è‡ªæ­¤å¤„ï¼šğŸ‘‰ <a href="https://www.w3resource.com/python-exercises/math/python-math-exercise-77.php">Python Math: Convert RGB color to HSV color - w3resource</a><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hue_calculate</span>(<span class="params">round1, round2, delta, add_num</span>):</span></span><br><span class="line">    <span class="keyword">return</span> (((round1 - round2) / delta) * <span class="number">60</span> + add_num) % <span class="number">360</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rgb_to_hsv</span>(<span class="params">rgb_seq</span>):</span></span><br><span class="line">    r, g, b = rgb_seq</span><br><span class="line">    r_round = <span class="built_in">float</span>(r) / <span class="number">255</span></span><br><span class="line">    g_round = <span class="built_in">float</span>(g) / <span class="number">255</span></span><br><span class="line">    b_round = <span class="built_in">float</span>(b) / <span class="number">255</span></span><br><span class="line">    max_c = <span class="built_in">max</span>(r_round, g_round, b_round)</span><br><span class="line">    min_c = <span class="built_in">min</span>(r_round, g_round, b_round)</span><br><span class="line">    delta = max_c - min_c</span><br><span class="line"></span><br><span class="line">    h = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">if</span> delta == <span class="number">0</span>:</span><br><span class="line">        h = <span class="number">0</span></span><br><span class="line">    <span class="keyword">elif</span> max_c == r_round:</span><br><span class="line">        h = hue_calculate(g_round, b_round, delta, <span class="number">360</span>)</span><br><span class="line">    <span class="keyword">elif</span> max_c == g_round:</span><br><span class="line">        h = hue_calculate(b_round, r_round, delta, <span class="number">120</span>)</span><br><span class="line">    <span class="keyword">elif</span> max_c == b_round:</span><br><span class="line">        h = hue_calculate(r_round, g_round, delta, <span class="number">240</span>)</span><br><span class="line">    <span class="keyword">if</span> max_c == <span class="number">0</span>:</span><br><span class="line">        s = <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        s = (delta / max_c) * <span class="number">100</span></span><br><span class="line">    v = max_c * <span class="number">100</span></span><br><span class="line">    <span class="keyword">return</span> h, s, v</span><br></pre></td></tr></table></figure><h2 id="é¢œè‰²åˆ’åˆ†"><a href="#é¢œè‰²åˆ’åˆ†" class="headerlink" title="é¢œè‰²åˆ’åˆ†"></a>é¢œè‰²åˆ’åˆ†</h2></li></ul><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><table class="dtable"><tbody><tr><th>Color</th><th>Color name</th><th>(H,S,V)</th><th>Hex</th><th>(R,G,B)</th></tr><tr><td style="background-color:#000000">&nbsp;</td><td>Black</td><td>(0Â°,0%,0%)</td><td>#000000</td><td>(0,0,0)</td></tr>        <tr><td style="background-color:#808080">&nbsp;</td><td>Gray</td><td>(0Â°,0%,50%)</td><td>#808080</td><td>(128,128,128)</td></tr><tr><td style="background-color:#FFFFFF">&nbsp;</td><td>White</td><td>(0Â°,0%,100%)</td><td>#FFFFFF</td><td>(255,255,255)</td></tr><tr><td style="background-color:#FF0000">&nbsp;</td><td>Red</td><td>(0Â°,100%,100%)</td><td>#FF0000</td><td>(255,0,0)</td></tr>        <tr><td style="background-color:#FFFF00">&nbsp;</td><td>Yellow</td><td>(60Â°,100%,100%)</td><td>#FFFF00</td><td>(255,255,0)</td></tr><tr><td style="background-color:#00FF00">&nbsp;</td><td>Lime</td><td>(120Â°,100%,100%)</td><td>#00FF00</td><td>(0,255,0)</td></tr><tr><td style="background-color:#00FFFF">&nbsp;</td><td>Cyan</td><td>(180Â°,100%,100%)</td><td>#00FFFF</td><td>(0,255,255)</td></tr><tr><td style="background-color:#0000FF">&nbsp;</td><td>Blue</td><td>(240Â°,100%,100%)</td><td>#0000FF</td><td>(0,0,255)</td></tr><tr><td style="background-color:#FF00FF">&nbsp;</td><td>Magenta</td><td>(300Â°,100%,100%)</td><td>#FF00FF</td><td>(255,0,255)</td></tr></tbody></table><p>æ•°æ®æ¥æºï¼š<a href="https://www.rapidtables.com/convert/color/hsv-to-rgb.html">HSV to RGB conversion | color conversion</a><br>çœ‹<del>è‰²å›¾</del>ï¼Œå“¦ä¸ï¼Œè‰²ç¯å›¾ã€‚ğŸ˜³<br><img src= "/img/loading.svg" data-lazy-src="/images/color_circle.jpg" alt="è‰²ç¯å›¾"></p><p>å…ˆä¸ç®¡é»‘ç°ç™½ä¸‰ç§è‰²ï¼Œæ‰¾å…¶ä»–é¢œè‰²ä¸è‰²ç¯çš„å¯¹åº”å…³ç³»ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å‘ç° H ä¸è‰²ç¯çš„å¯¹åº”å…³ç³»ã€‚</p><ol><li>å˜æ¢è‰²ç›¸ Hï¼Œä¿æŒ Sï¼ŒV ä¸å˜ï¼Œé¢œè‰²å‘ç”Ÿå˜åŒ–ï¼›<div class="justified-gallery"><p><img src= "/img/loading.svg" data-lazy-src="/images/change_H_30.png" alt="H30"><br><img src= "/img/loading.svg" data-lazy-src="/images/change_H_60.png" alt="H60"><br><img src= "/img/loading.svg" data-lazy-src="/images/change_H_180.png" alt="H180"><br><img src= "/img/loading.svg" data-lazy-src="/images/change_H_210.png" alt="H210"><br><img src= "/img/loading.svg" data-lazy-src="/images/change_H_270.png" alt="H270"><br><img src= "/img/loading.svg" data-lazy-src="/images/change_H_330.png" alt="H330"><br><img src= "/img/loading.svg" data-lazy-src="/images/change_S_4.png" alt="H360"></p>          </div>ä¿®æ”¹ H ä¼šå¼•èµ·é¢œè‰²å˜åŒ–ï¼›</li><li>å˜æ¢äº®åº¦ Vï¼Œä¿æŒ Hï¼ŒS ä¸å˜ï¼Œæˆ‘ä»¬å‘ç°é¢œè‰²åœ¨é»‘ç°ç™½ä¹‹é—´å˜åŒ–ï¼›<div class="justified-gallery"><p><img src= "/img/loading.svg" data-lazy-src="/images/change_V_100.png" alt="V100"><br><img src= "/img/loading.svg" data-lazy-src="/images/change_V_50.png" alt="V50"><br><img src= "/img/loading.svg" data-lazy-src="/images/change_V_0.png" alt="V0"></p>          </div></li><li>å˜æ¢é¥±å’Œåº¦ Sï¼Œä¿æŒ Hï¼ŒV ä¸å˜ï¼Œé¢œè‰²ä¸ä¼šå˜åŒ–ï¼Œå˜çš„åªæ˜¯é¢œè‰²çš„æ·±æµ…ç¨‹åº¦ï¼›<div class="justified-gallery"><p><img src= "/img/loading.svg" data-lazy-src="/images/change_S_1.png" alt="HSV1"><br><img src= "/img/loading.svg" data-lazy-src="/images/change_S_2.png" alt="HSV1"><br><img src= "/img/loading.svg" data-lazy-src="/images/change_S_3.png" alt="HSV1"><br><img src= "/img/loading.svg" data-lazy-src="/images/change_S_4.png" alt="HSV1"></p>          </div>å› ä¸ºäººçœ¼å¯¹æ˜äº®çš„é¢œè‰²æ›´åŠ æ•æ„Ÿï¼Œæ‰€ä»¥æˆ‘ä»¬é€‚å½“è°ƒé«˜äº®åº¦ï¼Œä¹‹åé€æ¸ä¿®æ”¹ Sï¼Œè§‚å¯Ÿé¢œè‰²å˜åŒ–ã€‚<br>æœ‰å†…å‘³å„¿äº†ï¼Œé¢œè‰²å˜å¾—è¶Šæ¥è¶Šæµ“éƒäº†ï¼</li></ol><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><h4 id="é¢œè‰²å½’ç±»ï¼ˆæŒ‰è‰²ç³»ï¼‰"><a href="#é¢œè‰²å½’ç±»ï¼ˆæŒ‰è‰²ç³»ï¼‰" class="headerlink" title="é¢œè‰²å½’ç±»ï¼ˆæŒ‰è‰²ç³»ï¼‰"></a>é¢œè‰²å½’ç±»ï¼ˆæŒ‰è‰²ç³»ï¼‰</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_color_series</span>(<span class="params">rgb_seq</span>):</span>  <span class="comment"># <span class="doctag">TODO:</span>æ­¤å¤„æ˜¯å¦æœ‰æ›´å¥½å®ç°ï¼Ÿ</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    å°†rgbè½¬ä¸ºhsvä¹‹åæ ¹æ®hå’Œvå¯»æ‰¾è‰²ç³»</span></span><br><span class="line"><span class="string">    :param rgb_seq:</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    h, s, v = rgb_to_hsv(rgb_seq)</span><br><span class="line">    cs = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">if</span> <span class="number">30</span> &lt; h &lt;= <span class="number">90</span>:</span><br><span class="line">        cs = <span class="string">&#x27;yellow&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="number">90</span> &lt; h &lt;= <span class="number">150</span>:</span><br><span class="line">        cs = <span class="string">&#x27;green&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="number">150</span> &lt; h &lt;= <span class="number">210</span>:</span><br><span class="line">        cs = <span class="string">&#x27;cyan&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="number">210</span> &lt; h &lt;= <span class="number">270</span>:</span><br><span class="line">        cs = <span class="string">&#x27;blue&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="number">270</span> &lt; h &lt;= <span class="number">330</span>:</span><br><span class="line">        cs = <span class="string">&#x27;purple&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> h &gt; <span class="number">330</span> <span class="keyword">or</span> h &lt;= <span class="number">30</span>:</span><br><span class="line">        cs = <span class="string">&#x27;red&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> s &lt; <span class="number">10</span>:  <span class="comment"># è‰²ç›¸å¤ªæ·¡æ—¶ï¼Œæ˜¾ç¤ºä»€ä¹ˆé¢œè‰²ä¸»è¦ç”±äº®åº¦æ¥å†³å®š</span></span><br><span class="line">        cs = update_by_value(v)</span><br><span class="line">    <span class="keyword">assert</span> cs <span class="keyword">in</span> COLOR_SERIES_MAP</span><br><span class="line">    <span class="keyword">return</span> cs</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">update_by_value</span>(<span class="params">v</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    æ ¹æ® V å€¼å»æ›´æ–°è‰²ç³»æ•°æ®</span></span><br><span class="line"><span class="string">    :param v: </span></span><br><span class="line"><span class="string">    :return: </span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> v &lt;= <span class="number">100</span> / <span class="number">3</span> * <span class="number">1</span>:</span><br><span class="line">        cs = <span class="string">&#x27;black&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> v &lt;= <span class="number">100</span> / <span class="number">3</span> * <span class="number">2</span>:</span><br><span class="line">        cs = <span class="string">&#x27;gray&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        cs = <span class="string">&#x27;white&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> cs</span><br></pre></td></tr></table></figure><h4 id="ä»£ç éªŒè¯"><a href="#ä»£ç éªŒè¯" class="headerlink" title="ä»£ç éªŒè¯"></a>ä»£ç éªŒè¯</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"></span><br><span class="line">    color_list = [[<span class="number">22</span>, <span class="number">24</span>, <span class="number">35</span>], [<span class="number">36</span>, <span class="number">134</span>, <span class="number">185</span>], [<span class="number">234</span>, <span class="number">137</span>, <span class="number">88</span>], [<span class="number">32</span>, <span class="number">161</span>, <span class="number">98</span>], [<span class="number">100</span>, <span class="number">106</span>, <span class="number">88</span>]]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> color_list:</span><br><span class="line">        print(find_color_series(item))</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿”å›ç»“æœï¼š<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">blue</span><br><span class="line">cyan</span><br><span class="line">red</span><br><span class="line">cyan</span><br><span class="line">yellow</span><br></pre></td></tr></table></figure><br>è‡³æ­¤ï¼Œæˆ‘ä»¬å®Œæˆäº†æ•°æ®é¢œè‰²ç²—ç•¥çš„å½’ç±»ã€‚<br>åˆ°è¿™é‡Œå°±ç»“æŸäº†å—ï¼Ÿæ˜¾ç„¶æ²¡æœ‰ã€‚å®é™…ä¸Šï¼Œè¿™ç§æ•°æ®è¿”å›ç»“æœæ˜¯å¾ˆç²—ç³™çš„ï¼Œæˆ‘ä»¬éœ€è¦å¯¹ Hue è¿›è¡Œåå¤ä¿®æ­£æ‰èƒ½å¾—å‡ºä¸€ä¸ªè¾ƒä¸ºæ»¡æ„çš„ç»“æœã€‚æ­£å¦‚ç‰©ç†å®éªŒä¸€æ ·ï¼šç†è®ºå’Œå®è·µå¯èƒ½å­˜åœ¨è¾ƒå¤§åå·®ç”šè‡³å¯èƒ½å¾—å‡ºå®Œå…¨ç›¸åçš„ç»“è®ºï¼Œæ­¤å¤„æˆ‘ä»¬ä¸å†å±•å¼€ã€‚ğŸ˜‚æˆ‘ä»¬è¿›ä¸€æ­¥åˆ†ææ•°æ®ï¼Œå‘ç°ï¼š</p><blockquote><p>ç”šä¸‰<strong>ç´…</strong>ã€<strong>é»„</strong>æœ½è‘‰ã€åƒæ­³<strong>ç·‘</strong>ã€éŒ†<strong>é’</strong>ç£ã€æ±Ÿæˆ¸<strong>ç´«</strong>ã€<strong>ç™½</strong>ç·´â€¦â€¦</p></blockquote><p>ä½ ç»†å“~æ˜¯çš„ï¼Œéƒ¨åˆ†é¢œè‰²åç§°é‡Œé¢å·²ç»åŒ…å«äº†é¢œè‰²çš„è‰²ç³»å…³é”®å­—ã€‚æˆ‘ä»¬å‡å®šåç§°çš„å‘½åæ˜¯é è°±çš„ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ­£åˆ™æŠŠè‰²ç³»å…³é”®å­—æå–å‡ºæ¥ï¼Œç„¶ååªå¯¹æ²¡æœ‰æŒ‡æ˜çš„é¢œè‰²è¿›è¡Œè®¡ç®—ã€‚</p><p>å¯æ˜¯ä¸Šé¢çš„ä»£ç å·²ç»å†™å®Œäº†ï¼Œæˆ‘ä¸æƒ³å†å¤§åŠ¨å¹²æˆˆä¿®æ”¹æ­¤å‡½æ•°ï¼Œæ€ä¹ˆåŠï¼Ÿæ­¤å¤„ï¼Œæˆ‘ä»¬ä½¿ç”¨è£…é¥°å™¨ã€‚</p><h4 id="é¢œè‰²å½’ç±»ï¼ˆæŒ‰åç§°ï¼‰"><a href="#é¢œè‰²å½’ç±»ï¼ˆæŒ‰åç§°ï¼‰" class="headerlink" title="é¢œè‰²å½’ç±»ï¼ˆæŒ‰åç§°ï¼‰"></a>é¢œè‰²å½’ç±»ï¼ˆæŒ‰åç§°ï¼‰</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> wraps, partial</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">attach_wrapper</span>(<span class="params">obj, func=<span class="literal">None</span></span>):</span></span><br><span class="line">    <span class="keyword">if</span> func <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span> partial(attach_wrapper, obj)</span><br><span class="line">    <span class="built_in">setattr</span>(obj, func.__name__, func)</span><br><span class="line">    <span class="keyword">return</span> func</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_color_series_by_name</span>(<span class="params">name=<span class="string">&#x27;&#x27;</span></span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    è£…é¥°å™¨ï¼šé€šè¿‡é¢œè‰²çš„ä¸­æ–‡åç§°åˆ©ç”¨æ­£åˆ™åŒ¹é…è·å–é¢œè‰²åç§°</span></span><br><span class="line"><span class="string">    æˆ‘ä»¬å‡å®šå‘½åæ˜¯ç¬¦åˆäººç±»ä¸»è§‚æ„è¯†çš„ï¼Œå³ï¼šåç§°æ¯”æˆ‘ä»¬çš„ä»£ç æ›´å¯é </span></span><br><span class="line"><span class="string">    å› ä¸ºæŒ‰ç…§hsvå»åŒ¹é…çš„æ—¶å€™ä¼šæœ‰è¯¯å·®ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆé€šè¿‡åç§°å»ç›´æ¥åŒ¹é…è‰²ç³»ï¼Œå¦‚æœåç§°ä¸­æ²¡æœ‰å…³é”®å­—ï¼Œæˆ‘ä»¬å†ä½¿ç”¨è‡ªå·±å†™çš„è§„åˆ™</span></span><br><span class="line"><span class="string">    :param name:str,</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">deco</span>(<span class="params">func</span>):</span></span><br><span class="line">        color_name_char = name</span><br><span class="line"></span><br><span class="line"><span class="meta">        @wraps(<span class="params">func</span>)</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span>(<span class="params">*args, **kwargs</span>):</span></span><br><span class="line">            color_series = <span class="string">&#x27;&#x27;</span></span><br><span class="line">            <span class="keyword">if</span> color_name_char:</span><br><span class="line">                re_ret = re.match(REG_COLOR_SERES, color_name_char)</span><br><span class="line">                <span class="keyword">if</span> re_ret:</span><br><span class="line">                    color_signal = re_ret.group(<span class="number">1</span>)</span><br><span class="line">                    color_series = COLOR_SERIES_MAP_REVERSE.get(color_signal)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> color_series == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">                color_series = func(*args, **kwargs)</span><br><span class="line">            <span class="keyword">return</span> color_series</span><br><span class="line"></span><br><span class="line"><span class="meta">        @attach_wrapper(<span class="params">wrapper</span>)</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">set_color_name</span>(<span class="params">new_name</span>):</span></span><br><span class="line">            <span class="keyword">nonlocal</span> color_name_char</span><br><span class="line">            color_name_char = new_name</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> wrapper</span><br><span class="line">    <span class="keyword">return</span> deco</span><br></pre></td></tr></table></figure><p>å…³äºæ­¤å¤„è£…é¥°å™¨çš„å†™æ³•ï¼Œå‚è§ã€ŠPython Cookbook ä¸­æ–‡ç‰ˆã€‹V3 P342 ç¬¬ 9.5 ç« èŠ‚ï¼š<em>å®šä¹‰ä¸€ä¸ªå±æ€§å¯ç”±ç”¨æˆ·ä¿®æ”¹çš„è£…é¥°å™¨</em>ã€‚</p><p>æœ€åï¼Œæˆ‘ä»¬ç»™ä¹‹å‰å†™çš„å‡½æ•°æˆ´ä¸Šè¿™é¡¶å«åšè£…é¥°å™¨çš„â€œå¸½å­â€ã€‚<br><img src= "/img/loading.svg" data-lazy-src="/images/your_hat.jpg" alt="è£…é¥°å™¨"></p><h5 id="è£…é¥°å™¨ä½¿ç”¨"><a href="#è£…é¥°å™¨ä½¿ç”¨" class="headerlink" title="è£…é¥°å™¨ä½¿ç”¨"></a>è£…é¥°å™¨ä½¿ç”¨</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@find_color_series_by_name(<span class="params">name=<span class="string">&#x27;&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_color_series</span>(<span class="params">rgb_seq</span>):</span></span><br><span class="line">    <span class="keyword">pass</span>    <span class="comment"># çœç•¥é‡å¤ä»£ç </span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    </span><br><span class="line">    test_color_map = &#123;<span class="string">&#x27;ä¸œæ–¹çº¢&#x27;</span>: [<span class="number">254</span>, <span class="number">223</span>, <span class="number">225</span>], <span class="string">&#x27;çº¢ä¸œæ–¹&#x27;</span>: [<span class="number">215</span>, <span class="number">196</span>, <span class="number">187</span>], <span class="string">&#x27;æ–¹çº¢ä¸œ&#x27;</span>: [<span class="number">86</span>, <span class="number">46</span>, <span class="number">55</span>], <span class="string">&#x27;é»„ä¸¹&#x27;</span>: [<span class="number">240</span>, <span class="number">94</span>, <span class="number">28</span>],</span><br><span class="line">                      <span class="string">&#x27;ä¸‡çº¢ä¸›ä¸­ä¸€ç‚¹ç»¿&#x27;</span>: [<span class="number">63</span>, <span class="number">43</span>, <span class="number">54</span>]&#125;</span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> test_color_map.items():</span><br><span class="line">        find_color_series.set_color_name(k)</span><br><span class="line">        find_color = find_color_series(v)</span><br><span class="line">        print(find_color)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿”å›ç»“æœ<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">red</span><br><span class="line">red</span><br><span class="line">red</span><br><span class="line">yellow</span><br><span class="line">green</span><br></pre></td></tr></table></figure></p><h2 id="æ€»ç»“å±•æœ›"><a href="#æ€»ç»“å±•æœ›" class="headerlink" title="æ€»ç»“å±•æœ›"></a>æ€»ç»“å±•æœ›</h2><p>ç»è¿‡ä¸Šé¢çš„æ­¥éª¤æˆ‘ä»¬å®Œæˆäº†é¢œè‰²çš„åˆ†ç±»ï¼Œä½†æ˜¯è¿™ç§åˆ†ç±»æ˜¯ç²—ç²’åº¦çš„ï¼Œç»“æœä¹Ÿå¯èƒ½æ˜¯ä¸å¤Ÿå‡†ç¡®çš„ã€‚å¦‚æœéœ€è¦æ›´ç²¾å‡†çš„è®¡ç®—ï¼Œå¯èƒ½éœ€è¦å»ºæ¨¡åŠç®—æ³•ç”šè‡³è®­ç»ƒæ¨¡å‹å»å®ç°ï¼Œè¿™é‡Œä¸å†å±•å¼€ï¼ˆ<del>ä¸»è¦æ˜¯æˆ‘ä¸ä¼š</del>ï¼‰ã€‚</p><p>å¦‚æœé¢œè‰²æœ¬èº«å‘½åé”™è¯¯ï¼Œå¦‚ä¸Šä¾‹ä¸­çš„â€œä¸‡çº¢ä¸›ä¸­ä¸€ç‚¹ç»¿â€ï¼Œæˆ‘ä»¬ç›´æ¥èµ°è£…é¥°å™¨åˆ¤æ–­é€»è¾‘ï¼Œå°±ä¼šä½¿è®¡ç®—è¿‡æ»¤çš„é€»è¾‘å¤±æ•ˆã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ•°æ®åˆ†åˆ«èµ°ä¸¤å¥—é€»è¾‘ï¼Œå¯¹äºä¸¤è€…è¿”å›ä¸€è‡´çš„ï¼Œæˆ‘ä»¬è®¤ä¸ºè¿™ä¸ªæ•°æ®æ˜¯å¯ä¿¡çš„ï¼›å¯¹äºä¸ä¸€è‡´çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬åˆ™éœ€è¦ä½¿ç”¨äººå·¥æ™ºèƒ½çš„â€œäººå·¥â€éƒ¨åˆ†å¯¹æ•°æ®è¿›è¡ŒäºŒæ¬¡ç¼–è¾‘ï¼Œä¹‹åå°†ç»“æœæ›´æ–°ä¸Šå»ã€‚</p><h2 id="è¥¿é£åŸ"><a href="#è¥¿é£åŸ" class="headerlink" title="è¥¿é£åŸ"></a>è¥¿é£åŸ</h2><ol><li>æˆ‘ä»¬çŸ¥é“ Python æ˜¯ä¸€é—¨è‡ªå¸¦ç”µæ± çš„è¯­è¨€ï¼Œå…³äºé¢œè‰² rgb è½¬ hsvï¼Œå…¶å® <a href="https://docs.python.org/zh-cn/3.7/library/colorsys.html">å®˜æ–¹æ¨¡å—</a> <code>colorsys</code> ä¸­å·²ç»æœ‰è‡ªå·±çš„å®ç°ï¼Œæˆ‘ä»¬éœ€è¦çš„åªæ˜¯å¯¹æ•°æ®åšç›¸åº”æ¯”ä¾‹çš„æ”¾å¤§ã€‚å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨åç»­é€»è¾‘ä¸­ç›´æ¥ç”¨å®˜æ–¹è¿”å›çš„æ•°æ®åˆ’åˆ†åŒºåŸŸã€‚<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; import colorsys</span><br><span class="line">&gt;&gt;&gt; colorsys.rgb_to_hsv(0.2, 0.4, 0.4)</span><br><span class="line">(0.5, 0.5, 0.4)</span><br><span class="line">&gt;&gt;&gt; colorsys.hsv_to_rgb(0.5, 0.5, 0.4)</span><br><span class="line">(0.2, 0.4, 0.4)</span><br></pre></td></tr></table></figure></li><li>å…³äºé¢œè‰²çš„åˆ¤æ–­ï¼Œæˆ‘ä»¬çŸ¥é“è‰²çš„ä¸‰åŸè‰²ä¸º RGBï¼ˆçº¢ç»¿è“ï¼‰ï¼Œè€Œå®é™…é¢œè‰²æ˜¯æŒ‰ç…§ä¸åŒæ¯”ä¾‹æ··åˆçš„ï¼Œæ‰€ä»¥é¢œè‰²æ˜¯æ²¡æœ‰åŠæ³•çœŸçš„åšæ˜æ˜¾ç•Œçº¿åŒºåˆ†çš„ã€‚<blockquote><p>è°èƒ½åœ¨å½©è™¹é‡Œç”»ä¸‹ç´«è‰²ç»“æŸã€æ©™è‰²å¼€å§‹çš„åˆ†ç•Œçº¿å‘¢ï¼Ÿæˆ‘ä»¬èƒ½æ¸…æ™°åœ°çœ‹åˆ°é¢œè‰²çš„ä¸åŒï¼Œä½†æ˜¯ç©¶ç«Ÿåœ¨ä»€ä¹ˆåœ°æ–¹ä¸€ç§é¢œè‰²é€æ¸åœ°æ··å…¥äº†å¦ä¸€ç§é¢œè‰²å‘¢ï¼Ÿç†æ™ºå’Œç–¯ç‹‚çš„ç•Œé™ï¼Œäº¦æ˜¯å¦‚æ­¤ã€‚</p></blockquote></li><li>æ—¥å¸¸é»‘ç”·æ€§ç¯èŠ‚ï¼š<br><img src= "/img/loading.svg" data-lazy-src="/images/colors-for-male-and-female.jpg" alt="ç”·ç”Ÿçœ¼ä¸­çš„é¢œè‰² vs å¥³ç”Ÿçœ¼ä¸­çš„é¢œè‰²"></li></ol><h2 id="é“¾æ¥"><a href="#é“¾æ¥" class="headerlink" title="é“¾æ¥"></a>é“¾æ¥</h2><h3 id="æºç ä¸‹è½½"><a href="#æºç ä¸‹è½½" class="headerlink" title="æºç ä¸‹è½½"></a>æºç ä¸‹è½½</h3><p>ğŸ­ <a href="https://github.com/imoyao/my_practices/tree/master/codes/tell_color_by_rgb">my_practices/codes/tell_color_by_rgb at master Â· imoyao/my_practices</a></p><h3 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h3><ul><li><a href="https://blog.csdn.net/hanshanbuleng/article/details/80383813">ä» RGB åˆ° HSV çš„è½¬æ¢è¯¦ç»†ä»‹ç»_äººå·¥æ™ºèƒ½_hanshanbuleng çš„åšå®¢-CSDN åšå®¢</a></li><li><a href="https://www.v2ex.com/amp/t/153186">çŸ¥é“ä¸€ä¸ªé¢œè‰²çš„ RGB å¦‚ä½•å½’ç±»åˆ°ç‰¹å®šé¢œè‰²ï¼ˆå¦‚èµ¤æ©™é»„ç»¿é’è“ç´«é»‘ç™½ç°ï¼‰ï¼Ÿ - V2EX</a></li><li><a href="https://graphicdesign.stackexchange.com/questions/92984/how-can-i-tell-basic-color-a-hex-code-is-closest-to">How can I tell basic color a hex code is closest to? - Graphic Design Stack Exchange</a></li><li><a href="https://stackoverflow.com/questions/4057475/rounding-colour-values-to-the-nearest-of-a-small-set-of-colours/4356523#4356523">algorithm - â€œRoundingâ€ colour values to the nearest of a small set of colours - Stack Overflow</a></li></ul><h3 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="headerlink" title="æ¨èé˜…è¯»"></a>æ¨èé˜…è¯»</h3><ul><li><a href="https://www.guokr.com/article/437666/">é’è‰²æ˜¯ä»€ä¹ˆæ ·å­çš„ï¼Ÿ| æœå£³ ç§‘æŠ€æœ‰æ„æ€</a></li></ul><h3 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h3><ul><li><a href="http://www.bosimedia.com/wiki/%E9%A2%9C%E8%89%B2%E5%88%97%E8%A1%A8">é¢œè‰²åˆ—è¡¨ - ç»´åŸºä¸­æ–‡é•œåƒï¼Œè‡ªç”±çš„ç™¾ç§‘å…¨ä¹¦</a></li><li><a href="http://www.jq22.com/yanshi16883">latex åœ¨çº¿å…¬å¼ç¼–è¾‘å™¨æ±‰åŒ–ç‰ˆ</a></li><li><a href="https://www.rapidtables.com/convert/color/hsv-to-rgb.html">HSV to RGB conversion | color conversion</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Projects </category>
          
          <category> GUSCSS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> è£…é¥°å™¨ </tag>
            
            <tag> è‰²ç³» </tag>
            
            <tag> é¢œè‰² </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸­å›½ä¼ ç»Ÿè‰² | æœ±ç ‚ç—£è¿˜æ˜¯ç™½æœˆå…‰ï¼Œå“ªä¸ªæ‰æ˜¯æˆ‘ä»¬çš„å¿ƒå¤´å¥½ï¼Ÿ</title>
      <link href="blog/2020-04-13/Traditional-Chinese-Colors/"/>
      <url>blog/2020-04-13/Traditional-Chinese-Colors/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>å¼ çˆ±ç²åœ¨ã€Šçº¢ç«ç‘°ä¸ç™½ç«ç‘°ã€‹ä¸­è¿™æ ·å†™é“ï¼š</p><blockquote><p>ä¹Ÿè®¸æ¯ä¸€ä¸ªç”·å­å…¨éƒ½æœ‰è¿‡è¿™æ ·çš„ä¸¤ä¸ªå¥³äººï¼Œè‡³å°‘ä¸¤ä¸ªã€‚å¨¶äº†çº¢ç«ç‘°ï¼Œä¹…è€Œä¹…ä¹‹ï¼Œçº¢çš„å˜äº†å¢™ä¸Šçš„ä¸€æŠ¹èšŠå­è¡€ï¼Œç™½çš„è¿˜æ˜¯â€åºŠå‰æ˜æœˆå…‰â€ï¼›å¨¶äº†ç™½ç«ç‘°ï¼Œç™½çš„ä¾¿æ˜¯è¡£æœä¸Šæ²¾çš„ä¸€ç²’é¥­é»å­ï¼Œçº¢çš„å´æ˜¯å¿ƒå£ä¸Šä¸€é¢—æœ±ç ‚ç—£ã€‚</p></blockquote><p>é‚£ä¹ˆç™½æœˆå…‰å’Œæœ±ç ‚ç—£åˆ°åº•æœ‰ä»€ä¹ˆä¸åŒå‘¢ï¼Ÿå˜¿å˜¿ï¼Œå…¶å®è¿™æ˜¯ä¸€ç¯‡è®²è‡ªå·±å¼€æºé¡¹ç›®çš„æ–‡ç« ï¼Œè¢«æ ‡é¢˜éª—è¿›æ¥çš„éæˆ˜æ–—äººå‘˜å¯ä»¥é€‰æ‹©è‡ªè¡Œç¦»åœºå•¦ã€‚ğŸ˜³</p><h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>ç”¨äºå±•ç¤ºä¸­å›½ä¼ ç»Ÿè‰²çš„ç½‘ç«™å¾ˆå¤šï¼Œä¸ºä»€ä¹ˆæˆ‘è¿˜è¦å åºŠæ¶å±‹åœ°å»è‡ªå·±é€ è½®å­å‘¢ï¼Ÿä¸ºäº†ç»ƒæ‰‹ï¼Œé¡ºä¾¿æ‰“å‘è‡ªå·±é—²å¾—æŒ å¢™çš„æ— èŠæ—¶å…‰ã€‚ä¼—æ‰€å‘¨çŸ¥ï¼Œäººç±»çš„æœ¬è´¨æ˜¯å¤è¯»æœºã€‚ğŸ¤¬</p><h2 id="æŠ€æœ¯æ ˆ"><a href="#æŠ€æœ¯æ ˆ" class="headerlink" title="æŠ€æœ¯æ ˆ"></a>æŠ€æœ¯æ ˆ</h2><h3 id="åç«¯"><a href="#åç«¯" class="headerlink" title="åç«¯"></a>åç«¯</h3><ol><li style="list-style: none"><input type="checkbox" checked></input> ä½¿ç”¨ Python æ”¶é›†ã€æ•´ç†ã€å»é‡æ•°æ®ï¼›</li><li style="list-style: none"><input type="checkbox"></input> çˆ¬è™«ï¼Œä½¿ç”¨ request æ¨¡å—ç­‰ï¼›</li></ol><h3 id="å‰ç«¯"><a href="#å‰ç«¯" class="headerlink" title="å‰ç«¯"></a>å‰ç«¯</h3><p> ä½¿ç”¨ Vue ç¼–å†™é¡µé¢ï¼Œå±•ç¤ºæ•°æ®ï¼›</p><h2 id="å…·ä½“è§£å†³æ–¹æ¡ˆä»‹ç»"><a href="#å…·ä½“è§£å†³æ–¹æ¡ˆä»‹ç»" class="headerlink" title="å…·ä½“è§£å†³æ–¹æ¡ˆä»‹ç»"></a>å…·ä½“è§£å†³æ–¹æ¡ˆä»‹ç»</h2><h3 id="æ•°æ®è·å–"><a href="#æ•°æ®è·å–" class="headerlink" title="æ•°æ®è·å–"></a>æ•°æ®è·å–</h3><ol><li>å¯¹äºç½‘ç«™ç»™å‡ºæºç çš„ï¼ˆç›®å‰å·²å®Œæˆï¼‰<br> ç›´æ¥å»æºç ä¸­æ‹¿æ•°æ®ï¼Œä¹‹åå¯¹æ ¼å¼æ‹¼è£…ã€ç»„åˆï¼›</li><li>æ²¡æœ‰æºç çš„ï¼ˆåæœŸå¼€å‘è®¡åˆ’ï¼‰<ol><li>ä¸Šçˆ¬è™«ï¼Œç»™ğŸ‘´çˆ¬ï¼</li><li>åˆ©ç”¨ OCR æŠ€æœ¯è¯†åˆ«æ–‡å­—å’Œ PIL è·å–é¢œè‰²å¯¹åº”çš„ RGB å€¼æ•°æ®ï¼›<ul><li><a href="https://kite.com/python/answers/how-get-the-rgb-values-of-an-image-using-pil-in-python">Kite - AI Autocomplete for Python</a></li></ul></li></ol></li></ol><h3 id="æ•°æ®å¤„ç†"><a href="#æ•°æ®å¤„ç†" class="headerlink" title="æ•°æ®å¤„ç†"></a>æ•°æ®å¤„ç†</h3><h4 id="é¢œè‰²åç§°"><a href="#é¢œè‰²åç§°" class="headerlink" title="é¢œè‰²åç§°"></a>é¢œè‰²åç§°</h4><p>ä½¿ç”¨ pypinyin è·å–åç§°æ‹¼éŸ³ï¼Œä½¿ç”¨ zhtools ä¿å­˜é¢œè‰²ç®€ä½“å’Œç¹ä½“ä¸¤ç§åç§°ï¼›</p><h4 id="æ–‡å­—æ˜¾ç¤º"><a href="#æ–‡å­—æ˜¾ç¤º" class="headerlink" title="æ–‡å­—æ˜¾ç¤º"></a>æ–‡å­—æ˜¾ç¤º</h4><ul><li><a href="https://blog.csdn.net/sinat_38184748/article/details/93002587">åˆ¤æ–­é¢œè‰²ä¸ºæ·±é¢œè‰²è¿˜æ˜¯æµ…é¢œè‰²æ¥åŠ¨æ€è°ƒæ•´ app æ–‡å­—å’Œå›¾æ ‡é¢œè‰²_ç§»åŠ¨å¼€å‘_YD-10-NG çš„åšå®¢-CSDN åšå®¢</a><br>é¢œè‰²æè¿°ä½¿ç”¨é»˜è®¤æè¿°ï¼Œå½“é»˜è®¤æè¿°ä¸ºç©ºæ—¶ï¼Œè°ƒç”¨<a href="https://www.jinrishici.com/">ä»Šæ—¥è¯—è¯ API</a>ï¼Œå¦‚æœè°ƒç”¨å¤±è´¥ï¼Œåˆ™æ˜¾ç¤ºé»˜è®¤è¯—å¥ã€‚</li></ul><h4 id="è‰²ç³»åˆ¤æ–­"><a href="#è‰²ç³»åˆ¤æ–­" class="headerlink" title="è‰²ç³»åˆ¤æ–­"></a>è‰²ç³»åˆ¤æ–­</h4><p>å°†é¢œè‰²çš„ RGB è‰²å€¼è½¬åŒ–ä¸º HSVï¼Œä¹‹åé€šè¿‡ hue å»åˆ¤æ–­å½©è‰²çš„è‰²å€¼ï¼Œç”¨æ˜åº¦å»åˆ¤æ–­é»‘ç™½ç°ã€‚<br>å‚è§ <a href="/blog/2020-04-15/tell-me-rgb-values-nearest-color-with-Python/">å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªé¢œè‰²å±äºä»€ä¹ˆè‰²ç³»ï¼Ÿ</a></p><h2 id="æ›´æ–°å­—å…¸"><a href="#æ›´æ–°å­—å…¸" class="headerlink" title="æ›´æ–°å­—å…¸"></a>æ›´æ–°å­—å…¸</h2><p><a href="https://codereview.stackexchange.com/questions/209202/merge-two-list-of-dicts-with-same-key">python - Merge two list of dicts with same key - Code Review Stack Exchange</a><br>å°†æ•°æ®æŒ‰ç…§è‰²ç³»åˆ†ç»„<br><a href="https://www.geeksforgeeks.org/python-merging-two-list-of-dictionaries/">Python | Merging two list of dictionaries - GeeksforGeeks</a></p><h2 id="æ·»åŠ â€œäº¿ç‚¹ç‚¹â€ç»†èŠ‚"><a href="#æ·»åŠ â€œäº¿ç‚¹ç‚¹â€ç»†èŠ‚" class="headerlink" title="æ·»åŠ â€œäº¿ç‚¹ç‚¹â€ç»†èŠ‚"></a>æ·»åŠ â€œäº¿ç‚¹ç‚¹â€ç»†èŠ‚</h2><p>ä½¿ç”¨ Vue å°†é¡µé¢å±•ç¤ºå‡ºæ¥ï¼Œæ­¤å¤„å‚è€ƒäº†å¼€æºé¡¹ç›® <a href="https://github.com/ssshooter/nippon-color">ssshooter/nippon-color</a>ã€‚å†™åç«¯çš„ä½ ç¡¬è®©æˆ‘å†™å‰ç«¯ï¼Œæˆ‘çœ‹ä½ æ˜¯åœ¨ä¸ºéš¾æˆ‘èƒ–è™ã€‚<br><img src= "/img/loading.svg" data-lazy-src="/images/draw_horse.jpeg" alt="å¦‚ä½•ç”»é©¬"></p><h2 id="æ•ˆæœå±•ç¤º"><a href="#æ•ˆæœå±•ç¤º" class="headerlink" title="æ•ˆæœå±•ç¤º"></a>æ•ˆæœå±•ç¤º</h2><p><img src= "/img/loading.svg" data-lazy-src="/images/zhusha.png" alt="æœ±ç ‚|ç”µè„‘"></p><p><img src= "/img/loading.svg" data-lazy-src="/images/iPad-with-case-on-wood-table.png" alt="é’è‘±|å¹³æ¿"></p><p><img src= "/img/loading.svg" data-lazy-src="/images/yuebai.png" alt="æœˆç™½|æ‰‹æœº"></p><h2 id="éƒ¨ç½²"><a href="#éƒ¨ç½²" class="headerlink" title="éƒ¨ç½²"></a>éƒ¨ç½²</h2><p>Github æ”¯æŒéƒ¨ç½² docs ç›®å½•ä¸ºé¡¹ç›®æ–‡æ¡£ï¼Œæˆ‘ä»¬ç›´æ¥ä¿®æ”¹<code>vue.config.js</code>è®¾ç½®<code>outputDir: &#39;docs&#39;</code>ï¼ŒæŠŠå…¶å¯¼å‡ºåˆ° docs ç›®å½•ï¼Œ<br>å‚è§<a href="https://github.blog/2016-08-17-simpler-github-pages-publishing/">Simpler GitHub Pages publishing - The GitHub Blog</a></p><h2 id="å±•æœ›"><a href="#å±•æœ›" class="headerlink" title="å±•æœ›"></a>å±•æœ›</h2><p>è¿˜æœ‰å¾ˆå¤šç‚¹å¯ä»¥å®Œå–„ï¼š</p><ol><li>å¤šéŸ³å­—è¯ç»„çš„æ­£ç¡®å‘éŸ³ã€‚å¦‚<a href="https://colors.masantu.com/#/?colorId=100115112">å¡å…¶ç»¿</a></li><li>æ›´åŠ æƒå¨çš„æ•°æ®æ¥æºã€‚</li></ol><h2 id="Help-Wanted"><a href="#Help-Wanted" class="headerlink" title="Help Wanted"></a>Help Wanted</h2><h3 id="æˆ‘æ˜¯å¼€å‘è€…"><a href="#æˆ‘æ˜¯å¼€å‘è€…" class="headerlink" title="æˆ‘æ˜¯å¼€å‘è€…"></a>æˆ‘æ˜¯å¼€å‘è€…</h3><p>ä½ å¯ä»¥ fork æ­¤ä»“åº“ä¹‹åä¿®æ”¹<a href="https://github.com/imoyao/GUSCSS/blob/dev/_data/amend.json">amend æ–‡ä»¶</a> ä¸­çš„ data å­—æ®µï¼Œä¿®æ”¹æ˜¯ä»¥ id ä¸ºå‚è€ƒåŸºå‡†ï¼Œåªéœ€è¦æäº¤ä¿®æ”¹æ–°å€¼ï¼Œä¸ä¿®æ”¹å€¼ç›´æ¥ä¸å†™ï¼ˆæˆ‘ä»¬ä¼šä½¿ç”¨ Python å­—å…¸çš„ update æ–¹æ³• patch æ›´æ–°æ•°æ®ï¼‰ï¼Œä¹‹åæäº¤ pr å³å¯ã€‚å½“ç„¶ï¼Œä¹Ÿæ¬¢è¿æäº¤ä»£ç é€»è¾‘åŠå®ç°ä¸­ä¸åˆç†çš„åœ°æ–¹åŠ bug ä¿®å¤ã€‚æ›´å¤šå‚è€ƒ <a href="https://github.com/imoyao/GUSCSS/projects/1">æ­¤å¤„</a><br>å‚è€ƒæ•°æ®æ ·å¼ï¼š<br><figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;id&quot;</span>: <span class="string">&quot;1847572&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;æœ±ç ‚&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;tra_name&quot;</span>: <span class="string">&quot;ç¡ƒç ‚&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;color_series&quot;</span>: <span class="string">&quot;red&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;pinyin&quot;</span>: <span class="string">&quot;zhÅ« shÄ&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;font_color&quot;</span>: <span class="string">&quot;dark&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;is_bright&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">&quot;rgb&quot;</span>: [</span><br><span class="line">    <span class="number">184</span>,</span><br><span class="line">    <span class="number">75</span>,</span><br><span class="line">    <span class="number">72</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">&quot;hex&quot;</span>: <span class="string">&quot;#FF461F&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;cmyk&quot;</span>: [</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">59</span>,</span><br><span class="line">    <span class="number">61</span>,</span><br><span class="line">    <span class="number">28</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">&quot;desc&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;figure&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="æˆ‘æ˜¯æ™®é€šç”¨æˆ·"><a href="#æˆ‘æ˜¯æ™®é€šç”¨æˆ·" class="headerlink" title="æˆ‘æ˜¯æ™®é€šç”¨æˆ·"></a>æˆ‘æ˜¯æ™®é€šç”¨æˆ·</h3><p>å¦‚æœä½ ä¸ä¼šå†™ä»£ç ï¼Œä½†æ˜¯å‘ç°é¡µé¢ä¸­æœ‰ä¸¥é‡é”™è¯¯ã€‚å¦‚æœä½ æœ‰ Github è´¦å·ï¼Œå¯ä»¥å» <a href="https://github.com/imoyao/GUSCSS/issues">issue é¡µé¢</a> æäº¤åé¦ˆï¼›å¦‚æœä½ æ²¡æœ‰è´¦å·æˆ–è€…ä¸ä¼šä½¿ç”¨ Githubï¼Œå¯ä»¥é€šè¿‡ç•™è¨€æ–¹å¼æˆ–è€…ç›´æ¥å‘é‚®ä»¶ <a href="mailto:immoyao@gmail.com">ç»™æˆ‘</a> è¿›è¡Œåé¦ˆï¼Œé‚®ç®±åœ°å€ï¼š<a href="mailto:immoyao@gmail.com">immoyao@gmail.com</a>ã€‚</p><h3 id="æˆ‘é™¤äº†é’±å•¥éƒ½æ²¡"><a href="#æˆ‘é™¤äº†é’±å•¥éƒ½æ²¡" class="headerlink" title="æˆ‘é™¤äº†é’±å•¥éƒ½æ²¡"></a>æˆ‘é™¤äº†é’±å•¥éƒ½æ²¡</h3><p>è¯·ä½¿ç”¨å¾®ä¿¡ï¼ˆWeChatï¼‰æ‰«æä¸‹æ–¹äºŒç»´ç ä¸æˆ‘ä¸€èµ·åš<strong>å…¬ç›Š</strong>å§ï¼<br><img src= "/img/loading.svg" data-lazy-src="https://www.masantu.com/img/PublicWelfare-for-Children.jpg" alt="è…¾è®¯å…¬ç›Š"><br>å½“ç„¶ï¼Œè¿˜å¯ä»¥å»æˆ‘çš„åšå®¢æ‰¾èµèµç ç»™æˆ‘æ‰“é’±ã€‚ï¼ˆæ…¢æ…¢æ‰¾å»å§ï¼‰ğŸ˜Š</p><h2 id="æ•°æ®æ¥æº"><a href="#æ•°æ®æ¥æº" class="headerlink" title="æ•°æ®æ¥æº"></a>æ•°æ®æ¥æº</h2><ul><li><a href="http://boxingp.github.io/traditional-chinese-colors/">Traditional Chinese Colors | ä¸­å›½ä¼ ç»Ÿé¢œè‰²</a><br>  æºç ï¼š<a href="https://github.com/BoxingP/traditional-chinese-colors">BoxingP/traditional-chinese-colors</a></li><li><a href="https://colors.flinhong.com/">colors-source.yml</a>| <a href="https://htmlcss.jp/color/china.html">ä¸­å›½ã®ä¼çµ±è‰² 320 è‰²</a><br>  æºç ï¼š<a href="https://github.com/flinhong/colors/">flinhong/colors: é’å±±ç»¿æ°´ï¼Œç™½è‰çº¢å¶é»„èŠ±ã€‚é¢œè‰²éƒ½è¯¥æœ‰å®ƒå¥½å¬çš„åå­—ï¼</a></li><li><a href="https://ssshooter.github.io/nippon-color/#/">nipponcolor</a><br>  æºç  <a href="https://github.com/ssshooter/nippon-color">ssshooter/nippon-color: nippon-color PWA build with vue-cli 3</a></li><li><a href="https://colors.ichuantong.cn/">ä¸­å›½ä¼ ç»Ÿé¢œè‰²æ‰‹å†Œ | Chinese Color Cheatsheet</a><br>  æºç ï¼š<a href="https://github.com/zerosoul/chinese-colors">zerosoul/chinese-colors: ğŸ‡¨ğŸ‡³ğŸ¨Chinese traditional color cheatsheet online</a></li><li><a href="https://www.douban.com/doulist/34917690/">ä¹¾éš†è‰²è°±â€”â€”ä»å†å²æ¡£æ¡ˆå¤åŸæ¸…ä»£è‰²å½©</a></li></ul><h2 id="é“¾æ¥"><a href="#é“¾æ¥" class="headerlink" title="é“¾æ¥"></a>é“¾æ¥</h2><ul><li><a href="https://colors.masantu.com/#/">GUSCSS | ç»™ä½ ç‚¹é¢œè‰²ç§ç§</a></li><li><a href="https://github.com/imoyao/GUSCSS">æºç  Â· imoyao/GUSCSS</a></li></ul><blockquote><p>å¨‡è•Šæ”¾ä¸‹èŒ¶æ¯ï¼Œç«‹èµ·èº«ï¼Œä»ç¢—æ©±é‡Œå–å‡ºä¸€ç½å­èŠ±ç”Ÿé…±æ¥ï¼Œç¬‘é“ï¼šâ€œæˆ‘æ˜¯ä¸ªç²—äººï¼Œå–œæ¬¢åƒç²—ä¸œè¥¿ã€‚â€æŒ¯ä¿ç¬‘é“ï¼šâ€œå“å‘€ï¼è¿™ä¸œè¥¿æœ€å¯Œäºæ»‹å…»æ–™ï¼Œæœ€ä½¿äººå‘èƒ–çš„ï¼â€å¨‡è•Šå¼€äº†ç›–å­é“ï¼šâ€œæˆ‘é¡¶å–œæ¬¢çŠ¯æ³•ã€‚ä½ ä¸èµæˆçŠ¯æ³•ä¹ˆï¼Ÿâ€æŒ¯ä¿æŠŠæ‰‹æŒ‰ä½ç»ç’ƒç½ï¼Œé“ï¼šâ€œä¸ã€‚â€å¨‡è•Šè¸Œèº‡åŠæ—¥ï¼Œç¬‘é“ï¼šâ€œè¿™æ ·ç½¢ï¼Œä½ ç»™æˆ‘é¢åŒ…ä¸Šå¡Œä¸€ç‚¹ã€‚ä½ ä¸ä¼šç»™æˆ‘å¤ªå¤šçš„ã€‚â€æŒ¯ä¿è§å¥¹åšå‡ºé‚£æ¥šæ¥šå¯æ€œçš„æ ·å­ï¼Œä¸ç¦ç¬‘äº†èµ·æ¥ï¼ŒæœçœŸä¸ºå¥¹çš„é¢åŒ…ä¸Šæ•·äº†èŠ±ç”Ÿé…±ã€‚å¨‡è•Šä»èŒ¶æ¯å£ä¸Šå‡è§†ç€ä»–ï¼ŒæŠ¿ç€å˜´ä¸€ç¬‘é“ï¼šâ€œä½ çŸ¥é“æˆ‘ä¸ºä»€ä¹ˆæ”¯ä½¿ä½ ï¼Ÿè¦æ˜¯æˆ‘è‡ªå·±ï¼Œä¹Ÿè®¸ä¸€ä¸‹å­æ„å¿—åšå¼ºèµ·æ¥ï¼Œå¡Œå¾—æè–„æè–„ã€‚å¯æ˜¯ä½ ï¼Œæˆ‘çŸ¥é“ä½ ä¸å¥½æ„æ€ç»™æˆ‘å¡Œå¾—å¤ªå°‘çš„ï¼â€ä¸¤äººåŒå£°å¤§ç¬‘ã€‚</p><footer><strong>å¼ çˆ±ç²</strong><cite>ã€Šçº¢ç«ç‘°ä¸ç™½ç«ç‘°ã€‹</cite></footer></blockquote>]]></content>
      
      
      <categories>
          
          <category> Projects </category>
          
          <category> GUSCSS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®°ä¸€æ¬¡ base64 ç¼–ç é”™è¯¯é—®é¢˜</title>
      <link href="blog/2020-03-24/python-ignore-incorrect-padding-error-when-base64-decoding/"/>
      <url>blog/2020-03-24/python-ignore-incorrect-padding-error-when-base64-decoding/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å‡ºç°è¿™ä¸ªé—®é¢˜ï¼Œé¦–å…ˆçœ‹ä¸€ä¸‹æ˜¯ä¸æ˜¯æŠŠ encode åçš„å­—ç¬¦é”™è¯¯åœ°ä¼ ç»™äº† decode æ–¹æ³•ï¼Œå¦‚æœæ˜¯çš„è¯ï¼Œè¯·è°ƒç”¨æ­£ç¡®çš„æ–¹æ³•ï¼Œå¦‚æœä¸æ˜¯ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨ä¸‹é¢çš„ä»£ç ã€‚</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bytes2JsonEncoder</span>(<span class="params">json.JSONEncoder</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    è§£å†³ï¼šTypeError: Object of type bytes is not JSON serializable</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">default</span>(<span class="params">self, obj</span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(obj, <span class="built_in">bytes</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">str</span>(obj, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> json.JSONEncoder.default(self, obj)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B64Crypty</span>:</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    å¯†ç æ··æ·†ä¸åæ··æ·†</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">b64encode</span>(<span class="params">plain_text</span>):</span></span><br><span class="line">        <span class="keyword">return</span> base64.b64encode(plain_text.encode())</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pw_decode</span>(<span class="params">cipher_text</span>):</span></span><br><span class="line">        <span class="keyword">return</span> base64.b64decode(cipher_text).decode()</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">b64decode_wrap</span>(<span class="params">cipher_text</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        # è§£å†³é—®é¢˜ï¼špython-ignore-incorrect-padding-error-when-base64-decoding</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Wrapper for base64.b64decode</span></span><br><span class="line"><span class="string">        - Expects Base64 encoded ASCII data as input argument cipher_text</span></span><br><span class="line"><span class="string">        - Returns decoded data as bytes object</span></span><br><span class="line"><span class="string">        - Expects cipher_text uses standard Base64 place-values:  A-Z; a-z; 0-9; +; /.</span></span><br><span class="line"><span class="string">        - Robust to missing Base64 encoded characters</span></span><br><span class="line"><span class="string">          - Will not return original data in this case</span></span><br><span class="line"><span class="string">        - Not necessarily robust to corrupted characters in cipher_text</span></span><br><span class="line"><span class="string">        - Throws MISSING_B64_NOT_ASCII exception if cipher_text contains non-ASCII</span></span><br><span class="line"><span class="string">          characters; implemented via bytes.decode and/or str.encode</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># Ensure argument is either bytes ASCII or str ASCII</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">isinstance</span>(cipher_text, <span class="built_in">bytes</span>):</span><br><span class="line">                arg_string = cipher_text.decode(<span class="string">&#x27;ASCII&#x27;</span>)</span><br><span class="line">            <span class="keyword">elif</span> <span class="built_in">isinstance</span>(cipher_text, <span class="built_in">str</span>):</span><br><span class="line">                arg_string = cipher_text.encode().decode(<span class="string">&#x27;ASCII&#x27;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">assert</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="keyword">raise</span> exceptions.MISSING_B64_NOT_ASCII(</span><br><span class="line">                <span class="string">&#x27;Method missing_b64.b64decode Base64 encoded argument is neither ASCII bytes nor ASCII str&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># Remove any = chars, and try padding with two =s</span></span><br><span class="line">            <span class="comment"># - This will work with (len(cipher_text&#x27;) % 4) of 0, 2 or 3</span></span><br><span class="line">            <span class="comment">#  - cipher_text&#x27; is cipher_text with all non-Base64-standard-place-values removed</span></span><br><span class="line">            decode_ret = base64.b64decode(arg_string.replace(<span class="string">&#x27;=&#x27;</span>, <span class="string">&#x27;&#x27;</span>) + <span class="string">&#x27;==&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span> base64.binascii.Error <span class="keyword">as</span> e:</span><br><span class="line">            <span class="comment"># If that failed, padd with A==</span></span><br><span class="line">            <span class="comment"># - This will work with (len(cipher_text&#x27;) % 4) of 1</span></span><br><span class="line">            decode_ret = base64.b64decode(arg_string.replace(<span class="string">&#x27;=&#x27;</span>, <span class="string">&#x27;&#x27;</span>) + <span class="string">&#x27;A==&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="comment"># Execution should never get here</span></span><br><span class="line">            <span class="keyword">raise</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(decode_ret, <span class="built_in">bytes</span>):  <span class="comment"># for py3</span></span><br><span class="line">            <span class="keyword">return</span> decode_ret.encode()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> decode_ret</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://stackoverflow.com/questions/2941995/python-ignore-incorrect-padding-error-when-base64-decoding">Python: Ignore â€˜Incorrect paddingâ€™ error when base64 decoding - Stack Overflow</a></p>]]></content>
      
      
      <categories>
          
          <category> å·¥ä½œæ—¥å¸¸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CentOS7 å®‰è£… Octopus ç‰ˆ CEPHï¼ˆä½¿ç”¨ cephadmï¼‰</title>
      <link href="blog/2020-03-22/cephadm-install-Ceph-Octopus-on-CentOS7/"/>
      <url>blog/2020-03-22/cephadm-install-Ceph-Octopus-on-CentOS7/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h2 id="ç‰ˆæœ¬ä¿¡æ¯"><a href="#ç‰ˆæœ¬ä¿¡æ¯" class="headerlink" title="ç‰ˆæœ¬ä¿¡æ¯"></a>ç‰ˆæœ¬ä¿¡æ¯</h2><ul><li>ç³»ç»Ÿä¿¡æ¯  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[root@cepho ~]# uname -r</span><br><span class="line">3.10.0-957.el7.x86_64</span><br><span class="line">[root@cepho ~]# cat &#x2F;etc&#x2F;system-release</span><br><span class="line">CentOS Linux release 7.6.1810 (Core) </span><br></pre></td></tr></table></figure></li><li>Python3 ç‰ˆæœ¬  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[root@cepho ~]# python3 -V</span><br><span class="line">Python 3.8.2</span><br></pre></td></tr></table></figure>  ç”Ÿäº§ç¯å¢ƒä¸­æˆ‘ä»¬æ²¡æœ‰å¿…è¦è¿½æ±‚æœ€æ–°ï¼Œå®‰è£… 3.6 ç‰ˆæœ¬å³å¯ã€‚å½“ç„¶å¦‚æœä½ è¿½æ±‚æœ€æ–°ï¼Œé‚£ä¹ˆå°±ç”¨æœ€æ–°çš„ä¹Ÿå¥½ã€‚</li><li>Docker ä¿¡æ¯  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[root@cepho ~]# docker --version</span><br><span class="line">Docker version 19.03.8, build afacb8b</span><br></pre></td></tr></table></figure></li><li>CEPH ç‰ˆæœ¬<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ceph --version</span><br><span class="line">ceph version 15.1.1 (4536217610b4c55c08a293e67f5ae1f1129190be) octopus (rc)</span><br></pre></td></tr></table></figure>å› ä¸ºç³»ç»Ÿå®‰è£…çš„æ˜¯æ™®é€šç‰ˆæœ¬è€Œä¸æ˜¯æœ€å°å®‰è£…ï¼Œæ‰€ä»¥ ntpã€lvm ç®¡ç†å·¥å…·ç­‰é»˜è®¤å·²ç»å®‰è£…ã€‚</li></ul><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>Cephadm é€šè¿‡ SSH ä»ç®¡ç†å®ˆæŠ¤ç¨‹åºè¿æ¥åˆ°ä¸»æœºæ¥éƒ¨ç½²å’Œç®¡ç† Ceph ç¾¤é›†ï¼Œä»¥æ·»åŠ ã€åˆ é™¤æˆ–æ›´æ–° Ceph å®ˆæŠ¤ç¨‹åºçš„å®¹å™¨ã€‚å®ƒä¸ä¾èµ–äºå¤–éƒ¨é…ç½®æˆ–ç¼–æ’å·¥å…·ï¼Œå¦‚ Ansibleã€Rook æˆ– Saltã€‚</p><p>Cephadm ç®¡ç† Ceph ç¾¤é›†çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸã€‚å®ƒé¦–å…ˆåœ¨å•ä¸ªèŠ‚ç‚¹ï¼ˆä¸€ä¸ª<code>monitor</code>å’Œä¸€ä¸ª<code>mgr</code>ï¼‰ä¸Šå¼•å¯¼ä¸€ä¸ªæœ€ç®€çš„ Ceph ç¾¤é›†ï¼Œç„¶åä½¿ç”¨ä¸šåŠ¡æµç¨‹æ¥å£ï¼ˆåç»­å‘½ä»¤ï¼ˆâ€œday 2â€ commandsï¼‰ï¼‰æ‰©å±•ç¾¤é›†ä»¥åŒ…æ‹¬æ‰€æœ‰ä¸»æœºå¹¶é¢„é…æ‰€æœ‰ Ceph å®ˆæŠ¤è¿›ç¨‹å’ŒæœåŠ¡ã€‚è¿™å¯ä»¥é€šè¿‡ Ceph å‘½ä»¤è¡Œæ¥å£ ï¼ˆCLIï¼‰ æˆ– dashboard  ï¼ˆGUIï¼‰ æ‰§è¡Œå®Œæˆã€‚</p><h2 id="å‘å±•åŠ¨å‘"><a href="#å‘å±•åŠ¨å‘" class="headerlink" title="å‘å±•åŠ¨å‘"></a>å‘å±•åŠ¨å‘</h2><p>ç›®å‰ cephadm ä»ç„¶åœ¨è¿›ä¸€æ­¥å¼€å‘ï¼ŒåŠŸèƒ½æ­£åœ¨æœ‰æ¡ä¸ç´Šåœ°è¿›è¡Œç€ï¼Œä½¿ç”¨ cephadm æ˜¯ä¸€ä¸ªå·®å¼ºäººæ„çš„é€‰æ‹©ã€‚<br>ä»¥ä¸‹ç»„ä»¶çš„ Cephadm ç®¡ç†ç›®å‰å¾—åˆ°è‰¯å¥½æ”¯æŒï¼š</p><ul><li>Monitors</li><li>Managers</li><li>OSDs</li><li>CephFS æ–‡ä»¶ç³»ç»Ÿ</li><li>rbd-mirror</li></ul><p>ä»¥ä¸‹ç»„ä»¶æ­£åœ¨ä½¿ç”¨ cephadmï¼Œä½†æ–‡æ¡£å¹¶ä¸åƒæˆ‘ä»¬å¸Œæœ›çš„é‚£ä¹ˆå®Œæ•´ï¼Œè€Œä¸”åœ¨ä¸ä¹…çš„å°†æ¥ä½¿ç”¨å¯èƒ½ä¼šæœ‰ä¸€äº›å˜åŒ–ï¼š</p><ul><li>RGW</li><li>dmcrypt Osds</li></ul><p>Cephadm å¯¹ä»¥ä¸‹åŠŸèƒ½çš„æ”¯æŒä»åœ¨å¼€å‘ä¸­ï¼š</p><ul><li>NFS</li><li>iSCSI</li></ul><p>å¦‚æœé‡åˆ°é—®é¢˜ï¼Œæ‚¨å§‹ç»ˆå¯ä»¥ä½¿ç”¨ï¼š<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ceph orch pause</span><br></pre></td></tr></table></figure><br>æˆ–ä½¿ç”¨å¦‚ä¸‹æŒ‡ä»¤å®Œå…¨å…³é—­ cephadmï¼š<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ceph orch <span class="built_in">set</span> backend <span class="string">&#x27;&#x27;</span></span><br><span class="line">ceph mgr module <span class="built_in">disable</span> cephadm</span><br></pre></td></tr></table></figure></p><h2 id="å®‰è£…-cephadm"><a href="#å®‰è£…-cephadm" class="headerlink" title="å®‰è£… cephadm"></a>å®‰è£… cephadm</h2><ul><li>ä¸‹è½½ cephadm å¹¶èµ‹æƒ<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">curl --silent --remote-name --location https:&#x2F;&#x2F;github.com&#x2F;ceph&#x2F;ceph&#x2F;raw&#x2F;octopus&#x2F;src&#x2F;cephadm&#x2F;cephadm</span><br><span class="line">chmod +x cephadm</span><br></pre></td></tr></table></figure></li><li><p>æ·»åŠ æºä¿¡æ¯ï¼ŒæŒ‡å®šä¸º Octopus ç‰ˆæœ¬</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">./cephadm add-repo --release octopus</span><br><span class="line">./cephadm install</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ä¼šæ›´æ–° repo ä¿¡æ¯</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.&#x2F;cephadm add-repo --release octopus</span><br><span class="line">INFO:root:Writing repo to &#x2F;etc&#x2F;yum.repos.d&#x2F;ceph.repo...</span><br><span class="line">INFO:cephadm:Enabling EPEL...</span><br></pre></td></tr></table></figure><p>éªŒè¯ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[root@cepho yum.repos.d]# ll -t</span><br><span class="line">total 48</span><br></pre></td></tr></table></figure><p>æ›´æ–°å‰ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># before</span><br><span class="line">total 36</span><br><span class="line">-rw-r--r--. 1 root root  413 Mar 15 12:36 ceph.repo</span><br><span class="line">-rw-r--r--. 1 root root 1664 Nov 23  2018 CentOS-Base.repo</span><br><span class="line">-rw-r--r--. 1 root root 1309 Nov 23  2018 CentOS-CR.repo</span><br><span class="line">-rw-r--r--. 1 root root  649 Nov 23  2018 CentOS-Debuginfo.repo</span><br><span class="line">-rw-r--r--. 1 root root  314 Nov 23  2018 CentOS-fasttrack.repo</span><br><span class="line">-rw-r--r--. 1 root root  630 Nov 23  2018 CentOS-Media.repo</span><br><span class="line">-rw-r--r--. 1 root root 1331 Nov 23  2018 CentOS-Sources.repo</span><br><span class="line">-rw-r--r--. 1 root root 5701 Nov 23  2018 CentOS-Vault.repo</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ›´æ–°å</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># after</span><br><span class="line">-rw-r--r--. 1 root root  477 Mar 22 17:33 ceph.repo</span><br><span class="line">-rw-r--r--. 1 root root 2424 Oct 19 05:57 docker-ce.repo</span><br><span class="line">-rw-r--r--. 1 root root 1050 Sep 18  2019 epel.repo</span><br><span class="line">-rw-r--r--. 1 root root 1149 Sep 18  2019 epel-testing.repo</span><br><span class="line">-rw-r--r--. 1 root root 1664 Nov 23  2018 CentOS-Base.repo</span><br><span class="line">-rw-r--r--. 1 root root 1309 Nov 23  2018 CentOS-CR.repo</span><br><span class="line">-rw-r--r--. 1 root root  649 Nov 23  2018 CentOS-Debuginfo.repo</span><br><span class="line">-rw-r--r--. 1 root root  314 Nov 23  2018 CentOS-fasttrack.repo</span><br><span class="line">-rw-r--r--. 1 root root  630 Nov 23  2018 CentOS-Media.repo</span><br><span class="line">-rw-r--r--. 1 root root 1331 Nov 23  2018 CentOS-Sources.repo</span><br><span class="line">-rw-r--r--. 1 root root 5701 Nov 23  2018 CentOS-Vault.repo</span><br></pre></td></tr></table></figure><p>å…¶ä¸­å‰ä¸‰è¡Œå³æ˜¯æ›´æ–°ä¹‹åçš„æºä¿¡æ¯ã€‚</p><div class="note info no-icon modern"><h3 id="æŠ¥é”™å¤„ç†"><a href="#æŠ¥é”™å¤„ç†" class="headerlink" title="æŠ¥é”™å¤„ç†"></a>æŠ¥é”™å¤„ç†</h3><ol><li>æ²¡æœ‰è£… Python3<br> æ‰§è¡Œç¬¬ä¸€æ¡æŒ‡ä»¤<em>å¯èƒ½</em>æŠ¥é”™ <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.&#x2F;cephadm add-repo --release octopus</span><br><span class="line">-bash: .&#x2F;cephadm: &#x2F;usr&#x2F;bin&#x2F;python3: bad interpreter: No such file or directory</span><br></pre></td></tr></table></figure> è¿™æ˜¯å› ä¸ºç³»ç»Ÿä¸­ç¼ºå°‘ Python3 æ”¯æŒï¼Œæ‰€ä»¥è¦å®‰è£… Python3ï¼Œå…³äº Python3 çš„å®‰è£…å¯ä»¥å‚è€ƒæ­¤å¤„ğŸ‘‡<ol><li><a href="https://www.runoob.com/python3/python3-install.html">Python3 ç¯å¢ƒæ­å»º | èœé¸Ÿæ•™ç¨‹</a> </li><li><a href="https://www.cnblogs.com/Jimc/p/10218062.html">å®‰è£… Python æ‰€éœ€ä¾èµ–ç¯å¢ƒ - å¯’çˆµ - åšå®¢å›­</a><br>å®‰è£…ä¹‹åéªŒè¯ï¼š<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">python3 -V</span><br></pre></td></tr></table></figure>è¿”å›ç‰ˆæœ¬ä¿¡æ¯ï¼š<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Python 3.8.2</span><br></pre></td></tr></table></figure></li></ol></li><li>æ²¡æœ‰è£… podman/docker <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Unable to locate any of [&#39;podman&#39;, &#39;docker&#39;]</span><br></pre></td></tr></table></figure> å®‰è£… Docker å‚è€ƒ<a href="https://www.runoob.com/docker/centos-docker-install.html">CentOS Docker å®‰è£… | èœé¸Ÿæ•™ç¨‹</a><br> éªŒè¯ <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">docker --version</span><br><span class="line">Docker version 19.03.8, build afacb8b</span><br></pre></td></tr></table></figure></li></ol></div></li><li><p>å®‰è£… cephadm</p>  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.&#x2F;cephadm install</span><br></pre></td></tr></table></figure>  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">INFO:cephadm:Installing packages [&#39;cephadm&#39;]...</span><br></pre></td></tr></table></figure></li><li>éªŒè¯ cephadm å®‰è£…å®Œæˆ  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">which cephadm</span><br></pre></td></tr></table></figure>  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;usr&#x2F;sbin&#x2F;cephadm</span><br></pre></td></tr></table></figure><h2 id="å¼•å¯¼æ–°é›†ç¾¤"><a href="#å¼•å¯¼æ–°é›†ç¾¤" class="headerlink" title="å¼•å¯¼æ–°é›†ç¾¤"></a>å¼•å¯¼æ–°é›†ç¾¤</h2>ä½ éœ€è¦çŸ¥é“ç”¨äºç¾¤é›†çš„ç¬¬ä¸€ä¸ªç›‘è§†å™¨å®ˆæŠ¤ç¨‹åºçš„ IP åœ°å€ã€‚ é€šå¸¸ï¼Œè¿™æ˜¯ç¬¬ä¸€å°ä¸»æœºçš„ IPã€‚ å¦‚æœå­˜åœ¨å¤šä¸ªç½‘ç»œå’Œæ¥å£ï¼Œè¯·ç¡®ä¿é€‰æ‹©ä»»ä½•å¯ä¾›è®¿é—® Ceph ç¾¤é›†çš„ä¸»æœºè®¿é—®çš„ç½‘ç»œå’Œæ¥å£ã€‚<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mkdir -p &#x2F;etc&#x2F;ceph</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cephadm bootstrap --mon-ip *&lt;mon-ip&gt;*   # æ­¤å¤„æŒ‡å®šmoniteråœ°å€</span><br></pre></td></tr></table></figure><div class="note warning modern"><p><strong>TODO</strong><br>æ³¨æ„ï¼Œæ­¤å¤„æŒ‡å®šä¸º ssh ç™»å½•çš„ ip æ—¶ä¸€ç›´æç¤ºç«¯å£å ç”¨ï¼Œä¸” mon è¿›ç¨‹ä¸€ç›´å¯ä¸æ¥ï¼Œåæ¥æ”¹æˆå¦ä¸€ä¸ªèŠ‚ç‚¹ä¹‹åå¯ä»¥æ­£å¸¸éƒ¨ç½²ï¼Œéœ€è¦æŸ¥é˜…æ›´å¤šèµ„æ–™ç¡®è®¤ï¼</p></div></li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cephadm bootstrap --mon-ip 172.18.1.128</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">INFO:cephadm:Using recent ceph image ceph&#x2F;daemon-base:latest</span><br><span class="line">INFO:cephadm:Verifying podman|docker is present...  # éªŒè¯podman|docker</span><br><span class="line">INFO:cephadm:Verifying lvm2 is present...           # éªŒè¯lvm2</span><br><span class="line">INFO:cephadm:Verifying time synchronization is in place... # éªŒè¯æ—¶é—´åŒæ­¥</span><br><span class="line">INFO:cephadm:Unit chronyd.service is enabled and running        # chronyd</span><br><span class="line">INFO:cephadm:Repeating the final host check...</span><br><span class="line">INFO:cephadm:podman|docker (&#x2F;usr&#x2F;bin&#x2F;docker) is present</span><br><span class="line">INFO:cephadm:systemctl is present</span><br><span class="line">INFO:cephadm:lvcreate is present</span><br><span class="line">INFO:cephadm:Unit chronyd.service is enabled and running</span><br><span class="line">INFO:cephadm:Host looks OK</span><br><span class="line">INFO:root:Cluster fsid: d0d73402-6c28-11ea-8165-00505625d3e6    # ç”Ÿæˆé›†ç¾¤fsid</span><br><span class="line">INFO:cephadm:Verifying IP 172.18.1.128 port 3300 ...</span><br><span class="line">INFO:cephadm:Verifying IP 172.18.1.128 port 6789 ...            # éªŒè¯ç«¯å£</span><br><span class="line">INFO:cephadm:Pulling latest ceph&#x2F;daemon-base:latest container...</span><br><span class="line">INFO:cephadm:Extracting ceph user uid&#x2F;gid from container image...   # pullå®¹å™¨</span><br><span class="line">INFO:cephadm:Creating initial keys...</span><br><span class="line">INFO:cephadm:Creating initial monmap...                     # åˆå§‹åŒ–keysã€monmap</span><br><span class="line">INFO:cephadm:Creating mon...</span><br><span class="line">INFO:cephadm:Waiting for mon to start...</span><br><span class="line">INFO:cephadm:Waiting for mon...                                # åˆ›å»ºå¹¶å¯åŠ¨mon</span><br><span class="line">INFO:cephadm:Assimilating anything we can from ceph.conf...</span><br><span class="line">INFO:cephadm:Generating new minimal ceph.conf...                # ç”Ÿæˆé…ç½®</span><br><span class="line">INFO:cephadm:Restarting the monitor...                      </span><br><span class="line">INFO:cephadm:Creating mgr...                                    # åˆ›å»ºmgr</span><br><span class="line">INFO:cephadm:Non-zero exit code 1 from &#x2F;usr&#x2F;bin&#x2F;firewall-cmd --permanent --query-service ceph</span><br><span class="line">INFO:cephadm:&#x2F;usr&#x2F;bin&#x2F;firewall-cmd:stdout no</span><br><span class="line">INFO:cephadm:Enabling firewalld service ceph in current zone...</span><br><span class="line">INFO:cephadm:Non-zero exit code 1 from &#x2F;usr&#x2F;bin&#x2F;firewall-cmd --permanent --query-port 8080&#x2F;tcp</span><br><span class="line">INFO:cephadm:&#x2F;usr&#x2F;bin&#x2F;firewall-cmd:stdout no</span><br><span class="line">INFO:cephadm:Enabling firewalld port 8080&#x2F;tcp in current zone...</span><br><span class="line">INFO:cephadm:Non-zero exit code 1 from &#x2F;usr&#x2F;bin&#x2F;firewall-cmd --permanent --query-port 8443&#x2F;tcp</span><br><span class="line">INFO:cephadm:&#x2F;usr&#x2F;bin&#x2F;firewall-cmd:stdout no</span><br><span class="line">INFO:cephadm:Enabling firewalld port 8443&#x2F;tcp in current zone...</span><br><span class="line">INFO:cephadm:Non-zero exit code 1 from &#x2F;usr&#x2F;bin&#x2F;firewall-cmd --permanent --query-port 9283&#x2F;tcp</span><br><span class="line">INFO:cephadm:&#x2F;usr&#x2F;bin&#x2F;firewall-cmd:stdout no</span><br><span class="line">INFO:cephadm:Enabling firewalld port 9283&#x2F;tcp in current zone...        # æ‰“å¼€é˜²ç«å¢™ç«¯å£</span><br><span class="line">INFO:cephadm:Wrote keyring to ceph.client.admin.keyring</span><br><span class="line">INFO:cephadm:Wrote config to ceph.conf</span><br><span class="line">INFO:cephadm:Waiting for mgr to start...</span><br><span class="line">INFO:cephadm:Waiting for mgr...</span><br><span class="line">INFO:cephadm:mgr not available, waiting (1&#x2F;10)...</span><br><span class="line">â€¦â€¦</span><br><span class="line">INFO:cephadm:mgr not available, waiting (5&#x2F;10)...</span><br><span class="line">INFO:cephadm:Enabling cephadm module...</span><br><span class="line">INFO:cephadm:Waiting for the mgr to restart...                          # é‡å¯mgr</span><br><span class="line">INFO:cephadm:Waiting for Mgr epoch 5...</span><br><span class="line">INFO:cephadm:Setting orchestrator backend to cephadm...</span><br><span class="line">INFO:cephadm:Generating ssh key...</span><br><span class="line">INFO:cephadm:Wrote public SSH key to to ceph.pub</span><br><span class="line">INFO:cephadm:Adding key to root@localhost&#39;s authorized_keys...</span><br><span class="line">INFO:cephadm:Adding host cepho...</span><br><span class="line">INFO:cephadm:Deploying mon service with default placement...</span><br><span class="line">INFO:cephadm:Deploying mgr service with default placement...</span><br><span class="line">INFO:cephadm:Deploying crash service with default placement...</span><br><span class="line">INFO:cephadm:Enabling the dashboard module...</span><br><span class="line">INFO:cephadm:Waiting for the mgr to restart...</span><br><span class="line">INFO:cephadm:Waiting for Mgr epoch 9...</span><br><span class="line">INFO:cephadm:Generating a dashboard self-signed certificate...      # åˆå§‹åŒ–dashboard</span><br><span class="line">INFO:cephadm:Creating initial admin user...</span><br><span class="line">INFO:cephadm:Fetching dashboard port number...</span><br><span class="line">INFO:cephadm:Ceph Dashboard is now available at:</span><br><span class="line"></span><br><span class="line">     URL: https:&#x2F;&#x2F;cepho:8443&#x2F;</span><br><span class="line">    User: admin</span><br><span class="line">Password: tkl507cgh3                                            # åˆå§‹å¯†ç ï¼Œé»˜è®¤ç™»å½•ä¹‹åéœ€è¦ä¿®æ”¹</span><br><span class="line"></span><br><span class="line">INFO:cephadm:You can access the Ceph CLI with:</span><br><span class="line"></span><br><span class="line">sudo &#x2F;usr&#x2F;sbin&#x2F;cephadm shell --fsid d0d73402-6c28-11ea-8165-00505625d3e6 -c ceph.conf -k ceph.client.admin.keyring</span><br><span class="line"></span><br><span class="line">INFO:cephadm:Please consider enabling telemetry to help improve Ceph:</span><br><span class="line"></span><br><span class="line">ceph telemetry on</span><br><span class="line"></span><br><span class="line">For more information see:</span><br><span class="line"></span><br><span class="line">https:&#x2F;&#x2F;docs.ceph.com&#x2F;docs&#x2F;master&#x2F;mgr&#x2F;telemetry&#x2F;</span><br><span class="line"></span><br><span class="line">INFO:cephadm:Bootstrap complete.</span><br></pre></td></tr></table></figure><p>è¯¥å‘½ä»¤ä¼šåšä»¥ä¸‹æ“ä½œï¼š</p><ul><li><p>åœ¨æœ¬åœ°ä¸»æœºä¸Šä¸ºé›†ç¾¤åˆ›å»º<code>mon</code>å’Œ<code>mgr</code>å®ˆæŠ¤ç¨‹åºã€‚</p></li><li><p>ä¸º Ceph é›†ç¾¤ç”Ÿæˆä¸€ä¸ªæ–°çš„ SSH å¯†é’¥ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°<code>root</code>ç”¨æˆ·çš„<code>/root/.ssh/authorized_keys</code>æ–‡ä»¶ä¸­ã€‚</p></li><li><p>å°†ä¸æ–°é›†ç¾¤é€šä¿¡æ‰€éœ€çš„æœ€å°é…ç½®æ–‡ä»¶å†™å…¥<code>/etc/ceph/ceph.conf</code>ã€‚</p></li><li><p>å°†<code>client.admin</code>ç®¡ç†ï¼ˆç‰¹æƒï¼ï¼‰ç§˜å¯†å¯†é’¥çš„å‰¯æœ¬å†™å…¥<code>/etc/ceph/ceph.client.admin.keyring</code>ã€‚</p></li><li><p>å°†å…¬å…±å¯†é’¥çš„å‰¯æœ¬å†™å…¥<code>/etc/ceph/ceph.pub</code>ã€‚</p></li></ul><div class="note info modern"><p><strong>æ³¨æ„</strong>ï¼š æ‰§è¡Œä¸Šè¿°å‘½ä»¤ä¼šå» docker ä¸Šé¢æ‹‰å–æœ€æ–°çš„<code>ceph/daemon-base</code>ï¼Œå›½å†…éœ€è¦æ¢æºã€‚å…·ä½“æ“ä½œå¦‚ä¸‹ï¼š</p><ol><li>ç¼–è¾‘æˆ–æ–°å»ºé…ç½®æ–‡ä»¶ï¼š<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">vi /etc/docker/daemon.json</span><br></pre></td></tr></table></figure>å†™å…¥ï¼š<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">&quot;registry-mirrors&quot; : [</span><br><span class="line">    &quot;http:&#x2F;&#x2F;ovfftd6p.mirror.aliyuncs.com&quot;,</span><br><span class="line">    &quot;http:&#x2F;&#x2F;registry.docker-cn.com&quot;,</span><br><span class="line">    &quot;http:&#x2F;&#x2F;docker.mirrors.ustc.edu.cn&quot;,</span><br><span class="line">    &quot;http:&#x2F;&#x2F;hub-mirror.c.163.com&quot;</span><br><span class="line">],</span><br><span class="line">&quot;insecure-registries&quot; : [</span><br><span class="line">    &quot;registry.docker-cn.com&quot;,</span><br><span class="line">    &quot;docker.mirrors.ustc.edu.cn&quot;</span><br><span class="line">],</span><br><span class="line">&quot;debug&quot; : true,</span><br><span class="line">&quot;experimental&quot; : true</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>é‡å¯ docker æœåŠ¡ <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure></li><li>æ‰‹åŠ¨æ‹‰å–é•œåƒ<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker pull ceph/daemon-base</span><br></pre></td></tr></table></figure>ç”±äºæœ¬äººç¬¬ä¸€æ¬¡ä½¿ç”¨ dockerï¼Œæ‰€ä»¥ä¸€äº›è¡¨è¿°å¯èƒ½å­˜åœ¨é—®é¢˜ã€‚</li></ol></div><h3 id="è®¿é—®-dashboard"><a href="#è®¿é—®-dashboard" class="headerlink" title="è®¿é—® dashboard"></a>è®¿é—® dashboard</h3><p><img src= "/img/loading.svg" data-lazy-src="/images/Ceph-dashboard-overview.png" alt="overview"><br><img src= "/img/loading.svg" data-lazy-src="/images/Ceph-dashboard-host.png" alt="Ceph-dashboard"></p><p>é»˜è®¤çš„å¼•å¯¼è¡Œä¸ºé€‚ç”¨äºç»å¤§å¤šæ•°ç”¨æˆ·ã€‚ è¯·å‚é˜…ä»¥ä¸‹æœ‰å…³é€‰é¡¹å¯¹æŸäº›ç”¨æˆ·å¯èƒ½æœ‰ç”¨çš„ä¸€äº›ï¼Œæˆ–è¿è¡Œ <code>cephadm bootstrap -h</code> ä»¥æŸ¥çœ‹æ‰€æœ‰å¯ç”¨é€‰é¡¹ï¼š</p><ul><li><p>æ–¹ä¾¿èµ·è§ï¼ŒBootstrap ä¼šå°†è®¿é—®æ–°é›†ç¾¤æ‰€éœ€çš„æ–‡ä»¶å†™åˆ°<code>/etc/ceph</code>ä¸­ï¼Œä»¥ä¾¿ä¸»æœºæœ¬èº«å®‰è£…çš„ä»»ä½• Ceph è½¯ä»¶åŒ…ï¼ˆä¾‹å¦‚ï¼Œè®¿é—®å‘½ä»¤è¡Œç•Œé¢ï¼‰éƒ½å¯ä»¥è½»æ¾æ‰¾åˆ°å®ƒä»¬ã€‚</p><p>ä½†æ˜¯ï¼Œä½¿ç”¨<code>cephadm</code>éƒ¨ç½²çš„å®ˆæŠ¤ç¨‹åºå®¹å™¨æ ¹æœ¬ä¸éœ€è¦<code>/etc/ceph</code>ã€‚ ä½¿ç”¨<code>--output-dir *directory&gt;*</code>é€‰é¡¹å°†å®ƒä»¬æ”¾åœ¨ä¸åŒçš„ç›®å½•ï¼ˆå¦‚.&lt;å½“å‰ç›®å½•&gt;ï¼‰ä¸­ï¼Œé¿å…ä¸åŒä¸€ä¸»æœºä¸Šçš„ç°æœ‰ Ceph é…ç½®ï¼ˆ<code>cephadm</code>æˆ–å…¶ä»–ï¼‰ä¹‹é—´çš„æ½œåœ¨å†²çªã€‚</p></li><li><p>æˆ‘ä»¬å¯ä»¥å°†ä»»ä½•åˆå§‹ Ceph é…ç½®é€‰é¡¹ä¼ é€’åˆ°æ–°é›†ç¾¤ï¼Œæ–¹æ³•æ˜¯å°†å®ƒä»¬æ”¾ç½®åœ¨æ ‡å‡†<code>ini</code>æ ·å¼çš„é…ç½®æ–‡ä»¶ä¸­ï¼Œå¹¶ä½¿ç”¨<code>--config * &lt;config-file&gt; *</code>é€‰é¡¹ã€‚</p></li></ul><h3 id="ä½¿èƒ½-CEPH-CLI"><a href="#ä½¿èƒ½-CEPH-CLI" class="headerlink" title="ä½¿èƒ½ CEPH CLI"></a>ä½¿èƒ½ CEPH CLI</h3><p>ceph å®˜æ–¹å»ºè®®å¯ç”¨å¯¹ ceph å‘½ä»¤çš„è½»æ¾è®¿é—®ï¼Œæˆ‘ä»¬æœ‰ä»¥ä¸‹é€”å¾„å¯ä»¥å®ç°ï¼š</p><ul><li>è°ƒç”¨ cephadm shell å‘½ä»¤å¯åŠ¨å®¹å™¨ä¸­çš„ bash  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo &#x2F;usr&#x2F;sbin&#x2F;cephadm shell --fsid d0d73402-6c28-11ea-8165-00505625d3e6 -c ceph.conf -k ceph.client.admin.keyring</span><br></pre></td></tr></table></figure>  å…¶ä¸­çš„<code>fsid</code>å¯ä»¥åœ¨ä¸Šä¸€æ¡è¿”å›ä¿¡æ¯ä¸­æ‰¾åˆ°ï¼Œæˆ–è€…åœ¨<code>ceph.conf</code>ä¸­è¿›è¡ŒæŸ¥çœ‹ã€‚  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">INFO:cephadm:Using recent ceph image ceph&#x2F;daemon-base:latest</span><br></pre></td></tr></table></figure></li><li>å®‰è£… ceph-common åŒ…ï¼ŒåŒ…å«äº†<code>ceph</code>, <code>rbd</code>, <code>mount.ceph</code> (ç”¨äºæŒ‚è½½ CephFS æ–‡ä»¶ç³»ç»Ÿ)ç­‰ï¼›  <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cephadm add-repo --release octopus          # æ­¤å¤„ä¼šæ›´æ–°æºï¼Œå¦‚æœéœ€è¦ä½¿ç”¨å›½å†…æºè¯·ä¸è¦æ‰§è¡Œ</span><br><span class="line">yum install ceph-common # æ­¤å¤„å®˜ç½‘æš‚ä¸ºcephadm install xxxï¼Œä½†æ˜¯æˆ‘æ‰§è¡Œä¹‹åæŠ¥é”™ï¼Œæ‰€ä»¥ä¿®æ”¹ã€‚</span><br></pre></td></tr></table></figure></li><li>è°ƒç”¨<code>ceph</code>å‘½ä»¤æŸ¥çœ‹é›†ç¾¤çŠ¶æ€  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ceph -s</span><br><span class="line">cluster:</span><br><span class="line">    id:     d0d73402-6c28-11ea-8165-00505625d3e6</span><br><span class="line">    health: HEALTH_WARN</span><br><span class="line">            Reduced data availability: 1 pg inactive</span><br><span class="line">            OSD count 0 &lt; osd_pool_default_size 3</span><br><span class="line"></span><br><span class="line">services:</span><br><span class="line">    mon: 1 daemons, quorum cepho (age 20m)</span><br><span class="line">    mgr: cepho.lgqcve(active, since 18m)</span><br><span class="line">    osd: 0 osds: 0 up, 0 in</span><br><span class="line"></span><br><span class="line">data:</span><br><span class="line">    pools:   1 pools, 1 pgs</span><br><span class="line">    objects: 0 objects, 0 B</span><br><span class="line">    usage:   0 B used, 0 B &#x2F; 0 B avail</span><br><span class="line">    pgs:     100.000% pgs unknown</span><br><span class="line">            1 unknown</span><br></pre></td></tr></table></figure></li><li>åœ¨<code>cephadm shell</code>ä¸­æŸ¥çœ‹é›†ç¾¤å¥åº·ä¿¡æ¯  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[ceph: root@cepho &#x2F;]# ceph health</span><br><span class="line">HEALTH_WARN Reduced data availability: 1 pg inactive; OSD count 0 &lt; osd_pool_default_size 3</span><br></pre></td></tr></table></figure></li></ul><hr><p>TODO:ä»¥ä¸‹å¾…éªŒè¯</p><h3 id="é›†ç¾¤æ·»åŠ æ–°èŠ‚ç‚¹"><a href="#é›†ç¾¤æ·»åŠ æ–°èŠ‚ç‚¹" class="headerlink" title="é›†ç¾¤æ·»åŠ æ–°èŠ‚ç‚¹"></a>é›†ç¾¤æ·»åŠ æ–°èŠ‚ç‚¹</h3><ol><li>åœ¨æ–°çš„èŠ‚ç‚¹æ‹·è´è®¤è¯<code>ssh key</code>è®¤è¯å¯†é’¥<br>åœ¨ bash ä¸­æ‰§è¡Œ<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ssh-copy-id -f -i ceph.pub root@*&lt;new-host&gt;*    # æ–°èŠ‚ç‚¹çš„hostname</span><br></pre></td></tr></table></figure></li><li>å‘Šè¯‰æ–°èŠ‚ç‚¹æ˜¯é›†ç¾¤çš„ä¸€éƒ¨åˆ†<br>åœ¨ cephadm shell ä¸­æ‰§è¡Œ<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ceph orch host add *newhost*</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2></li></ol><ul><li><a href="https://docs.ceph.com/en/latest/cephadm/">Deploying a new Ceph cluster â€” Ceph Documentation</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> å·¥ä½œæ—¥å¸¸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CEPH </tag>
            
            <tag> CentOS7 </tag>
            
            <tag> ç¯å¢ƒæ­å»º </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•ä½¿ç”¨ ceph-deploy éƒ¨ç½²ä¸€ä¸ªæŒ‡å®šç‰ˆæœ¬å·çš„ ceph é›†ç¾¤</title>
      <link href="blog/2020-03-16/ceph-deploy-install-a-specific-minor-version-ceph/"/>
      <url>blog/2020-03-16/ceph-deploy-install-a-specific-minor-version-ceph/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨ <a href="/blog/2020-03-15/ceph-deploy-install-ceph-nautilus-on-CentOS7/">ä¸Šæ–‡</a> ä¸­æˆ‘ä»¬ä½¿ç”¨ ceph-deploy æ­å»º ceph é›†ç¾¤ã€‚è€Œå½“å‰ç‰ˆæœ¬ ceph-deploy ä¸æ”¯æŒç”¨æˆ·æŒ‡å®šå°ç‰ˆæœ¬å·ï¼Œä½¿ç”¨<code>--release</code>åªæ”¯æŒå®‰è£…æœ€æ–°ç¨³å®šç‰ˆã€‚å½“ç„¶æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨æ­å»ºï¼Œä½†æ˜¯æ“ä½œä¸‹æ¥è€—æ—¶ä¸”å®¹æ˜“å‡ºé”™ï¼Œæ¯•ç«Ÿ<del>äººç”Ÿè‹¦çŸ­ï¼ˆæˆ‘å¤ªæ‡’äº†ï¼‰</del>ã€‚</p><h2 id="ç‰ˆæœ¬ä¿¡æ¯"><a href="#ç‰ˆæœ¬ä¿¡æ¯" class="headerlink" title="ç‰ˆæœ¬ä¿¡æ¯"></a>ç‰ˆæœ¬ä¿¡æ¯</h2><ol><li>ç³»ç»Ÿç‰ˆæœ¬<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[root@admin-node my-cluster]# cat &#x2F;etc&#x2F;system-release</span><br><span class="line">CentOS Linux release 7.6.1810 (Core) </span><br><span class="line">[root@admin-node my-cluster]# uname -a</span><br><span class="line">Linux admin-node 3.10.0-957.el7.x86_64 #1 SMP Thu Nov 8 23:39:32 UTC 2018 x86_64 x86_64 x86_64 GNU&#x2F;Linux</span><br></pre></td></tr></table></figure></li><li>ceph ç‰ˆæœ¬<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[root@admin-node my-cluster]# ceph -v</span><br><span class="line">ceph version 14.2.5 (ad5bd132e1492173c85fda2cc863152730b16a92) nautilus (stable)</span><br></pre></td></tr></table></figure><h2 id="åœ¨æœ¬åœ°é…ç½®ç¦»çº¿å­˜å‚¨åº“"><a href="#åœ¨æœ¬åœ°é…ç½®ç¦»çº¿å­˜å‚¨åº“" class="headerlink" title="åœ¨æœ¬åœ°é…ç½®ç¦»çº¿å­˜å‚¨åº“"></a>åœ¨æœ¬åœ°é…ç½®ç¦»çº¿å­˜å‚¨åº“</h2></li></ol><h3 id="å®‰è£…ç½‘ç»œæœåŠ¡"><a href="#å®‰è£…ç½‘ç»œæœåŠ¡" class="headerlink" title="å®‰è£…ç½‘ç»œæœåŠ¡"></a>å®‰è£…ç½‘ç»œæœåŠ¡</h3><ol><li>å®‰è£… ngix<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">yum install epel-release -y</span><br><span class="line">yum install nginx -y</span><br></pre></td></tr></table></figure></li><li>æ‰“å¼€ nginx<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">systemctl start nginx</span><br><span class="line">systemctl enable nginx</span><br><span class="line">systemctl status nginx</span><br></pre></td></tr></table></figure></li><li><p>æ·»åŠ é˜²ç«å¢™è§„åˆ™</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">firewall-cmd --zone&#x3D;public --permanent --add-service&#x3D;http</span><br><span class="line">firewall-cmd --zone&#x3D;public --permanent --add-service&#x3D;https</span><br><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºæœ¬åœ°é•œåƒæº"><a href="#åˆ›å»ºæœ¬åœ°é•œåƒæº" class="headerlink" title="åˆ›å»ºæœ¬åœ°é•œåƒæº"></a>åˆ›å»ºæœ¬åœ°é•œåƒæº</h3></li><li><p>å®‰è£…å¿…éœ€å·¥å…·</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">yum install createrepo yum-utils wget -y</span><br></pre></td></tr></table></figure></li><li>åˆ›å»ºé•œåƒæºæ–‡ä»¶å¤¹<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mkdir -p &#x2F;var&#x2F;www&#x2F;html&#x2F;repos&#x2F;&#123;SRPMS,x86_64,noarch&#125;</span><br></pre></td></tr></table></figure></li><li>ä¸‹è½½ç›¸åº”è½¯ä»¶åŒ…<br>å¯ä»¥æ‰‹åŠ¨åœ¨ä»¥ä¸‹ 3 ä¸ªé“¾æ¥ä¸­ä¸‹è½½å„è‡ªæ¶æ„ä¸‹çš„ç›¸åº”è½¯ä»¶åŒ…<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;download.ceph.com&#x2F;rpm-nautilus&#x2F;el7&#x2F;SRPMS&#x2F;</span><br><span class="line">https:&#x2F;&#x2F;download.ceph.com&#x2F;rpm-nautilus&#x2F;el7&#x2F;noarch&#x2F;</span><br><span class="line">https:&#x2F;&#x2F;download.ceph.com&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;</span><br></pre></td></tr></table></figure>å¦å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä»é˜¿é‡Œäº‘çš„é•œåƒæºé“¾æ¥<code>http://mirrors.aliyun.com/ceph/</code>ä¸‹è½½ï¼ˆå›½å†…ç”¨æˆ·ä½ æ‡‚çš„ï¼‰<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;ceph-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;ceph-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;ceph-base-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;ceph-common-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;ceph-debuginfo-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;ceph-fuse-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;ceph-mds-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;ceph-mgr-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;ceph-mon-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;ceph-osd-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;ceph-radosgw-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;ceph-resource-agents-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;ceph-selinux-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;ceph-test-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;cephfs-java-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;libcephfs-devel-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;libcephfs2-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;libcephfs_jni-devel-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;libcephfs_jni1-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;librados-devel-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;librados2-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;libradosstriper-devel-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;libradosstriper1-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;librbd-devel-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;librbd1-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;librgw-devel-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;librgw2-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;python-ceph-compat-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;python-cephfs-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;python-rados-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;python-rbd-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;python-rgw-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;python34-ceph-argparse-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;python34-cephfs-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;python34-rados-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;python34-rbd-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;python34-rgw-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;rados-objclass-devel-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;rbd-fuse-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;rbd-mirror-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;rbd-nbd-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;x86_64&#x2F;python-ceph-argparse-14.2.5-0.el7.x86_64.rpm</span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;noarch&#x2F;ceph-deploy-2.0.0-0.noarch.rpm</span><br></pre></td></tr></table></figure></li><li>æ‰§è¡Œé•œåƒæºåˆ›å»º<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">createrepo -v &#x2F;var&#x2F;www&#x2F;html&#x2F;repos&#x2F;SRPMS&#x2F;</span><br><span class="line">createrepo -v &#x2F;var&#x2F;www&#x2F;html&#x2F;repos&#x2F;x86_64&#x2F;</span><br><span class="line">createrepo -v &#x2F;var&#x2F;www&#x2F;html&#x2F;repos&#x2F;noarch&#x2F;</span><br></pre></td></tr></table></figure></li><li>ä¿®æ”¹ Nginx é…ç½®<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vi &#x2F;etc&#x2F;nginx&#x2F;conf.d&#x2F;repos.conf</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">        listen   80;</span><br><span class="line">        server_name  172.18.1.101;# ä¿®æ”¹æ­¤å¤„ä¸ºæœ¬æœºåœ°å€</span><br><span class="line">        root   &#x2F;var&#x2F;www&#x2F;html&#x2F;repos;</span><br><span class="line">        location &#x2F; &#123;</span><br><span class="line">                index  index.php index.html index.htm;</span><br><span class="line">                autoindex on;#enable listing of directory index</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li>é‡æ–°å¯åŠ¨ nginxï¼Œç„¶åå†æ¬¡è®¿é—®æœ¬åœ°æºæµ‹è¯•<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">systemctl restart nginx</span><br></pre></td></tr></table></figure><img src= "/img/loading.svg" data-lazy-src="/images/pasted-0.png" alt="upload successful"></li></ol><h2 id="å®‰è£…-Ceph"><a href="#å®‰è£…-Ceph" class="headerlink" title="å®‰è£… Ceph"></a>å®‰è£… Ceph</h2><ol><li>å£°æ˜æœ¬åœ°ä»“åº“<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vi&#x2F;etc&#x2F;yum.repos.d&#x2F;ceph.repo</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[ceph]</span><br><span class="line">name&#x3D;Ceph packages for $basearch</span><br><span class="line">baseurl&#x3D;http:&#x2F;&#x2F;172.18.1.101&#x2F;x86_64&#x2F;# æ³¨æ„æ­¤å¤„ipä¸ºé•œåƒæºçš„ip</span><br><span class="line">enabled&#x3D;1</span><br><span class="line">priority&#x3D;2</span><br><span class="line">gpgcheck&#x3D;0</span><br><span class="line">gpgkey&#x3D;https:&#x2F;&#x2F;download.ceph.com&#x2F;keys&#x2F;release.asc</span><br><span class="line"></span><br><span class="line">[ceph-noarch]</span><br><span class="line">name&#x3D;Ceph noarch packages</span><br><span class="line">baseurl&#x3D;http:&#x2F;&#x2F;172.18.1.101&#x2F;noarch</span><br><span class="line">enabled&#x3D;1</span><br><span class="line">priority&#x3D;2</span><br><span class="line">gpgcheck&#x3D;0</span><br><span class="line">gpgkey&#x3D;https:&#x2F;&#x2F;download.ceph.com&#x2F;keys&#x2F;release.asc</span><br><span class="line"></span><br><span class="line">[ceph-source]</span><br><span class="line">name&#x3D;Ceph source packages</span><br><span class="line">baseurl&#x3D;http:&#x2F;&#x2F;172.18.1.101&#x2F;SRPMS</span><br><span class="line">enabled&#x3D;0</span><br><span class="line">priority&#x3D;2</span><br><span class="line">gpgcheck&#x3D;0</span><br><span class="line">gpgkey&#x3D;https:&#x2F;&#x2F;download.ceph.com&#x2F;keys&#x2F;release.asc</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure></li><li>ç„¶ååƒ<a href="/blog/2020-03-15/ceph-deploy-install-ceph-nautilus-on-CentOS7/">å¾€å¸¸ä¸€æ ·</a>è¿›è¡Œ ceph éƒ¨ç½²<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">yum -y install ceph-deploy</span><br></pre></td></tr></table></figure></li><li>è½¬åˆ°ä½¿ç”¨ <code>ceph-deploy</code> å®‰è£…çš„æ­¥éª¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ <strong>â€“repo-url</strong> æ›¿æ¢å‘½ä»¤<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ceph-deploy install --repo-url http:&#x2F;&#x2F;172.18.1.101&#x2F; ceph1 ceph2 ceph3</span><br></pre></td></tr></table></figure></li><li>å®‰è£…å®Œæˆåï¼Œå†æ¬¡æ£€æŸ¥<code>ceph version</code>ç‰ˆæœ¬<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[node2][DEBUG ] </span><br><span class="line">[node2][DEBUG ] Complete!</span><br><span class="line">[node2][INFO  ] Running command: sudo ceph --version</span><br><span class="line">[node2][DEBUG ] ceph version 14.2.5 (ad5bd132e1492173c85fda2cc863152730b16a92) nautilus (stable)</span><br><span class="line">[root@admin-node x86_64]# ceph -v</span><br><span class="line">ceph version 14.2.5 (ad5bd132e1492173c85fda2cc863152730b16a92) nautilus (stable)</span><br></pre></td></tr></table></figure><h2 id="æœ¬åœ°é•œåƒå®‰è£…"><a href="#æœ¬åœ°é•œåƒå®‰è£…" class="headerlink" title="æœ¬åœ°é•œåƒå®‰è£…"></a>æœ¬åœ°é•œåƒå®‰è£…</h2></li><li>ä¸‹è½½æºæ–‡ä»¶åˆ°æœ¬åœ°<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mkdir ceph-mirror</span><br><span class="line">cd ceph-mirror</span><br><span class="line"></span><br><span class="line">yum install --downloadonly --downloaddir&#x3D;. ceph</span><br><span class="line">yum install --downloadonly --downloaddir&#x3D;. yum-plugin-priorities</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>å¯¹æ–‡ä»¶è¿›è¡Œåˆ é€‰<br>ä»…ä¿ç•™æˆ‘ä»¬éœ€è¦çš„ç‰ˆæœ¬çš„ rpm æ–‡ä»¶ï¼Œå…¶ä½™çš„åˆ é™¤ï¼ˆå¦åˆ™åŒæ­¥ä¼šå¾ˆè€—æ—¶ï¼‰</p></li><li><p>ä½¿ç”¨<code>--local-mirror</code>æŒ‡å®šä½¿ç”¨æœ¬åœ°é•œåƒå®‰è£…</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ceph-deploy install --local-mirror &#123;&#x2F;opt&#x2F;ceph-mirror&#x2F;rpm-nautilus&#x2F;el7&#x2F;&#125; node1 nodex</span><br></pre></td></tr></table></figure><p>åé¢ä¸€æ¬¡è·Ÿçš„æŒ‡ä»¤ä¸ºæœ¬åœ° mirror æ‰€åœ¨è·¯å¾„ã€èŠ‚ç‚¹ hostnameï¼ˆå¤šä¸ªæˆ–ä¸€ä¸ªï¼‰</p></li></ol><h3 id="é—®é¢˜å®šä½"><a href="#é—®é¢˜å®šä½" class="headerlink" title="é—®é¢˜å®šä½"></a>é—®é¢˜å®šä½</h3><p>åŒæ­¥æ—¶åŒæ­¥æ–‡ä»¶æŠ¥å†…å­˜ä¸è¶³<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[cdnode1][INFO  ] syncing file: aarch64&#x2F;ceph-debuginfo-14.2.2-0.el7.aarch64.rpm</span><br><span class="line">[ceph_deploy][ERROR ] Traceback (most recent call last):</span><br><span class="line">[ceph_deploy][ERROR ]   File &quot;&#x2F;usr&#x2F;lib&#x2F;python2.7&#x2F;site-packages&#x2F;ceph_deploy&#x2F;util&#x2F;decorators.py&quot;, line 69, in newfunc</span><br><span class="line"></span><br><span class="line"># å¤ªé•¿çœç•¥</span><br><span class="line">[ceph_deploy][ERROR ]     return _Serializer().save(obj)</span><br><span class="line">[ceph_deploy][ERROR ]   File &quot;&#x2F;usr&#x2F;lib&#x2F;python2.7&#x2F;site-packages&#x2F;ceph_deploy&#x2F;lib&#x2F;vendor&#x2F;remoto&#x2F;lib&#x2F;vendor&#x2F;execnet&#x2F;gateway_base.py&quot;, line 1312, in save</span><br><span class="line">[ceph_deploy][ERROR ]     return type(streamlist[0])().join(streamlist)</span><br><span class="line">[ceph_deploy][ERROR ] MemoryError</span><br><span class="line">[ceph_deploy][ERROR ] </span><br><span class="line">Error in sys.exitfunc:</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>åˆ†æäº†ä¸€ä¸‹ï¼Œè¿™ä¸ªæ–‡ä»¶å¤§æ¦‚ 2G å¤§å°ï¼Œå¦‚æœç›´æ¥ rsync çš„è¯ä¼šå¯¼è‡´å†…å­˜çˆ†ç‚¸ï¼Œæ‰€ä»¥æˆ‘çš„å¤„ç†åŠæ³•æ˜¯åˆ é™¤<code>ceph-debuginfo</code>è¿™ä¸ªæ–‡ä»¶ï¼Œåç»­æœ‰é—®é¢˜å†è£…ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p> <code>ceph-deploy</code> å¯ä»¥é€šè¿‡ä¸‰ç§æŒ‡å®šæ–¹å¼éƒ¨ç½² ceph,åˆ†åˆ«ä¸º<code>ceph-deploy install --release</code>ï¼ˆç”¨äºæŒ‡å®šå¤§ç‰ˆæœ¬å·å¦‚<code>nautilus</code>ï¼‰ã€<code>ceph-deploy install --testing</code>(ç”¨äºæœ€æ–°å¼€å‘ç‰ˆæœ¬)å’Œ<code>ceph-deploy install --dev</code>ï¼ˆç”¨äºæŒ‡å®šåˆ†æ”¯æˆ–è€… tagï¼‰,èµ·åˆæˆ‘ä»¥ä¸º<code>--dev</code>å¯ä»¥æ»¡è¶³æˆ‘æŒ‡å®šç‰ˆæœ¬å·çš„éœ€æ±‚ï¼Œåæ¥ä¸€é¡¿æ“ä½œå‘ç°æŠ¥é”™:<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[ceph_deploy.hosts.centos.install][DEBUG ] fetching repo information from: https:&#x2F;&#x2F;shaman.ceph.com&#x2F;api&#x2F;repos&#x2F;ceph&#x2F;14.5.2&#x2F;latest&#x2F;centos&#x2F;7&#x2F;repo&#x2F;?arch&#x3D;x86_64</span><br><span class="line">[ceph_deploy.util.net][ERROR ] repository might not be available yet</span><br><span class="line">[ceph_deploy][ERROR ] RuntimeError: HTTP Error 504: Gateway Timeout, failed to fetch https:&#x2F;&#x2F;shaman.ceph.com&#x2F;api&#x2F;repos&#x2F;ceph&#x2F;14.5.2&#x2F;latest&#x2F;centos&#x2F;7&#x2F;repo&#x2F;?arch&#x3D;x86_64</span><br></pre></td></tr></table></figure><br>è®¿é—®<code>https://shaman.ceph.com/api/repos/ceph</code>å‘ç°å¯ç”¨åº“é‡Œæ ¹æœ¬æ²¡æœ‰å¯¹åº”ç‰ˆæœ¬ã€‚é€šè¿‡é˜…è¯»<a href="https://docs.ceph.com/ceph-deploy/docs/install.html#behind-firewall">install â€” ceph-deploy 2.0.2 documentation</a>æˆ‘ä»¬çŸ¥é“å¯ä»¥æŒ‡å®š <code>--repo-url</code>æ­é…<code>--gpg-url</code>ä½¿ç”¨æŒ‡å®šæºé“¾æ¥çš„æ–¹å¼æŒ‡å®šæœ¬åœ°æºå®‰è£…ã€‚æ­¤å¤–ï¼Œä½¿ç”¨<code>--local-mirrors</code>æŒ‡å®šæœ¬åœ°æºçš„æ–¹å¼ä¹Ÿå¯ä»¥å‚è€ƒã€‚å‚è§<a href="https://docs.ceph.com/ceph-deploy/docs/install.html#local-mirrors">install â€” ceph-deploy 2.0.2 documentation</a>ã€‚</p><p>æœ¬æ–‡é€šè¿‡æ­å»ºæœ¬åœ°é•œåƒæºç„¶åæŒ‡å®šçš„æ–¹å¼é—´æ¥å®Œæˆäº† ceph é›†ç¾¤çš„å®‰è£…ã€‚</p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><ul><li><a href="https://docs.ceph.com/projects/ceph-deploy/en/latest/#installation">install â€” ceph-deploy 2.0.2 documentation</a></li><li><a href="https://github.com/thaonguyenvan/notes-storage/blob/51e6eeb02c34767ad84d350c2462bdccc179c35c/ceph/setup/ceph-deploy-specific-version.md">ceph-deploy-specific-version.md at thaonguyenvan/notes-storage</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> å·¥ä½œæ—¥å¸¸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CEPH </tag>
            
            <tag> ceph-deploy </tag>
            
            <tag> CentOS7 </tag>
            
            <tag> ç¯å¢ƒæ­å»º </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CentOS7 éƒ¨ç½² nautilus ç‰ˆ CEPHï¼ˆä½¿ç”¨ ceph-deployï¼‰</title>
      <link href="blog/2020-03-15/ceph-deploy-install-ceph-nautilus-on-CentOS7/"/>
      <url>blog/2020-03-15/ceph-deploy-install-ceph-nautilus-on-CentOS7/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>é¡¹ç›®å¼€å‘ä¸­å‡†å¤‡åŸºäº ceph-mgr ä¸­çš„ dashboard åšäºŒæ¬¡å¼€å‘ï¼Œæœ¬æ–‡ä¸»è¦è®°å½•æ­å»º ceph ç¯å¢ƒçš„è¿‡ç¨‹ã€‚</p><h3 id="ç¯å¢ƒè¯´æ˜"><a href="#ç¯å¢ƒè¯´æ˜" class="headerlink" title="ç¯å¢ƒè¯´æ˜"></a>ç¯å¢ƒè¯´æ˜</h3><p>èŠ‚ç‚¹é…ç½®ä¸­å‚è€ƒå®˜ç½‘æ­å»ºç¤ºä¾‹ï¼ŒåŸºäºå®ä½“æœºå†…å­˜çŠ¶å†µé™åˆ¶ï¼Œä½¿ç”¨ä¸‰èŠ‚ç‚¹æœ€å°èŠ‚ç‚¹é…ç½®ï¼Œå…·ä½“å¦‚ä¸‹ï¼š<br><img src= "/img/loading.svg" data-lazy-src="/images/ceph-1.png" alt="ceph èŠ‚ç‚¹ç»„æˆè¯´æ˜"></p><h2 id="å‰æœŸå‡†å¤‡"><a href="#å‰æœŸå‡†å¤‡" class="headerlink" title="å‰æœŸå‡†å¤‡"></a>å‰æœŸå‡†å¤‡</h2><ol><li>é…ç½®ç½‘ç»œä¸ºé™æ€ ip<br>æ­¤æ­¥è¯·è‡ªè¡Œå®Œæˆï¼›<br> æ­¤æ­¥é…ç½®ä¹‹åéœ€è¦ä¿è¯ï¼š<ol><li>å¼€æœºç½‘ç»œè‡ªå¯ï¼›</li><li>å„èŠ‚ç‚¹ä¹‹é—´çš„ç½‘ç»œè¿é€šæ€§ï¼ˆ<code>ping &#123;hostname&#125;</code>ï¼‰</li></ol></li><li>æ·»åŠ  CEPH çš„ yum æº<br>å›½å†…ä½¿ç”¨é˜¿é‡ŒæºåŠ å¿«ä¸‹è½½<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim /etc/yum.repos.d/ceph.repo</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[Ceph]</span><br><span class="line">name&#x3D;Ceph packages for $basearch</span><br><span class="line">baseurl&#x3D;http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;$basearch</span><br><span class="line">enabled&#x3D;1</span><br><span class="line">gpgcheck&#x3D;0</span><br><span class="line">type&#x3D;rpm-md</span><br><span class="line"></span><br><span class="line">[Ceph-noarch]</span><br><span class="line">name&#x3D;Ceph noarch packages</span><br><span class="line">baseurl&#x3D;http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;noarch</span><br><span class="line">enabled&#x3D;1</span><br><span class="line">gpgcheck&#x3D;0</span><br><span class="line">type&#x3D;rpm-md</span><br><span class="line"></span><br><span class="line">[ceph-source]</span><br><span class="line">name&#x3D;Ceph source packages</span><br><span class="line">baseurl&#x3D;http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ceph&#x2F;rpm-nautilus&#x2F;el7&#x2F;SRPMS</span><br><span class="line">enabled&#x3D;1</span><br><span class="line">gpgcheck&#x3D;0</span><br><span class="line">type&#x3D;rpm-md</span><br></pre></td></tr></table></figure></li><li>æ›´æ–° epel.repo<br>æ·»åŠ  EPEL çš„é˜¿é‡Œé•œåƒæº<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo</span><br></pre></td></tr></table></figure>æˆ–è€…æ‰‹åŠ¨ç¼–è¾‘</li></ol><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim /etc/yum.repos.d/epel-7.repo</span><br></pre></td></tr></table></figure><p>ç›´æ¥å†™å…¥<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[epel]</span><br><span class="line">name&#x3D;Extra Packages for Enterprise Linux 7 - $basearch</span><br><span class="line">baseurl&#x3D;http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;epel&#x2F;7&#x2F;$basearch</span><br><span class="line">failovermethod&#x3D;priority</span><br><span class="line">enabled&#x3D;1</span><br><span class="line">gpgcheck&#x3D;0</span><br><span class="line">gpgkey&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;pki&#x2F;rpm-gpg&#x2F;RPM-GPG-KEY-EPEL-7</span><br><span class="line"></span><br><span class="line">[epel-debuginfo]</span><br><span class="line">name&#x3D;Extra Packages for Enterprise Linux 7 - $basearch - Debug</span><br><span class="line">baseurl&#x3D;http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;epel&#x2F;7&#x2F;$basearch&#x2F;debug</span><br><span class="line">failovermethod&#x3D;priority</span><br><span class="line">enabled&#x3D;0</span><br><span class="line">gpgkey&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;pki&#x2F;rpm-gpg&#x2F;RPM-GPG-KEY-EPEL-7</span><br><span class="line">gpgcheck&#x3D;0</span><br><span class="line"></span><br><span class="line">[epel-source]</span><br><span class="line">name&#x3D;Extra Packages for Enterprise Linux 7 - $basearch - Source</span><br><span class="line">baseurl&#x3D;http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;epel&#x2F;7&#x2F;SRPMS</span><br><span class="line">failovermethod&#x3D;priority</span><br><span class="line">enabled&#x3D;0</span><br><span class="line">gpgkey&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;pki&#x2F;rpm-gpg&#x2F;RPM-GPG-KEY-EPEL-7</span><br><span class="line">gpgcheck&#x3D;0</span><br></pre></td></tr></table></figure></p><ol start="4"><li>æ›´æ–°æºå¹¶å®‰è£… ceph-deploy<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo yum update</span><br><span class="line">sudo yum install ceph-deploy -y</span><br></pre></td></tr></table></figure></li><li>å®‰è£… NTP<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo yum install ntp ntpdate ntp-doc -y</span><br></pre></td></tr></table></figure>é…ç½® ntp æœåŠ¡ï¼ˆæ­¤æ­¥çœç•¥ï¼‰</li><li>å®‰è£… SSH æœåŠ¡<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo yum install openssh-server -y</span><br></pre></td></tr></table></figure></li><li>ä¿®æ”¹ host<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vi /etc/hosts</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class="line">172.18.1.101 admin-node</span><br><span class="line">172.18.1.102 node1</span><br><span class="line">172.18.1.103 node2</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»º-CEPH-DEPLOY-ç”¨æˆ·ï¼ˆä»¥-cephadm-ä¸ºä¾‹ï¼‰"><a href="#åˆ›å»º-CEPH-DEPLOY-ç”¨æˆ·ï¼ˆä»¥-cephadm-ä¸ºä¾‹ï¼‰" class="headerlink" title="åˆ›å»º CEPH DEPLOY ç”¨æˆ·ï¼ˆä»¥ cephadm ä¸ºä¾‹ï¼‰"></a>åˆ›å»º CEPH DEPLOY ç”¨æˆ·ï¼ˆä»¥ cephadm ä¸ºä¾‹ï¼‰</h3></li></ol><div class="note warning modern"><p><strong>æ³¨æ„</strong></p><ul><li>å„èŠ‚ç‚¹éƒ½è¦åˆ›å»ºè¯¥ç”¨æˆ·ï¼›</li><li>ä¸è¦ä½¿ç”¨ ceph ä½œä¸ºéƒ¨ç½²ç”¨æˆ·çš„ç”¨æˆ·åï¼›</li><li>ç”¨æˆ·å¿…é¡»èµ‹æƒ root ç”¨æˆ·ï¼›</li></ul></div><ol><li>åˆ›å»ºç”¨æˆ·<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># æœ¬ä¾‹ä¸­ä½¿ç”¨ cephadm</span><br><span class="line">sudo useradd -d &#x2F;home&#x2F;cephadm -m cephadm </span><br><span class="line">sudo passwd cephadm</span><br></pre></td></tr></table></figure></li><li>sudo èµ‹æƒ<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">echo &quot;cephadm ALL &#x3D; (root) NOPASSWD:ALL&quot;  &gt; &#x2F;etc&#x2F;sudoers.d&#x2F;cephadm</span><br><span class="line">sudo chmod 0440 &#x2F;etc&#x2F;sudoers.d&#x2F;cephadm</span><br></pre></td></tr></table></figure>æ›´å¤šä¿¡æ¯å‚é˜…å®˜æ–¹æ–‡æ¡£ <a href="https://ceph.readthedocs.io/en/latest/install/ceph-deploy/quick-start-preflight/#create-a-ceph-deploy-user">Preflight Checklist â€” Ceph Documentation</a></li></ol><hr><h3 id="é…ç½®èŠ‚ç‚¹"><a href="#é…ç½®èŠ‚ç‚¹" class="headerlink" title="é…ç½®èŠ‚ç‚¹"></a>é…ç½®èŠ‚ç‚¹</h3><p> ä¿®æ”¹ä¸¤ä¸ªå­èŠ‚ç‚¹çš„ç½‘ç»œ<br><div class="note warning modern"><p>å¦‚æœä½¿ç”¨å…‹éš†è™šæ‹Ÿæœºï¼Œè¯·æ³¨æ„ä¸€å®šè¦ä¿®æ”¹ MAC åœ°å€ç»‘å®š<br><a href="https://blog.csdn.net/lp102811/article/details/80204321">è™šæ‹Ÿæœºå…‹éš†ä»¥åŠ IPï¼ŒMAC åœ°å€çš„ä¿®æ”¹_è¿ç»´_è¿›å‡»çš„èœé¸Ÿ-CSDN åšå®¢</a></p></div><br>æ³¨æ„ï¼šä»¥ä¸‹æ“ä½œåªåœ¨ admin-node èŠ‚ç‚¹æ‰§è¡Œå³å¯ï¼›</p><ol><li>åˆ‡æ¢åˆ° cephadm ç”¨æˆ·<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">su cephadm</span><br></pre></td></tr></table></figure></li><li>å»ºç«‹ admin-node èŠ‚ç‚¹åˆ°ä¸¤ä¸ªå­èŠ‚ç‚¹çš„ ssh äº’ä¿¡<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> ç”Ÿæˆå¯†é’¥ï¼ˆä¸€è·¯å›è½¦ï¼‰</span></span><br><span class="line">ssh-keygen</span><br><span class="line"><span class="meta">#</span><span class="bash"> æ‹·è´</span></span><br><span class="line">ssh-copy-id cephadm@node1</span><br><span class="line">ssh-copy-id cephadm@node2</span><br></pre></td></tr></table></figure></li><li>éªŒè¯å…å¯†ç™»å½•<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ssh node1 </span><br><span class="line">ssh node2</span><br></pre></td></tr></table></figure>æ³¨æ„ï¼šå…å¯†ç™»å½•æ¯”è¾ƒé‡è¦ï¼Œå¦‚æœæ˜¯æµ‹è¯•ç¯å¢ƒï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ root ç”¨æˆ·çš„è¯ï¼Œä¸Šé¢æŒ‡ä»¤æ”¹ä¸º<code>ssh-copy-id root@node1</code>å»å»ºç«‹äº’ä¿¡å…³ç³»ã€‚</li><li>æ­¤æ­¥ä¸ºå»ºè®®æ­¥éª¤<br>ç¼–è¾‘<code>~/.ssh/config</code>ï¼Œé˜²æ­¢æ¯æ¬¡ä½¿ç”¨ cephadm ç”¨æˆ·æ‰§è¡Œæ“ä½œæ—¶æ‰‹åŠ¨è¾“å…¥ï¼Œå¦‚æœä½ æœ‰å®‰å…¨æ–¹é¢çš„é¡¾è™‘ï¼Œä¹Ÿå¯ä»¥æ‰§è¡Œæ—¶å†è¾“å…¥ã€‚<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Host node1</span><br><span class="line">   Hostname node1</span><br><span class="line">   User cephadm</span><br><span class="line">Host node2</span><br><span class="line">   Hostname node2</span><br><span class="line">   User cephadm</span><br><span class="line">Host node3</span><br><span class="line">   Hostname node3</span><br><span class="line">   User cephadm</span><br></pre></td></tr></table></figure>å…¶ä¸­ Host åé¢è·Ÿä½ çš„éƒ¨ç½²çš„èŠ‚ç‚¹çš„ hostnameï¼ŒUser åé¢è·Ÿåˆšæ‰æ–°å»ºçš„ç”¨æˆ·åï¼ˆæœ¬ä¾‹ä¸­å³ cephadmï¼‰</li></ol><h3 id="é˜²ç«å¢™ç«¯å£"><a href="#é˜²ç«å¢™ç«¯å£" class="headerlink" title="é˜²ç«å¢™ç«¯å£"></a>é˜²ç«å¢™ç«¯å£</h3><p>ä½ å¯ä»¥é€‰æ‹©ç›´æ¥å…³é—­é˜²ç«å¢™ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©å¼€æ”¾é˜²ç«å¢™ç«¯å£ã€‚ä»¥ä¸‹ä»¥å¼€æ”¾é˜²ç«å¢™ç«¯å£ä¸ºä¾‹ï¼š</p><ol><li>åœ¨ monitor èŠ‚ç‚¹<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo firewall-cmd --zone=public --add-service=ceph-mon --permanent</span><br></pre></td></tr></table></figure></li><li>åœ¨ OSDs å’Œ MDSs èŠ‚ç‚¹<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo firewall-cmd --zone&#x3D;public --add-service&#x3D;ceph --permanent</span><br></pre></td></tr></table></figure></li><li>é…ç½®ç«‹å³ç”Ÿæ•ˆ<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo firewall-cmd --reload</span><br></pre></td></tr></table></figure><h3 id="TTY"><a href="#TTY" class="headerlink" title="TTY"></a>TTY</h3>ä½¿ç”¨<code>sudo visudo</code>æ‰“å¼€<code>sudoers</code>æ–‡ä»¶ï¼ˆæ³¨æ„ä¸è¦ç”¨ç¼–è¾‘å™¨æ‰“å¼€è€Œæ˜¯ä½¿ç”¨ä¸“ç”¨å‘½ä»¤ï¼‰ï¼Œå®šä½åˆ°<code>Defaults requiretty</code>è®¾ç½®ï¼Œä¿®æ”¹ä¸º <code>Defaults:ceph !requiretty</code></li></ol><h3 id="è®¾ç½®-SELINUX-ä¸º-Permissive"><a href="#è®¾ç½®-SELINUX-ä¸º-Permissive" class="headerlink" title="è®¾ç½® SELINUX ä¸º Permissive"></a>è®¾ç½® SELINUX ä¸º Permissive</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo setenforce 0</span><br></pre></td></tr></table></figure><h2 id="åˆ›å»ºé›†ç¾¤"><a href="#åˆ›å»ºé›†ç¾¤" class="headerlink" title="åˆ›å»ºé›†ç¾¤"></a>åˆ›å»ºé›†ç¾¤</h2><p>åœ¨ç®¡ç†èŠ‚ç‚¹ä¸Šåˆ›å»ºä¸€ä¸ªç›®å½•ï¼Œä»¥ç»´æŠ¤ ceph-deploy ä¸ºé›†ç¾¤ç”Ÿæˆçš„é…ç½®æ–‡ä»¶å’Œå¯†é’¥ã€‚<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mkdir my-cluster</span><br><span class="line">cd my-cluster</span><br></pre></td></tr></table></figure><br><div class="note warning modern"><h3 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h3><ol><li>ä»¥åæ‰§è¡Œ ceph-deploy çš„æŒ‡ä»¤éƒ½åº”è¯¥åœ¨è¯¥ç›®å½•ä¸‹è¿›è¡Œï¼›</li><li>è¯·ä¸è¦ä½¿ç”¨ sudo è°ƒç”¨ ceph-deployï¼›å¦‚æœä½ ä»¥å…¶ä»–ç”¨æˆ·èº«ä»½è¿›è¡Œéƒ¨ç½²æ“ä½œï¼Œä¸è¦ä»¥ root èº«ä»½è¿è¡Œå®ƒï¼Œå› ä¸ºå®ƒä¸ä¼šå‘å‡ºè¿œç¨‹ä¸»æœºä¸Šæ‰€éœ€çš„ sudo å‘½ä»¤ã€‚</li></ol></div></p><h3 id="æ¸…é™¤ç¯å¢ƒ"><a href="#æ¸…é™¤ç¯å¢ƒ" class="headerlink" title="æ¸…é™¤ç¯å¢ƒ"></a>æ¸…é™¤ç¯å¢ƒ</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ceph-deploy purge node1 node2</span><br><span class="line">ceph-deploy purgedata node1 node2</span><br><span class="line">ceph-deploy forgetkeys</span><br><span class="line">rm ceph.* -rf</span><br></pre></td></tr></table></figure><div class="note warning modern"><h4 id="æŠ¥é”™"><a href="#æŠ¥é”™" class="headerlink" title="æŠ¥é”™"></a>æŠ¥é”™</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Bad owner or permissions on &#x2F;home&#x2F;cephadm&#x2F;.ssh&#x2F;config</span><br><span class="line">[ceph_deploy][ERROR ] RuntimeError: connecting to host: cnode1 resulted in errors: HostNotFound cnode1</span><br></pre></td></tr></table></figure><h4 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h4><p>ç¡®è®¤èŠ‚ç‚¹å¼€æœºï¼Ÿç¡®è®¤æ˜¯ä»¥ cephadm ç”¨æˆ·ç™»å½•ï¼Ÿä¹‹åæ‰§è¡Œï¼š<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">chmod 600 /home/cephadm/.ssh/config</span><br></pre></td></tr></table></figure><br>ç„¶åé‡å¤æ‰§è¡Œä¸Šä¸€æ­¥ã€‚</p></div><p>æ­¤æ­¥éª¤ä¼šæ¸…é™¤èŠ‚ç‚¹ä¹‹é—´çš„ ceph ç¯å¢ƒï¼Œç›¸å½“äºåˆå§‹åŒ–ä¸€ä¸ªå…¨æ–°çš„å®‰è£…ç¯å¢ƒã€‚</p><h3 id="åˆå§‹åŒ–"><a href="#åˆå§‹åŒ–" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h3><ol><li>åœ¨<code>my-cluster</code>ç®¡ç†èŠ‚ç‚¹æ‰§è¡Œåˆ›å»ºéƒ¨ç½²èŠ‚ç‚¹<br>æŒ‡å®šçš„èŠ‚ç‚¹åç§°ä¸º hostname, fqdn æˆ–è€… hostname:fqdnï¼Œå¦‚æœä¸äº†è§£ FQDN çš„å«ä¹‰å¯ä»¥å‚è€ƒï¼š<br><a href="https://www.cnblogs.com/videring/articles/7025867.html">å…³äº hostname å’Œ fqdn çš„åŒºåˆ«å’Œè·å–åŠè®¾ç½® - é‚¹å¤©å¾— - åšå®¢å›­</a><br>æœ¬ä¾‹ä¸­ç®¡ç†èŠ‚ç‚¹<code>hostname</code>ä¸º admin-nodeï¼Œæ­¤å¤„åº”è¯¥ä¸ºä½ æ‰§è¡Œ ceph-deploy æ“ä½œçš„èŠ‚ç‚¹ hostnameã€‚<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ceph-deploy new admin-node</span><br></pre></td></tr></table></figure>è¾“å‡ºå¦‚ä¸‹:<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ll</span><br><span class="line">total 12</span><br><span class="line">-rw-r--r--. 1 root root  200 Mar 15 16:33 ceph.conf</span><br><span class="line">-rw-r--r--. 1 root root 3014 Mar 15 16:33 ceph-deploy-ceph.log</span><br><span class="line">-rw-------. 1 root root   73 Mar 15 16:33 ceph.mon.keyring</span><br></pre></td></tr></table></figure><div class="note warning modern"><p>é‡åˆ°æŠ¥é”™<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;&#x2F;usr&#x2F;bin&#x2F;ceph-deploy&quot;, line 18, in &lt;module&gt;</span><br><span class="line">    from ceph_deploy.cli import main</span><br><span class="line">  File &quot;&#x2F;usr&#x2F;lib&#x2F;python2.7&#x2F;site-packages&#x2F;ceph_deploy&#x2F;cli.py&quot;, line 1, in &lt;module&gt;</span><br><span class="line">    import pkg_resources</span><br><span class="line">ImportError: No module named pkg_resources</span><br></pre></td></tr></table></figure><br>å®‰è£…<code>distribute</code>ã€‚å¦‚æœå›½å†…æºå¤ªæ…¢ï¼Œå¯ä»¥å‚è€ƒæ­¤æ–‡<a href="https://www.masantu.com/wiki/%E6%8D%A2%E6%BA%90/pip/">Python æ¢æºæ“ä½œ | åˆ«é™¢ç‰§å¿—</a><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¦‚æœæ²¡æœ‰å®‰è£…pipï¼Œå…ˆå®‰è£…pip</span></span><br><span class="line">yum install python-pip </span><br><span class="line">pip install distribute</span><br></pre></td></tr></table></figure><br>æˆ–è€…å‚è€ƒæ­¤å¤„ï¼š<a href="https://stackoverflow.com/questions/7446187/no-module-named-pkg-resources">python - No module named pkg_resources - Stack Overflow</a></p></div></li><li>ä¿®æ”¹é›†ç¾¤é…ç½®<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">vi ceph.conf</span><br></pre></td></tr></table></figure>å¦‚æœæœ‰å¤šä¸ªç½‘ç»œæ¥å£ï¼Œéœ€è¦åœ¨ Ceph é…ç½®æ–‡ä»¶çš„<code>[global]</code>ä¸€èŠ‚ä¸‹æ·»åŠ <code>public network</code>è®¾ç½®ï¼Œè¿™ä¹Ÿæ˜¯å®˜ç½‘å»ºè®®æˆ‘ä»¬çš„é…ç½®ã€‚å…·ä½“å‚è§<a href="https://docs.ceph.com/docs/nautilus/rados/configuration/network-config-ref/">Network Configuration Reference â€” Ceph Documentation</a><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[global]</span><br><span class="line">fsid &#x3D; 52420c57-bf82-4ca9-9184-a38e2fab427e</span><br><span class="line">mon_initial_members &#x3D; admin-node</span><br><span class="line">mon_host &#x3D; 172.18.1.101</span><br><span class="line">auth_cluster_required &#x3D; cephx</span><br><span class="line">auth_service_required &#x3D; cephx</span><br><span class="line">auth_client_required &#x3D; cephx</span><br><span class="line">osd pool default size &#x3D; 2  #å¢åŠ é»˜è®¤å‰¯æœ¬æ•°ä¸º 2</span><br><span class="line">public network &#x3D; 172.18.1.0&#x2F;24 # æ·»åŠ æ•´ä¸ªå­ç½‘æ®µ</span><br></pre></td></tr></table></figure>å¦‚æœä½¿ç”¨ ipv6 ç½‘ç»œï¼Œåˆ™è¿½åŠ å¦‚ä¸‹å†…å®¹<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> ms <span class="built_in">bind</span> ipv6 = <span class="literal">true</span> &gt;&gt; ceph.conf</span><br></pre></td></tr></table></figure><h3 id="å®‰è£…-ceph"><a href="#å®‰è£…-ceph" class="headerlink" title="å®‰è£… ceph"></a>å®‰è£… ceph</h3>admin-node èŠ‚ç‚¹æ‰§è¡Œï¼Œceph-deploy è‡ªåŠ¨å»å„èŠ‚ç‚¹å®‰è£… ceph ç¯å¢ƒ<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ceph-deploy install admin-node node1 node2</span><br></pre></td></tr></table></figure></li></ol><hr><h4 id="æŠ¥é”™å¤„ç†"><a href="#æŠ¥é”™å¤„ç†" class="headerlink" title="æŠ¥é”™å¤„ç†"></a>æŠ¥é”™å¤„ç†</h4><div class="note danger modern"><ol><li>ç½‘ç»œä¸é€š<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># å¤ªé•¿çœç•¥</span><br><span class="line">[admin-node][WARNIN]             yum-config-manager --save --setopt&#x3D;&lt;repoid&gt;.skip_if_unavailable&#x3D;true</span><br><span class="line">[admin-node][WARNIN] </span><br><span class="line">[admin-node][WARNIN] Cannot find a valid baseurl for repo: base&#x2F;7&#x2F;x86_64</span><br><span class="line">[admin-node][ERROR ] RuntimeError: command returned non-zero exit status: 1</span><br><span class="line">[ceph_deploy][ERROR ] RuntimeError: Failed to execute command: yum -y install epel-release</span><br></pre></td></tr></table></figure>é‡åˆ°æ­¤é”™è¯¯ï¼Œå…ˆæ’æŸ¥ç½‘ç»œæ˜¯å¦è”é€šï¼ˆ<code>ping www.baidu.com</code>ï¼‰ï¼Œå¦‚æœä¸é€šï¼Œåˆ™ä¿®æ”¹ç½‘ç»œï¼Œå¦åˆ™ï¼Œæ·»åŠ  DNS è§£æé…ç½®ï¼›<br>å‚è§ï¼š</li></ol><ul><li><a href="https://www.jianshu.com/p/50f0fb206cf7">ç”¨ yum å®‰è£…è½¯ä»¶æç¤º cannot find a valid baseurl for repo:base/7/x86_64 çš„è§£å†³æ–¹æ³• - ç®€ä¹¦</a></li><li><a href="https://www.cnblogs.com/linnuo/p/6257204.html">å°ç™½è§£å†³ CENTOS7 é”™è¯¯:Cannot find a valid baseurl for repo: base/7/x86_6 - æ—è¯ºæ¬§å·´ - åšå®¢å›­</a><br>ä¸Šé¢çš„æ–¹æ³•æä¾›äº†ä¸¤ç§æ–¹æ¡ˆï¼ša):ç›´æ¥ä¿®æ”¹ç½‘å¡é…ç½®ï¼›b):ä¿®æ”¹ <code>cat /etc/resolv.conf</code><br>æˆ‘ä½¿ç”¨ a æ–¹æ¡ˆæ—¶å€™é‡å¯ç½‘ç»œ<code>systemctl restart network</code>å‘ç°åŸŸåè§£æé…ç½®æ–‡ä»¶å·²ç»è¢«ä¿®æ”¹äº†ã€‚é„™äººä¸æ“…é•¿ç½‘ç»œã€‚<br>æ­¤å¤–ï¼Œå¦‚æœä½¿ç”¨é root ç”¨æˆ·éƒ¨ç½²ï¼Œä¸€å®šè¦ä¿è¯éƒ¨ç½²ç”¨æˆ·ï¼ˆæœ¬ä¾‹ä¸­çš„ cephadmï¼‰å¯ä»¥æ­£å¸¸ sudoï¼</li></ul><ol start="2"><li>é‡æ–°é…ç½® epel.repo<br>è¿›å…¥<code>/etc/yum.repos.d</code>ä¸­åˆ é™¤<code>epel.repo</code>å’Œ<code>epel-testing.repo</code>é‡æ–°å®‰è£…</li></ol></div><hr><div class="note info modern"><p>æœ¬äººåœ¨å®è·µæ—¶å‘ç°é»˜è®¤å®‰è£…æœ€æ–°ç¨³å®šç‰ˆæœ¬ cephï¼Œè€Œå‡å¦‚éœ€è¦å®‰è£…æŒ‡å®šå°ç‰ˆæœ¬çš„ cephï¼Œå¯ä»¥å‚è€ƒ<a href="/blog/2020-03-16/ceph-deploy-install-a-specific-minor-version-ceph/">æ­¤æ–‡</a>ã€‚</p></div><p>æ‰§è¡Œåˆ°ä¸Šé¢çš„æ—¶å€™å¯èƒ½ä¼šé‡åˆ°æŠ¥é”™ï¼Œä¸€å®šè¦è€å¿ƒæ’æŸ¥ä¿è¯æ²¡æœ‰<code>ERROR</code>ä¹‹åå†è¿›è¡Œä¸‹ä¸€æ­¥ï¼</p><h3 id="åˆå§‹åŒ–-monitor-èŠ‚ç‚¹å¹¶æ”¶é›†æ‰€æœ‰å¯†é’¥"><a href="#åˆå§‹åŒ–-monitor-èŠ‚ç‚¹å¹¶æ”¶é›†æ‰€æœ‰å¯†é’¥" class="headerlink" title="åˆå§‹åŒ– monitor èŠ‚ç‚¹å¹¶æ”¶é›†æ‰€æœ‰å¯†é’¥"></a>åˆå§‹åŒ– monitor èŠ‚ç‚¹å¹¶æ”¶é›†æ‰€æœ‰å¯†é’¥</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ceph-deploy mon create-initial</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ç›®å½•ä¸‹æ–‡ä»¶ä¸º<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">total 44</span><br><span class="line">-rw-------. 1 root root   113 Mar 15 19:36 ceph.bootstrap-mds.keyring</span><br><span class="line">-rw-------. 1 root root   113 Mar 15 19:36 ceph.bootstrap-mgr.keyring</span><br><span class="line">-rw-------. 1 root root   113 Mar 15 19:36 ceph.bootstrap-osd.keyring</span><br><span class="line">-rw-------. 1 root root   113 Mar 15 19:36 ceph.bootstrap-rgw.keyring</span><br><span class="line">-rw-------. 1 root root   151 Mar 15 19:36 ceph.client.admin.keyring</span><br><span class="line">-rw-r--r--. 1 root root   226 Mar 15 18:27 ceph.conf</span><br><span class="line">-rw-r--r--. 1 root root 16137 Mar 15 19:36 ceph-deploy-ceph.log</span><br><span class="line">-rw-------. 1 root root    73 Mar 15 18:26 ceph.mon.keyring</span><br></pre></td></tr></table></figure></p><h3 id="éƒ¨ç½²-manager-å®ˆæŠ¤çº¿ç¨‹"><a href="#éƒ¨ç½²-manager-å®ˆæŠ¤çº¿ç¨‹" class="headerlink" title="éƒ¨ç½² manager å®ˆæŠ¤çº¿ç¨‹"></a>éƒ¨ç½² manager å®ˆæŠ¤çº¿ç¨‹</h3><p>è¿™æ˜¯ nautilus ç‰ˆæ–°åŠ è¿›ç¨‹ï¼Œæ­¤å¤„åˆ›å»º mgr ä¸»è¦æ˜¯ä¸ºäº†åç»­ ceph-dashboard ä½¿ç”¨ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ceph-deploy mgr create admin-node</span><br></pre></td></tr></table></figure><hr><div class="note danger modern"><p>åœ¨åˆ›å»º mgr èŠ‚ç‚¹çš„æ—¶å€™é‡åˆ°æ˜¾ç¤º<code>HostNotFound</code>é”™è¯¯ï¼Œä½¿ç”¨<code>vi /etc/sysconfig/network</code>ä¿®æ”¹ hostname ä¹‹åä¿è¯ä¸ä¸Šæ–‡ä¸­<code>/etc/hosts</code>é…ç½®ç›¸åŒï¼Œé‡æ–°è¿è¡Œå³å¯ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[ceph_deploy.mgr][DEBUG ] Deploying mgr, cluster ceph hosts node1:node1</span><br><span class="line">ssh: connect to host node1 port 22: Connection timed out</span><br><span class="line">[ceph_deploy.mgr][ERROR ] connecting to host: node1 resulted in errors: HostNotFound node1</span><br><span class="line">[ceph_deploy][ERROR ] GenericError: Failed to create 1 MGRs</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><h3 id="æŸ¥çœ‹-ceph-å·¥ä½œçŠ¶æ€"><a href="#æŸ¥çœ‹-ceph-å·¥ä½œçŠ¶æ€" class="headerlink" title="æŸ¥çœ‹ ceph å·¥ä½œçŠ¶æ€"></a>æŸ¥çœ‹ ceph å·¥ä½œçŠ¶æ€</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ceph -s</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cluster:</span><br><span class="line">  id:     91c3049f-7500-4840-beaf-e57ab240d1d5</span><br><span class="line">  health: HEALTH_OK</span><br><span class="line"> </span><br><span class="line">services:</span><br><span class="line">  mon: 1 daemons, quorum admin-node (age 98m)</span><br><span class="line">  mgr: admin-node(active, since 5s)</span><br><span class="line">  osd: 0 osds: 0 up, 0 in</span><br><span class="line"> </span><br><span class="line">data:</span><br><span class="line">  pools:   0 pools, 0 pgs</span><br><span class="line">  objects: 0 objects, 0 B</span><br><span class="line">  usage:   0 B used, 0 B &#x2F; 0 B avail</span><br><span class="line">  pgs:     </span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ï¼Œé›†ç¾¤å·²ç»éƒ¨ç½²æˆåŠŸï¼Œä½†æ˜¯è¿˜æ²¡æœ‰å­˜å‚¨èŠ‚ç‚¹ï¼Œ<code>é©å‘½å°šæœªæˆåŠŸï¼ŒåŒå¿—ä»éœ€åŠªåŠ›</code>ã€‚<br><div class="note warning modern"><p>ä»Šå¤©é‡æ–°éƒ¨ç½²é‡åˆ°æŠ¥é”™ï¼š<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ceph -s</span><br><span class="line">[errno 2] error connecting to the cluster</span><br></pre></td></tr></table></figure><br>ç°è±¡æè¿°ï¼šä¸åŠ  sudo æ‰§è¡Œä¸‹é¢çš„æŒ‡ä»¤æ˜¾ç¤ºå—é™ï¼ŒåŠ  sudo ä¹‹åå¯ä»¥è·å–åˆ° ceph çš„çŠ¶æ€ï¼Œå¾ˆå¥‡æ€ªï¼Œæš‚æ—¶æ²¡æœ‰æ‰¾åˆ°è§£å†³åŠæ³•ã€‚<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo ceph --connect-timeout=25 --cluster=ceph --admin-daemon=/var/run/ceph/ceph-mon.cnode0.asok mon_status</span><br></pre></td></tr></table></figure></p></div></p><h3 id="æ·»åŠ -OSD-èŠ‚ç‚¹"><a href="#æ·»åŠ -OSD-èŠ‚ç‚¹" class="headerlink" title="æ·»åŠ  OSD èŠ‚ç‚¹"></a>æ·»åŠ  OSD èŠ‚ç‚¹</h3><ol><li>è·å–é›†ç¾¤èŠ‚ç‚¹å¯ç”¨ç£ç›˜åˆ—è¡¨<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ceph-deploy disk list node1 node2</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[ceph_deploy.conf][DEBUG ] found configuration file at: &#x2F;root&#x2F;.cephdeploy.conf</span><br><span class="line">[ceph_deploy.cli][INFO  ] Invoked (2.0.1): &#x2F;usr&#x2F;bin&#x2F;ceph-deploy disk list node1 node2</span><br><span class="line">[ceph_deploy.cli][INFO  ] ceph-deploy options:</span><br><span class="line">[ceph_deploy.cli][INFO  ]  username                      : None</span><br><span class="line">[ceph_deploy.cli][INFO  ]  verbose                       : False</span><br><span class="line">[ceph_deploy.cli][INFO  ]  debug                         : False</span><br><span class="line">[ceph_deploy.cli][INFO  ]  overwrite_conf                : False</span><br><span class="line">[ceph_deploy.cli][INFO  ]  subcommand                    : list</span><br><span class="line">[ceph_deploy.cli][INFO  ]  quiet                         : False</span><br><span class="line">[ceph_deploy.cli][INFO  ]  cd_conf                       : &lt;ceph_deploy.conf.cephdeploy.Conf instance at 0x7f8d2e53be60&gt;</span><br><span class="line">[ceph_deploy.cli][INFO  ]  cluster                       : ceph</span><br><span class="line">[ceph_deploy.cli][INFO  ]  host                          : [&#39;node1&#39;, &#39;node2&#39;]</span><br><span class="line">[ceph_deploy.cli][INFO  ]  func                          : &lt;function disk at 0x7f8d2e99e320&gt;</span><br><span class="line">[ceph_deploy.cli][INFO  ]  ceph_conf                     : None</span><br><span class="line">[ceph_deploy.cli][INFO  ]  default_release               : False</span><br><span class="line">[node1][DEBUG ] connection detected need for sudo</span><br><span class="line">[node1][DEBUG ] connected to host: node1 </span><br><span class="line">[node1][DEBUG ] detect platform information from remote host</span><br><span class="line">[node1][DEBUG ] detect machine type</span><br><span class="line">[node1][DEBUG ] find the location of an executable</span><br><span class="line">[node1][INFO  ] Running command: sudo fdisk -l</span><br><span class="line">[node1][INFO  ] Disk &#x2F;dev&#x2F;sda: 21.5 GB, 21474836480 bytes, 41943040 sectors</span><br><span class="line">[node1][INFO  ] Disk &#x2F;dev&#x2F;mapper&#x2F;centos-root: 18.2 GB, 18249416704 bytes, 35643392 sectors</span><br><span class="line">[node1][INFO  ] Disk &#x2F;dev&#x2F;mapper&#x2F;centos-swap: 2147 MB, 2147483648 bytes, 4194304 sectors</span><br><span class="line">[node2][DEBUG ] connection detected need for sudo</span><br><span class="line">[node2][DEBUG ] connected to host: node2 </span><br><span class="line">[node2][DEBUG ] detect platform information from remote host</span><br><span class="line">[node2][DEBUG ] detect machine type</span><br><span class="line">[node2][DEBUG ] find the location of an executable</span><br><span class="line">[node2][INFO  ] Running command: sudo fdisk -l</span><br><span class="line">[node2][INFO  ] Disk &#x2F;dev&#x2F;sda: 21.5 GB, 21474836480 bytes, 41943040 sectors</span><br><span class="line">[node2][INFO  ] Disk &#x2F;dev&#x2F;mapper&#x2F;centos-root: 18.2 GB, 18249416704 bytes, 35643392 sectors</span><br><span class="line">[node2][INFO  ] Disk &#x2F;dev&#x2F;mapper&#x2F;centos-swap: 2147 MB, 2147483648 bytes, 4194304 sectors</span><br></pre></td></tr></table></figure></li><li>æ·»åŠ ç£ç›˜ï¼ˆå¯é€‰ï¼‰<br>é™¤äº†ç³»ç»Ÿç›˜æ²¡æœ‰å¯ç”¨ç£ç›˜ï¼å› ä¸ºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯è™šæ‹Ÿæœºï¼Œå¯ä»¥åœ¨ osd èŠ‚ç‚¹ç›´æ¥æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªç£ç›˜ï¼Œä¹‹åæŸ¥çœ‹ç£ç›˜å¦‚ä¸‹ï¼š<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ceph-deploy disk list node1 node2</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[ceph_deploy.conf][DEBUG ] found configuration file at: &#x2F;root&#x2F;.cephdeploy.conf</span><br><span class="line">[ceph_deploy.cli][INFO  ] Invoked (2.0.1): &#x2F;usr&#x2F;bin&#x2F;ceph-deploy disk list node1 node2</span><br><span class="line">[ceph_deploy.cli][INFO  ] ceph-deploy options:</span><br><span class="line">[ceph_deploy.cli][INFO  ]  username                      : None</span><br><span class="line">[ceph_deploy.cli][INFO  ]  verbose                       : False</span><br><span class="line">[ceph_deploy.cli][INFO  ]  debug                         : False</span><br><span class="line">[ceph_deploy.cli][INFO  ]  overwrite_conf                : False</span><br><span class="line">[ceph_deploy.cli][INFO  ]  subcommand                    : list</span><br><span class="line">[ceph_deploy.cli][INFO  ]  quiet                         : False</span><br><span class="line">[ceph_deploy.cli][INFO  ]  cd_conf                       : &lt;ceph_deploy.conf.cephdeploy.Conf instance at 0x7fd5f2a89ef0&gt;</span><br><span class="line">[ceph_deploy.cli][INFO  ]  cluster                       : ceph</span><br><span class="line">[ceph_deploy.cli][INFO  ]  host                          : [&#39;node1&#39;, &#39;node2&#39;]</span><br><span class="line">[ceph_deploy.cli][INFO  ]  func                          : &lt;function disk at 0x7fd5f2eeb320&gt;</span><br><span class="line">[ceph_deploy.cli][INFO  ]  ceph_conf                     : None</span><br><span class="line">[ceph_deploy.cli][INFO  ]  default_release               : False</span><br><span class="line">[node1][DEBUG ] connection detected need for sudo</span><br><span class="line">[node1][DEBUG ] connected to host: node1 </span><br><span class="line">[node1][DEBUG ] detect platform information from remote host</span><br><span class="line">[node1][DEBUG ] detect machine type</span><br><span class="line">[node1][DEBUG ] find the location of an executable</span><br><span class="line">[node1][INFO  ] Running command: sudo fdisk -l</span><br><span class="line">[node1][INFO  ] Disk &#x2F;dev&#x2F;sda: 21.5 GB, 21474836480 bytes, 41943040 sectors</span><br><span class="line">[node1][INFO  ] Disk &#x2F;dev&#x2F;sdb: 5368 MB, 5368709120 bytes, 10485760 sectors</span><br><span class="line">[node1][INFO  ] Disk &#x2F;dev&#x2F;mapper&#x2F;centos-root: 18.2 GB, 18249416704 bytes, 35643392 sectors</span><br><span class="line">[node1][INFO  ] Disk &#x2F;dev&#x2F;mapper&#x2F;centos-swap: 2147 MB, 2147483648 bytes, 4194304 sectors</span><br><span class="line">[node2][DEBUG ] connection detected need for sudo</span><br><span class="line">[node2][DEBUG ] connected to host: node2 </span><br><span class="line">[node2][DEBUG ] detect platform information from remote host</span><br><span class="line">[node2][DEBUG ] detect machine type</span><br><span class="line">[node2][DEBUG ] find the location of an executable</span><br><span class="line">[node2][INFO  ] Running command: sudo fdisk -l</span><br><span class="line">[node2][INFO  ] Disk &#x2F;dev&#x2F;sda: 21.5 GB, 21474836480 bytes, 41943040 sectors</span><br><span class="line">[node2][INFO  ] Disk &#x2F;dev&#x2F;sdb: 8589 MB, 8589934592 bytes, 16777216 sectors</span><br><span class="line">[node2][INFO  ] Disk &#x2F;dev&#x2F;mapper&#x2F;centos-root: 18.2 GB, 18249416704 bytes, 35643392 sectors</span><br><span class="line">[node2][INFO  ] Disk &#x2F;dev&#x2F;mapper&#x2F;centos-swap: 2147 MB, 2147483648 bytes, 4194304 sectors</span><br></pre></td></tr></table></figure><div class="note warning modern"><p>è¿›è¡Œä¸‹é¢æ“ä½œæ—¶è¯·ç¡®ä¿ä½ çš„ç£ç›˜æ²¡æœ‰è¢«ä½¿ç”¨ä¸”ä¸åŒ…å«ä»»ä½•ä¸ªäººé‡è¦æ•°æ®ã€‚</p></div></li><li>æ“¦é™¤ç£ç›˜çš„åˆ†åŒºè¡¨å’Œå†…å®¹<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ceph-deploy disk zap node1 /dev/sdb</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[ceph_deploy.conf][DEBUG ] found configuration file at: &#x2F;root&#x2F;.cephdeploy.conf</span><br><span class="line">[ceph_deploy.cli][INFO  ] Invoked (2.0.1): &#x2F;usr&#x2F;bin&#x2F;ceph-deploy disk zap node1 &#x2F;dev&#x2F;sdb</span><br><span class="line">[ceph_deploy.cli][INFO  ] ceph-deploy options:</span><br><span class="line">[ceph_deploy.cli][INFO  ]  username                      : None</span><br><span class="line">[ceph_deploy.cli][INFO  ]  verbose                       : False</span><br><span class="line">[ceph_deploy.cli][INFO  ]  debug                         : False</span><br><span class="line">[ceph_deploy.cli][INFO  ]  overwrite_conf                : False</span><br><span class="line">[ceph_deploy.cli][INFO  ]  subcommand                    : zap</span><br><span class="line">[ceph_deploy.cli][INFO  ]  quiet                         : False</span><br><span class="line">[ceph_deploy.cli][INFO  ]  cd_conf                       : &lt;ceph_deploy.conf.cephdeploy.Conf instance at 0x7f509bdcbef0&gt;</span><br><span class="line">[ceph_deploy.cli][INFO  ]  cluster                       : ceph</span><br><span class="line">[ceph_deploy.cli][INFO  ]  host                          : node1</span><br><span class="line">[ceph_deploy.cli][INFO  ]  func                          : &lt;function disk at 0x7f509c22d320&gt;</span><br><span class="line">[ceph_deploy.cli][INFO  ]  ceph_conf                     : None</span><br><span class="line">[ceph_deploy.cli][INFO  ]  default_release               : False</span><br><span class="line">[ceph_deploy.cli][INFO  ]  disk                          : [&#39;&#x2F;dev&#x2F;sdb&#39;]</span><br><span class="line">[ceph_deploy.osd][DEBUG ] zapping &#x2F;dev&#x2F;sdb on node1</span><br><span class="line">[node1][DEBUG ] connection detected need for sudo</span><br><span class="line">[node1][DEBUG ] connected to host: node1 </span><br><span class="line">[node1][DEBUG ] detect platform information from remote host</span><br><span class="line">[node1][DEBUG ] detect machine type</span><br><span class="line">[node1][DEBUG ] find the location of an executable</span><br><span class="line">[ceph_deploy.osd][INFO  ] Distro info: CentOS Linux 7.6.1810 Core</span><br><span class="line">[node1][DEBUG ] zeroing last few blocks of device</span><br><span class="line">[node1][DEBUG ] find the location of an executable</span><br><span class="line">[node1][INFO  ] Running command: sudo &#x2F;usr&#x2F;sbin&#x2F;ceph-volume lvm zap &#x2F;dev&#x2F;sdb</span><br><span class="line">[node1][WARNIN] --&gt; Zapping: &#x2F;dev&#x2F;sdb</span><br><span class="line">[node1][WARNIN] --&gt; --destroy was not specified, but zapping a whole device will remove the partition table</span><br><span class="line">[node1][WARNIN] Running command: &#x2F;bin&#x2F;dd if&#x3D;&#x2F;dev&#x2F;zero of&#x3D;&#x2F;dev&#x2F;sdb bs&#x3D;1M count&#x3D;10</span><br><span class="line">[node1][WARNIN] --&gt; Zapping successful for: &lt;Raw Device: &#x2F;dev&#x2F;sdb&gt;</span><br></pre></td></tr></table></figure></li><li>å°†ç£ç›˜ä½œä¸º OSD ä½¿ç”¨<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ceph-deploy --overwrite-conf osd create --data /dev/sdb node1</span><br></pre></td></tr></table></figure><div class="note info modern"><p>ä¸Šé¢çš„<code>--overwrite-conf</code>æ˜¯å› ä¸ºé‡åˆ°æŠ¥é”™ï¼š<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[ceph_deploy.osd][ERROR ] RuntimeError: config file /etc/ceph/ceph.conf exists with different content; use --overwrite-conf to overwrite</span><br><span class="line">[ceph_deploy][ERROR ] GenericError: Failed to create 1 OSDs</span><br></pre></td></tr></table></figure><br>æ‰€ä»¥éœ€è¦è¦†å†™é…ç½®ï¼Œæ­£å¸¸æ“ä½œçš„æ—¶å€™ä¸éœ€è¦æ·»åŠ è¯¥é€‰é¡¹ã€‚<br>æ³¨æ„<code>--overwrite-conf</code>æŒ‡ä»¤å¿…é¡»ç´§è·Ÿåœ¨åé¢ï¼Œè€Œä¸èƒ½å†™åœ¨é…ç½®æ–‡ä»¶åé¢ï¼</p></div></li></ol><blockquote><p>å…¶ä¸­<code>create</code>æ˜¯<code>prepare</code>å’Œ<code>active</code>çš„åˆå¹¶æ“ä½œï¼Œä¸‹é¢æ˜¯è¯¥å‘½ä»¤çš„è§£é‡Šï¼š<br><code>ceph-deploy osd prepare HOST:DISK[:JOURNAL] [HOST:DISK[:JOURNAL]â€¦â€¦]</code><br>ä¸º osd å‡†å¤‡ä¸€ä¸ªç›®å½•/ç£ç›˜ã€‚å®ƒä¼šæ£€æŸ¥æ˜¯å¦è¶…è¿‡ MAX PIDs,è¯»å– bootstrap-osd çš„ key æˆ–è€…å†™ä¸€ä¸ªï¼ˆå¦‚æœæ²¡æœ‰æ‰¾åˆ°çš„è¯ï¼‰ï¼Œç„¶åå®ƒä¼šä½¿ç”¨ ceph-disk çš„ prepare å‘½ä»¤æ¥å‡†å¤‡ç£ç›˜ã€æ—¥å¿—ï¼Œå¹¶ä¸”æŠŠ OSD éƒ¨ç½²åˆ°æŒ‡å®šçš„ä¸»æœºä¸Šã€‚<br><code>ceph-deploy osd active HOST:DISK[:JOURNAL] [HOST:DISK[:JOURNAL]â€¦â€¦]</code><br>æ¿€æ´»ä¸Šä¸€æ­¥çš„ OSDã€‚å®é™…ä¸Šå®ƒä¼šè°ƒç”¨ ceph-disk çš„ active å‘½ä»¤ï¼Œè¿™ä¸ªæ—¶å€™ OSD ä¼š up and inã€‚<br><code>ceph-deploy osd create HOST:DISK[:JOURNAL] [HOST:DISK[:JOURNAL]â€¦â€¦]</code><br>ä¸Šé¢ä¸¤ä¸ªå‘½ä»¤çš„ç»¼åˆã€‚</p></blockquote><p>è¿”å›ç»“æœå¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[ceph_deploy.conf][DEBUG ] found configuration file at: &#x2F;root&#x2F;.cephdeploy.conf</span><br><span class="line">[ceph_deploy.cli][INFO  ] Invoked (2.0.1): &#x2F;usr&#x2F;bin&#x2F;ceph-deploy --overwrite-conf osd create --data &#x2F;dev&#x2F;sdb node1</span><br><span class="line">[ceph_deploy.cli][INFO  ] ceph-deploy options:</span><br><span class="line">[ceph_deploy.cli][INFO  ]  verbose                       : False</span><br><span class="line">[ceph_deploy.cli][INFO  ]  bluestore                     : None</span><br><span class="line">[ceph_deploy.cli][INFO  ]  cd_conf                       : &lt;ceph_deploy.conf.cephdeploy.Conf instance at 0x7fa5b902af80&gt;</span><br><span class="line">[ceph_deploy.cli][INFO  ]  cluster                       : ceph</span><br><span class="line">[ceph_deploy.cli][INFO  ]  fs_type                       : xfs</span><br><span class="line">[ceph_deploy.cli][INFO  ]  block_wal                     : None</span><br><span class="line">[ceph_deploy.cli][INFO  ]  default_release               : False</span><br><span class="line">[ceph_deploy.cli][INFO  ]  username                      : None</span><br><span class="line">[ceph_deploy.cli][INFO  ]  journal                       : None</span><br><span class="line">[ceph_deploy.cli][INFO  ]  subcommand                    : create</span><br><span class="line">[ceph_deploy.cli][INFO  ]  host                          : node1</span><br><span class="line">[ceph_deploy.cli][INFO  ]  filestore                     : None</span><br><span class="line">[ceph_deploy.cli][INFO  ]  func                          : &lt;function osd at 0x7fa5b94882a8&gt;</span><br><span class="line">[ceph_deploy.cli][INFO  ]  ceph_conf                     : None</span><br><span class="line">[ceph_deploy.cli][INFO  ]  zap_disk                      : False</span><br><span class="line">[ceph_deploy.cli][INFO  ]  data                          : &#x2F;dev&#x2F;sdb</span><br><span class="line">[ceph_deploy.cli][INFO  ]  block_db                      : None</span><br><span class="line">[ceph_deploy.cli][INFO  ]  dmcrypt                       : False</span><br><span class="line">[ceph_deploy.cli][INFO  ]  overwrite_conf                : True</span><br><span class="line">[ceph_deploy.cli][INFO  ]  dmcrypt_key_dir               : &#x2F;etc&#x2F;ceph&#x2F;dmcrypt-keys</span><br><span class="line">[ceph_deploy.cli][INFO  ]  quiet                         : False</span><br><span class="line">[ceph_deploy.cli][INFO  ]  debug                         : False</span><br><span class="line">[ceph_deploy.osd][DEBUG ] Creating OSD on cluster ceph with data device &#x2F;dev&#x2F;sdb</span><br><span class="line">[node1][DEBUG ] connection detected need for sudo</span><br><span class="line">[node1][DEBUG ] connected to host: node1</span><br><span class="line">[node1][DEBUG ] detect platform information from remote host</span><br><span class="line">[node1][DEBUG ] detect machine type</span><br><span class="line">[node1][DEBUG ] find the location of an executable</span><br><span class="line">[ceph_deploy.osd][INFO  ] Distro info: CentOS Linux 7.6.1810 Core</span><br><span class="line">[ceph_deploy.osd][DEBUG ] Deploying osd to node1</span><br><span class="line">[node1][DEBUG ] write cluster configuration to &#x2F;etc&#x2F;ceph&#x2F;&#123;cluster&#125;.conf</span><br><span class="line">[node1][DEBUG ] find the location of an executable</span><br><span class="line">[node1][INFO  ] Running command: sudo &#x2F;usr&#x2F;sbin&#x2F;ceph-volume --cluster ceph lvm create --bluestore --data &#x2F;dev&#x2F;sdb</span><br><span class="line">[node1][WARNIN] Running command: &#x2F;bin&#x2F;ceph-authtool --gen-print-key</span><br><span class="line">[node1][WARNIN] Running command: &#x2F;bin&#x2F;ceph --cluster ceph --name client.bootstrap-osd --keyring &#x2F;var&#x2F;lib&#x2F;ceph&#x2F;bootstrap-osd&#x2F;ceph.keyring -i - osd new 0e40ac48-72bf-42b7-b1d0-8c7d4ed3a1d5</span><br><span class="line">[node1][WARNIN] Running command: &#x2F;usr&#x2F;sbin&#x2F;vgcreate -s 1G --force --yes ceph-54716551-34cf-47e3-8f6f-81cce6973a81 &#x2F;dev&#x2F;sdb</span><br><span class="line">[node1][WARNIN]  stdout: Physical volume &quot;&#x2F;dev&#x2F;sdb&quot; successfully created.</span><br><span class="line">[node1][WARNIN]  stdout: Volume group &quot;ceph-54716551-34cf-47e3-8f6f-81cce6973a81&quot; successfully created</span><br><span class="line">[node1][WARNIN] Running command: &#x2F;usr&#x2F;sbin&#x2F;lvcreate --yes -l 100%FREE -n osd-block-0e40ac48-72bf-42b7-b1d0-8c7d4ed3a1d5 ceph-54716551-34cf-47e3-8f6f-81cce6973a81</span><br><span class="line">[node1][WARNIN]  stdout: Logical volume &quot;osd-block-0e40ac48-72bf-42b7-b1d0-8c7d4ed3a1d5&quot; created.</span><br><span class="line">[node1][WARNIN] Running command: &#x2F;bin&#x2F;ceph-authtool --gen-print-key</span><br><span class="line">[node1][WARNIN] Running command: &#x2F;bin&#x2F;mount -t tmpfs tmpfs &#x2F;var&#x2F;lib&#x2F;ceph&#x2F;osd&#x2F;ceph-0</span><br><span class="line">[node1][WARNIN] Running command: &#x2F;usr&#x2F;sbin&#x2F;restorecon &#x2F;var&#x2F;lib&#x2F;ceph&#x2F;osd&#x2F;ceph-0</span><br><span class="line">[node1][WARNIN] Running command: &#x2F;bin&#x2F;chown -h ceph:ceph &#x2F;dev&#x2F;ceph-54716551-34cf-47e3-8f6f-81cce6973a81&#x2F;osd-block-0e40ac48-72bf-42b7-b1d0-8c7d4ed3a1d5</span><br><span class="line">[node1][WARNIN] Running command: &#x2F;bin&#x2F;chown -R ceph:ceph &#x2F;dev&#x2F;dm-2</span><br><span class="line">[node1][WARNIN] Running command: &#x2F;bin&#x2F;ln -s &#x2F;dev&#x2F;ceph-54716551-34cf-47e3-8f6f-81cce6973a81&#x2F;osd-block-0e40ac48-72bf-42b7-b1d0-8c7d4ed3a1d5 &#x2F;var&#x2F;lib&#x2F;ceph&#x2F;osd&#x2F;ceph-0&#x2F;block</span><br><span class="line">[node1][WARNIN] Running command: &#x2F;bin&#x2F;ceph --cluster ceph --name client.bootstrap-osd --keyring &#x2F;var&#x2F;lib&#x2F;ceph&#x2F;bootstrap-osd&#x2F;ceph.keyring mon getmap -o &#x2F;var&#x2F;lib&#x2F;ceph&#x2F;osd&#x2F;ceph-0&#x2F;activate.monmap</span><br><span class="line">[node1][WARNIN]  stderr: 2020-03-18 21:22:24.155 7f50487fa700 -1 auth: unable to find a keyring on &#x2F;etc&#x2F;ceph&#x2F;ceph.client.bootstrap-osd.keyring,&#x2F;etc&#x2F;ceph&#x2F;ceph.keyring,&#x2F;etc&#x2F;ceph&#x2F;keyring,&#x2F;etc&#x2F;ceph&#x2F;keyring.bin,: (2) No such file or directory</span><br><span class="line">[node1][WARNIN] 2020-03-18 21:22:24.155 7f50487fa700 -1 AuthRegistry(0x7f5040064e08) no keyring found at &#x2F;etc&#x2F;ceph&#x2F;ceph.client.bootstrap-osd.keyring,&#x2F;etc&#x2F;ceph&#x2F;ceph.keyring,&#x2F;etc&#x2F;ceph&#x2F;keyring,&#x2F;etc&#x2F;ceph&#x2F;keyring.bin,, disabling cephx</span><br><span class="line">[node1][WARNIN]  stderr: got monmap epoch 1</span><br><span class="line">[node1][WARNIN] Running command: &#x2F;bin&#x2F;ceph-authtool &#x2F;var&#x2F;lib&#x2F;ceph&#x2F;osd&#x2F;ceph-0&#x2F;keyring --create-keyring --name osd.0 --add-key AQCMIHJeddtiNhAAqZHUd554bkav2bT85my+3A&#x3D;&#x3D;</span><br><span class="line">[node1][WARNIN]  stdout: creating &#x2F;var&#x2F;lib&#x2F;ceph&#x2F;osd&#x2F;ceph-0&#x2F;keyring</span><br><span class="line">[node1][WARNIN] added entity osd.0 auth(key&#x3D;AQCMIHJeddtiNhAAqZHUd554bkav2bT85my+3A&#x3D;&#x3D;)</span><br><span class="line">[node1][WARNIN] Running command: &#x2F;bin&#x2F;chown -R ceph:ceph &#x2F;var&#x2F;lib&#x2F;ceph&#x2F;osd&#x2F;ceph-0&#x2F;keyring</span><br><span class="line">[node1][WARNIN] Running command: &#x2F;bin&#x2F;chown -R ceph:ceph &#x2F;var&#x2F;lib&#x2F;ceph&#x2F;osd&#x2F;ceph-0&#x2F;</span><br><span class="line">[node1][WARNIN] Running command: &#x2F;bin&#x2F;ceph-osd --cluster ceph --osd-objectstore bluestore --mkfs -i 0 --monmap &#x2F;var&#x2F;lib&#x2F;ceph&#x2F;osd&#x2F;ceph-0&#x2F;activate.monmap --keyfile - --osd-data &#x2F;var&#x2F;lib&#x2F;ceph&#x2F;osd&#x2F;ceph-0&#x2F; --osd-uuid 0e40ac48-72bf-42b7-b1d0-8c7d4ed3a1d5 --setuser ceph --setgroup ceph</span><br><span class="line">[node1][WARNIN] --&gt; ceph-volume lvm prepare successful for: &#x2F;dev&#x2F;sdb</span><br><span class="line">[node1][WARNIN] Running command: &#x2F;bin&#x2F;chown -R ceph:ceph &#x2F;var&#x2F;lib&#x2F;ceph&#x2F;osd&#x2F;ceph-0</span><br><span class="line">[node1][WARNIN] Running command: &#x2F;bin&#x2F;ceph-bluestore-tool --cluster&#x3D;ceph prime-osd-dir --dev &#x2F;dev&#x2F;ceph-54716551-34cf-47e3-8f6f-81cce6973a81&#x2F;osd-block-0e40ac48-72bf-42b7-b1d0-8c7d4ed3a1d5 --path &#x2F;var&#x2F;lib&#x2F;ceph&#x2F;osd&#x2F;ceph-0 --no-mon-config</span><br><span class="line">[node1][WARNIN] Running command: &#x2F;bin&#x2F;ln -snf &#x2F;dev&#x2F;ceph-54716551-34cf-47e3-8f6f-81cce6973a81&#x2F;osd-block-0e40ac48-72bf-42b7-b1d0-8c7d4ed3a1d5 &#x2F;var&#x2F;lib&#x2F;ceph&#x2F;osd&#x2F;ceph-0&#x2F;block</span><br><span class="line">[node1][WARNIN] Running command: &#x2F;bin&#x2F;chown -h ceph:ceph &#x2F;var&#x2F;lib&#x2F;ceph&#x2F;osd&#x2F;ceph-0&#x2F;block</span><br><span class="line">[node1][WARNIN] Running command: &#x2F;bin&#x2F;chown -R ceph:ceph &#x2F;dev&#x2F;dm-2</span><br><span class="line">[node1][WARNIN] Running command: &#x2F;bin&#x2F;chown -R ceph:ceph &#x2F;var&#x2F;lib&#x2F;ceph&#x2F;osd&#x2F;ceph-0</span><br><span class="line">[node1][WARNIN] Running command: &#x2F;bin&#x2F;systemctl enable ceph-volume@lvm-0-0e40ac48-72bf-42b7-b1d0-8c7d4ed3a1d5</span><br><span class="line">[node1][WARNIN]  stderr: Created symlink from &#x2F;etc&#x2F;systemd&#x2F;system&#x2F;multi-user.target.wants&#x2F;ceph-volume@lvm-0-0e40ac48-72bf-42b7-b1d0-8c7d4ed3a1d5.service to &#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;system&#x2F;ceph-volume@.service.</span><br><span class="line">[node1][WARNIN] Running command: &#x2F;bin&#x2F;systemctl enable --runtime ceph-osd@0</span><br><span class="line">[node1][WARNIN]  stderr: Created symlink from &#x2F;run&#x2F;systemd&#x2F;system&#x2F;ceph-osd.target.wants&#x2F;ceph-osd@0.service to &#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;system&#x2F;ceph-osd@.service.</span><br><span class="line">[node1][WARNIN] Running command: &#x2F;bin&#x2F;systemctl start ceph-osd@0</span><br><span class="line">[node1][WARNIN] --&gt; ceph-volume lvm activate successful for osd ID: 0</span><br><span class="line">[node1][WARNIN] --&gt; ceph-volume lvm create successful for: &#x2F;dev&#x2F;sdb</span><br><span class="line">[node1][INFO  ] checking OSD status...</span><br><span class="line">[node1][DEBUG ] find the location of an executable</span><br><span class="line">[node1][INFO  ] Running command: sudo &#x2F;bin&#x2F;ceph --cluster&#x3D;ceph osd stat --format&#x3D;json</span><br><span class="line">[ceph_deploy.osd][DEBUG ] Host node1 is now ready for osd use.</span><br></pre></td></tr></table></figure><br>é˜…è¯»æœ€åä¸€è¡Œä¿¡æ¯ï¼Œæˆ‘ä»¬çŸ¥é“ node1 ä½œä¸º osd èŠ‚ç‚¹è¢«æ·»åŠ è¿›å»äº†ã€‚<br><div class="note info modern"><p><strong>æ³¨æ„ï¼š</strong><br>å¦‚æœ zap ç£ç›˜å¤±è´¥ï¼Œç¡®è®¤ç£ç›˜æ˜¯å¦ä¹‹å‰å·²ç»åšè¿‡ LUNï¼Œå¦‚æœæ˜¯ï¼Œéœ€è¦åˆ é™¤ LVï¼ŒVGï¼ŒPVï¼Œä¹‹åå†è¿›è¡Œæ·»åŠ  osd çš„æ“ä½œã€‚</p></div></p><ol start="5"><li>æŸ¥çœ‹é›†ç¾¤çŠ¶æ€<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ceph -s</span><br></pre></td></tr></table></figure>è¿”å›ç»“æœå¦‚ä¸‹ï¼š<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cluster:</span><br><span class="line">id:     e32088fc-a761-4aab-b221-fb56d42371dc</span><br><span class="line">health: HEALTH_WARN         # æç¤º osd èŠ‚ç‚¹å°‘äºé¢„è®¾</span><br><span class="line">        2 daemons have recently crashed</span><br><span class="line">        OSD count 1 &lt; osd_pool_default_size 2</span><br><span class="line">services:</span><br><span class="line">mon: 1 daemons, quorum admin-node (age 3h)</span><br><span class="line">mgr: admin-node(active, since 26m)</span><br><span class="line">osd: 1 osds: 1 up (since 7m), 1 in (since 7m)</span><br><span class="line">data:</span><br><span class="line">pools:   0 pools, 0 pgs</span><br><span class="line">objects: 0 objects, 0 B</span><br><span class="line">usage:   1.0 GiB used, 3.0 GiB &#x2F; 4 GiB avail</span><br><span class="line">pgs:</span><br></pre></td></tr></table></figure>è‡³æ­¤ï¼Œå•ä¸ªçš„ OSD èŠ‚ç‚¹æ·»åŠ æˆåŠŸã€‚</li></ol><p>ä½†æ˜¯å› ä¸ºæˆ‘ä»¬åœ¨<a href="#%E5%88%9D%E5%A7%8B%E5%8C%96">3.2 èŠ‚</a>çš„é…ç½®ä¸­æ·»åŠ äº†<code>osd pool default size = 2</code>é…ç½®ï¼Œæ‰€ä»¥ä¼šæ˜¾ç¤º warning ä¿¡æ¯ã€‚æˆ‘ä»¬å¯ä»¥é‡å¤ä¸Šé¢æ­¥éª¤æ·»åŠ  node2 ä¸ºå¦ä¸€ä¸ª OSD èŠ‚ç‚¹ä¹‹åå†æ¬¡æŸ¥çœ‹é›†ç¾¤å¥åº·çŠ¶æ€ï¼š<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ceph health</span><br></pre></td></tr></table></figure><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">HEALTH_OK</span><br></pre></td></tr></table></figure><br>è‡³æ­¤ï¼Œceph ç¯å¢ƒæ­å»ºå®Œæ¯•ï¼ </p><hr><h2 id="å¯ç”¨-dashboard"><a href="#å¯ç”¨-dashboard" class="headerlink" title="å¯ç”¨ dashboard"></a>å¯ç”¨ dashboard</h2><ol><li>åœ¨æ‰€æœ‰çš„ mgr èŠ‚ç‚¹å®‰è£… dashbaord<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum install ceph-mgr-dashboard -y</span><br></pre></td></tr></table></figure></li><li>é‡å¯ mgr åŠŸèƒ½<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ceph mgr module <span class="built_in">disable</span> dashboard</span><br><span class="line">ceph mgr module <span class="built_in">enable</span> dashboard</span><br></pre></td></tr></table></figure></li><li>ç”Ÿæˆå¹¶å®‰è£…è‡ªç­¾åçš„è¯ä¹¦<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ceph dashboard create-self-signed-cert</span><br></pre></td></tr></table></figure></li><li>åˆ›å»ºä¸€ä¸ª dashboard ç™»å½•ç”¨æˆ·åå¯†ç <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ceph dashboard ac-user-create admin admin administrator </span><br></pre></td></tr></table></figure></li><li>æŸ¥çœ‹æœåŠ¡è®¿é—®æ–¹å¼<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ceph mgr services</span><br></pre></td></tr></table></figure>è¿”å›ç»“æœ<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;dashboard&quot;: &quot;https:&#x2F;&#x2F;cnode0:8443&#x2F;&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>æ‰“å¼€é˜²ç«å¢™æŒ‡å®šç«¯å£ï¼ˆ8443ï¼‰<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">firewall-cmd --zone&#x3D;public --add-port&#x3D;8443&#x2F;tcp --permanent &gt;&#x2F;dev&#x2F;null 2&gt;&amp;1</span><br><span class="line">firewall-cmd --reload &gt;&#x2F;dev&#x2F;null 2&gt;&amp;1</span><br></pre></td></tr></table></figure></li><li>è®¿é—®æµè§ˆå™¨<br><img src= "/img/loading.svg" data-lazy-src="/images/ceph-dashboard.png" alt="dashboard"></li></ol><h2 id="å¼€å¯-Object-Gateway-ç®¡ç†åŠŸèƒ½"><a href="#å¼€å¯-Object-Gateway-ç®¡ç†åŠŸèƒ½" class="headerlink" title="å¼€å¯ Object Gateway ç®¡ç†åŠŸèƒ½"></a>å¼€å¯ Object Gateway ç®¡ç†åŠŸèƒ½</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1ã€åˆ›å»ºrgwç”¨æˆ·</span><br><span class="line"># radosgw-admin user info --uid&#x3D;user01</span><br><span class="line">2ã€æä¾›Dashboardè¯ä¹¦</span><br><span class="line"># ceph dashboard set-rgw-api-access-key $access_key</span><br><span class="line"># ceph dashboard set-rgw-api-secret-key $secret_key</span><br><span class="line">3ã€é…ç½®rgwä¸»æœºåå’Œç«¯å£</span><br><span class="line"># ceph dashboard set-rgw-api-host 192.168.25.224</span><br><span class="line">4ã€åˆ·æ–°webé¡µé¢</span><br></pre></td></tr></table></figure><p>ä»¥ä¸‹å†…å®¹æ˜¯ä»åˆ«äººåšå®¢å¤åˆ¶çš„ï¼Œæ²¡æœ‰éªŒè¯ã€‚</p><hr><h2 id="å®‰è£…-grafana"><a href="#å®‰è£…-grafana" class="headerlink" title="å®‰è£… grafana"></a>å®‰è£… grafana</h2><ol><li>é…ç½® yum æºæ–‡ä»¶<br>å»ºè®®ä½¿ç”¨æ¸…åæºï¼š<a href="https://mirror.tuna.tsinghua.edu.cn/help/grafana/">grafana | é•œåƒç«™ä½¿ç”¨å¸®åŠ© | æ¸…åå¤§å­¦å¼€æºè½¯ä»¶é•œåƒç«™ | Tsinghua Open Source Mirror</a><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim /etc/yum.repos.d/grafana.repo</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[grafana]</span><br><span class="line">name&#x3D;grafana</span><br><span class="line">baseurl&#x3D;https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;grafana&#x2F;yum&#x2F;rpm</span><br><span class="line">repo_gpgcheck&#x3D;0</span><br><span class="line">enabled&#x3D;1</span><br><span class="line">gpgcheck&#x3D;0</span><br></pre></td></tr></table></figure></li><li>é€šè¿‡ yum å‘½ä»¤å®‰è£… grafana<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum -y install grafana</span><br></pre></td></tr></table></figure>3.å¯åŠ¨ grafana å¹¶è®¾ä¸ºå¼€æœºè‡ªå¯<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">systemctl start grafana-server.service </span><br><span class="line">systemctl <span class="built_in">enable</span> grafana-server.service</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…-promethus"><a href="#å®‰è£…-promethus" class="headerlink" title="å®‰è£… promethus"></a>å®‰è£… promethus</h2></li><li>ä¸‹è½½å®‰è£…åŒ…ï¼Œ<br>ä¸‹è½½åœ°å€ï¼š<code>https://prometheus.io/download/</code></li><li>è§£å‹å‹ç¼©åŒ…<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tar fvxz prometheus-2.14.0.linux-amd64.tar.gz</span><br></pre></td></tr></table></figure></li><li>å°†è§£å‹åçš„ç›®å½•æ”¹å<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mv prometheus-2.14.0.linux-amd64 /opt/prometheus</span><br></pre></td></tr></table></figure></li><li>æŸ¥çœ‹ promethus ç‰ˆæœ¬<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./prometheus --version</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">prometheus, version 2.14.0 (branch: HEAD, revision: edeb7a44cbf745f1d8be4ea6f215e79e651bfe19)</span><br><span class="line">  build user:       root@df2327081015</span><br><span class="line">  build date:       20191111-14:27:12</span><br><span class="line">  go version:       go1.13.4</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li>é…ç½®ç³»ç»ŸæœåŠ¡å¯åŠ¨<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim /etc/systemd/system/prometheus.service</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description&#x3D;Prometheus Monitoring System</span><br><span class="line">Documentation&#x3D;Prometheus Monitoring System</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">ExecStart&#x3D;&#x2F;opt&#x2F;prometheus&#x2F;prometheus \</span><br><span class="line">  --config.file &#x2F;opt&#x2F;prometheus&#x2F;prometheus.yml \</span><br><span class="line">  --web.listen-address&#x3D;:9090</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy&#x3D;multi-user.target</span><br></pre></td></tr></table></figure>6ã€åŠ è½½ç³»ç»ŸæœåŠ¡<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">systemctl daemon-reload</span><br></pre></td></tr></table></figure>7ã€å¯åŠ¨æœåŠ¡å’Œæ·»åŠ å¼€æœºè‡ªå¯åŠ¨<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">systemctl start prometheus</span><br><span class="line">systemctl <span class="built_in">enable</span> prometheus</span><br></pre></td></tr></table></figure><h2 id="ceph-mgr-prometheus-æ’ä»¶é…ç½®"><a href="#ceph-mgr-prometheus-æ’ä»¶é…ç½®" class="headerlink" title="ceph mgr prometheus æ’ä»¶é…ç½®"></a>ceph mgr prometheus æ’ä»¶é…ç½®</h2></li></ol><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ceph mgr module <span class="built_in">enable</span> prometheus</span><br><span class="line">netstat -nltp | grep mgr æ£€æŸ¥ç«¯å£</span><br><span class="line">curl 127.0.0.1:9283/metrics  æµ‹è¯•è¿”å›å€¼</span><br></pre></td></tr></table></figure><h2 id="é…ç½®-promethus"><a href="#é…ç½®-promethus" class="headerlink" title="é…ç½® promethus"></a>é…ç½® promethus</h2><p>1ã€åœ¨ scrape_configs: é…ç½®é¡¹ä¸‹æ·»åŠ </p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vim prometheus.yml</span><br><span class="line">- job_name: &#39;ceph_cluster&#39;</span><br><span class="line">    honor_labels: true</span><br><span class="line">    scrape_interval: 5s</span><br><span class="line">    static_configs:</span><br><span class="line">      - targets: [&#39;192.168.25.224:9283&#39;]</span><br><span class="line">        labels:</span><br><span class="line">          instance: ceph</span><br><span class="line">          </span><br></pre></td></tr></table></figure><p>2ã€é‡å¯ promethus æœåŠ¡</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">systemctl restart prometheus</span><br></pre></td></tr></table></figure><p>3ã€æ£€æŸ¥ prometheus æœåŠ¡å™¨ä¸­æ˜¯å¦æ·»åŠ æˆåŠŸ</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># æµè§ˆå™¨-ã€‹ http:&#x2F;&#x2F;x.x.x.x:9090 -ã€‹status -ã€‹Targets</span><br></pre></td></tr></table></figure><h2 id="é…ç½®-grafana"><a href="#é…ç½®-grafana" class="headerlink" title="é…ç½® grafana"></a>é…ç½® grafana</h2><ol><li>æµè§ˆå™¨ç™»å½• grafana ç®¡ç†ç•Œé¢  </li><li>æ·»åŠ  data sourcesï¼Œç‚¹å‡» configurationâ€“ã€‹data sources  </li><li>æ·»åŠ  dashboardï¼Œç‚¹å‡» HOMEâ€“ã€‹find dashboard on grafana.com  </li><li>æœç´¢ ceph çš„ dashboard  </li><li>ç‚¹å‡» HOMEâ€“ã€‹Import dashboard, é€‰æ‹©åˆé€‚çš„ dashboardï¼Œè®°å½•ç¼–å·</li></ol><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://docs.ceph.com/en/nautilus/start/quick-start-preflight/">Preflight Checklist â€” Ceph Documentation</a></li><li><a href="https://docs.ceph.com/en/nautilus/start/quick-ceph-deploy/">Storage Cluster Quick Start â€” Ceph Documentation</a></li><li><a href="https://www.linuxtechi.com/install-configure-ceph-cluster-centos-7/">Quick Guide to Install and Configure Ceph Cluster on CentOS 7</a></li><li><a href="https://zhuanlan.zhihu.com/p/67832892">å•æœºç‰ˆ Ceph ç¯å¢ƒéƒ¨ç½²ï¼ŒLinux å¹³å° - çŸ¥ä¹</a></li><li><a href="https://blog.csdn.net/aixiaoyang168/article/details/78788703">åˆè¯• Centos7 ä¸Š Ceph å­˜å‚¨é›†ç¾¤æ­å»º_è¿ç»´_å“_å°ç¾Šçš„åšå®¢-CSDN åšå®¢</a></li><li><a href="https://docs.ceph.com/en/latest/man/8/ceph-deploy/">ceph-deploy â€“ Ceph deployment tool â€” Ceph Documentation</a></li><li><a href="https://blog.csdn.net/ns2250225/article/details/69978355">ceph-deploy å‘½ä»¤è¯¦è§£_è¿ç»´_ns2250225-CSDN åšå®¢</a></li><li><a href="https://www.cnblogs.com/passzhang/p/12151835.html">å…¨ç½‘æœ€è¯¦ç»†çš„ Ceph14.2.5 é›†ç¾¤éƒ¨ç½²åŠé…ç½®æ–‡ä»¶è¯¦è§£ï¼Œå¿«æ¥çœ‹çœ‹å§-åšå®¢å›­</a></li><li><a href="https://www.cnblogs.com/passzhang/p/12179816.html">Ceph æ–‡ä»¶ç³»ç»Ÿ-å…¨ç½‘æœ€ç‚«é…·çš„ Ceph Dashboard é¡µé¢å’Œ Ceph ç›‘æ§-åšå®¢å›­</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> å·¥ä½œæ—¥å¸¸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CEPH </tag>
            
            <tag> CentOS7 </tag>
            
            <tag> ç¯å¢ƒæ­å»º </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•ç¦ç”¨ Angular ä¸­æ¨¡æ¿é©±åŠ¨è¡¨å•ä¸­çš„æŸä¸ªå­—æ®µï¼Ÿ</title>
      <link href="blog/2020-03-09/Angular-disable-input-fields-in-template-driven-form/"/>
      <url>blog/2020-03-09/Angular-disable-input-fields-in-template-driven-form/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä¹¦æ¥ä¸Šå›ï¼Œæˆ‘ä»¬åœ¨<a href="/blog/2020-03-06/Angular-orderBy-Object-or-Array/">ä¸Šæ–‡</a>ä¸­å°†è¡¨å•å±•ç¤ºå‡ºæ¥äº†ï¼Œä½†æ˜¯æ€ä¹ˆæŒ‰ç…§é€»è¾‘å¯¹è¡¨å•è¿›è¡Œé™åˆ¶å‘¢ï¼Ÿæ¯”å¦‚è¯´åŸºæœ¬çš„ç¦ç”¨è¡¨å•ä¸­çš„æŸä¸ªå­—æ®µï¼Ÿ</p><h2 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h2><p>ç›´æ¥ä½¿ç”¨<code>disable=true</code>å¹¶ä¸èƒ½éšç€ checkbox çš„å˜åŒ–ä½¿å€¼å˜åŒ–ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è¿™ä¹ˆå†™ï¼š<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!--html--&gt;</span><br><span class="line">&lt;!-- Field control --&gt;</span><br><span class="line">&lt;!-- bool --&gt;</span><br><span class="line">&lt;div class&#x3D;&quot;form-group&quot;</span><br><span class="line">  *ngIf&#x3D;&quot;moduleOption.value.type &#x3D;&#x3D;&#x3D; &#39;bool&#39;&quot;&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;checkbox checkbox-primary&quot;&gt;</span><br><span class="line">    &lt;input id&#x3D;&quot;&#123;&#123; moduleOption.value.name &#125;&#125;&quot;</span><br><span class="line">           type&#x3D;&quot;checkbox&quot;</span><br><span class="line">           (change)&#x3D;&quot;onUserCheckMode()&quot;</span><br><span class="line">           formControlName&#x3D;&quot;&#123;&#123; moduleOption.value.name &#125;&#125;&quot;&gt;</span><br><span class="line">    &lt;label i18n for&#x3D;&quot;&#123;&#123; moduleOption.value.name &#125;&#125;&quot;&gt; Check set mode auto&#x2F;manual.&lt;&#x2F;label&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br></pre></td></tr></table></figure><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; xx.ts</span><br><span class="line">&#x2F;&#x2F;åœ¨é€‰æ‹©timeæ—¶ï¼Œå¦‚æœè‡ªåŠ¨ï¼Œåˆ™disableéƒ¨åˆ†input</span><br><span class="line">  onUserCheckMode() &#123;</span><br><span class="line">    this.isAuto &#x3D; this.sysSettingForm.value.auto &#x3D;&#x3D; true;</span><br><span class="line">    if (this.isTime) &#123;</span><br><span class="line">      if (this.isAuto &#x3D;&#x3D; true) &#123;</span><br><span class="line">        this.sysSettingForm.get(&#39;ntp_addr&#39;).enable();</span><br><span class="line">        this.sysSettingForm.get(&#39;date&#39;).disable();</span><br><span class="line">        this.sysSettingForm.get(&#39;time&#39;).disable();</span><br><span class="line">        this.sysSettingForm.get(&#39;time_zone&#39;).disable();</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        this.sysSettingForm.get(&#39;ntp_addr&#39;).disable();</span><br><span class="line">        this.sysSettingForm.get(&#39;date&#39;).enable();</span><br><span class="line">        this.sysSettingForm.get(&#39;time&#39;).enable();</span><br><span class="line">        this.sysSettingForm.get(&#39;time_zone&#39;).enable();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  &#x2F;&#x2F; åˆå§‹åŒ–è¡¨æ ¼æ—¶ï¼Œå¯¹è¡¨æ ¼ä¹Ÿéœ€è¦disable</span><br><span class="line">  createForm() &#123;</span><br><span class="line">    const controlsConfig &#x3D; &#123;&#125;;</span><br><span class="line">    _.forEach(this.moduleOptions, (moduleOption) &#x3D;&gt; &#123;</span><br><span class="line">      switch (moduleOption.type) &#123;</span><br><span class="line">        case &#39;bool&#39;:</span><br><span class="line">          controlsConfig[moduleOption.name] &#x3D; [this.isAuto, this.getValidators(moduleOption)];</span><br><span class="line">          break;</span><br><span class="line">        default:</span><br><span class="line">          controlsConfig[moduleOption.name] &#x3D; [moduleOption.default_value, this.getValidators(moduleOption)];</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    this.sysSettingForm &#x3D; this.formBuilder.group(controlsConfig);</span><br><span class="line">    if (this.isTime) &#123;</span><br><span class="line">      if (this.isAuto &#x3D;&#x3D; true) &#123;</span><br><span class="line">        this.sysSettingForm.get(&#39;ntp_addr&#39;).enable();</span><br><span class="line">        this.sysSettingForm.get(&#39;date&#39;).disable();</span><br><span class="line">        this.sysSettingForm.get(&#39;time&#39;).disable();</span><br><span class="line">        this.sysSettingForm.get(&#39;time_zone&#39;).disable();</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        this.sysSettingForm.get(&#39;ntp_addr&#39;).disable();</span><br><span class="line">        this.sysSettingForm.get(&#39;date&#39;).enable();</span><br><span class="line">        this.sysSettingForm.get(&#39;time&#39;).enable();</span><br><span class="line">        this.sysSettingForm.get(&#39;time_zone&#39;).enable();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p><h2 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h2><p><img src= "/img/loading.svg" data-lazy-src="/images/Angular-form-disable.gif" alt="æ ¹æ®é€‰æ‹©æ¡†disable/enable"></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://stackoverflow.com/questions/42840136/disable-input-fields-in-reactive-form">angular - Disable Input fields in reactive form - Stack Overflow</a></p>]]></content>
      
      
      <categories>
          
          <category> å·¥ä½œæ—¥å¸¸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> form </tag>
            
            <tag> Angular </tag>
            
            <tag> å‰ç«¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Angular ä¸­å¦‚ä½•å°† Object æˆ–è€… Array æŒ‰åºæ’åˆ—ï¼Ÿ</title>
      <link href="blog/2020-03-06/Angular-orderBy-Object-or-Array/"/>
      <url>blog/2020-03-06/Angular-orderBy-Object-or-Array/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><div class="note warning no-icon modern"><p><strong>æ³¨æ„ï¼š</strong><br>Angular ä¸å†æå€¡ä½¿ç”¨ç®¡é“ï¼Œå› ä¸º<br>(a) å®ƒä»¬æ€§èƒ½å ªå¿§<br>(b) å®ƒä»¬ä¼šé˜»æ­¢æ¯”è¾ƒæ¿€è¿›çš„ä»£ç æœ€å°åŒ–(minification)ã€‚</p><p>æ— è®ºæ˜¯ filter è¿˜æ˜¯ orderBy éƒ½éœ€è¦å®ƒçš„å‚æ•°å¼•ç”¨å¯¹è±¡å‹å±æ€§ã€‚è¿™æ ·çš„ç®¡é“å¿…ç„¶æ˜¯éçº¯ç®¡é“ï¼Œå¹¶ä¸” Angular ä¼šåœ¨å‡ ä¹æ¯ä¸€æ¬¡å˜æ›´æ£€æµ‹å‘¨æœŸä¸­è°ƒç”¨éçº¯ç®¡é“ã€‚</p><p>è¿‡æ»¤ã€ ç‰¹åˆ«æ˜¯æ’åºæ˜¯æ˜‚è´µçš„æ“ä½œã€‚ å½“ Angular æ¯ç§’è°ƒç”¨å¾ˆå¤šæ¬¡è¿™ç±»ç®¡é“å‡½æ•°æ—¶ï¼Œå³ä½¿æ˜¯ä¸­ç­‰è§„æ¨¡çš„åˆ—è¡¨éƒ½å¯èƒ½<strong>ä¸¥é‡é™ä½ç”¨æˆ·ä½“éªŒ</strong>ã€‚<br><strong>å»ºè®®ï¼š</strong><br>æŠŠä½ çš„è¿‡æ»¤å’Œæ’åºé€»è¾‘æŒªè¿›ç»„ä»¶æœ¬èº«ã€‚ ç»„ä»¶å¯ä»¥å¯¹å¤–æš´éœ²ä¸€ä¸ª filteredHeroes æˆ– sortedHeroes å±æ€§ï¼Œè¿™æ ·å®ƒå°±è·å¾—æ§åˆ¶æƒï¼Œä»¥å†³å®šè¦ç”¨ä»€ä¹ˆé¢‘åº¦å»æ‰§è¡Œå…¶å®ƒè¾…åŠ©é€»è¾‘ã€‚ ä½ åŸæœ¬å‡†å¤‡å®ç°ä¸ºç®¡é“ï¼Œå¹¶åœ¨æ•´ä¸ªåº”ç”¨ä¸­å…±äº«çš„é‚£äº›åŠŸèƒ½ï¼Œéƒ½èƒ½è¢«æ”¹å†™ä¸ºä¸€ä¸ªè¿‡æ»¤/æ’åºçš„æœåŠ¡ï¼Œå¹¶æ³¨å…¥åˆ°ç»„ä»¶ä¸­ã€‚</p></div><hr><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å†™å‰ç«¯çš„æ—¶å€™éš¾å…é‡åˆ°æ•°æ®å±•ç¤ºé—®é¢˜ï¼Œæ¯”å¦‚ form è¡¨å•ï¼Œåœ¨ <a href="https://angular.cn/guide/reactive-forms#generating-form-controls-with-formbuilder">ä½¿ç”¨ FormBuilder æ¥ç”Ÿæˆè¡¨å•æ§ä»¶</a> æ—¶ï¼Œå½“ input è¾“å…¥æ¡†è¾ƒå¤šçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯èƒ½å¸Œæœ›èƒ½å¤Ÿè‡ªä¸»æ§åˆ¶è¡¨å•å­—æ®µé¡ºåºï¼Œæ­¤æ—¶ï¼Œåˆ™éœ€è¦å¯¹è¡¨å•å­—æ®µè¿›è¡Œæ’åºã€‚é‚£ä¹ˆï¼Œå¦‚ä½•å®ç°å‘¢ï¼Ÿ</p><h2 id="ä½¿ç”¨å†…ç½®-orderBy"><a href="#ä½¿ç”¨å†…ç½®-orderBy" class="headerlink" title="ä½¿ç”¨å†…ç½® orderBy"></a>ä½¿ç”¨å†…ç½® orderBy</h2> <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;li ng-repeat&#x3D;&quot;item in items | orderBy:&#39;color&#39;&quot;&gt;&#123;&#123; item.color &#125;&#125;&lt;&#x2F;li&gt;</span><br></pre></td></tr></table></figure><p> å‚è§<a href="https://www.cnblogs.com/dajianshi/p/4484237.html">AngularJS orderBy ä½¿ç”¨è¦ç‚¹ - ä½£å·¥ 7001 - åšå®¢å›­</a></p><h2 id="æ²¡æœ‰-orderBy-æ€ä¹ˆåŠ"><a href="#æ²¡æœ‰-orderBy-æ€ä¹ˆåŠ" class="headerlink" title="æ²¡æœ‰ orderBy æ€ä¹ˆåŠ"></a>æ²¡æœ‰ orderBy æ€ä¹ˆåŠ</h2><p> ä» Angular å¼€å§‹ orderBy ä¸å†æ”¯æŒï¼Œæ­¤æ—¶æ— æ³•ç›´æ¥ä½¿ç”¨ã€‚<br> update<a href="https://angular.cn/guide/pipes#appendix-no-filterpipe-or-orderbypipe">é™„å½•ï¼šæ²¡æœ‰ FilterPipe æˆ–è€… OrderByPipe</a></p><h3 id="ä½¿ç”¨å¼€æºåŒ…-ngx-order-pipe"><a href="#ä½¿ç”¨å¼€æºåŒ…-ngx-order-pipe" class="headerlink" title="ä½¿ç”¨å¼€æºåŒ… ngx-order-pipe"></a>ä½¿ç”¨å¼€æºåŒ… ngx-order-pipe</h3><p>å¦‚æœä¸è€ƒè™‘æ€§èƒ½é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨è¿™æ ·çš„æ–¹å¼ï¼š<br> å‚è§ <a href="https://github.com/VadimDez/ngx-order-pipe">Angular 5+ Order Pipe</a><br>è¿™ä¸ªåŒ…å¯ä»¥å®ç°åˆ—è¡¨å¼æ•°æ®çš„æ’åºï¼Œå…·ä½“ç”¨æ³•å‚è§æ–‡æ¡£ã€‚<br>æ³¨æ„ï¼šå¯èƒ½é‡åˆ°<code>The pipe &#39;orderBy&#39; could not be found</code>é”™è¯¯ï¼Œè¿™ä¸ªå¯ä»¥ç¿»é˜… issue è§£å†³ï¼Œæˆ‘è‡ªå·±çš„å®è·µæ˜¯æ”¾åœ¨ä½¿ç”¨çš„ç»„ä»¶çš„ä¸Šä¸€å±‚çº§ç›®å½•ä¸‹é¢ã€‚å¦‚å›¾ï¼š<br><img src= "/img/loading.svg" data-lazy-src="\images\Snipaste_2020-03-06_21-21-52.png" alt=""></p><h3 id="è‡ªå®šä¹‰-pipe-é€ è½®å­"><a href="#è‡ªå®šä¹‰-pipe-é€ è½®å­" class="headerlink" title="è‡ªå®šä¹‰ pipe é€ è½®å­"></a>è‡ªå®šä¹‰ pipe é€ è½®å­</h3><p>å‚è§ <a href="https://blog.csdn.net/u010564430/article/details/54097236">angular2 è‡ªå®šä¹‰ pipe ï¼Œorderby å®ç°æ’åº<em>JavaScript</em>å…°è‰²çš„ fire-CSDN åšå®¢</a></p><h3 id="å¦‚æœè¿”å›çš„å€¼æ˜¯-Object-æ€ä¹ˆåŠ"><a href="#å¦‚æœè¿”å›çš„å€¼æ˜¯-Object-æ€ä¹ˆåŠ" class="headerlink" title="å¦‚æœè¿”å›çš„å€¼æ˜¯ Object æ€ä¹ˆåŠ"></a>å¦‚æœè¿”å›çš„å€¼æ˜¯ Object æ€ä¹ˆåŠ</h3><ol><li>ä½¿ç”¨ KeyValuePipe ç»„ä»¶ã€‚å‚è€ƒ<a href="https://grokonez.com/frontend/angular/angular-6/angular-6-keyvalue-pipe-ngfor-loop-through-object-map-example">Angular 6 - KeyValue Pipe - *ngFor Loop through Object, Map example Â» grokonez</a></li><li>å°† Object éå†ï¼Œç„¶åæ’åºæ”¾åˆ°åˆ—è¡¨ä¸­ï¼Œä»£ç å‚è§ï¼š<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">app.filter(&#39;orderObjectBy&#39;, function() &#123;</span><br><span class="line">  return function(items, field, reverse) &#123;</span><br><span class="line">    var filtered &#x3D; [];</span><br><span class="line">    angular.forEach(items, function(item) &#123;</span><br><span class="line">      filtered.push(item);</span><br><span class="line">    &#125;);</span><br><span class="line">    filtered.sort(function (a, b) &#123;</span><br><span class="line">      return (a[field] &gt; b[field] ? 1 : -1);</span><br><span class="line">    &#125;);</span><br><span class="line">    if(reverse) filtered.reverse();</span><br><span class="line">      return filtered;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2>æ–‡ç« å†™å‡ºæ¥äº†æ‰ç¿»åˆ°å®˜æ–¹æ–‡æ¡£ä¸­çš„å»ºè®®ï¼Œæ‰€ä»¥è¿™ç¯‡æ–‡ç« æ„ä¹‰ä¹Ÿä¸å¤§äº†ã€‚ä¸è¿‡è¿˜æ˜¯åšä¸€ä¸ªè®°å½•å§ï¼Œè¿™ä¹Ÿè¯´æ˜<em>ä½¿ç”¨æ¡†æ¶å‰å…ˆé˜…è¯»å®˜æ–¹æ–‡æ¡£</em>çš„å¿…è¦æ€§ã€‚</li></ol><p>é¡ºä¾¿å‚è€ƒä¸€ä¸‹æ€ä¹ˆå®ç°æ•°ç»„çš„æ’åº<a href="https://segmentfault.com/a/1190000015961859">sort()æ–¹æ³•å®ç°å¯¹è±¡æ•°ç»„çš„æ’åº</a></p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><ol><li><a href="https://stackoverflow.com/questions/19387552/angular-cant-make-ng-repeat-orderby-work">javascript - Angular - Canâ€™t make ng-repeat orderBy work - Stack Overflow</a></li><li><a href="https://justinklemm.com/angularjs-filter-ordering-objects-ngrepeat/">AngularJS Filter for Ordering Objects (Hashes) with ngRepeat</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> å·¥ä½œæ—¥å¸¸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Angular </tag>
            
            <tag> å‰ç«¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨ Python å‹ç¼©å›¾ç‰‡(å€ŸåŠ© TinyPng çš„æ¥å£)</title>
      <link href="blog/2020-01-12/Python-Tinify-images/"/>
      <url>blog/2020-01-12/Python-Tinify-images/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><div class="note info modern"><p>@Depreciate<br>ç›®å‰æš‚æ—¶æ²¡æœ‰è¿™æ–¹é¢çš„éœ€æ±‚ã€‚è€Œä¸”åœ¨<a href="https://tinypng.com/third-party">Third-Party Solutions</a>ä¸­ï¼Œå·²ç»æœ‰äº†ç›¸åº”çš„ Python å®ç°ï¼Œåé¢æœ‰éœ€æ±‚çš„è¯å†ç»§ç»­æ”¹å†™å§ã€‚æœ‰äººæœ‰éœ€æ±‚çš„è¯å¯ä»¥è®¿é—®ä¸‹é¢çš„é“¾æ¥ï¼š</p><ul><li><a href="https://github.com/mbarkhau/tinypng/">mbarkhau/tinypng: Python module and command line tool for tinypng.com</a></li><li><a href="https://github.com/GcsSloop/TinyPng">GcsSloop/TinyPng: å›¾ç‰‡æ‰¹é‡å‹ç¼©è„šæœ¬(Python)</a></li></ul></div><h2 id="ç¼˜èµ·"><a href="#ç¼˜èµ·" class="headerlink" title="ç¼˜èµ·"></a>ç¼˜èµ·</h2><p>çœ‹åˆ°åˆ«äººå®ç°äº†ä¸€å¥—ï¼Œä½†æ˜¯åªæ˜¯åŸºäº Python2 çš„æ”¯æŒï¼Œæ‰€ä»¥æ‰“ç®—å†™ä¸€ä¸ªæ”¯æŒ Python3 çš„ç‰ˆæœ¬ã€‚</p><h2 id="ä½¿ç”¨è¯´æ˜"><a href="#ä½¿ç”¨è¯´æ˜" class="headerlink" title="ä½¿ç”¨è¯´æ˜"></a>ä½¿ç”¨è¯´æ˜</h2><p>é¦–å…ˆå»å®˜ç½‘ç”³è¯·åˆ° key ğŸ‘‰<a href="https://tinypng.com/developers">tinypng</a>ã€‚ç„¶åè¿è¡Œè„šæœ¬ã€‚<code>-h</code>æŸ¥çœ‹å¸®åŠ©ã€‚</p><h3 id="ä¾èµ–"><a href="#ä¾èµ–" class="headerlink" title="ä¾èµ–"></a>ä¾èµ–</h3><p>çœ‹ pipenv é…ç½®</p><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><h3 id="key"><a href="#key" class="headerlink" title="key"></a>key</h3><p>åœ¨æ‰§è¡Œå‰ç›´æ¥é…ç½®ï¼šç¨‹åºè‡ªåŠ¨è·å–ï¼ˆç¯å¢ƒå˜é‡ã€æ–‡ä»¶ã€ä»£ç ä¸­ï¼‰ï¼›å¦‚æœè·å–å¤±è´¥åˆ™æç¤ºé…ç½®ï¼Œè®¾ç½® key æˆåŠŸï¼Œä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œä¸‹ä¸€æ¬¡æ‰§è¡Œæ—¶ï¼Œç›´æ¥åœ¨æ–‡ä»¶ä¸­ç›´æ¥è¯»å–ï¼›</p><h3 id="å‹ç¼©å¤„ç†"><a href="#å‹ç¼©å¤„ç†" class="headerlink" title="å‹ç¼©å¤„ç†"></a>å‹ç¼©å¤„ç†</h3><ol><li>å¦‚æœæ²¡æœ‰ç»™å‡ºå‚æ•°ï¼Œåˆ™é€’å½’å‹ç¼©å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œå¹¶ä¿å­˜åˆ°<code>tiny</code>ç›®å½•ï¼›</li><li>å¦‚æœç»™å‡ºå‚æ•°å¹¶ä¸”æ˜¯æ–‡ä»¶ï¼Œåˆ™å‹ç¼©å•ä¸ªæ–‡ä»¶<ol><li>å¦‚æœæ²¡æœ‰é¢å¤–å‚æ•°ï¼Œåˆ™å‹ç¼©è¯¥æ–‡ä»¶å¹¶ä¿å­˜åˆ° tiny ç›®å½•ï¼›</li><li>å¦‚æœç»™å‡ºçš„é¢å¤–å‚æ•°æ˜¯ -d xxxï¼Œåˆ™ä¿å­˜åˆ°ç”¨æˆ·æŒ‡å®šçš„ç›®å½•ï¼ˆç›®å½•å¯ä»¥æ˜¯ç›¸å¯¹ï¼Œä¹Ÿå¯ä»¥æ˜¯ç»å¯¹è·¯å¾„ï¼‰ï¼›</li><li>å¦‚æœç»™å‡ºçš„å‚æ•°æ˜¯ -f  xxxï¼Œå¦‚æœä¸ºç©ºï¼Œåˆ™å‹ç¼©æˆåŒå+â€™_tinifiedâ€™ï¼›å¦‚æœä¸ä¸ºç©ºä¸”æœ‰åç¼€ï¼Œåˆ™éªŒè¯åç¼€ç›¸åŒå†å‹ç¼©ï¼Œå¦åˆ™ raiseï¼›å¦‚æœæ²¡æœ‰åç¼€ï¼Œåˆ™åˆ¤æ–­æ˜¯å¦åŒåï¼Œä¸åŒååˆ™å‹ç¼©ä¹‹åå‘½åæ–°åç§°æ–‡ä»¶ï¼Œå¦åˆ™è¦†ç›–æç¤ºï¼›</li></ol></li><li>å¦‚æœç»™å‡ºå‚æ•°[æºç›®å½• ç›®çš„ç›®å½•]ï¼Œåˆ™å°†æ–‡ä»¶ä¿å­˜åˆ°æŒ‡å®šç›®å½•ï¼›</li></ol><h2 id="å‚æ•°"><a href="#å‚æ•°" class="headerlink" title="å‚æ•°"></a>å‚æ•°</h2><ul><li>ä¸å¸¦å‚æ•°<br>  é€’å½’å‹ç¼©å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰å›¾ç‰‡ï¼Œå¹¶ä¿å­˜åˆ° tiny ç›®å½•ï¼›  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python shrink_img.py</span><br></pre></td></tr></table></figure></li><li><p><code>--key/-k</code><br>ä»å®˜ç½‘ç”³è¯·çš„ <code>key</code>ï¼Œæä¾›ä¸‰ç§æ–¹å¼å¯¼å…¥ä½¿ç”¨ï¼š</p><ol><li>ä»£ç ä¸­ç›´æ¥å¡«å……ï¼›</li><li>æ‰§è¡Œå‰ï¼Œå‘½ä»¤è¡Œå¯¼å…¥ç¯å¢ƒå˜é‡ï¼›<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> TINY_KEY=<span class="string">&#x27;&#123;&#123;YOU GET FROM tinypng.com &#125;&#125;&#x27;</span></span><br></pre></td></tr></table></figure></li><li>å†™è¿›é…ç½®æ–‡ä»¶<code>tiny.key</code>ï¼›<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;&#123;&#123;YOU GET FROM tinypng.com &#125;&#125;&#x27;</span> &gt; tiny.key</span><br></pre></td></tr></table></figure></li><li>æ‰§è¡Œæ—¶ï¼Œæ­é…<code>--key</code>æŒ‡å®šï¼›å¦‚æœæ²¡æœ‰ç»™å‡ºï¼Œåˆ™è¦æ±‚ç”¨æˆ·è¾“å…¥ï¼›</li></ol></li><li><p><code>--file/-f</code><br>  æŒ‡å®šå›¾ç‰‡åç§°ï¼Œå¿…é¡»åŒ…å«æ–‡ä»¶å…¨åï¼ˆå³åŒ…å«åç¼€åï¼‰ã€‚å¦‚æœä¸å¸¦é¢å¤–å‚æ•°ï¼Œåˆ™è¡¨ç¤ºä¿å­˜åˆ°å½“å‰ç›®å½•ä¸‹ï¼›å¦åˆ™ï¼Œä¸ºç”¨æˆ·æŒ‡å®šç›®å½•ä¸‹æ–‡ä»¶ã€‚<br>  æ­é…ä»¥ä¸‹æŒ‡ä»¤ä½¿ç”¨ï¼š</p><ul><li><p><code>--fcover/-c</code><br>  ä»¥è¦†ç›–å½¢å¼å‹ç¼©ï¼Œå³ç›´æ¥å°†å‹ç¼©åæ–‡ä»¶ä¿å­˜ä¸ºè¢«å‹ç¼©æ–‡ä»¶çš„ä½ç½®ï¼ˆä¸”åŒåï¼‰ï¼›</p></li><li><p><code>--save/-s</code><br>  å¯é€‰å‚æ•°ï¼Œç¼ºçœæ—¶ä¸º<strong>å½“å‰æ‰§è¡Œç›®å½•</strong>ä¸‹çš„<code>tiny</code>ç›®å½•ï¼›ç»™å®šå‚æ•°æ—¶ï¼Œä¸ºæŒ‡å®šä¿å­˜çš„ç›®å½•ï¼›</p></li></ul></li><li><p><code>--dir/-d</code><br>  æŒ‡å®šå‹ç¼©çš„ç›®å½•ã€‚ç¼ºçœæ—¶ä¸º<strong>å½“å‰æ‰§è¡Œç›®å½•</strong>ä¸‹çš„<code>tiny</code>ç›®å½•ï¼Œå¯é€‰æŒ‡å®šç›®å½•åç§°ï¼›</p><p>  å¯é€‰æ­é…ä»¥ä¸‹å‚æ•°ä½¿ç”¨:</p><ul><li><code>--recurse|--not-recurse/-r|-nr</code><br>  é€’å½’å¼å‹ç¼©æŒ‡å®šç›®å½•ã€‚å¦‚æœä½¿ç”¨<code>--recurse/-r</code>åˆ™é€’å½’å‹ç¼©æŒ‡å®šç›®å½•ä¸‹æ‰€æœ‰å±‚çº§ä¸‹çš„å›¾ç‰‡æ–‡ä»¶ï¼›å¦‚æœä½¿ç”¨<code>--not-recurse/-nr</code>è¡¨ç¤ºåªå‹ç¼©è¯¥å±‚çº§ç›®å½•ï¼›</li><li><code>--save/-s</code><br>  å¯é€‰å‚æ•°ï¼Œå¯ä»¥é€‰æ‹©æ­é…<code>--recurse</code>ä½¿ç”¨ã€‚ç¼ºçœæ—¶ä¸º<strong>å½“å‰æ‰§è¡Œç›®å½•</strong>ä¸‹çš„<code>tiny</code>ç›®å½•ï¼ˆå³å’Œé»˜è®¤ä¸æŒ‡å®šç›®å½•åç§°æ•ˆæœç›¸åŒï¼‰ï¼›ç»™å®šå‚æ•°æ—¶ï¼Œä¸ºæŒ‡å®šä¿å­˜çš„ç›®å½•ï¼›</li></ul></li><li><p>resize<br>åªæ”¯æŒå•æ–‡ä»¶ resize,æ ¹æ®å®˜ç½‘ APIï¼Œç›®å‰æ”¯æŒ<code>--scale/--fit/--cover/--thumb</code>å‚æ•°ï¼ŒæŒ‡å®šè¯¥å‚æ•°ä¸­çš„å…¶ä¸€æ—¶ï¼Œè¡¨ç¤º resize çš„æ–‡ä»¶åç§°ï¼Œåé¢è·Ÿ<em>file name å’Œ width å’Œ/æˆ– height</em>ï¼›</p></li></ul><ol><li>å…¶ä¸­æŒ‡å®šä¸º<code>--scale</code>æ—¶ï¼Œ<strong>å¿…é¡»</strong>â€“width æˆ–è€…â€“heightï¼›<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">--scale FILENAME --width INT</span><br><span class="line">--scale FILENAME --height INT</span><br></pre></td></tr></table></figure></li><li>å…¶ä½™å‚æ•°æ—¶ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ–‡ä»¶åï¼Œå‰©ä½™ä¸¤ä¸ªå‚æ•°<strong>ä¾æ¬¡</strong>ä¸º<em>width å’Œ height</em>ï¼Œä¸éœ€è¦æ˜¾å¼æŒ‡å®š<code>--width</code>å’Œ<code>--height</code>ï¼›<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">--[fit,cover,thumb] FILENAME INT INT</span><br></pre></td></tr></table></figure><h2 id="æŠ¥é”™è®°å½•"><a href="#æŠ¥é”™è®°å½•" class="headerlink" title="æŠ¥é”™è®°å½•"></a>æŠ¥é”™è®°å½•</h2></li></ol><ul><li><p>TypeError: It would appear that nargs is set to conflict with the composite type arity.</p><p>  å‚è€ƒ <a href="https://stackoverflow.com/questions/40794429/typeerror-it-would-appear-that-nargs-is-set-to-conflict-with-the-composite-type">here</a>å’Œ <a href="https://github.com/pallets/click/issues/472">github issue</a>  </p><blockquote><p>Click does not have a way currently to define default values for nargs &gt; 1 when different types are used. A workaround is to set default=(None, None) for instance.</p></blockquote><p>  ä¹Ÿå°±æ˜¯è¯´ä½ å¿…é¡»ç»™ tuple ä¸€ä¸ªé»˜è®¤å€¼ä¸º None çš„ç­‰é•¿å…ƒç¥–ï¼›</p>  <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> click</span><br><span class="line"><span class="meta">@click.option(<span class="params"><span class="string">&#x27;--baz&#x27;</span>, <span class="string">&#x27;-b&#x27;</span>,</span></span></span><br><span class="line"><span class="meta"><span class="params">              default=[<span class="literal">None</span>] * <span class="number">6</span>,</span></span></span><br><span class="line"><span class="meta"><span class="params">              <span class="built_in">type</span>=click.Tuple(<span class="params">[<span class="built_in">str</span>, <span class="built_in">str</span>, <span class="built_in">str</span>, <span class="built_in">str</span>, <span class="built_in">str</span>, <span class="built_in">str</span>]</span>),<span class="built_in">help</span>=<span class="string">&#x27;bar&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span>(<span class="params">baz</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><h2 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h2></li><li style="list-style: none"><input type="checkbox"></input> ç»„è£…ä¿¡æ¯å¹¶è¿”å›ç»™ç”¨æˆ·å±•ç¤ºå‡ºæ¥ï¼›<br>  åº”åŒ…å«æ“ä½œç±»å‹ï¼ˆfile/dirï¼‰ï¼Œæºä¸ç›®çš„æ–‡ä»¶ï¼Œkey ä½¿ç”¨æ¬¡æ•°ç­‰ï¼›</li><li style="list-style: none"><input type="checkbox"></input> é€’å½’å‹ç¼©ç›®å½•ä¸‹æ–‡ä»¶å¥½åƒæœ‰é—®é¢˜ï¼›</li><li style="list-style: none"><input type="checkbox"></input> ä¸è¦å†™æ–‡ä»¶ï¼Œè€Œæ˜¯ä½¿ç”¨ ini/conf é…ç½®ï¼›</li><li style="list-style: none"><input type="checkbox"></input> resize æ²¡æœ‰æµ‹è¯•ï¼›</li><li style="list-style: none"><input type="checkbox"></input> åªè¾“å…¥ key æ—¶åº”è¯¥æ˜¯åªè®¾ç½® key æ“ä½œï¼Œå®Œæˆç›´æ¥ click.Abort()ï¼Œåªæœ‰æ­é…-kï¼Œ-f ä½¿ç”¨ï¼Œæ‰æ˜¯æ›´æ–° key æ“ä½œï¼›</li></ul><p>æºç ä¸­çš„ click ä½¿ç”¨ Google å¼€æºåº“ <a href="https://github.com/google/python-fire">Python Fire</a></p><h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><ul><li><a href="https://click-docs-zh-cn.readthedocs.io/zh/latest/">æ¬¢è¿æŸ¥é˜… Click ä¸­æ–‡æ–‡æ¡£ â€” click</a></li></ul><h2 id="æ›´å¤š"><a href="#æ›´å¤š" class="headerlink" title="æ›´å¤š"></a>æ›´å¤š</h2><ul><li><a href="https://www.zhihu.com/question/19779256">å›¾ç‰‡æ— æŸå‹ç¼©å·¥å…·éƒ½æœ‰å“ªäº›ï¼Ÿ - çŸ¥ä¹</a></li></ul><hr><blockquote><p>æ˜ç™½äº‹ç†çš„äººä½¿è‡ªå·±é€‚åº”ä¸–ç•Œï¼›ä¸æ˜äº‹ç†çš„äººæƒ³ä½¿ä¸–ç•Œé€‚åº”è‡ªå·±ã€‚æ‰€ä»¥ï¼Œæ‰€æœ‰è¿›æ­¥éƒ½è¦é ä¸æ˜äº‹ç†çš„äººã€‚</p><footer><strong>è§ä¼¯çº³</strong></footer></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> å‹ç¼©å›¾ç‰‡ </tag>
            
            <tag> TODO </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨ pip è£…åŒ…æ—¶æç¤º&#39;[Errno 101] Network is unreachable&#39;</title>
      <link href="blog/2020-01-12/pip-install-error-Failed-to-establish-a-new-connection-Network-is-unreachable/"/>
      <url>blog/2020-01-12/pip-install-error-Failed-to-establish-a-new-connection-Network-is-unreachable/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h2 id="ç¼˜èµ·"><a href="#ç¼˜èµ·" class="headerlink" title="ç¼˜èµ·"></a>ç¼˜èµ·</h2><p>ä»Šå¤©å†™ä»£ç å®‰è£…ä¾èµ–çš„æ—¶å€™ï¼Œæ‰§è¡Œ<code>pipenv install &#123;SOMETHING&#125;</code>æ—¶æŠ¥é”™ï¼š<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">(PyTinyPng) [root@172 PyTinyPng]# pipenv install tinify</span><br><span class="line">Installing tinifyâ€¦</span><br><span class="line">âœ” Installation Succeeded </span><br><span class="line">Pipfile.lock not found, creatingâ€¦</span><br><span class="line">Locking [dev-packages] dependenciesâ€¦</span><br><span class="line">Locking [packages] dependenciesâ€¦</span><br><span class="line">âœ˜ Locking Failed! </span><br><span class="line">#â€¦â€¦</span><br><span class="line">[pipenv.exceptions.ResolutionFailure]:       No versions found</span><br><span class="line">[pipenv.exceptions.ResolutionFailure]: Warning: Your dependencies could not be resolved. You likely have a mismatch in your sub-dependencies.</span><br><span class="line">  First try clearing your dependency cache with $ pipenv lock --clear, then try the original command again.</span><br><span class="line"> Alternatively, you can use $ pipenv install --skip-lock to bypass this mechanism, then run $ pipenv graph to inspect the situation.</span><br><span class="line">  Hint: try $ pipenv lock --pre if it is a pre-release dependency.</span><br><span class="line">ERROR: ERROR: Could not find a version that matches tinify</span><br><span class="line">No versions found</span><br><span class="line">Was https:&#x2F;&#x2F;pypi.org&#x2F;simple reachable?</span><br><span class="line"></span><br></pre></td></tr></table></figure></p><h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><p>ç»™ pip æ¢æ¸…åæº<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd ~</span><br><span class="line">mkdir .pip/pip.conf</span><br><span class="line">vi .pip/pip.conf</span><br><span class="line"><span class="meta">#</span><span class="bash">å†™å…¥æ–°åœ°å€</span></span><br><span class="line">[global]</span><br><span class="line">index-url = https://pypi.tuna.tsinghua.edu.cn/simple</span><br></pre></td></tr></table></figure><br>å¤–éƒ¨æ‰§è¡Œæµ‹è¯•å®‰è£…ï¼Œå¯ä»¥æ­£å¸¸å®‰è£…ï¼Œè¿›å…¥ pipenv ä¹‹åè¿˜æ˜¯æŠ¥é”™ï¼Œä¿®æ”¹ Pipfile<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">(PyTinyPng) [root@172 PyTinyPng]# find &#x2F; -name Pipfile</span><br><span class="line">&#x2F;root&#x2F;iyblog&#x2F;Pipfile</span><br><span class="line">&#x2F;root&#x2F;Flog&#x2F;Pipfile</span><br><span class="line">&#x2F;root&#x2F;PyTinyPng&#x2F;Pipfile</span><br></pre></td></tr></table></figure><br>ä¿®æ”¹å¯¹åº”é¡¹ç›®çš„ Pipfileï¼Œæ¢æˆæ¸…åæºæˆ–è€…é˜¿é‡Œæºï¼Œä¹‹åæ‰§è¡Œ<code>pipenv install &#123;SOMETHING&#125;</code>å³å¯ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ç½‘ç»œåŸå› å¯¼è‡´ pypi æºä¸å¯è¾¾ï¼Œä¿®æ”¹ pip.conf å¯ä»¥ä½¿ pip æ­£å¸¸ä½¿ç”¨ï¼Œä½†æ˜¯ pipenv æœ‰è‡ªå·±çš„é…ç½®æ–‡ä»¶ï¼Œä¸ä¼šè·Ÿç€ä¿®æ”¹ï¼Œå³ä½¿æŠŠè™šæ‹Ÿç¯å¢ƒåˆ äº†ï¼ˆ<code>pipenv --rm</code>ï¼‰ï¼ŒPipenv ä¹Ÿä¸ä¼šåˆ é™¤ï¼ˆæˆ‘æµ‹è¯•çš„æ—¶å€™æ˜¯è¿™æ ·ï¼‰ã€‚æ‰€ä»¥éœ€è¦é‡æ–°ç”Ÿæˆè¯¥æ–‡ä»¶æˆ–è€…ç›´æ¥ä¿®æ”¹æ–‡ä»¶ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> pip </tag>
            
            <tag> pipenv </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ğŸPyTricks | Python ä¸­å¦‚ä½•å®ç°åˆ—è¡¨çš„è¡Œåˆ—äº’è½¬ï¼Ÿ</title>
      <link href="blog/2020-01-10/how-to-transpose-row-and-column-in-Python/"/>
      <url>blog/2020-01-10/how-to-transpose-row-and-column-in-Python/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h2 id="ç¬¨æ–¹æ³•"><a href="#ç¬¨æ–¹æ³•" class="headerlink" title="ç¬¨æ–¹æ³•"></a>ç¬¨æ–¹æ³•</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">make_row_to_column</span>(<span class="params">a</span>):</span></span><br><span class="line">    b = []</span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a[<span class="number">0</span>])):</span><br><span class="line">        r = []</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">            r.append(a[j][item])</span><br><span class="line">        b.append(r)</span><br><span class="line">    <span class="keyword">return</span> b</span><br></pre></td></tr></table></figure><h2 id="ğŸPyTricks"><a href="#ğŸPyTricks" class="headerlink" title="ğŸPyTricks"></a>ğŸPyTricks</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">row_2_column</span>(<span class="params">row_list</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">map</span>(<span class="built_in">list</span>,<span class="built_in">zip</span>(*row_list))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    nest_list = [[_ <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)] </span><br><span class="line">    print(row_2_column(nest_list)) </span><br><span class="line">    <span class="comment"># [[0, 0, 0, 0], [1, 1, 1, 1], [2, 2, 2, 2], [3, 3, 3, 3], [4, 4, 4, 4]]</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„åœ¨<code>Python3</code>ä¸­è¿”å›çš„æ˜¯ä¸€ä¸ª<code>&lt;map object at 0x000002674CC62688&gt;</code>ï¼Œéœ€è¦å†ç”¨<code>list()</code> æ–¹æ³•è½¬ä¸€ä¸‹ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://www.zhihu.com/question/39660985">å¦‚ä½•ç”¨ python å®ç°è¡Œåˆ—äº’æ¢ï¼Ÿ - çŸ¥ä¹</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> ğŸPyTricks </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> ğŸPyTricks </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git merge/rebase/squash çš„åŒºåˆ«</title>
      <link href="blog/2020-01-08/diff-about-merge-rebase-sqush-of-Git/"/>
      <url>blog/2020-01-08/diff-about-merge-rebase-sqush-of-Git/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h3 id="git-merge"><a href="#git-merge" class="headerlink" title="git merge"></a>git merge</h3><p>å¦‚æœ A åŒå­¦é€‰æ‹©ç”¨ git merge çš„æ–¹å¼è¿›è¡Œåˆå¹¶ dev åˆ° master åˆ†æ”¯ï¼Œé‚£ä¹ˆ git ä¼šè¿™ä¹ˆåšï¼š</p><ol><li>æ‰¾å‡º dev åˆ†æ”¯å’Œ master åˆ†æ”¯çš„æœ€è¿‘å…±åŒç¥–å…ˆ commit ç‚¹ï¼›</li><li>å°† dev æœ€æ–°ä¸€æ¬¡ commit å’Œ master æœ€æ–°ä¸€æ¬¡ commit åˆå¹¶åç”Ÿæˆä¸€ä¸ªæ–°çš„ commitï¼Œæœ‰å†²çªçš„è¯éœ€è¦è§£å†³å†²çªï¼›</li><li>å°†ä»¥ä¸Šä¸¤ä¸ªåˆ†æ”¯ dev å’Œ master ä¸Šçš„æ‰€æœ‰æäº¤ç‚¹æŒ‰ç…§æäº¤æ—¶é—´çš„å…ˆåé¡ºåºè¿›è¡Œä¾æ¬¡æ”¾åˆ° master åˆ†æ”¯ä¸Šï¼›</li></ol><h3 id="git-rebase-åå†-git-merge"><a href="#git-rebase-åå†-git-merge" class="headerlink" title="git rebase åå† git merge"></a>git rebase åå† git merge</h3><ol><li>rebase ä¹‹å‰éœ€è¦ç» master åˆ†æ”¯æ‹‰åˆ°æœ€æ–°ï¼›<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git checkout master</span><br><span class="line">git pull</span><br></pre></td></tr></table></figure></li><li>åˆ‡æ¢åˆ†æ”¯åˆ°éœ€è¦ rebase çš„åˆ†æ”¯ï¼Œå‡å®šæ˜¯ dev åˆ†æ”¯ï¼›<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git checkout dev</span><br></pre></td></tr></table></figure></li><li><p>å˜åŸºï¼Œæ‰§è¡Œ <code>git rebase -i master</code>ï¼Œæœ‰å†²çªå°±è§£å†³å†²çªï¼Œè§£å†³åç›´æ¥ <code>git add</code> ï¼Œå† é€æ­¥<code>git rebase --continue</code> ï¼›<br>æ³¨æ„ï¼Œè¿™é‡Œçš„å˜åŸºå…¶å®å°±æ˜¯æ‰¾åˆ°ä¸¤ä¸ªåˆ†æ”¯å…±åŒçš„ç¥–å…ˆï¼Œç„¶ååœ¨å½“å‰åˆ†æ”¯ä¸Šåˆå¹¶ä»å…±åŒç¥–å…ˆåˆ°ç°åœ¨çš„æ‰€æœ‰ commitï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ç¬¬äºŒæ­¥çš„æ—¶å€™ä¼šé€‰æ‹©æ€ä¹ˆå¤„ç†è¿™äº› commitï¼Œç„¶åæˆ‘ä»¬å°±å¾—åˆ°äº†ä¸€ä¸ªä»å…¬å…± commit åˆ°ç°åœ¨çš„å•ä¸ª commitï¼Œå°† commit åˆå¹¶åˆ° master ä¹Ÿåªä¼šåœ¨ master ä¸Šç•™ä¸‹ä¸€ä¸ª commit è®°å½•ï¼Œè€Œåœ¨ dev åˆ†æ”¯ä¸Šçš„å¼€å‘è€…çš„æ“ä½œå·²ç»è¢«åˆå¹¶æ”¹å†™äº†ï¼›</p></li><li><p>åˆ‡æ¢åˆ° master åˆ†æ”¯ï¼Œæ‰§è¡Œ <code>git merge dev</code>ï¼›</p></li></ol><h3 id="squash-merge"><a href="#squash-merge" class="headerlink" title="squash merge"></a>squash merge</h3><p>åœ¨ä½¿ç”¨ git çš„è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä½ é‡åˆ°è¿‡æƒ³è¦åˆå¹¶å¤šä¸ª commit ä¸ºä¸€ä¸ªï¼Œç„¶åå¾ˆå¤šäººä¼šå‘Šè¯‰ä½ ç”¨ <code>git commit --amend</code>ï¼Œç„¶åä½ å‘ç°é‡Œé¢æœ‰ä½ çš„å¤šä¸ª commit å†å²ï¼Œä½ å¯ä»¥é€šè¿‡ pick é€‰æ‹©ï¼Œsquash åˆå¹¶ç­‰ç­‰ã€‚åŒæ ·çš„ï¼Œmerge çš„æ—¶å€™ä¹Ÿå¯ä»¥è¿™ä¹ˆå¹²ï¼Œä½ åªéœ€è¦è¿™ä¹ˆç®€å•çš„ä¸¤æ­¥ï¼š</p><ol><li>åˆ‡æ¢åˆ°ç›®æ ‡åˆ†æ”¯ï¼š<code>git checkout master</code></li><li>ä»¥ squash çš„å½¢å¼ mergeï¼š<code>git merge --squash devel</code><br>ä½ ä¼šå‘ç°ï¼Œåœ¨ master åˆ†æ”¯ä¸Šå±…ç„¶æœ‰æœªæäº¤çš„ä¿®æ”¹ï¼Œç„¶åä½ å°±éœ€è¦åœ¨ master ä¸Šä¸»åŠ¨æäº¤äº†ä¿®æ”¹ï¼Œæ³¨æ„ï¼Œè¿™é‡Œæ˜¯ master ä¸Šçš„ä½  commit çš„ï¼Œä¹Ÿå°±æ˜¯æ”¹å˜äº† commit çš„ authorã€‚</li></ol><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>git merge æ“ä½œåˆå¹¶åˆ†æ”¯ä¼šè®©ä¸¤ä¸ªåˆ†æ”¯çš„æ¯ä¸€æ¬¡æäº¤éƒ½æŒ‰ç…§æäº¤æ—¶é—´ï¼ˆå¹¶ä¸æ˜¯ push æ—¶é—´ï¼‰æ’åºï¼Œå¹¶ä¸”ä¼šå°†ä¸¤ä¸ªåˆ†æ”¯çš„æœ€æ–°ä¸€æ¬¡ commit ç‚¹è¿›è¡Œåˆå¹¶æˆä¸€ä¸ªæ–°çš„ commitï¼Œæœ€ç»ˆçš„åˆ†æ”¯æ ‘å‘ˆç°éæ•´æ¡çº¿æ€§ç›´çº¿çš„å½¢å¼ï¼›</p><p>git rebase æ“ä½œå®é™…ä¸Šæ˜¯å°†å½“å‰æ‰§è¡Œ rebase åˆ†æ”¯çš„æ‰€æœ‰åŸºäºåŸåˆ†æ”¯æäº¤ç‚¹ä¹‹åçš„ commit æ‰“æ•£æˆä¸€ä¸ªä¸€ä¸ªçš„ patchï¼Œå¹¶é‡æ–°ç”Ÿæˆä¸€ä¸ªæ–°çš„ commit hash å€¼ï¼Œå†æ¬¡åŸºäºåŸåˆ†æ”¯ç›®å‰æœ€æ–°çš„ commit ç‚¹ä¸Šè¿›è¡Œæäº¤ï¼Œå¹¶ä¸æ ¹æ®ä¸¤ä¸ªåˆ†æ”¯ä¸Šå®é™…çš„æ¯æ¬¡æäº¤çš„æ—¶é—´ç‚¹æ’åºï¼Œrebase å®Œæˆåï¼Œåˆ‡åˆ°åŸºåˆ†æ”¯è¿›è¡Œåˆå¹¶å¦ä¸€ä¸ªåˆ†æ”¯æ—¶ä¹Ÿä¸ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„ commit ç‚¹ï¼Œå¯ä»¥ä¿æŒæ•´ä¸ªåˆ†æ”¯æ ‘çš„å®Œç¾çº¿æ€§ï¼›</p><p>squash ä¹Ÿå¯ä»¥ä¿æŒ master åˆ†æ”¯å¹²å‡€ï¼Œä½†æ˜¯ master ä¸­ author éƒ½æ˜¯ç®¡ç†è€…ï¼ˆmaintainerï¼‰ï¼Œè€Œä¸æ˜¯åŸ ownerï¼Œä¹Ÿå°±æ˜¯æœ‰ç‚¹â€œçªƒå–åŠ³åŠ¨æœå®â€çš„å‘³é“ã€‚</p><p>å€¼å¾—ä¸€æçš„æ˜¯ï¼šå½“æˆ‘ä»¬å¼€å‘ä¸€ä¸ªåŠŸèƒ½æ—¶ï¼Œå¯èƒ½ä¼šåœ¨æœ¬åœ°æœ‰æ— æ•°æ¬¡ commitï¼Œè€Œä½ å®é™…ä¸Šåœ¨ä½ çš„ master åˆ†æ”¯ä¸Šåªæƒ³æ˜¾ç¤ºæ¯ä¸€ä¸ªåŠŸèƒ½æµ‹è¯•å®Œæˆåçš„ä¸€æ¬¡å®Œæ•´æäº¤è®°å½•å°±å¥½äº†ï¼Œå…¶ä»–çš„æäº¤è®°å½•å¹¶ä¸æƒ³å°†æ¥å…¨éƒ¨ä¿ç•™åœ¨ä½ çš„ master åˆ†æ”¯ä¸Šï¼Œé‚£ä¹ˆ rebase å°†ä¼šæ˜¯ä¸€ä¸ªå¥½çš„é€‰æ‹©ï¼Œä»–å¯ä»¥åœ¨ rebase æ—¶å°†æœ¬åœ°å¤šæ¬¡çš„ commit åˆå¹¶æˆä¸€ä¸ª commitï¼Œè¿˜å¯ä»¥ä¿®æ”¹ commit çš„æè¿°ç­‰ã€‚</p><p>ä¸»åˆ†æ”¯ä¸Šä¸èƒ½ rebaseã€‚å¦åˆ™ï¼Œä¸»åˆ†æ”¯çš„å†å²å°†è¢«ç¯¡æ”¹ï¼Œä¸èƒ½çœ‹åˆ°åŸå§‹çš„å†å²è®°å½•ã€‚</p><h2 id="å‚è€ƒé˜…è¯»"><a href="#å‚è€ƒé˜…è¯»" class="headerlink" title="å‚è€ƒé˜…è¯»"></a>å‚è€ƒé˜…è¯»</h2><ul><li><a href="https://www.jianshu.com/p/6960811ac89c">ä½ çœŸçš„æ‡‚ git rebase å—ï¼Ÿ - ç®€ä¹¦</a></li><li><a href="https://liqiang.io/post/difference-between-merge-squash-and-rebase/">merge squash å’Œ merge rebase åŒºåˆ«</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo ä¸»é¢˜ Butterfly è‡ªå®šä¹‰ä¹‹è·¯</title>
      <link href="blog/2020-01-06/customize-hexo-theme-Butterfly/"/>
      <url>blog/2020-01-06/customize-hexo-theme-Butterfly/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><p>æœ¬æ–‡ä¸»è¦é’ˆå¯¹ hexo-theme-butterfly ä¸»é¢˜è¿›è¡Œäº†ä¸ªæ€§åŒ–è‡ªå®šä¹‰ï¼Œå¹¶å¯¹ä¿®æ”¹å†…å®¹åšäº†ç®€å•ä»‹ç»ã€‚<br><a id="more"></a><br><div class="note no-icon modern"><p>åŸä½œè€…æ–‡æ¡£ğŸ‘‰ <a href="https://butterfly.js.org/">hexo-theme-butterfly å®‰è£…æ–‡æ¡£</a></p></div></p><h2 id="åŠ é€Ÿè®¿é—®"><a href="#åŠ é€Ÿè®¿é—®" class="headerlink" title="åŠ é€Ÿè®¿é—®"></a>åŠ é€Ÿè®¿é—®</h2><p>å¶ç„¶é—´çŸ¥é“ä¸€ä¸ªåŠ é€Ÿç½‘ç«™çš„æ–¹æ³•ï¼šä½¿ç”¨ <a href="https://vercel.com/">Vercel</a> åŠ é€Ÿè®¿é—®ï¼Œä¸çœ‹å¹¿å‘Šçœ‹ç–—æ•ˆğŸ‘‡<br><div class="justified-gallery"><p><img src= "/img/loading.svg" data-lazy-src="https://cdn.jsdelivr.net/gh/masantu/statics/images/VS-github.png" alt="å’Œ Github å¯¹æ¯”"><br><img src= "/img/loading.svg" data-lazy-src="https://cdn.jsdelivr.net/gh/masantu/statics/images/VS-gitee.png" alt="å’Œ Gitee å¯¹æ¯”"></p>          </div><br>æƒ³ä¸Šè½¦çš„çœ‹è¿™é‡Œï¼š</p><ol><li><a href="https://www.qtmuniao.com/2020/03/15/hexo-to-zeit-co/">ä½¿ç”¨ zeit.co æ‰˜ç®¡ Hexo é™æ€åšå®¢ | Muniaoâ€™s blog</a></li><li><a href="https://vincentqin.tech/posts/speedup-gitpage/">ğŸ”¨å·¥å…·ï¼šä½¿ç”¨ vercel åŠ é€Ÿ Hexo é™æ€åšå®¢è®¿é—® | RealCat</a></li><li><a href="https://editio.me/2020/vercel/">ä½¿ç”¨ Vercel è‡ªåŠ¨éƒ¨ç½²åšå®¢ç½‘ç«™ | Editioâ€™s Dream</a></li></ol><h2 id="å·²å®Œæˆ"><a href="#å·²å®Œæˆ" class="headerlink" title="å·²å®Œæˆ"></a>å·²å®Œæˆ</h2><h3 id="ç¾åŒ–"><a href="#ç¾åŒ–" class="headerlink" title="ç¾åŒ–"></a>ç¾åŒ–</h3><h4 id="svg-èƒŒæ™¯"><a href="#svg-èƒŒæ™¯" class="headerlink" title="svg èƒŒæ™¯"></a>svg èƒŒæ™¯</h4><p>ä½¿ç”¨ <a href="https://c.runoob.com/more/svgeditor/">SVG ç¼–è¾‘å™¨</a> ä¿®æ”¹</p><ul><li>footer èƒŒæ™¯<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">- var footer_img &#x3D;  theme.footer_bg.footer_img</span><br><span class="line">      - var footer_bg &#x3D; theme.footer_bg.enable &#x3D;&#x3D; false ? &#39;&#39; : &#96;background-image: url($&#123;footer_img&#125;)&#96;</span><br><span class="line">      - var is_bg &#x3D; theme.footer_bg.enable &#x3D;&#x3D; false ? &#39;color&#39; : &#39;photo&#39;</span><br></pre></td></tr></table></figure></li><li>å‹é“¾å¤´åƒ 404 é»˜è®¤å›¾</li><li>è¯„è®ºåŒºèƒŒæ™¯å›¾</li></ul><h4 id="page-èƒŒæ™¯å›¾"><a href="#page-èƒŒæ™¯å›¾" class="headerlink" title="page èƒŒæ™¯å›¾"></a>page èƒŒæ™¯å›¾</h4><p> åœ¨åŸä½œè€…çš„åŸºç¡€ä¸Šæ·»åŠ äº†ä¿®æ”¹ books é¡µé¢ bg çš„ strictï¼Œä¸å¾—ä¸è¯´ä½œè€…çœŸçš„å¾ˆç»†å¿ƒã€‚<br> <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">if theme.douban_background.enable</span><br><span class="line">    if is_current(&#39;&#x2F;movies&#x2F;&#39;, [strict])</span><br><span class="line">      - var source &#x3D; theme.movie_background</span><br><span class="line">    if is_current(&#39;&#x2F;books&#x2F;&#39;, [strict])</span><br><span class="line">      - var source &#x3D; theme.book_background</span><br><span class="line">    if source</span><br><span class="line">      - var bg_img &#x3D; &#96;background-image: url($&#123;source&#125;)&#96;</span><br><span class="line">      #web_bg(data-type&#x3D;&#39;photo&#39; style&#x3D;bg_img)</span><br></pre></td></tr></table></figure></p><h4 id="ç½‘ç«™-logo"><a href="#ç½‘ç«™-logo" class="headerlink" title="ç½‘ç«™ logo"></a>ç½‘ç«™ logo</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">  &#x2F;&#x2F;æ›´æ¢æ–‡å­—ä¸ºlogoå›¾ç‰‡</span><br><span class="line">&#x2F;&#x2F;a#site-name.blog_title(href&#x3D;url_for(&#39;&#x2F;&#39;)) #[&#x3D;config.title]</span><br><span class="line">a#site-name.blog_title(href&#x3D;url_for(&#39;&#x2F;&#39;))</span><br><span class="line">  - var site_logo &#x3D; theme.site_logo</span><br><span class="line">  - var site_patch &#x3D; &#96;background: url($&#123;site_logo&#125;)&#96;</span><br><span class="line">  span.site-logo(style&#x3D;site_patch)</span><br></pre></td></tr></table></figure><figure class="highlight styl"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ç½‘ç«™æ¢ä¸ºå›¾ç‰‡ä¹‹ååŠ æ ·å¼</span></span><br><span class="line">    .site-logo</span><br><span class="line">      <span class="attribute">display</span>: inline-block;</span><br><span class="line">      <span class="attribute">vertical-align</span>: middle;</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">150px</span>;</span><br><span class="line">      <span class="attribute">height</span>: <span class="number">40px</span></span><br><span class="line">      <span class="attribute">background-size</span>: cover!important;</span><br></pre></td></tr></table></figure><h4 id="è¡¨æ ¼ç¾åŒ–"><a href="#è¡¨æ ¼ç¾åŒ–" class="headerlink" title="è¡¨æ ¼ç¾åŒ–"></a>è¡¨æ ¼ç¾åŒ–</h4><table><thead><tr><th style="text-align:center">å§“å</th><th style="text-align:left">å¹´é¾„</th><th style="text-align:right">æ€§åˆ«</th><th style="text-align:center">æ°‘æ—</th></tr></thead><tbody><tr><td style="text-align:center">å¼ ä¸‰ä¸°</td><td style="text-align:left">100</td><td style="text-align:right">ç”·</td><td style="text-align:center">æ±‰æ—</td></tr><tr><td style="text-align:center">å¼ ç¿ å±±</td><td style="text-align:left">35</td><td style="text-align:right">ç”·</td><td style="text-align:center">æ±‰æ—</td></tr><tr><td style="text-align:center">æ®·ç´ ç´ </td><td style="text-align:left">33</td><td style="text-align:right">å¥³</td><td style="text-align:center">æ±‰æ—</td></tr><tr><td style="text-align:center">å¼ æ— å¿Œ</td><td style="text-align:left">12</td><td style="text-align:right">ç”·</td><td style="text-align:center">æ±‰æ—</td></tr><tr><td style="text-align:center">èµµæ•</td><td style="text-align:left">12</td><td style="text-align:right">å¥³</td><td style="text-align:center">è’™å¤æ—</td></tr><tr><td style="text-align:center">å°æ˜­</td><td style="text-align:left">12</td><td style="text-align:right">å¥³</td><td style="text-align:center">æ³¢æ–¯äºº</td></tr></tbody></table><p>å‚è€ƒ <a href="https://hexo.imydl.tech/archives/6742.html">Hexo ä¸‹è¡¨æ ¼çš„ç¾åŒ–å’Œä¼˜åŒ–</a></p><h3 id="æ–°å¢"><a href="#æ–°å¢" class="headerlink" title="æ–°å¢"></a>æ–°å¢</h3><h4 id="æ ‡ç­¾å¤–æŒ‚"><a href="#æ ‡ç­¾å¤–æŒ‚" class="headerlink" title="æ ‡ç­¾å¤–æŒ‚"></a>æ ‡ç­¾å¤–æŒ‚</h4><ul><li style="list-style: none"><input type="checkbox" checked></input> <del>å‚è€ƒ<code>Next</code><a href="https://hexo-theme-next.netlify.com/docs/tag-plugins/">ä¸»é¢˜å¤–æŒ‚</a></del><br>å‚è§ <a href="https://vuejs.org/v2/cookbook/serverless-blog.html">æ­¤å¤„</a> note æŒ‚ä»¶ï¼›<br>å»ºè®®é˜…è¯» <a href="https://demo.jerryc.me/posts/2df239ce/">æ ‡ç­¾å¤–æŒ‚(Tag Plugins) | Butterfly</a><br><code>gallery</code>å·²ç»å®ç°éœ€æ±‚ï¼Œæ‰€ä»¥æ²¡æœ‰å¿…è¦å®ç°äº†ã€‚</li></ul><div class="justified-gallery"><p><img src= "/img/loading.svg" data-lazy-src="https://images.unsplash.com/photo-1578028076641-ef1d08387c14?ixlib=rb-1.2.1&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;auto=format&amp;fit=crop&amp;w=1350&amp;q=80" alt=""> </p><p><img src= "/img/loading.svg" data-lazy-src="https://images.unsplash.com/photo-1557244056-ac3033d17d9a?ixlib=rb-1.2.1&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;auto=format&amp;fit=crop&amp;w=634&amp;q=80" alt=""> </p><p><img src= "/img/loading.svg" data-lazy-src="https://i0.hippopx.com/photos/121/457/241/girls-the-scenery-wallpaper-7f97112750013868bc5bcc249f13e27d.jpg" alt=""> </p><p><img src= "/img/loading.svg" data-lazy-src="https://picjumbo.com/wp-content/uploads/iphone-free-stock-photos-2210x3315.jpg" alt=""><br><img src= "/img/loading.svg" data-lazy-src="https://images.unsplash.com/photo-1529245814698-dd66c442bfef?ixlib=rb-1.2.1&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;auto=format&amp;fit=crop&amp;w=1350&amp;q=80" alt=""> </p>          </div><h4 id="ç”¨æˆ·çŠ¶æ€"><a href="#ç”¨æˆ·çŠ¶æ€" class="headerlink" title="ç”¨æˆ·çŠ¶æ€"></a>ç”¨æˆ·çŠ¶æ€</h4><ul><li style="list-style: none"><input type="checkbox" checked></input> ç”¨æˆ·å¡ç‰‡é¡µæ˜¾ç¤ºä¸ªäººå·¥ä½œçŠ¶æ€ï¼ˆæ”¯æŒ fa å’Œ emoji ğŸ˜€ï¼‰<br>å¤´åƒ hover äº‹ä»¶ä¿®æ”¹<br>å‚è€ƒæ­¤å¤„å®ç°<a href="https://vwin.github.io/2018/08/02/Hexo-Next%E4%B8%BB%E9%A2%98%E5%A4%B4%E5%83%8F%E6%97%8B%E8%BD%AC/">å¤´åƒä¸ç¿»è½¬ï¼Œé¼ æ ‡ hover æ”¾å¤§</a><figure class="highlight styl"><table><tr><td class="code"><pre><span class="line">.card-info</span><br><span class="line">    img</span><br><span class="line">      <span class="attribute">display</span>: inline-block</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">110px</span></span><br><span class="line">      <span class="attribute">height</span>: <span class="number">110px</span></span><br><span class="line">      <span class="attribute">border-radius</span>: <span class="number">70px</span></span><br><span class="line">      <span class="attribute">vertical-align</span>: top</span><br><span class="line">      <span class="attribute">margin</span>: <span class="number">0</span> auto</span><br><span class="line">      webkit-<span class="attribute">transition</span>: <span class="number">1.4s</span> all</span><br><span class="line">      moz-<span class="attribute">transition</span>: <span class="number">1.4s</span> all</span><br><span class="line">      ms-<span class="attribute">transition</span>: <span class="number">1.4s</span> all</span><br><span class="line">      <span class="attribute">transition</span>: <span class="number">1.4s</span> all</span><br><span class="line"></span><br><span class="line">      &amp;:hover</span><br><span class="line">        <span class="attribute">background-color</span>: <span class="variable">$avatar</span>-bg</span><br><span class="line">        webkit-<span class="attribute">transform</span>: rotate(<span class="number">360deg</span>) scale(<span class="number">1.1</span>)</span><br><span class="line">        moz-<span class="attribute">transform</span>: rotate(<span class="number">360deg</span>) scale(<span class="number">1.1</span>)</span><br><span class="line">        ms-<span class="attribute">transform</span>: rotate(<span class="number">360deg</span>) scale(<span class="number">1.1</span>)</span><br><span class="line">        <span class="attribute">transform</span>: rotate(<span class="number">360deg</span>) scale(<span class="number">1.1</span>)</span><br></pre></td></tr></table></figure><h4 id="footer-é¡µé¢"><a href="#footer-é¡µé¢" class="headerlink" title="footer é¡µé¢"></a>footer é¡µé¢</h4></li><li style="list-style: none"><input type="checkbox" checked></input> æ·»åŠ  badge<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#&#x2F;Butterfly&#x2F;layout&#x2F;includes&#x2F;footer.pug</span><br></pre></td></tr></table></figure><h4 id="iframe-å®ç°-è±†ç“£ä¹¦å½±éŸ³-é¡µé¢"><a href="#iframe-å®ç°-è±†ç“£ä¹¦å½±éŸ³-é¡µé¢" class="headerlink" title="iframe å®ç° è±†ç“£ä¹¦å½±éŸ³ é¡µé¢"></a>iframe å®ç° <a href="/douban/">è±†ç“£ä¹¦å½±éŸ³</a> é¡µé¢</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--ç”¨æˆ·åæ›¿æ¢ä¸ºè‡ªå·±çš„è±†ç“£id--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;iframe&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">iframe</span> <span class="attr">height</span>=<span class="string">&quot;100%&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://m.douban.com/people/imoyao/subject_profile&quot;</span> <span class="attr">sandbox</span>=<span class="string">&quot;allow-forms allow-scripts allow-same-origin allow-popups&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="å®ç°-Netlify-CMS-ç®¡ç†"><a href="#å®ç°-Netlify-CMS-ç®¡ç†" class="headerlink" title="å®ç° Netlify CMS ç®¡ç†"></a>å®ç° Netlify CMS ç®¡ç†</h4>ä½¿ç”¨<a href="https://github.com/jiangtj/hexo-netlify-cms">Hexo Netlify CMS</a>å®ç°<br>å‚è€ƒ<a href="https://io-oi.me/tech/deploy-static-site-to-netlify/">å°† Hexo é™æ€åšå®¢éƒ¨ç½²åˆ° Netlify | reuixiy</a></li></ul><h4 id="åä¸ªæ§½"><a href="#åä¸ªæ§½" class="headerlink" title="åä¸ªæ§½"></a>åä¸ªæ§½</h4><ul><li style="list-style: none"><input type="checkbox" checked></input> ä¾§è¾¹æ æ·»åŠ åä¸ªæ§½ï¼Œç”¨æˆ·å¯ä»¥è¿›è¡Œåé¦ˆ</li></ul><h3 id="æ”¹è¿›"><a href="#æ”¹è¿›" class="headerlink" title="æ”¹è¿›"></a>æ”¹è¿›</h3><h4 id="æ–‡ç« é¡µ-sidebar-å›¾æ ‡"><a href="#æ–‡ç« é¡µ-sidebar-å›¾æ ‡" class="headerlink" title="æ–‡ç« é¡µ sidebar å›¾æ ‡"></a>æ–‡ç« é¡µ sidebar å›¾æ ‡</h4><ul><li style="list-style: none"><input type="checkbox" checked></input> æ›´æ¢å¦å¤–ä¸€ç§å›¾æ ‡ï¼ŒåŒæ—¶ hover å˜æˆæ˜¾çœ¼æŒ‰é’®</li></ul><h4 id="ä¸ªäººä¿¡æ¯"><a href="#ä¸ªäººä¿¡æ¯" class="headerlink" title="ä¸ªäººä¿¡æ¯"></a>ä¸ªäººä¿¡æ¯</h4><ul><li style="list-style: none"><input type="checkbox" checked></input> å›¾æ ‡æ˜¾ç¤ºé£æ ¼å·¦å³æ—‹è½¬è€Œä¸æ˜¯ä¸Šä¸‹é¢ å€’</li></ul><h4 id="èµèµ"><a href="#èµèµ" class="headerlink" title="èµèµ"></a>èµèµ</h4><p>é‰´äºå›½äººç°å®ç»æµçŠ¶å†µï¼Œåªæœ‰åœ¨<code>font-matter</code>ä¸­æ·»åŠ <code>reward: true</code>æ‰ä¼šæ‰“å¼€èµèµåŠŸèƒ½ï¼›<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; themes&#x2F;Butterfly&#x2F;layout&#x2F;post.pug</span><br><span class="line">if theme.reward.enable &amp;&amp; page.reward</span><br></pre></td></tr></table></figure></p><h4 id="page-é¡µä¾§è¾¹æ "><a href="#page-é¡µä¾§è¾¹æ " class="headerlink" title="page é¡µä¾§è¾¹æ "></a>page é¡µä¾§è¾¹æ </h4><ul><li style="list-style: none"><input type="checkbox" checked></input> ä¸è¦å±•ç¤ºåªçœ‹ä¸€æ¬¡å°±å¯ä»¥çš„ä¿¡æ¯ï¼ˆå¦‚ç½‘ç«™æ¦‚è§ˆï¼Œå…¬å‘Šç­‰ï¼‰</li><li style="list-style: none"><input type="checkbox" checked></input> åªåœ¨é¦–é¡µæ˜¾ç¤ºå…¬å‘Šå’Œç½‘ç«™æ¦‚è§ˆï¼›è·³åˆ°å¯¹åº”é¡µæ—¶ï¼Œä¾§è¾¹æ ä¸æ˜¾ç¤ºå¯¹åº” cardï¼ˆé¿å…ä¿¡æ¯é‡å¤ï¼‰ï¼›<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">layout&#x2F;includes&#x2F;widget&#x2F;index.pug</span><br></pre></td></tr></table></figure><h4 id="æ–‡ç« é¡µç»“æŸè¯­"><a href="#æ–‡ç« é¡µç»“æŸè¯­" class="headerlink" title="æ–‡ç« é¡µç»“æŸè¯­"></a>æ–‡ç« é¡µç»“æŸè¯­</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F;ç»“æŸè¯­åˆ†å‰²çº¿</span><br><span class="line">  .divider.divider-horizontal.divider-with-text-center(role&#x3D;&#39;separator&#39;)</span><br><span class="line">    span.divider-inner-text&#x3D;theme.divider_text</span><br></pre></td></tr></table></figure><h2 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h2></li></ul><h3 id="åŸä½œè€…åºŸå¼ƒ"><a href="#åŸä½œè€…åºŸå¼ƒ" class="headerlink" title="åŸä½œè€…åºŸå¼ƒ"></a>åŸä½œè€…åºŸå¼ƒ</h3><ul><li style="list-style: none"><input type="checkbox" checked></input> æ–‡ç«  front matter: hide æ”¯æŒ</li></ul><h3 id="æ–°å¢-1"><a href="#æ–°å¢-1" class="headerlink" title="æ–°å¢"></a>æ–°å¢</h3><h4 id="é¦–é¡µæ·»åŠ æè¿°å¡"><a href="#é¦–é¡µæ·»åŠ æè¿°å¡" class="headerlink" title="é¦–é¡µæ·»åŠ æè¿°å¡"></a>é¦–é¡µæ·»åŠ æè¿°å¡</h4><ul><li style="list-style: none"><input type="checkbox" checked></input> è‡ªè¿°é¡µé¢</li><li><del>music</del></li><li><del>video</del></li></ul><h4 id="æ·»åŠ -logos-é¡µé¢å­˜æ”¾ç½‘ç«™-logo-ç­‰ä¸ªäººä¿¡æ¯"><a href="#æ·»åŠ -logos-é¡µé¢å­˜æ”¾ç½‘ç«™-logo-ç­‰ä¸ªäººä¿¡æ¯" class="headerlink" title="æ·»åŠ  logos é¡µé¢å­˜æ”¾ç½‘ç«™ logo ç­‰ä¸ªäººä¿¡æ¯"></a>æ·»åŠ  logos é¡µé¢å­˜æ”¾ç½‘ç«™ logo ç­‰ä¸ªäººä¿¡æ¯</h4><p>å‚è€ƒ</p><ul><li><a href="https://ceph.io/logos/">Ceph Logos - Ceph</a></li><li><a href="https://www.python.org/community/logos/">The Python Logo | Python Software Foundation</a></li></ul><h4 id="page-é¡µ"><a href="#page-é¡µ" class="headerlink" title="page é¡µ"></a>page é¡µ</h4><ul><li style="list-style: none"><input type="checkbox" checked></input> å¢åŠ æ­£æ–‡ç»“æŸåˆ†å‰²çº¿ï¼Œå¯ä»¥è‡ªå®šä¹‰åˆ†å‰²çº¿æ–‡å­—å†…å®¹ï¼›</li><li style="list-style: none"><input type="checkbox" checked></input> ä¿®æ”¹ booksã€movies é¡µé¢çš„èƒŒæ™¯ï¼Œæ›´åŠ æ²‰æµ¸å¼ï¼›<br>  TODO:æš‚æ—¶é¡µé¢ id é‡å¤æœªè§£å†³</li></ul><h3 id="ä¾§è¾¹æ "><a href="#ä¾§è¾¹æ " class="headerlink" title="ä¾§è¾¹æ "></a>ä¾§è¾¹æ </h3><ul><li style="list-style: none"><input type="checkbox" checked></input> ç»™å‹é“¾é¡µé¢ä¸­çš„æœ‹å‹æ å¢åŠ é¦–é¡µå‹é“¾å¡ï¼›</li><li style="list-style: none"><input type="checkbox" checked></input> ä¾§è¾¹æ åªæ˜¾ç¤º 20 æ¡ tagï¼Œå‰©ä½™çš„è®¿é—® tag é¡µé¢æ‰èƒ½çœ‹åˆ°ï¼›</li><li style="list-style: none"><input type="checkbox" checked></input> <a href="/douban/">è±†ç“£å†å²</a>é¡µé¢ä¸æ˜¾ç¤ºä¾§è¾¹æ ï¼›<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">    &#x2F;&#x2F;douban é¡µé¢ç‰¹æ®Šå¤„ç†</span><br><span class="line">else if page.type &#x3D;&#x3D;&#x3D; &#39;douban&#39;</span><br><span class="line">  article#page.no-aside-page</span><br><span class="line">    .article-container!&#x3D; page.content</span><br></pre></td></tr></table></figure><h3 id="æ‘˜è¦"><a href="#æ‘˜è¦" class="headerlink" title="æ‘˜è¦"></a>æ‘˜è¦</h3></li><li style="list-style: none"><input type="checkbox" checked></input> ç›®å‰çš„æ‘˜è¦åŠŸèƒ½åº”è¯¥æ˜¯æˆ‘æ²¡æœ‰é…ç½®å¥½ï¼Œæ„Ÿè§‰æ²¡æœ‰ç”Ÿæ•ˆï¼›<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">- var specific_desc &#x3D; article.description || article.subtitle || article.excerpt</span><br><span class="line">     if specific_desc</span><br><span class="line">       .content!&#x3D; specific_desc</span><br><span class="line">     else if theme.auto_excerpt &amp;&amp; theme.auto_excerpt.enable</span><br><span class="line">       - const content &#x3D; strip_html(article.content)</span><br><span class="line">       - let expert &#x3D; content.substring(0, theme.auto_excerpt.length) </span><br><span class="line">       - content.length &gt; theme.auto_excerpt.length ? expert +&#x3D; &#39; ...&#39; : &#39;&#39;</span><br><span class="line">       .content!&#x3D; expert</span><br></pre></td></tr></table></figure><blockquote><p>å› ä¸ºä¸»é¢˜ UI çš„å…³ç³»ï¼Œä¸»é¡µæ–‡ç« èŠ‚é€‰åªæ”¯æŒè‡ªåŠ¨èŠ‚é€‰å’Œæ–‡ç« é¡µ descriptionã€‚ä¼˜å…ˆé€‰æ‹©è‡ªåŠ¨èŠ‚é€‰ã€‚<br>åœ¨ butterfly.yml é‡Œå¯ä»¥å¼€å¯ auto_excerpt çš„é€‰é¡¹ï¼Œä½ çš„æ–‡ç« å°†ä¼šåœ¨è‡ªåŠ¨æˆªå–éƒ¨åˆ†æ˜¾ç¤ºåœ¨ä¸»é¡µã€‚ï¼ˆé»˜è®¤æ˜¾ç¤º 150 ä¸ªå­—ï¼‰ã€‚</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">auto_excerpt: </span><br><span class="line">enable: true </span><br><span class="line">length: 150</span><br></pre></td></tr></table></figure></blockquote><h3 id="ç¼–è¾‘ç›´è¾¾"><a href="#ç¼–è¾‘ç›´è¾¾" class="headerlink" title="ç¼–è¾‘ç›´è¾¾"></a>ç¼–è¾‘ç›´è¾¾</h3></li><li style="list-style: none"><input type="checkbox"></input> é¦–é¡µå¢åŠ  <a href="https://imoyao.netlify.com/admin/#/">åå°ç®¡ç†</a> navbarï¼›</li><li style="list-style: none"><input type="checkbox"></input> æ–‡ç« é¡µæ·»åŠ ç¼–è¾‘æŒ‰é’®ï¼ˆï¼Ÿï¼‰ï¼›<br>  å‚è€ƒä¸»é¢˜ <a href="https://github.com/wzpan/hexo-theme-freemind">wzpan/hexo-theme-freemind: Most powerful bootstrap theme for hexo.</a> å®ç°</li></ul><h3 id="æš—è‰²æ¨¡å¼"><a href="#æš—è‰²æ¨¡å¼" class="headerlink" title="æš—è‰²æ¨¡å¼"></a>æš—è‰²æ¨¡å¼</h3><ul><li style="list-style: none"><input type="checkbox" checked></input> ä¸€äº›è‡ªå®šä¹‰æ ·å¼ä¿®æ”¹ï¼›</li></ul><h3 id="ç®€åŒ–éƒ¨ç½²"><a href="#ç®€åŒ–éƒ¨ç½²" class="headerlink" title="ç®€åŒ–éƒ¨ç½²"></a>ç®€åŒ–éƒ¨ç½²</h3><p>åœ¨ç«™ç‚¹é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹è¿œç¨‹éƒ¨ç½²ä»“åº“ä¿¡æ¯å¦‚ä¸‹ï¼š<br><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span></span><br><span class="line">    <span class="attr">github:</span> <span class="string">https://github.com/imoyao/imoyao.github.io.git</span></span><br><span class="line">    <span class="attr">gitee:</span> <span class="string">https://gitee.com/imoyao/imoyao.git</span></span><br></pre></td></tr></table></figure><br>å…¶ä¸­åœ°å€ä¿®æ”¹ä¸ºä½ çš„ä»“åº“çš„åœ°å€ã€‚å…·ä½“è¯´æ˜è§<a href="https://blog.csdn.net/tsvico/article/details/80629452">æ­¤å¤„</a>ï¼›åŒæ—¶è¿˜å¯ä»¥å°†ä»£ç æ¨é€åˆ°ä¸¤ä¸ªä»“åº“ä¸­ï¼Œå‚è€ƒ<a href="https://www.jianshu.com/p/747e2bb71775">æ­¤å¤„</a>ï¼š<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git remote set-url --add origin &#123;ä½ çš„ gitee é¡¹ç›®åœ°å€&#125;</span><br></pre></td></tr></table></figure><br>ï¼ˆå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥æ‰‹åŠ¨ç‚¹å‡» gitee ç½‘é¡µä¸Šçš„åŒæ­¥æŒ‰é’®å¼ºåˆ¶ä» github ä¸Šæ›´æ–°ï¼‰</p><h2 id="å…¶ä»–å·¥å…·"><a href="#å…¶ä»–å·¥å…·" class="headerlink" title="å…¶ä»–å·¥å…·"></a>å…¶ä»–å·¥å…·</h2><ul><li><a href="https://www.deadlinkchecker.com/website-dead-link-checker.asp">æ­»é“¾æ£€æµ‹</a></li></ul><h2 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="headerlink" title="æ¨èé˜…è¯»"></a>æ¨èé˜…è¯»</h2><p><a href="https://www.antmoe.com/posts/a811d614/index.html">Hexo åšå®¢ä¹‹ butterfly ä¸»é¢˜ä¼˜é›…é­”æ”¹ç³»åˆ—ï¼ˆæŒç»­æ›´æ–°ï¼‰ | å°åº·åšå®¢</a></p>]]></content>
      
      
      <categories>
          
          <category> åšå®¢ä¸ªæ€§åŒ– </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> Butterfly </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ğŸPyTricks | Python ä¸­å¦‚ä½•æŠŠä¸€ä¸ªåˆ—è¡¨åˆ‡åˆ†æˆæŒ‡å®šå¤§å°çš„å­åˆ—è¡¨</title>
      <link href="blog/2019-12-27/python-split-list-into-lists-by-particular-value/"/>
      <url>blog/2019-12-27/python-split-list-into-lists-by-particular-value/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h2 id="è‡ªå·±å†™çš„"><a href="#è‡ªå·±å†™çš„" class="headerlink" title="è‡ªå·±å†™çš„"></a>è‡ªå·±å†™çš„</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">split_list</span>(<span class="params">alist, split_len</span>):</span>   <span class="comment"># <span class="doctag">TODO:</span> æ˜¯å¦æœ‰æ”¹è¿›ä¹‹å¤„</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    æŒ‰ç…§æ¯4ä¸ªä¸€ç»„è¿›è¡Œåˆ’åˆ†</span></span><br><span class="line"><span class="string">    :param alist:</span></span><br><span class="line"><span class="string">    :param split_len:</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    b = []</span><br><span class="line">    start_split_index = <span class="number">0</span></span><br><span class="line">    length = <span class="built_in">int</span>(math.ceil(<span class="built_in">len</span>(alist) / <span class="built_in">float</span>(split_len)))</span><br><span class="line">    <span class="keyword">while</span> length &gt; <span class="number">0</span>:</span><br><span class="line">        a = []</span><br><span class="line">        end_index = start_split_index + split_len</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> alist[start_split_index:end_index]:</span><br><span class="line">            a.append(i)</span><br><span class="line"></span><br><span class="line">        start_split_index += split_len</span><br><span class="line"></span><br><span class="line">        length -= <span class="number">1</span></span><br><span class="line">        b.append(a)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> b</span><br></pre></td></tr></table></figure><h2 id="ç½‘ä¸Šçœ‹åˆ°çš„"><a href="#ç½‘ä¸Šçœ‹åˆ°çš„" class="headerlink" title="ç½‘ä¸Šçœ‹åˆ°çš„"></a>ç½‘ä¸Šçœ‹åˆ°çš„</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">list_of_groups</span>(<span class="params">init_list, children_list_len</span>):</span></span><br><span class="line">    list_of_group = <span class="built_in">zip</span>(*(<span class="built_in">iter</span>(init_list),) * children_list_len)</span><br><span class="line">    end_list = [<span class="built_in">list</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> list_of_group]</span><br><span class="line">    count = <span class="built_in">len</span>(init_list) % children_list_len</span><br><span class="line">    end_list.append(init_list[-count:]) <span class="keyword">if</span> count != <span class="number">0</span> <span class="keyword">else</span> end_list</span><br><span class="line">    <span class="keyword">return</span> end_list</span><br></pre></td></tr></table></figure><h2 id="CookBook"><a href="#CookBook" class="headerlink" title="CookBook"></a>CookBook</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">slice_list</span>(<span class="params">seq, size</span>):</span></span><br><span class="line">    <span class="keyword">return</span> [seq[i:i + size] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(seq), size)]</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">zip_iter</span>(<span class="params">seq, size</span>):</span> <span class="comment"># <span class="doctag">TODO:</span>æ²¡çœ‹æ‡‚ï¼Œè¿™ä¸ªæ–¹æ³•å½“ seq å¤ªå°æ—¶ï¼Œä¼šè¿”å›ç©ºï¼›e.g.zip_iter(list(range(2)),4)</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span>(<span class="built_in">zip</span>(*[<span class="built_in">iter</span>(seq)] * size))</span><br></pre></td></tr></table></figure><h2 id="æ‰§è¡Œç»“æœ"><a href="#æ‰§è¡Œç»“æœ" class="headerlink" title="æ‰§è¡Œç»“æœ"></a>æ‰§è¡Œç»“æœ</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    a = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">24</span>))</span><br><span class="line">    num = <span class="number">4</span></span><br><span class="line">    t1 = split_list(a, num)</span><br><span class="line">    t2 = list_of_groups(a, num)</span><br><span class="line">    t3 = slice_list(a, num)</span><br><span class="line">    t4 = zip_iter(a, num)</span><br><span class="line">    print(t1)</span><br><span class="line">    print(t2)</span><br><span class="line">    print(t3)</span><br><span class="line">    print(t4)</span><br><span class="line"><span class="comment"># [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15], [16, 17, 18, 19], [20, 21, 22, 23]]</span></span><br><span class="line"><span class="comment"># [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15], [16, 17, 18, 19], [20, 21, 22, 23]]</span></span><br><span class="line"><span class="comment"># [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15], [16, 17, 18, 19], [20, 21, 22, 23]]</span></span><br><span class="line"><span class="comment"># [(0, 1, 2, 3), (4, 5, 6, 7), (8, 9, 10, 11), (12, 13, 14, 15), (16, 17, 18, 19), (20, 21, 22, 23)]</span></span><br></pre></td></tr></table></figure><h2 id="æ›´å¤šé˜…è¯»"><a href="#æ›´å¤šé˜…è¯»" class="headerlink" title="æ›´å¤šé˜…è¯»"></a>æ›´å¤šé˜…è¯»</h2><ul><li><a href="https://www.garyrobinson.net/2008/04/splitting-a-pyt.html"><strong>Splitting A Python List Into Sublists</strong></a></li><li><a href="http://code.activestate.com/recipes/425397/"><strong>split a list into roughly equal-sized pieces (python recipe)</strong></a></li><li><a href="https://www.geeksforgeeks.org/python-split-list-into-lists-by-particular-value/">Python | Split list into lists by particular value</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> ğŸPyTricks </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> TODO </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PyCharm æœ€æ–°ä¸“ä¸šç‰ˆï¼ˆ2020.2.2ï¼‰æ¿€æ´»</title>
      <link href="blog/2019-12-25/active-PyCharm/"/>
      <url>blog/2019-12-25/active-PyCharm/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h2 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h2><p>æœ¬è®°å½•æ¥æºç½‘ç»œï¼Œä»…ç”¨äºä¸ªäººè®°å½•ï¼Œè‹¥æ”¶åˆ°å®˜æ–¹å¾‹å¸ˆå‡½åæœè‡ªè´Ÿã€‚å¸Œæœ›ä¸å·®é’±çš„åŒå­¦çˆ±æŠ¤åŒè¡Œï¼Œæ”¯æŒæ­£ç‰ˆï¼Œå» <a href="https://www.jetbrains.com/zh-cn/pycharm/buy/#personal?billing=yearly">å®˜ç½‘è´­ä¹° PyCharm Professional</a>ï¼Œç»„ç»‡ç”¨æˆ·å¯ä»¥åœ¨ <a href="https://www.jetbrains.com/zh-cn/pycharm/buy/#discounts?billing=yearly">è¿™é‡Œ</a> å…³æ³¨ä¼˜æƒ æ”¿ç­–ã€‚</p><h2 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h2><ol><li>è·³è½¬åˆ°è¯¥å¼€æºé¡¹ç›®ï¼š<a href="https://gitee.com/pengzhile/ide-eval-resetter">ide-eval-resetter: Reset your IDE eval information.</a>ï¼›</li><li>ä¸‹è½½æ’ä»¶<a href="https://gitee.com/pengzhile/ide-eval-resetter/releases">releases</a>ï¼Œå®‰è£…æ‰©å±•ï¼ˆç±»ä¼¼äº Chrome å®‰è£…éå®˜æ–¹æ‰©å±•çš„æ–¹æ³•ï¼‰ï¼›<br><img src= "/img/loading.svg" data-lazy-src="https://cdn.jsdelivr.net/gh/masantu/statics@master/images/PyCharm-2020-2.png" alt="PyCharm-2020.2"></li><li>ç‚¹å‡» <code>Help</code> æˆ– <code>Get Help</code> -&gt; <code>Reset IDE&#39;s Eval</code> èœå•ï¼›</li><li>é‡å¯ IDEï¼›</li><li>é‡æ–°è¯„ä¼°ï¼Œä»¥åæ¯ä¸ªæœˆé‡æ–°æ“ä½œä¸€æ¬¡ã€‚</li><li>ç¥å¤§å®¶æ—©æ—¥å®ç°â€œç¼–è¾‘å™¨è‡ªç”±â€ï¼<div class="note warning modern"><p>å¦‚æœä¸å°å¿ƒé”™è¿‡è¯•ç”¨æœŸæ€ä¹ˆé‡ç½®ï¼ˆä¼šå¼ºåˆ¶é€€å‡ºï¼‰ï¼Ÿ</p><ol><li><code>Win+R</code>è¾“å…¥<code>regedit</code>æ‰“å¼€æ³¨å†Œè¡¨ï¼›</li><li>åˆ é™¤<code>è®¡ç®—æœº\HKEY_CURRENT_USER\Software\JavaSoft\Prefs</code>ä¸‹çš„<code>.idexxx</code>å’Œ<code>ide-eval-resetter</code>ç›®å½•ã€‚</li></ol></div></li></ol><hr><p>ä»¥ä¸‹ä¸ºä¸ªäººè®°å½•å¤‡ç”¨ï¼Œç”¨äºè¿·è·¯ä¹‹åçš„æ“ä½œï¼Œæ™®é€šä½¿ç”¨è€…å¯ä»¥å¿½ç•¥ã€‚</p><ol><li>å…³æ³¨å…¬ä¼—å·ï¼Œå‘<code>?</code>æ±‚åŠ©ï¼›</li><li>æ”¶åˆ°å›å¤ä¹‹åç ´è§£è°œé¢ï¼›</li><li>å®‰è£… pycryptodome    <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pip3 install -i https:&#x2F;&#x2F;pypi.douban.com&#x2F;simple pycryptodome</span><br></pre></td></tr></table></figure></li><li>è·å–åœ°å€ï¼Œå¾—åˆ°è°œåº•ã€‚<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Hash <span class="keyword">import</span> MD2</span><br><span class="line"><span class="comment"># åŸæ–‡</span></span><br><span class="line">txt = <span class="string">&quot;73.25&quot;</span></span><br><span class="line"><span class="comment"># md2åŠ å¯†1äº¿æ¬¡</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000000</span>):</span><br><span class="line">    txt = MD2.new(txt.encode(<span class="string">&quot;utf8&quot;</span>)).hexdigest()</span><br><span class="line">print(txt)</span><br></pre></td></tr></table></figure><h3 id="PyCharm-å’Œæ“ä½œç³»ç»Ÿç‰ˆæœ¬ä¿¡æ¯"><a href="#PyCharm-å’Œæ“ä½œç³»ç»Ÿç‰ˆæœ¬ä¿¡æ¯" class="headerlink" title="PyCharm å’Œæ“ä½œç³»ç»Ÿç‰ˆæœ¬ä¿¡æ¯"></a>PyCharm å’Œæ“ä½œç³»ç»Ÿç‰ˆæœ¬ä¿¡æ¯</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">PyCharm 2020.2 (Professional Edition)</span><br><span class="line">Build #PY-202.6397.98, built on July 27, 2020</span><br><span class="line">Licensed to PyCharm Evaluator</span><br><span class="line">Expiration date: September 21, 2020</span><br><span class="line">Runtime version: 11.0.7+10-b944.20 amd64</span><br><span class="line">VM: OpenJDK 64-Bit Server VM by JetBrains s.r.o.</span><br><span class="line">Windows 10 10.0</span><br><span class="line">GC: ParNew, ConcurrentMarkSweep</span><br><span class="line">Memory: 976M</span><br><span class="line">Cores: 4</span><br><span class="line">Registry: ide.balloon.shadow.size&#x3D;0</span><br><span class="line">Non-Bundled Plugins: Assets Compressor, BashSupport, com.nvlad.tinypng-optimizer, io.zhile.research.ide-eval-resetter, com.jetbrains.lang.ejs, com.jetbrains.plugins.jade, org.jetbrains.plugins.vue, com.illuminatedcloud2.intellij</span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> PyCharm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŸºäº CEPH çš„ dashboard çš„äºŒæ¬¡å¼€å‘</title>
      <link href="blog/2019-12-13/custom-base-on-ceph-dashboard/"/>
      <url>blog/2019-12-13/custom-base-on-ceph-dashboard/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><div class="note info modern"><p>æœ¬æ–‡ä¸ºä¸ªäººè®°å½•ä¹‹ç”¨ï¼Œä¸å¯¹å¤§å¤šæ•°ç”¨æˆ·å…·æœ‰å‚è€ƒä»·å€¼ã€‚</p></div><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>é¡¹ç›®ä»¥<code>ceph-14.2.5</code>ç‰ˆæœ¬ä»£ç ä¸­çš„ <a href="https://github.com/ceph/ceph/tree/master/src/pybind/mgr/dashboard">ceph/src/pybind/mgr/dashboardÂ· ceph/ceph</a> ä¸ºåŸºç¡€é€šè¿‡äºŒæ¬¡å¼€å‘ä»¥å®ç° Ceph åˆ†å¸ƒå¼ç®¡ç†ç³»ç»Ÿã€‚</p><p><img src= "/img/loading.svg" data-lazy-src="/images/ceph-dashboard.png" alt="Dashboard"></p><h2 id="å¼€å‘ç¯å¢ƒæ­å»º"><a href="#å¼€å‘ç¯å¢ƒæ­å»º" class="headerlink" title="å¼€å‘ç¯å¢ƒæ­å»º"></a>å¼€å‘ç¯å¢ƒæ­å»º</h2><h3 id="å‰ç«¯"><a href="#å‰ç«¯" class="headerlink" title="å‰ç«¯"></a>å‰ç«¯</h3><ol><li>å®‰è£… npm å·¥å…·<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> å®‰è£…npm</span></span><br><span class="line">yum install npm</span><br></pre></td></tr></table></figure></li><li>å®‰è£… node ç¯å¢ƒ<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> é…ç½®å›½å†…æº</span></span><br><span class="line">npm config set registry https://registry.npm.taobao.org</span><br><span class="line"><span class="meta">#</span><span class="bash"> å®‰è£…nodeç‰ˆæœ¬ç®¡ç†å·¥å…·<span class="string">&#x27;node&#x27;</span></span></span><br><span class="line">npm install -g n</span><br><span class="line"><span class="meta">#</span><span class="bash"> å‡çº§åˆ°`8.9`ç‰ˆæœ¬çš„`node`</span></span><br><span class="line">n 8.9.0</span><br></pre></td></tr></table></figure>æŸ¥çœ‹<code>npm</code>ä¸<code>nodejs</code>çš„ç‰ˆæœ¬ï¼Œå¦‚æœ<code>nodejs</code>ä½äº<code>8.9.0</code>ç‰ˆæœ¬ï¼Œåˆ™å‡çº§ä¹‹ã€‚<br><strong>æ³¨æ„</strong>ï¼šä»¥<code>Linux</code>ä¸ºå¼€å‘ç¯å¢ƒå®‰è£…å‰ç«¯ä¾èµ–è¿›è¡Œæ¼”ç¤ºï¼š<br>åˆ‡æ¢åˆ°<code>/usr/share/ceph/mgr/dashboard/frontend</code> ç›®å½•ï¼š<br>æ­¤å¤„å¯è§å®˜æ–¹<a href="https://docs.ceph.com/en/latest/dev/developer_guide/dash-devel/">Ceph Dashboard Developer Documentation â€” Ceph Documentation</a>æ–‡æ¡£è¯´æ˜ã€‚</li><li>å®‰è£…ä¾èµ–<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æ­¤å¤„å¯è§å®˜æ–¹../HACKING.rst æ–‡æ¡£è¯´æ˜</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> install dependencies</span></span><br><span class="line">npm install</span><br></pre></td></tr></table></figure>å¯ä»¥ä»¥<code>node-sass</code>å®‰è£…æˆåŠŸä¸ºå‚è€ƒæ ‡å¿—ï¼Œå¦‚æœæŠ¥é”™ï¼Œè¯·åˆ é™¤ node_modules ç›®å½•ä¹‹åé‡è¯•ã€‚<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">æŠ¥é”™æ¸…é™¤ç¼“å­˜</span></span><br><span class="line">npm cache verify</span><br></pre></td></tr></table></figure></li><li>å®‰è£…æˆåŠŸä¹‹åï¼Œä¿®æ”¹ä»£ç†é…ç½®<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> ä»£ç†é…ç½®</span></span><br><span class="line">mv proxy.conf.json.sample proxy.conf.json</span><br></pre></td></tr></table></figure>ä¸€ä¸ªå¯å‚è€ƒçš„é…ç½®å†…å®¹ä¸ºï¼š<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;&#x2F;api&#x2F;&quot;: &#123;</span><br><span class="line">    &quot;target&quot;: &quot;http:&#x2F;&#x2F;localhost:8080&quot;,  # æœåŠ¡ç«¯å£å’Œè¿è¡Œåœ°å€éœ€è¦æ ¹æ®æƒ…å†µé…ç½®ï¼Œæ³¨æ„httpå’Œhttpså¿…é¡»åˆ†æ¸…</span><br><span class="line">    &quot;secure&quot;: false,</span><br><span class="line">    &quot;logLevel&quot;: &quot;debug&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;&#x2F;ui-api&#x2F;&quot;: &#123;</span><br><span class="line">    &quot;target&quot;: &quot;http:&#x2F;&#x2F;localhost:8080&quot;,</span><br><span class="line">    &quot;secure&quot;: false,</span><br><span class="line">    &quot;logLevel&quot;: &quot;debug&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>å…¶ä¸­ç«¯å£å·å¯ä»¥ä½¿ç”¨<code>ceph mgr services</code>è·å–åˆ°ï¼Œå³è¾“å‡ºä¸­çš„<code>dashboard</code>å­—æ®µä¸­æ‰€æŒ‡ï¼š<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;dashboard&quot;: &quot;http:&#x2F;&#x2F;node-c1:8080&#x2F;&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>è¿è¡Œå‰ç«¯æœåŠ¡</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm start</span><br></pre></td></tr></table></figure><p>ä¹‹åï¼Œå¦‚æœä½¿ç”¨é»˜è®¤é…ç½®ï¼Œåˆ™è®¿é—®<code>http://localhost:4200/</code>è¿›è¡Œå¼€å‘ï¼Œå¤–éƒ¨ç½‘ç»œè®¿é—®ï¼Œæ›¿æ¢ä¸ºæœåŠ¡æ‰€å±æœºå™¨çš„ ip å³å¯ã€‚</p></li><li><p>ç‰ˆæœ¬é‡Šå‡º</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm run-script build</span><br></pre></td></tr></table></figure><p>è¯¥å‘½ä»¤ä¼šåœ¨ frontend ç›®å½•ä¸‹é‡Šå‡º<code>dist</code>ç›®å½•ã€‚</p></li></ol><h3 id="åç«¯"><a href="#åç«¯" class="headerlink" title="åç«¯"></a>åç«¯</h3><ol><li>å®‰è£… pip</li><li>å®‰è£… python ä¾èµ–<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pip install requirements.txt -r</span><br></pre></td></tr></table></figure></li><li>é…ç½®å¹¶å¯åŠ¨ ODSP ä½œä¸ºä¸€ä¸ªæœåŠ¡<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">systemctl start odspd</span><br></pre></td></tr></table></figure><h2 id="åŠŸèƒ½å±•ç¤º"><a href="#åŠŸèƒ½å±•ç¤º" class="headerlink" title="åŠŸèƒ½å±•ç¤º"></a>åŠŸèƒ½å±•ç¤º</h2><div class="justified-gallery"><p><img src= "/img/loading.svg" data-lazy-src="/images/ceph-dash/Estor-host-info.png" alt="èŠ‚ç‚¹ä¿¡æ¯å±•ç¤º"><br><img src= "/img/loading.svg" data-lazy-src="/images/ceph-dash/Snipaste_2020-11-06_14-49-46.png" alt="ç£ç›˜ï¼ˆæ‰¹é‡ï¼‰ç‚¹ç¯"><br><img src= "/img/loading.svg" data-lazy-src="/images/ceph-dash/Snipaste_2020-11-06_14-50-44.png" alt="èŠ‚ç‚¹è¿œç¨‹ç®¡ç†ï¼ˆå¼€ã€å…³æœºï¼Œç”¨æˆ·ã€ç½‘ç»œç®¡ç†ï¼‰"><br><img src= "/img/loading.svg" data-lazy-src="/images/ceph-dash/Snipaste_2020-11-06_14-58-33.png" alt="ç³»ç»Ÿå·¥å…·ï¼šæ—¶é—´å±•ç¤ºå’ŒDNSä¿®æ”¹åŠå±•ç¤º"></p>          </div></li></ol><h2 id="é¡¹ç›®ç›®å½•ç»“æ„"><a href="#é¡¹ç›®ç›®å½•ç»“æ„" class="headerlink" title="é¡¹ç›®ç›®å½•ç»“æ„"></a>é¡¹ç›®ç›®å½•ç»“æ„</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">tree -L 3 -I &quot;node_modules|*.pyc|*.pyo&quot; </span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.</span><br><span class="line">â”œâ”€â”€ awsauth.py</span><br><span class="line">â”œâ”€â”€ controllers     # åç«¯Python</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ auth.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ cephfs.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ cluster_configuration.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ docs.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ erasure_code_profile.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ grafana.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ health.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ home.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ host.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ __init__.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ iscsi.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ logging.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ logs.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ mgr_modules.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ monitor.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ nfsganesha.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ osd.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ perf_counters.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ pool.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ prometheus.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ rbd_mirroring.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ rbd.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ rgw.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ role.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ saml2.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ settings.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ summary.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ task.py</span><br><span class="line">â”‚Â Â  â””â”€â”€ user.py</span><br><span class="line">â”œâ”€â”€ exceptions.py</span><br><span class="line">â”œâ”€â”€ frontend            # å‰ç«¯</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ angular.json</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ dist</span><br><span class="line">â”‚Â Â  â”‚Â Â  â””â”€â”€ en-US</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ e2e</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ block</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ cluster</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ filesystems</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ helper.po.ts</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ nfs</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ pools</span><br><span class="line">â”‚Â Â  â”‚Â Â  â””â”€â”€ tsconfig.e2e.json</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ environment.build.js</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ html-linter.config.json</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ i18n.config.json</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ nodejs-8.9.4-1nodesource.x86_64.rpm</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ package.json</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ package-lock.json</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ protractor.conf.js</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ proxy.conf.json.sample</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ src                # é™æ€src</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ app</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ assets</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ defaults.scss</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ environments</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ favicon.ico</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ index.html</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ jestGlobalMocks.ts</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ locale</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ main.ts</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ polyfills.ts</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ setupJest.ts</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ styles</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ styles.scss</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ testing</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ tsconfig.app.json</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ tsconfig.spec.json</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ typings.d.ts</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ unit-test-configuration.ts.sample</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ vendor.overrides.scss</span><br><span class="line">â”‚Â Â  â”‚Â Â  â””â”€â”€ vendor.variables.scss</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ tsconfig.json</span><br><span class="line">â”‚Â Â  â””â”€â”€ tslint.json</span><br><span class="line">â”œâ”€â”€ grafana.py</span><br><span class="line">â”œâ”€â”€ HACKING.rst</span><br><span class="line">â”œâ”€â”€ __init__.py</span><br><span class="line">â”œâ”€â”€ module.py       # å¿…éœ€</span><br><span class="line">â”œâ”€â”€ plugins</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ feature_toggles.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ __init__.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ interfaces.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ lru_cache.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ pluggy.py</span><br><span class="line">â”‚Â Â  â””â”€â”€ ttl_cache.py</span><br><span class="line">â”œâ”€â”€ README.rst</span><br><span class="line">â”œâ”€â”€ requirements-py27.txt       # pythonä¾èµ–</span><br><span class="line">â”œâ”€â”€ requirements-py3.txt</span><br><span class="line">â”œâ”€â”€ requirements.txt</span><br><span class="line">â”œâ”€â”€ rest_client.py</span><br><span class="line">â”œâ”€â”€ run-backend-api-request.sh</span><br><span class="line">â”œâ”€â”€ run-backend-api-tests.sh</span><br><span class="line">â”œâ”€â”€ run-backend-rook-api-request.sh</span><br><span class="line">â”œâ”€â”€ run-frontend-e2e-tests.sh</span><br><span class="line">â”œâ”€â”€ run-frontend-unittests.sh</span><br><span class="line">â”œâ”€â”€ run-tox.sh</span><br><span class="line">â”œâ”€â”€ security.py</span><br><span class="line">â”œâ”€â”€ services</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ access_control.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ auth.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ cephfs.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ ceph_service.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ cephx.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ exception.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ ganesha.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ __init__.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ iscsi_client.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ iscsi_cli.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ iscsi_config.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ orchestrator.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ rbd.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ rgw_client.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ sso.py</span><br><span class="line">â”‚Â Â  â””â”€â”€ tcmu_service.py</span><br><span class="line">â”œâ”€â”€ settings.py</span><br><span class="line">â”œâ”€â”€ tests           # å•å…ƒæµ‹è¯•ä»£ç </span><br><span class="line">â”‚Â Â  â”œâ”€â”€ helper.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ __init__.py</span><br><span class="line">|   |â€”â€” # çœç•¥</span><br><span class="line">â”‚Â Â  â””â”€â”€ test_tools.py</span><br><span class="line">â”œâ”€â”€ tools.py</span><br><span class="line">â””â”€â”€ tox.ini</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="é—®é¢˜è®°å½•"><a href="#é—®é¢˜è®°å½•" class="headerlink" title="é—®é¢˜è®°å½•"></a>é—®é¢˜è®°å½•</h2><h3 id="é›†ç¾¤é…ç½®"><a href="#é›†ç¾¤é…ç½®" class="headerlink" title="é›†ç¾¤é…ç½®"></a>é›†ç¾¤é…ç½®</h3><p>å¯ç”¨<code>mgr restful</code>ä¹‹åï¼Œè®¿é—®<code>https://node_addr:8003/config/cluster</code>è·å–é›†ç¾¤é…ç½®ä¿¡æ¯ï¼Œä¹‹åå¯ä»¥è®¿é—®å…·ä½“åç§°ï¼Œè·å¾—é…ç½®è¯¦æƒ…ï¼›</p><h3 id="å¦‚ä½•æ·»åŠ controller"><a href="#å¦‚ä½•æ·»åŠ controller" class="headerlink" title="å¦‚ä½•æ·»åŠ controller"></a>å¦‚ä½•æ·»åŠ <code>controller</code></h3><p>å‚è§<a href="https://docs.ceph.com/en/latest/dev/developer_guide/dash-devel/">HACKING.rst</a></p><p>ç»§æ‰¿<code>BaseController</code>ä¹‹åä½¿ç”¨ <code>@Controller</code>,<code>@ApiController</code> æˆ–è€…<code>@UiApiController</code> ï¼Œä¸‰è€…çš„åŒºåˆ«æ˜¯ï¼š<br><code>@ApiController</code> å’Œ <code>@UiApiController</code> æ˜¯<code>@Controller</code>çš„ç‰¹æ®ŠåŒ–ã€‚</p><p><code>@ApiController</code> åº”è¯¥ç”¨åœ¨æä¾›ç±» API æ¥å£ï¼Œè€Œ<code>@UiApiController</code>åº”è¯¥è¢«ç”¨äºéå…¬ç”¨çš„ APIï¼Œå…¶ä»–æ¥å£ä½¿ç”¨<code>@Controller</code></p><p>ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬åªéœ€è¦å®ç°<code>@Controller</code>å’Œ<code>@ApiController</code> å³å¯ã€‚</p><p><code>@Endpoint</code> ç”¨äºæš´éœ²æ¥å£çš„æ–¹æ³•å®ç°ï¼Œå®ƒå¯ä»¥æ¥æ”¶å¾ˆå¤šå‚æ•°ï¼Œæ¯”å¦‚è¯·æ±‚æ–¹æ³•ï¼ŒæŸ¥è¯¢å‚æ•°ç­‰ï¼›<br><strong><em>æ³¨</em></strong>ï¼šå¯¹äºé›†ç¾¤ç®¡ç†æ—¶ï¼Œæˆ‘ä»¬æŠŠ node ä¿¡æ¯ç›´æ¥ä¼ è¾“åˆ° url ä¸­ï¼Œæˆ–è®¸æ˜¯ä¸€ä¸ªå¥½åŠæ³•ï¼Œå‚è€ƒï¼š<code>@Endpoint(path=&quot;/&#123;date&#125;/latency&quot;)</code>å¤„ä»£ç ã€‚</p><p>è€Œç»§æ‰¿<code>RESTController</code>é»˜è®¤è¿”å›<code>json</code>æ ¼å¼æ•°æ®ã€‚å®ƒæ˜¯ä¸€ä¸ªç®€åŒ–å¹¶ä½¿ç”¨<code>collection</code>æ•´åˆæ•°æ®çš„æŠ½è±¡å±‚ï¼Œå°†æ–¹æ³•åã€è¯·æ±‚ç±»å‹å’ŒçŠ¶æ€ç è¿›è¡Œæ˜ å°„ã€‚å…·ä½“æ˜ å°„å…³ç³»è§æ–‡æ¡£è¡¨æ ¼ã€‚</p><h3 id="è°ƒè¯•"><a href="#è°ƒè¯•" class="headerlink" title="è°ƒè¯•"></a>è°ƒè¯•</h3><p>æ¨¡å—ç¼–å†™å®Œæˆï¼Œé‡å¯æœåŠ¡ï¼Œçœ‹æ˜¯å¦ä¼šæœ‰æ¨¡å—æœªæ‰¾åˆ°ï¼ŒæœåŠ¡å¯¼å…¥ç­‰æŠ¥é”™<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ceph mgr module disable dashboard</span><br><span class="line">ceph mgr module enable dashboard</span><br><span class="line">ceph dashboard create-self-signed-cert</span><br></pre></td></tr></table></figure><br>ä¹Ÿå¯ä»¥æŸ¥çœ‹æ—¥å¿—ï¼ŒæŸ¥æ‰¾å¯èƒ½çš„æŠ¥é”™ä¿¡æ¯ã€‚</p><h4 id="æŸ¥çœ‹æ—¥å¿—"><a href="#æŸ¥çœ‹æ—¥å¿—" class="headerlink" title="æŸ¥çœ‹æ—¥å¿—"></a>æŸ¥çœ‹æ—¥å¿—</h4><p>é€šè¿‡è¯¥æ–‡ä»¶å¯ä»¥æŸ¥çœ‹<code>mgr</code>ä¸­çš„æŠ¥é”™ä¿¡æ¯ï¼Œæš‚æ—¶æœªæ‰¾åˆ° logger.info()å†™å…¥ log ä¸­çš„ä¿¡æ¯ï¼ˆæ˜¯å¦éœ€è¦é…ç½®ï¼Ÿï¼‰<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">tailf /var/log/ceph/ceph-mgr.node1.log</span><br></pre></td></tr></table></figure><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> ..module <span class="keyword">import</span> cherrypy</span><br><span class="line">cherrypy.log(<span class="string">&#x27;---------&#x27;</span>, json.dumps(update_info))     <span class="comment"># å¿…é¡»æ˜¯str</span></span><br></pre></td></tr></table></figure></p><h3 id="MDS-çŠ¶æ€"><a href="#MDS-çŠ¶æ€" class="headerlink" title="MDS çŠ¶æ€"></a>MDS çŠ¶æ€</h3><p><a href="https://my.oschina.net/myspaceNUAA/blog/500136">å…ƒæ•°æ®æœåŠ¡å™¨</a><br><a href="http://docs.ceph.org.cn/man/8/ceph-mds/">CEPH-MDS â€“ CEPH å…ƒæ•°æ®æœåŠ¡å™¨å®ˆæŠ¤è¿›ç¨‹</a></p><h3 id="éœ€è¦å®‰è£…çš„å·¥å…·ã€ä¾èµ–"><a href="#éœ€è¦å®‰è£…çš„å·¥å…·ã€ä¾èµ–" class="headerlink" title="éœ€è¦å®‰è£…çš„å·¥å…·ã€ä¾èµ–"></a>éœ€è¦å®‰è£…çš„å·¥å…·ã€ä¾èµ–</h3><ul><li>è·å–ç£ç›˜<code>SN</code>å·ç <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">yum install hdparm</span><br></pre></td></tr></table></figure><h3 id="æ—¶é—´é…ç½®"><a href="#æ—¶é—´é…ç½®" class="headerlink" title="æ—¶é—´é…ç½®"></a>æ—¶é—´é…ç½®</h3>é›†ç¾¤éƒ¨ç½²çš„æ—¶å€™è„šæœ¬ä¸­åº”è¯¥æœ‰é…ç½® NTP çš„æ“ä½œï¼Œæ­¥éª¤å‚è§ï¼š<a href="https://access.redhat.com/documentation/en-us/red_hat_ceph_storage/1.2.3/html/installation_guide_for_rhel_x86_64/pre-installation-requirements#ntp">NTP</a><br>ä¸å†æ”¯æŒæ‰‹åŠ¨è¾“å…¥æ—¶é—´é…ç½®</li></ul><ol><li>ç›´æ¥è®¾ç½®é›†ç¾¤å†…éƒ¨æœºå™¨ä¸º ntp æœåŠ¡å™¨ï¼Œå…¶ä»–æŒ‡å‘è¯¥æœºå™¨ï¼›</li><li>ç»™å®š ip æˆ–åŸŸååœ°å€ï¼Œå¦‚æœæ˜¯é›†ç¾¤ç½‘æ®µçš„ï¼Œåˆ™ç›´æ¥è¿”å›æç¤ºä¸æ”¯æŒï¼Œå¦åˆ™ï¼Œæ‰€æœ‰æŒ‡å‘è¯¥åœ°å€ã€‚<div class="note warning modern"><p><strong>æ³¨æ„</strong><br>æ ¹æ®ä¸‹é¢è¿™ç¯‡æ–‡ç« çš„è§‚ç‚¹ï¼Œåœ¨é›†ç¾¤èµ·æ¥ä¹‹åå†å»è°ƒèŠ‚ ntp æœåŠ¡è¢«è®¤ä¸ºæ˜¯ä¼šä¸¥é‡å½±å“é›†ç¾¤ä¸šåŠ¡çš„æ“ä½œï¼Œå¦‚æœä¸€å®šè¦è°ƒæ•´ï¼Œä¹Ÿå¯èƒ½ä¼šè€—æ—¶å¾ˆä¹…ï¼<br><a href="http://hackerain.me/2019/12/15/ceph/cephx.html">æ·±åº¦è§£æ CephX åŸç†â€”è°ƒèŠ‚ NTP æ—¶é’Ÿçš„å›°å¢ƒ | å¼€å¿ƒé¬¼</a></p></div></li></ol><p><a href="http://docs.ceph.org.cn/rados/configuration/mon-config-ref/">ç›‘è§†å™¨é…ç½®å‚è€ƒ</a></p><h3 id="mon-çŠ¶æ€"><a href="#mon-çŠ¶æ€" class="headerlink" title="mon çŠ¶æ€"></a>mon çŠ¶æ€</h3><ul><li><a href="https://access.redhat.com/documentation/en-us/red_hat_ceph_storage/3/html/troubleshooting_guide/troubleshooting-monitors#understanding-monitor-status">Understanding Monitor Status</a></li><li><p><a href="https://docs.ceph.com/docs/nautilus/rados/troubleshooting/troubleshooting-mon/">Troubleshooting Monitors â€” Ceph Documentation</a></p><h4 id="åœ¨æ³•å®šä¹‹å†…-in-quorum"><a href="#åœ¨æ³•å®šä¹‹å†…-in-quorum" class="headerlink" title="åœ¨æ³•å®šä¹‹å†… in quorum"></a>åœ¨æ³•å®šä¹‹å†… in quorum</h4><p><code>ceph daemon mon.node X mon_status</code>ä¸¤ç§ stateï¼Œ leader æˆ–è€… peonï¼›<br>å¦‚æœ leader down ä¹‹åï¼Œè°ƒç”¨å¯ä»¥çœ‹åˆ°åŸæ¥çš„ state ä¸º<code>peon</code>çš„ä¼šå˜ä¸º<code>probing</code>ï¼Œå¦‚æœå¯ä»¥å®ç°ä»²è£ï¼Œåˆ™<code>rank</code>æœ€å°è€…å˜ä¸º leaderï¼›</p><h4 id="è¶…å‡ºæ³•å®šäººæ•°-out-quorum-æ–°åŠ å…¥çš„èŠ‚ç‚¹"><a href="#è¶…å‡ºæ³•å®šäººæ•°-out-quorum-æ–°åŠ å…¥çš„èŠ‚ç‚¹" class="headerlink" title="è¶…å‡ºæ³•å®šäººæ•° out quorum/æ–°åŠ å…¥çš„èŠ‚ç‚¹"></a>è¶…å‡ºæ³•å®šäººæ•° out quorum/æ–°åŠ å…¥çš„èŠ‚ç‚¹</h4><p>çŠ¶æ€å¯èƒ½ä¸º æ¢æµ‹ï¼ˆprobingï¼‰, é€‰ä¸¾ï¼ˆelectingï¼‰ æˆ–è€… synchronizing</p></li><li><p><a href="https://access.redhat.com/documentation/en-us/red_hat_ceph_storage/3/html/troubleshooting_guide/troubleshooting-monitors#monitor-is-out-of-quorum">mon.X is down (out of quorum)</a></p></li></ul><h2 id="å‘å¸ƒå†å²"><a href="#å‘å¸ƒå†å²" class="headerlink" title="å‘å¸ƒå†å²"></a>å‘å¸ƒå†å²</h2><h3 id="vN1-0-1ï¼ˆ2020-07-03ï¼‰"><a href="#vN1-0-1ï¼ˆ2020-07-03ï¼‰" class="headerlink" title="vN1.0.1ï¼ˆ2020-07-03ï¼‰"></a>vN1.0.1ï¼ˆ2020-07-03ï¼‰</h3><h4 id="é›†ç¾¤ä¸»æœº"><a href="#é›†ç¾¤ä¸»æœº" class="headerlink" title="é›†ç¾¤ä¸»æœº"></a>é›†ç¾¤ä¸»æœº</h4><h5 id="mon-mgr"><a href="#mon-mgr" class="headerlink" title="mon/mgr"></a>mon/mgr</h5><p>èŠ‚ç‚¹å‘ç°ï¼š</p><ol><li>å•èŠ‚ç‚¹æ·»åŠ </li><li>å¤šèŠ‚ç‚¹æ·»åŠ </li><li>å±€åŸŸç½‘æ®µæ·»åŠ <br>èŠ‚ç‚¹åˆ é™¤</li></ol><h5 id="è¿œç¨‹ç®¡ç†"><a href="#è¿œç¨‹ç®¡ç†" class="headerlink" title="è¿œç¨‹ç®¡ç†"></a>è¿œç¨‹ç®¡ç†</h5><ol><li>èŠ‚ç‚¹è¿œç¨‹å¼€æœºã€å…³æœºã€é‡å¯ï¼›</li><li>ä¿®æ”¹è¿œç¨‹æ“ä½œç”¨æˆ·ç”¨æˆ·åã€å¯†ç ï¼›</li><li>ç½‘ç»œé…ç½®ï¼ˆipã€æ©ç ã€ç½‘å…³ã€‚</li></ol><h5 id="ç£ç›˜å±•ç¤ºåŠå®šä½"><a href="#ç£ç›˜å±•ç¤ºåŠå®šä½" class="headerlink" title="ç£ç›˜å±•ç¤ºåŠå®šä½"></a>ç£ç›˜å±•ç¤ºåŠå®šä½</h5><p>ç£ç›˜ç›˜ä½æŸ¥çœ‹ã€ï¼ˆæ‰¹é‡ï¼‰å®šä½åŠå–æ¶ˆå®šä½ï¼›</p><h5 id="ç³»ç»Ÿå·¥å…·"><a href="#ç³»ç»Ÿå·¥å…·" class="headerlink" title="ç³»ç»Ÿå·¥å…·"></a>ç³»ç»Ÿå·¥å…·</h5><ol><li>è®¾ç½® ntp æœåŠ¡å™¨</li><li>è®¾ç½® DNS</li></ol><h5 id="License"><a href="#License" class="headerlink" title="License"></a>License</h5><p>license æ·»åŠ ã€åˆ é™¤ã€æ›´æ–°</p><h5 id="OSD"><a href="#OSD" class="headerlink" title="OSD"></a>OSD</h5><p>osd æ–°å»ºï¼šosd æ·»åŠ ï¼ˆç±»å‹é…ç½®ï¼‰ã€æ·»åŠ -WAL devices DB devicesï¼ŒåŠ å¯†<br>OSD ç¼–è¾‘ï¼šæ´—åˆ·ã€æ·±åº¦æ´—åˆ·ã€è®¾ç½®æƒé‡ã€æ ‡è®°ã€é”€æ¯ã€æ¸…é™¤</p><h5 id="æ—¥å¿—"><a href="#æ—¥å¿—" class="headerlink" title="æ—¥å¿—"></a>æ—¥å¿—</h5><p>é›†ç¾¤æ—¥å¿—ç®¡ç†ã€å®¡è®¡æ—¥å¿—ã€æ—¥å¿—æ‰“åŒ…ä¸‹è½½</p><h5 id="å­˜å‚¨æ± "><a href="#å­˜å‚¨æ± " class="headerlink" title="å­˜å‚¨æ± "></a>å­˜å‚¨æ± </h5><p>å­˜å‚¨æ± æ–°å»ºã€ç¼–è¾‘ã€åˆ é™¤</p><h5 id="å—è®¾å¤‡"><a href="#å—è®¾å¤‡" class="headerlink" title="å—è®¾å¤‡"></a>å—è®¾å¤‡</h5><ul><li>æ˜ åƒ<br>æ–°å»ºã€ç¼–è¾‘ã€å¤åˆ¶ã€åˆ é™¤ï¼Œç§»é™¤å›æ”¶ç«™ã€å®¹é‡è°ƒèŠ‚</li><li>é•œåƒ</li><li>ISCSI-target</li><li>ISCSI-ç½‘å…³</li></ul><h5 id="å¯¹è±¡ç½‘å…³"><a href="#å¯¹è±¡ç½‘å…³" class="headerlink" title="å¯¹è±¡ç½‘å…³"></a>å¯¹è±¡ç½‘å…³</h5><p>å®ˆæŠ¤è¿›ç¨‹åˆ›å»ºã€æ›´æ–°ã€åˆ é™¤</p><h2 id="æ›´å¤š"><a href="#æ›´å¤š" class="headerlink" title="æ›´å¤š"></a>æ›´å¤š</h2><p>åŒäº‹å†™çš„å¤‡å¿˜å½•ï¼š<a href="https://note.youdao.com/ynoteshare1/index.html?id=550ed97b36101aab178afe9081cd52ee">æœ‰é“äº‘ç¬”è®°</a></p>]]></content>
      
      
      <categories>
          
          <category> å·¥ä½œæ—¥å¸¸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CEPH </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åœ¨ Python ä¸­å®šä¹‰æœ¬åœ°ç±»æ˜¯ä»€ä¹ˆæ“ä½œï¼Ÿ</title>
      <link href="blog/2019-12-10/define-a-local-class-inside-a-function-in-python/"/>
      <url>blog/2019-12-10/define-a-local-class-inside-a-function-in-python/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h2 id="ç¼˜èµ·"><a href="#ç¼˜èµ·" class="headerlink" title="ç¼˜èµ·"></a>ç¼˜èµ·</h2><p>ä»Šå¤©åœ¨çœ‹ cephï¼ˆmgr-dashboardï¼‰æºç çš„æ—¶å€™çœ‹åˆ°ä¸‹é¢çš„ä»£ç ï¼Œäº§ç”Ÿäº†ä¸€ç‚¹ç–‘æƒ‘ï¼Œè¿™é‡Œç®€å•æ•´ç†ä¸€ä¸‹ã€‚ä»£ç è¯¦è§<code>src/pybind/mgr/dashboard/module.py:502</code><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> cherrypy</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StandbyModule</span>(<span class="params">MgrStandbyModule, CherryPyConfig</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, *args, **kwargs</span>):</span></span><br><span class="line">        <span class="built_in">super</span>(StandbyModule, self).__init__(*args, **kwargs)</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">serve</span>(<span class="params">self</span>):</span>        <span class="comment"># here</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">Root</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line"><span class="meta">            @cherrypy.expose</span></span><br><span class="line">            <span class="function"><span class="keyword">def</span> <span class="title">index</span>(<span class="params">self</span>):</span></span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">        cherrypy.tree.mount(Root(), <span class="string">&quot;&#123;&#125;/&quot;</span>.<span class="built_in">format</span>(self.url_prefix), &#123;&#125;)</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">shutdown</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure></p><h2 id="ç†è§£"><a href="#ç†è§£" class="headerlink" title="ç†è§£"></a>ç†è§£</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">some_funky_data_structure</span>(<span class="params">bar_data=<span class="literal">None</span></span>):</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">FunkyClass</span>:</span></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">            self.data = <span class="string">&#x27;This is dunder init innner of FunkyClass&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">get_funky</span>(<span class="params">self, inner_data</span>):</span></span><br><span class="line">            print(<span class="string">&#x27;The inner_data of inner get_funky() is &#123;inner_data&#125;, outer of inner data is &#123;bar_data&#125;.&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">                inner_data=inner_data, bar_data=bar_data))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> FunkyClass</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    foo = some_funky_data_structure(<span class="string">&#x27;foo&#x27;</span>)</span><br><span class="line">    foo_bar = some_funky_data_structure(<span class="string">&#x27;foo_bar&#x27;</span>)</span><br><span class="line">    print(foo().get_funky(<span class="string">&#x27;baz&#x27;</span>), foo_bar().get_funky(<span class="string">&#x27;baz&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    f1 = some_funky_data_structure()()</span><br><span class="line">    f2 = some_funky_data_structure()()</span><br><span class="line">    <span class="comment"># ç±»å‹çœ‹èµ·æ¥ç›¸åŒä½†å®é™…ä¸åŒ</span></span><br><span class="line">    print(<span class="built_in">type</span>(f1))</span><br><span class="line">    print(<span class="built_in">type</span>(f2))</span><br><span class="line">    print(<span class="built_in">type</span>(f1) <span class="keyword">is</span> <span class="built_in">type</span>(f2))     <span class="comment"># False</span></span><br><span class="line">    print(<span class="built_in">isinstance</span>(f1, <span class="built_in">type</span>(f2)))     <span class="comment"># False</span></span><br></pre></td></tr></table></figure><p>åˆæ¬¡é‡åˆ°è¿™ç§ä»£ç çœ‹èµ·æ¥ä¼šæœ‰ç‚¹å¥‡æ€ªæˆ–è€…æ„Ÿåˆ°å›°æƒ‘ã€‚ä½†æ˜¯åŒæ—¶ç”±äºå°è£…çš„å®ç°ï¼Œå¯ä»¥é˜²æ­¢å¤–éƒ¨è®¿é—®å‡½æ•°çš„å®ç°ã€‚é‚£ä¹ˆè¿™ç©¶ç«Ÿæ˜¯ä¸€ä¸ªå¥½çš„å®è·µè¿˜æ˜¯ç³Ÿç³•çš„å®ç°å‘¢ï¼Ÿ</p><ol><li>æ— æ³•è¿›è¡Œç±»å‹æ£€æŸ¥ï¼Œå› ä¸ºå†…éƒ¨ç±»å¯¹å¤–éƒ¨æ˜¯éšè—çš„ï¼Œä½ æ— æ³•ä½¿ç”¨<code>isinstance(foo,FunkyClass)</code>è¯­å¥æ£€æŸ¥ç±»å‹ï¼Œå¤šæ¬¡å®ä¾‹åŒ–ä¹‹åä¸¤è€…ç±»å‹è™½ç„¶çœ‹èµ·æ¥ç›¸åŒï¼Œä½†å®é™…ä¸æ˜¯ä¸€ä¸ªç±»å‹ï¼Œç”šè‡³åœ¨ Python2 ä¸­æ‰“å°åˆ°çš„ç±»å‹æ˜¯<code>&lt;type &#39;instance&#39;&gt;</code></li><li>å®ç°<code>map()</code>å‡½æ•°çš„é™æ€è°ƒç”¨<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ³¨ï¼šæ­¤å¤„ä¸çŸ¥æ˜¯æˆ‘ç†è§£æœ‰è¯¯è¿˜æ˜¯è¯´çš„å°±æ˜¯è¿™ä¸ªæ„æ€ï¼Œè¿™ç§å†™æ³•è¿˜æ˜¯å°½é‡é¿å…å§</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_FunkyClass</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, *args, **kwargs</span>):</span></span><br><span class="line">        print(<span class="string">f&#x27;args is <span class="subst">&#123;args&#125;</span>,kwargs is <span class="subst">&#123;kwargs&#125;</span>.&#x27;</span>)</span><br><span class="line">        self.data = <span class="string">&#x27;This is dunder init innner of FunkyClass&#x27;</span></span><br><span class="line">        self.bar_data = kwargs.get(<span class="string">&#x27;bar_data&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_funky</span>(<span class="params">self, inner_data</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;The inner_data of inner get_funky() is &#123;inner_data&#125;, outer of inner data is &#123;bar_data&#125;.&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">            inner_data=inner_data, bar_data=self.bar_data))</span><br><span class="line">            </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># see also: https://stackoverflow.com/questions/16874244/python-map-and-arguments-unpacking            </span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">map</span>(<span class="keyword">lambda</span> x: _FunkyClass.get_funky(x[<span class="number">1</span>], x[<span class="number">0</span>]),</span><br><span class="line">                 [(<span class="string">&#x27;foo&#x27;</span>, _FunkyClass(bar_data=<span class="string">&#x27;foo_bar&#x27;</span>)), (<span class="string">&#x27;bar&#x27;</span>, _FunkyClass(bar_data=<span class="string">&#x27;bar_foo&#x27;</span>))]):</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>å‚é˜…<a href="https://stackoverflow.com/questions/34034644/python-best-practice-class-definition-inside-function">Python best practice: class definition inside function?</a></li></ol><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul><li>ä¼˜ç‚¹ï¼š<ol><li>ä½¿ç±»å±€éƒ¨æ€§ã€‚è¯¥ç±»ä¸ä¼šä»¥ä½ ä¸æœŸæœ›çš„æ–¹å¼åœ¨å‡½æ•°å¤–éƒ¨è¢«æ‰§è¡Œä½¿ç”¨ï¼›</li><li>æ€§èƒ½ã€‚æŸ¥æ‰¾å±€éƒ¨å˜é‡è¦æ¯”æŸ¥æ‰¾å…¨å±€å˜é‡å¿«å¾—å¤šã€‚å¦‚æœæ‚¨åˆ›å»ºäº†å¤§é‡å®ä¾‹ï¼Œè¿™å¯èƒ½ä¼šæé«˜ä½¿ç”¨å…¨å±€ç±»çš„æ€§èƒ½ã€‚ç„¶è€Œï¼Œé€šè¿‡é»˜è®¤å‚æ•°/å±€éƒ¨å˜é‡æ¥æŠµæ¶ˆè¿™ç§ä¼˜åŠ¿æ˜¯<strong>åŠå…¶</strong>å®¹æ˜“çš„ã€‚</li></ol></li><li>ç¼ºç‚¹ï¼š<ol><li>å¯è¯»æ€§ã€‚é™¤éç±»éå¸¸å®¹æ˜“ï¼Œå¦åˆ™å‡½æ•°å°†ä¸å¯é¿å…åœ°å¢é•¿å˜å¾—éå¸¸é•¿ï¼Œä¼šä½¿ä»£ç ä¸§å¤±å¯è¯»æ€§ã€‚æ­¤å¤–ç”±äº<code>Python</code>ä¸­ä½¿ç”¨ç¼©è¿›ï¼Œå¦‚æœä½ çš„å¤–éƒ¨å‡½æ•°æŸå¤„åµŒå¥—å¾ªç¯ï¼Œåˆ™ä¼šå½±å“å¯è¯»æ€§ï¼›</li><li>æ€§èƒ½ã€‚ç±»åœ¨æ¯ä¸€æ¬¡å‡½æ•°è°ƒç”¨æ—¶éƒ½å°†è¢«é‡æ–°ç¼–è¯‘ã€‚è™½ç„¶ä¸ä¼šå¾ˆè€—æ—¶ï¼Œä½†è¿˜æ˜¯ä¼šèŠ±ä¸€ç‚¹æ—¶é—´ã€‚å¦‚æœä½ åŸæ¥çš„<code>function</code>å¾ˆå¿«ï¼Œé‚£ä¹ˆè¿™ä¸ªï¼ˆå¼•å…¥æœ¬åœ°ç±»ï¼‰æˆæœ¬å¯èƒ½æœ‰ç‚¹é«˜ã€‚</li></ol></li></ul><h2 id="å»ºè®®"><a href="#å»ºè®®" class="headerlink" title="å»ºè®®"></a>å»ºè®®</h2><p>å®šä¹‰å…¨å±€çš„ç±»ï¼Œå¦‚æœä½ æƒ³å®šä¹‰æˆç§æœ‰çš„ï¼Œä½¿ç”¨ä¸‹åˆ’çº¿å³å¯ï¼Œä¾‹å¦‚<code>_MyClass()</code>ï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“è¿™æ˜¯<code>Python</code>ä¸­çº¦å®šå¥½çš„ã€‚<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># python3</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_FunkyClass</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, *args, **kwargs</span>):</span></span><br><span class="line">        print(<span class="string">f&#x27;args is <span class="subst">&#123;args&#125;</span>,kwargs is <span class="subst">&#123;kwargs&#125;</span>.&#x27;</span>)</span><br><span class="line">        self.data = <span class="string">&#x27;This is dunder init innner of FunkyClass&#x27;</span></span><br><span class="line">        self.bar_data = kwargs.get(<span class="string">&#x27;bar_data&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_funky</span>(<span class="params">self, inner_data</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;The inner_data of inner get_funky() is &#123;inner_data&#125;, outer of inner data is &#123;bar_data&#125;.&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">            inner_data=inner_data, bar_data=self.bar_data))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">normal_some_funky_data_structure</span>(<span class="params">bar_data=<span class="literal">None</span></span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">return</span> _FunkyClass(bar_data=bar_data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">call_normal_some_funky_data_structure</span>():</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">return</span> _FunkyClass</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:  </span><br><span class="line">    foo = normal_some_funky_data_structure(<span class="string">&#x27;foo&#x27;</span>)</span><br><span class="line">    foo_bar = normal_some_funky_data_structure(<span class="string">&#x27;foo_bar&#x27;</span>)</span><br><span class="line">    foo.get_funky(<span class="string">&#x27;baz&#x27;</span>)</span><br><span class="line">    foo_bar.get_funky(<span class="string">&#x27;baz&#x27;</span>)</span><br><span class="line">    print(<span class="built_in">isinstance</span>(foo, _FunkyClass))     <span class="comment"># True</span></span><br><span class="line"></span><br><span class="line">    c_foo = call_normal_some_funky_data_structure()(bar_data=<span class="string">&#x27;foo&#x27;</span>)</span><br><span class="line">    c_fb = call_normal_some_funky_data_structure()(bar_data=<span class="string">&#x27;foo_bar&#x27;</span>)</span><br><span class="line">    c_foo.get_funky(<span class="string">&#x27;baz&#x27;</span>)</span><br><span class="line">    c_fb.get_funky(<span class="string">&#x27;baz&#x27;</span>)</span><br><span class="line">    print(<span class="built_in">isinstance</span>(c_foo, _FunkyClass))   <span class="comment"># True</span></span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬ä½¿ç”¨ä¸‹é¢çš„ä»£ç åšä¸€ä¸ªç®€å•çš„æ€§èƒ½æµ‹è¯•ï¼š<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> timeit</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_Out</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test</span>(<span class="params">self, _try_time=<span class="number">10</span></span>):</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(_try_time):</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">function_out</span>(<span class="params">n, try_time</span>):</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        _Out().test(try_time)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">function_in</span>(<span class="params">n, try_time</span>):</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Inner</span>:</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">test</span>(<span class="params">self, _try_time=<span class="number">10</span></span>):</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(_try_time):</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        Inner().test(try_time)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">function_mixed</span>(<span class="params">n, try_time, cls=_Out</span>):</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        cls().test(try_time)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    m, test_try_time = <span class="number">1</span>, <span class="number">10</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    time of function_out is 0.0009663160890340805.</span></span><br><span class="line"><span class="string">    time of function_in is 0.009836168959736824.    # ç›¸å·®ä¸€ä¸ªæ•°é‡çº§</span></span><br><span class="line"><span class="string">    time of function_mixed is 0.0009927581995725632.</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="comment"># m, test_try_time = 1000, 10</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    time of function_out is 0.7052748203277588.</span></span><br><span class="line"><span class="string">    time of function_in is 0.7609770204871893.</span></span><br><span class="line"><span class="string">    time of function_mixed is 0.7371664671227336.</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="comment"># m, test_try_time = 10000, 10</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    time of function_out is 6.49063076544553.</span></span><br><span class="line"><span class="string">    time of function_in is 6.0502378745004535.</span></span><br><span class="line"><span class="string">    time of function_mixed is 6.159397796727717.</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    t1 = timeit.timeit(stmt=<span class="string">&quot;function_out(m, test_try_time)&quot;</span>,</span><br><span class="line">                       setup=<span class="string">&quot;from __main__ import function_out, m,test_try_time&quot;</span>, number=<span class="number">1000</span>)</span><br><span class="line">    t2 = timeit.timeit(stmt=<span class="string">&quot;function_in(m, test_try_time)&quot;</span>, setup=<span class="string">&quot;from __main__ import function_in, m,test_try_time&quot;</span>,</span><br><span class="line">                       number=<span class="number">1000</span>)</span><br><span class="line">    t3 = timeit.timeit(stmt=<span class="string">&quot;function_mixed(m, test_try_time)&quot;</span>,</span><br><span class="line">                       setup=<span class="string">&quot;from __main__ import function_mixed, m,test_try_time&quot;</span>, number=<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">f&#x27;time of function_out is <span class="subst">&#123;t1&#125;</span>.&#x27;</span>)</span><br><span class="line">    print(<span class="string">f&#x27;time of function_in is <span class="subst">&#123;t2&#125;</span>.&#x27;</span>)</span><br><span class="line">    print(<span class="string">f&#x27;time of function_mixed is <span class="subst">&#123;t3&#125;</span>.&#x27;</span>)</span><br></pre></td></tr></table></figure></p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><ul><li><a href="https://stackoverflow.com/questions/22497985/is-it-a-bad-idea-to-define-a-local-class-inside-a-function-in-python">Is it a bad idea to define a local class inside a function in python?</a></li><li><a href="https://www.datacamp.com/community/tutorials/inner-classes-python">Inner Classes in Python</a></li></ul><h3 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h3><ul><li><a href="https://stackoverflow.com/questions/4296677/creating-a-class-within-a-function-and-access-a-function-defined-in-the-containi">Creating a class within a function and access a function defined in the containing functionâ€™s scope</a></li><li><a href="https://stackoverflow.com/questions/20246523/how-references-to-variables-are-resolved-in-python">How references to variables are resolved in Python</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•è·å–åˆ°æŒ‡å®šæ—¥æœŸä¹‹åå®‰è£…çš„ Python æ¨¡å—</title>
      <link href="blog/2019-12-07/how-can-get-all-packages-installed-after-a-certain-date-or-time-of-pip/"/>
      <url>blog/2019-12-07/how-can-get-all-packages-installed-after-a-certain-date-or-time-of-pip/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><p>ä»Šå¤©åœ¨è£…åŒ…çš„æ—¶å€™ï¼Œä¸å°å¿ƒå°†æœ¬è¯¥è£…åˆ° Python è™šæ‹Ÿç¯å¢ƒä¸­çš„åŒ…å®‰è£…åˆ°äº†æœºå™¨çœŸå®ç¯å¢ƒä¸­ï¼Œæ‰€ä»¥éœ€è¦å¯¹å…¶ç­›é€‰å¹¶æ¸…é™¤ï¼Œé‚£ä¹ˆå¦‚ä½•æ‰¾åˆ°ç‰¹å®šæ—¥æœŸä¹‹åå®‰è£…çš„ Python åŒ…å‘¢ï¼Ÿåœ¨ <a href="https://stackoverflow.com/questions/10256093/how-to-convert-ctime-to-datetime-in-python">è¿™é‡Œ</a> æ‰¾åˆ°äº†è§£å†³æ–¹æ¡ˆï¼Œæœ€ååšäº†ä¸€ä¸ªç®€å•çš„å°è£…ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># Created by imoyao at 2019/12/7 13:33</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Usage:</span></span><br><span class="line"><span class="string">ä¿®æ”¹ specific_timeï¼ˆlike:2019-12-07ï¼‰,ä»¥æ‰¾åˆ°è¯¥æ—¥æœŸä¹‹åå®‰è£…çš„ pip åŒ…</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">from</span> pip._internal.utils.misc <span class="keyword">import</span> get_installed_distributions</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_all_packages</span>():</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    è·å–åˆ°æ‰€æœ‰å®‰è£…çš„ packages</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    install_packages = get_installed_distributions()</span><br><span class="line">    <span class="keyword">return</span> install_packages</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_after_date_packages</span>(<span class="params">date=<span class="literal">None</span></span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    è·å–æŒ‡å®šæ—¥æœŸä¹‹åå®‰è£…çš„ package</span></span><br><span class="line"><span class="string">    :param date:str, like:2019-12-07</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> date:</span><br><span class="line">        date = datetime.datetime.today().strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    install_packages = get_all_packages()</span><br><span class="line">    <span class="keyword">for</span> package <span class="keyword">in</span> install_packages:</span><br><span class="line">        package_ctime = os.path.getctime(package.location)  <span class="comment"># package åˆ›å»ºæ—¶é—´</span></span><br><span class="line">        time_array = time.localtime(package_ctime)</span><br><span class="line">        strftime_package = time.strftime(<span class="string">&quot;%Y-%m-%d&quot;</span>, time_array)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> strftime_package &gt;= date:  <span class="comment"># è½¬æ¢ä¸º %Y-%m-%d ä¹‹åæ¯”è¾ƒå¤§å°</span></span><br><span class="line">            <span class="comment"># æ‰“å°å®‰è£…æ—¶é—´å’Œ package åç§°</span></span><br><span class="line">            print(time.strftime(<span class="string">&#x27;%Y-%m-%d-%H:%M:%S&#x27;</span>, time_array), package)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    specific_time = <span class="string">&#x27;2019-11-06&#x27;</span></span><br><span class="line">    get_after_date_packages(specific_time)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨çš„æ—¶å€™åªéœ€è¦å°†å¹´æœˆæ—¥ä»¥<code>%Y-%m-%d</code>çš„æ ¼å¼ç»™å‡ºå°±å¯ä»¥æ‰“å°å‡ºè¯¥æ—¥æœŸä¹‹åå®‰è£…çš„åŒ…äº†ã€‚</p><p>å‘ç°ä¸€ä¸ªå¯ä»¥å¤„ç†<code>å¸è½½å‘½ä»¤çš„å¢å¼ºï¼Œèƒ½åˆ é™¤å¸è½½è½¯ä»¶åŒ…çš„æ‰€æœ‰ä¾èµ–å…³ç³»é—®é¢˜</code>çš„åŒ…ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pip install pef</span><br></pre></td></tr></table></figure><ul><li><a href="https://stackoverflow.com/questions/7915998/does-uninstalling-a-package-with-pip-also-remove-the-dependent-packages">remove a package plus unused dependencies.</a></li></ul><h2 id="ä¸¾ä¸€åä¸‰ï¼ŒLinux-ç¯å¢ƒä¸­çš„å‘¢"><a href="#ä¸¾ä¸€åä¸‰ï¼ŒLinux-ç¯å¢ƒä¸­çš„å‘¢" class="headerlink" title="ä¸¾ä¸€åä¸‰ï¼ŒLinux ç¯å¢ƒä¸­çš„å‘¢"></a>ä¸¾ä¸€åä¸‰ï¼ŒLinux ç¯å¢ƒä¸­çš„å‘¢</h2><ul><li><a href="https://www.ostechnix.com/list-installed-packages-sorted-installation-date-linux/">How To List Installed Packages Sorted By Installation Date In Linux</a></li><li><a href="https://askubuntu.com/questions/548683/how-can-one-remove-all-packages-installed-after-a-certain-date-time">How can one remove all packages installed after a certain date/time?</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> å·¥ä½œæ—¥å¸¸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> pip </tag>
            
            <tag> åŒ…ç®¡ç† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ping æŸä¸ªåŸŸåçš„è¯¦ç»†è¿‡ç¨‹</title>
      <link href="blog/2019-11-19/the-detail-of-ping-a-domain/"/>
      <url>blog/2019-11-19/the-detail-of-ping-a-domain/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h2 id="ICMP-åè®®"><a href="#ICMP-åè®®" class="headerlink" title="ICMP åè®®"></a>ICMP åè®®</h2><p>ICMPï¼ˆInternet Control Message Protocol | <em>ç½‘ç»œæ§åˆ¶æ¶ˆæ¯åè®®</em>ï¼‰æ˜¯ TCP/IP åè®®æ—çš„ä¸€ä¸ªå­åè®®ï¼Œå·¥ä½œåœ¨ç½‘ç»œäº’è”å±‚ï¼ˆ<em>ç½‘ç»œå±‚</em>ï¼‰ã€‚ICMP åè®®æ˜¯ä¸€ç§é¢å‘æ— è¿æ¥çš„åè®®ï¼Œç”¨äºåœ¨ IP ä¸»æœºã€è·¯ç”±å™¨ä¹‹é—´ä¼ é€’å‡ºé”™æŠ¥å‘Šæ§åˆ¶ä¿¡æ¯ã€‚æ§åˆ¶æ¶ˆæ¯æ˜¯æŒ‡ç½‘ç»œæ˜¯å¦è¿é€šã€ä¸»æœºæ˜¯å¦å¯è¾¾ã€è·¯ç”±æ˜¯å¦å¯ç”¨ç­‰ç½‘ç»œæœ¬èº«çš„æ¶ˆæ¯ã€‚è¿™äº›æ§åˆ¶æ¶ˆæ¯è™½ç„¶å¹¶ä¸ä¼ è¾“ç”¨æˆ·æ•°æ®ï¼Œä½†æ˜¯å¯¹äºç”¨æˆ·æ•°æ®çš„ä¼ é€’èµ·ç€é‡è¦çš„ä½œç”¨ã€‚</p><h3 id="å¸¸è§æŠ¥æ–‡ç±»å‹"><a href="#å¸¸è§æŠ¥æ–‡ç±»å‹" class="headerlink" title="å¸¸è§æŠ¥æ–‡ç±»å‹"></a>å¸¸è§æŠ¥æ–‡ç±»å‹</h3><table><thead><tr><th>ICMP æ¶ˆæ¯ç±»å‹</th><th>ç”¨é€”è¯´æ˜</th></tr></thead><tbody><tr><td>å›æ˜¾è¯·æ±‚</td><td>Ping å·¥å…·é€šè¿‡å‘é€ ICMP å›æ˜¾æ¶ˆæ¯æ£€æŸ¥ç‰¹å®šèŠ‚ç‚¹çš„ IPv4 è¿æ¥ä»¥æ’æŸ¥ç½‘ç»œé—®é¢˜ã€‚ç±»å‹å€¼ä¸º 0</td></tr><tr><td>å›æ˜¾åº”ç­”</td><td>èŠ‚ç‚¹å‘é€å›æ˜¾ç­”å¤æ¶ˆæ¯å“åº” ICMP å›æ˜¾æ¶ˆæ¯ã€‚ç±»å‹å€¼ä¸º 8</td></tr><tr><td>é‡å®šå‘</td><td>è·¯ç”±å™¨å‘é€â€œé‡å®šå‘â€æ¶ˆæ¯ï¼Œå‘Šè¯‰å‘é€ä¸»æœºåˆ°ç›®æ ‡ IPv4 åœ°å€æ›´å¥½çš„è·¯ç”±ã€‚ç±»å‹å€¼ä¸º 5</td></tr><tr><td>æºæŠ‘åˆ¶</td><td>è·¯ç”±å™¨å‘é€â€œæºç»“æŸâ€æ¶ˆæ¯ï¼Œå‘Šè¯‰å‘é€ä¸»æœºå®ƒä»¬çš„ IPv4 æ•°æ®æŠ¥å°†è¢«ä¸¢å¼ƒâ€”â€”å› ä¸ºè·¯ç”±å™¨ä¸Šå‘ç”Ÿäº†æ‹¥å¡ã€‚äºæ˜¯ï¼Œå‘é€ä¸»æœºå°†ä»¥è¾ƒä½çš„é¢‘åº¦å‘é€æ•°æ®æŠ¥ã€‚ç±»å‹å€¼ä¸º 4</td></tr><tr><td>è¶…æ—¶</td><td>è¿™ä¸ªæ¶ˆæ¯æœ‰ä¸¤ç§ç”¨é€”ã€‚ç¬¬ä¸€ï¼Œå½“è¶…è¿‡ IP ç”Ÿå­˜æœŸæ—¶å‘å‘é€ç³»ç»Ÿå‘å‡ºé”™è¯¯ä¿¡æ¯ã€‚ç¬¬äºŒï¼Œå¦‚æœåˆ†æ®µçš„ IP æ•°æ®æŠ¥æ²¡æœ‰åœ¨æŸç§æœŸé™å†…é‡æ–°ç»„åˆï¼Œè¿™ä¸ªæ¶ˆæ¯å°†é€šçŸ¥å‘é€ç³»ç»Ÿã€‚ç±»å‹å€¼ä¸º 11</td></tr><tr><td>æ— æ³•åˆ°è¾¾ç›®æ ‡</td><td>è·¯ç”±å™¨å’Œç›®æ ‡ä¸»æœºå‘é€â€œæ— æ³•åˆ°è¾¾ç›®æ ‡â€æ¶ˆæ¯ï¼Œé€šçŸ¥å‘é€ä¸»æœºå®ƒä»¬çš„æ•°æ®æ— æ³•ä¼ é€ã€‚ç±»å‹å€¼ä¸º 3  </td></tr></tbody></table><p>å…¶ä¸­æ— æ³•åˆ°è¾¾ç›®æ ‡æ¶ˆæ¯ä¸­å¯ä»¥ç»†åˆ†ä¸ºä¸€ä¸‹å‡ é¡¹ï¼š</p><table><thead><tr><th>æ— æ³•åˆ°è¾¾ç›®æ ‡æ¶ˆæ¯</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>ä¸èƒ½è®¿é—®ä¸»æœº</td><td>è·¯ç”±å™¨æ‰¾ä¸åˆ°ç›®æ ‡çš„ IPv4 åœ°å€çš„è·¯ç”±æ—¶å‘é€â€œä¸èƒ½è®¿é—®ä¸»æœºâ€æ¶ˆæ¯</td></tr><tr><td>æ— æ³•è®¿é—®åè®®</td><td>ç›®æ ‡ IPv4 èŠ‚ç‚¹æ— æ³•å°† IPv4 æŠ¥å¤´ä¸­çš„â€œåè®®â€å­—æ®µä¸å½“å‰ä½¿ç”¨çš„ IPv4 å®¢æˆ·ç«¯åè®®ç›¸åŒ¹é…æ—¶ä¼šå‘é€â€œæ— æ³•è®¿é—®åè®®â€æ¶ˆæ¯</td></tr><tr><td>æ— æ³•è®¿é—®ç«¯å£</td><td>IPv4 èŠ‚ç‚¹åœ¨ UDP æŠ¥å¤´ä¸­çš„â€œç›®æ ‡ç«¯å£â€å­—æ®µä¸ä½¿ç”¨è¯¥ UDP ç«¯å£çš„åº”ç”¨ç¨‹åºç›¸åŒ¹é…æ—¶å‘é€â€œæ— æ³•è®¿é—®ç«¯å£â€æ¶ˆæ¯</td></tr><tr><td>éœ€è¦åˆ†æ®µä½†è®¾ç½®äº† DF</td><td>å½“å¿…é¡»åˆ†æ®µä½†å‘é€èŠ‚ç‚¹åœ¨ IPv4 æŠ¥å¤´ä¸­è®¾ç½®äº†â€œä¸åˆ†æ®µï¼ˆDFï¼‰â€æ ‡å¿—æ—¶ï¼ŒIPv4 è·¯ç”±å™¨ä¼šå‘é€â€œéœ€è¦åˆ†æ®µä½†è®¾ç½®äº† DFâ€æ¶ˆæ¯</td></tr></tbody></table><h2 id="åœ°å€è§£æåè®®-ARP"><a href="#åœ°å€è§£æåè®®-ARP" class="headerlink" title="åœ°å€è§£æåè®® ARP"></a>åœ°å€è§£æåè®® ARP</h2><p>æˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°è¿™æ ·çš„é—®é¢˜ï¼šå·²ç»çŸ¥é“äº†ä¸€ä¸ªä¸»æœºçš„ IP åœ°å€ï¼Œéœ€è¦æ‰¾åˆ°å…¶å¯¹åº”çš„ç‰©ç†åœ°å€ï¼ˆMAC <Media Access Controlï¼Œä»‹è´¨è®¿é—®æ§åˆ¶> ï¼‰ã€‚å› ä¸ºå°† IP æ•°æ®æŠ¥å°è£…åˆ° MAC å¸§é‡Œé¢çš„æ—¶å€™éœ€è¦çŸ¥é“ç›®çš„åœ°å€çš„ MAC åœ°å€ã€‚åœ°å€è§£æåè®® ARP çš„ä½œç”¨å°±æ˜¯æ ¹æ®ä¸»æœºçš„ IP åœ°å€æ¥è·å¾—ç‰©ç†åœ°å€ã€‚</p><p>æ¯ä¸ªä¸»æœºéƒ½è®¾æœ‰ä¸€ä¸ª ARP é«˜é€Ÿç¼“å­˜ï¼ˆARP cacheï¼‰ï¼Œè¿™é‡Œé¢æ”¾ç€çš„æ˜¯ä¸»æœºå·²ç»çŸ¥é“çš„ IP åœ°å€å’Œ MAC åœ°å€çš„æ˜ å°„è¡¨ï¼Œå¹¶ä¸”è¿™ä¸ªæ˜ å°„è¡¨è¿˜æ˜¯ç»å¸¸åŠ¨æ€æ›´æ–°çš„ã€‚</p><h3 id="Address-Resolution-Protocol-â€”â€”-ARP-çš„å·¥ä½œåŸç†"><a href="#Address-Resolution-Protocol-â€”â€”-ARP-çš„å·¥ä½œåŸç†" class="headerlink" title="Address Resolution Protocol â€”â€” ARP çš„å·¥ä½œåŸç†"></a>Address Resolution Protocol â€”â€” ARP çš„å·¥ä½œåŸç†</h3><p>å½“ä¸»æœº A æƒ³è¦åŒæœ¬å±€åŸŸç½‘ä¸Šçš„æŸä¸ªä¸»æœº B å‘é€ IP æ•°æ®æŠ¥æ—¶ï¼Œå°±å…ˆåœ¨å…¶ ARP é«˜é€Ÿç¼“å­˜ä¸­æŸ¥çœ‹æœ‰æ— ä¸»æœº B çš„ IP åœ°å€ã€‚å¦‚æœæœ‰ï¼Œå°±åœ¨ ARP é«˜é€Ÿç¼“å­˜ä¸­æŸ¥æ‰¾å…¶å¯¹åº”çš„ç¡¬ä»¶åœ°å€ï¼Œå†æŠŠè¿™ä¸ªç¡¬ä»¶åœ°å€å†™å…¥ MAC å¸§é‡Œï¼Œç„¶åé€šè¿‡å±€åŸŸç½‘æŠŠ MAC å¸§å‘å¾€æ­¤ç¡¬ä»¶åœ°å€ã€‚ä¹Ÿæœ‰å¯èƒ½åœ¨ ARP é«˜é€Ÿç¼“å­˜ä¸­æŸ¥ä¸åˆ°ä¸»æœº B çš„ IP åœ°å€ï¼ˆä¸»æœº A ç¼“å­˜ä¸ºç©ºï¼Œæˆ–ä¸»æœº B åˆšåŠ å…¥å±€åŸŸç½‘ï¼‰ï¼Œè¿™æ ·ä¹Ÿå°±æ— æ³•çŸ¥é“ä¸»æœº B çš„ MAC åœ°å€ï¼Œè¿™æ—¶å€™å°±éœ€è¦ä½¿ç”¨åˆ° ARP äº†ã€‚</p><p>æŒ‰ä»¥ä¸‹æ­¥éª¤æ¥è·å¾—ä¸»æœº B çš„ç¡¬ä»¶åœ°å€ã€‚</p><ol><li><p>ä¸»æœº A çš„ ARP è¿›ç¨‹åœ¨æœ¬å±€åŸŸç½‘ä¸Šä»¥å¹¿æ’­çš„å½¢å¼å‘é€ä¸€ä¸ª ARP è¯·æ±‚åˆ†ç»„ï¼Œæ ¼å¼å¦‚å›¾ a æ‰€ç¤ºã€‚</p>   <table>       <tbody>           <tr>               <td width="87">               <div><b>ä»¥å¤ªç½‘ç›®çš„</b><b>MAC</b></div>               </td>               <td width="82">               <div><b>ä»¥å¤ªç½‘æº</b><b>MAC</b></div>               </td>               <td width="41">               <div><b>å¸§ç±»å‹</b></div>               </td>               <td width="57">               <div><b>ç¡¬ä»¶ç±»å‹</b></div>               </td>               <td rowspan="2" width="24">               <div><b>4</b></div>               </td>               <td rowspan="2" width="24">               <div><b>6</b></div>               </td>               <td width="35">               <div><b>OP</b></div>               </td>               <td width="89">               <div><b>å‘é€ç«¯ä»¥å¤ªç½‘</b><b>MAC</b></div>               </td>               <td width="72">               <div><b>å‘é€ç«¯</b><b>IP</b><b>åœ°å€</b></div>               </td>               <td width="84">               <div><b>ç›®çš„</b><b>MAC</b></div>               </td>               <td width="48">               <div><b>ç›®çš„</b><b>IP</b></div>               </td>           </tr>           <tr>               <td width="87">               <div>FF-FF-FF-FF-FF-FF</div>               </td>               <td width="82">               <div>00-50-56-C0-00-01</div>               </td>               <td width="41">               <div>0806</div>               </td>               <td width="57">               <div>0800</div>               </td>               <td width="35">               <div>1</div>               </td>               <td width="89">               <div>00-50-56-C0-00-01</div>               </td>               <td width="72">               <div>1.1.1.1</div>               </td>               <td width="84">               <div>00-00-00-00-00-00</div>               </td>               <td width="48">               <div>1.1.1.3</div>               </td>           </tr>       </tbody>   </table>   <p>å…¶ä¸­ OP å«ä¹‰å¯é€‰ä¸ºï¼š1:è¡¨ç¤º ARP è¯·æ±‚ 2:è¡¨ç¤º ARP åº”ç­” 3:è¡¨ç¤º RARP è¯·æ±‚ 4:è¡¨ç¤º RARP åº”ç­”ã€‚<br>æ›´å¤šå…³äº ARP æŠ¥æ–‡å‚è€ƒè¯¥æ–‡<a href="https://blog.csdn.net/u011784495/article/details/71716586">ARP åè®®æŠ¥æ–‡æ ¼å¼åŠ ARP è¡¨_changsoon-CSDN åšå®¢_arp æŠ¥æ–‡æ ¼å¼</a></p></li><li><p>åœ¨æœ¬å±€åŸŸç½‘ä¸Šçš„æ‰€æœ‰ä¸»æœºä¸Šè¿è¡Œçš„ ARP è¿›ç¨‹éƒ½æ”¶åˆ°äº†è¿™ä¸ª ARP è¯·æ±‚åˆ†ç»„ã€‚</p></li><li><p>ä¸»æœº B åœ¨ ARP è¯·æ±‚åˆ†ç»„ä¸­å‘ç°äº†è‡ªå·±çš„ IP åœ°å€ï¼Œå°±å‘ A ä¸»æœºå‘é€ ARP å“åº”åˆ†ç»„ï¼Œä»¥å•æ’­çš„å½¢å¼ç›´æ¥å‘ç»™ Aï¼Œä»¥å¦‚å›¾ b æ‰€ç¤ºã€‚åŒæ—¶ä¸»æœº B çŸ¥é“äº† A çš„ IP åœ°å€å’Œ MAC åœ°å€ï¼Œå°±å°†ä¸»æœº A çš„ IP åœ°å€å’Œ MAC åœ°å€å†™å…¥ ARP é«˜é€Ÿç¼“å­˜ä¸­ï¼Œå¹¶æŒ‰åŒæ ·çš„ ARP æŠ¥æ–‡æ ¼å¼è¿”å›ç»™ä¸»æœº Aã€‚å…¶ä»–ä¸»æœºåœ¨å¯¹æ¯” IP åœ°å€ä¹‹åï¼Œå‘ç°ä¸è‡ªå·±çš„ IP åœ°å€ä¸åŒï¼Œå°±ä¸¢æ‰åˆ†ç»„ã€‚</p>   <table border="1" cellspacing="0" cellpadding="0">       <tbody>           <tr>               <td width="124">               <div align="center"><b>ç›®çš„åœ°å€</b></div>               </td>               <td width="124">               <div align="center"><b>æºåœ°å€</b></div>               </td>               <td rowspan="2" width="63">               <div align="center"><b>â€¦</b></div>               </td>               <td width="63">               <div align="center"><b>æº</b><b>IP</b></div>               </td>               <td width="64">               <div align="center"><b>ç›®çš„</b><b>IP</b></div>               </td>               <td rowspan="2" width="63">               <div align="center"><b>â€¦</b></div>               </td>               <td width="67">               <div align="center"><b>ICMP</b><b>æŠ¥æ–‡</b></div>               </td>           </tr>           <tr>               <td width="124">               <div align="center">00-50-56-C0-00-03</div>               </td>               <td width="124">               <div align="center">00-50-56-C0-00-01</div>               </td>               <td width="63">               <div align="center">1.1.1.1</div>               </td>               <td width="64">               <div align="center">1.1.1.3</div>               </td>               <td width="67">               <div align="center">Echo request</div>               </td>           </tr>       </tbody>   </table>   </li><li><p>ä¸»æœº A æ”¶åˆ°ä¸»æœº B çš„ ARP å“åº”åˆ†ç»„ä¹‹åï¼Œè¿™æ ·å°±çŸ¥é“äº†ä¸»æœº B çš„ MAC åœ°å€ï¼ŒåŒæ—¶æŠŠä¸»æœº B çš„ IP åœ°å€å’Œ MAC åœ°å€å†™å…¥ ARP é«˜é€Ÿç¼“å­˜ï¼Œç„¶åå°±æŠŠè¿™ä¸ª MAC å°è£…åˆ° ICMP åè®®çš„äºŒå±‚æŠ¥æ–‡ä¸­å‘ä¸»æœº B å‘é€ã€‚</p>   <table border="1" cellspacing="0" cellpadding="0">       <tbody>           <tr>               <td width="124">               <div align="center"><b>ç›®çš„åœ°å€</b></div>               </td>               <td width="124">               <div align="center"><b>æºåœ°å€</b></div>               </td>               <td rowspan="2" width="63">               <div align="center"><b>â€¦</b></div>               </td>               <td width="63">               <div align="center"><b>æº</b><b>IP</b></div>               </td>               <td width="64">               <div align="center"><b>ç›®çš„</b><b>IP</b></div>               </td>               <td rowspan="2" width="63">               <div align="center"><b>â€¦</b></div>               </td>               <td width="67">               <div align="center"><b>ICMP</b><b>æŠ¥æ–‡</b></div>               </td>           </tr>           <tr>               <td width="124">               <div align="center">00-50-56-C0-00-03</div>               </td>               <td width="124">               <div align="center">00-50-56-C0-00-01</div>               </td>               <td width="63">               <div align="center">1.1.1.1</div>               </td>               <td width="64">               <div align="center">1.1.1.3</div>               </td>               <td width="67">               <div align="center">Echo request</div>               </td>           </tr>       </tbody>   </table>   </li><li><p>å½“ä¸»æœº B æ”¶åˆ°äº†è¿™ä¸ªæŠ¥æ–‡åï¼Œå‘ç°æ˜¯ä¸»æœº A çš„ ICPM å›æ˜¾è¯·æ±‚ï¼Œå°±æŒ‰åŒæ ·çš„æ ¼å¼ï¼Œè¿”å›ä¸€ä¸ªå€¼ç»™ä¸»æœº Aï¼Œè¿™æ ·å°±å®Œæˆäº†åŒä¸€ç½‘æ®µå†…çš„ ping è¿‡ç¨‹ã€‚</p>   <table border="1" cellspacing="0" cellpadding="0" align="left">       <tbody>           <tr>               <td width="124">               <div align="center"><b>ç›®çš„åœ°å€</b></div>               </td>               <td width="124">               <div align="center"><b>æºåœ°å€</b></div>               </td>               <td rowspan="2" width="63">               <div align="center"><b>â€¦</b></div>               </td>               <td width="63">               <div align="center"><b>æº</b><b>IP</b></div>               </td>               <td width="64">               <div align="center"><b>ç›®çš„</b><b>IP</b></div>               </td>               <td rowspan="2" width="63">               <div align="center"><b>â€¦</b></div>               </td>               <td width="67">               <div align="center"><b>ICMP</b><b>æŠ¥æ–‡</b></div>               </td>           </tr>           <tr>               <td width="124">               <div align="center">00-50-56-C0-00-01</div>               </td>               <td width="124">               <div align="center">00-50-56-C0-00-03</div>               </td>               <td width="63">               <div align="center">1.1.1.3</div>               </td>               <td width="64">               <div align="center">1.1.1.1</div>               </td>               <td width="67">               <div align="center">Echo answer</div>               </td>           </tr>       </tbody>   </table>   â€‹</li></ol><p><img src= "/img/loading.svg" data-lazy-src="/images/ARP.jpg" alt="ARPå·¥ä½œåŸç†"></p><p>ä¸Šé¢æ‰€æè¿°çš„æƒ…å†µæ˜¯åœ¨<strong>åŒä¸€å±€åŸŸç½‘</strong>ä¸‹çš„æƒ…æ™¯ï¼Œå¦‚æœä¸»æœº A è¦å’Œä¸åœ¨åŒä¸€å±€åŸŸç½‘ä¸‹çš„ä¸»æœº B è¿›è¡Œé€šä¿¡ï¼Œå‘é€ IP æ•°æ®æŠ¥ã€‚é¦–å…ˆä¸»æœº A å°†ä¸»æœº B çš„ IP åœ°å€åŒè‡ªå·±çš„å­ç½‘æ©ç è¿›è¡Œæ¯”å¯¹ï¼Œå‘ç°ä¸åœ¨åŒä¸€å±€åŸŸç½‘å†…ï¼Œåˆ™åˆ©ç”¨ ARP è¯·æ±‚åˆ†ç»„ï¼Œè·Ÿæœ¬å±€åŸŸç½‘ä¸Šçš„è·¯ç”±å™¨çš„ IP åœ°å€æ¥è·å–è·¯ç”±å™¨çš„ MAC åœ°å€ï¼Œç„¶åå°†å‰©ä¸‹çš„å·¥ä½œäº¤ç»™è·¯ç”±å™¨å»åšå³å¯ã€‚</p><h3 id="ARP-çš„å››ç§å…¸å‹æƒ…å†µ"><a href="#ARP-çš„å››ç§å…¸å‹æƒ…å†µ" class="headerlink" title="ARP çš„å››ç§å…¸å‹æƒ…å†µ"></a>ARP çš„å››ç§å…¸å‹æƒ…å†µ</h3><ol><li><p>å‘é€æ–¹æ˜¯ä¸»æœºï¼Œè¦æŠŠ IP æ•°æ®æŠ¥å‘é€åˆ°æœ¬ç½‘ç»œä¸Šçš„å¦ä¸€ä¸ªä¸»æœºã€‚è¿™æ—¶åˆ©ç”¨ ARP æ‰¾åˆ°ç›®çš„ä¸»æœºçš„ç¡¬ä»¶åœ°å€ã€‚</p></li><li><p>å‘é€æ–¹æ˜¯ä¸»æœºï¼Œè¦æŠŠ IP æ•°æ®æŠ¥å‘é€åˆ°å¦ä¸€ä¸ªç½‘ç»œä¸Šçš„ä¸€ä¸ªä¸»æœºã€‚è¿™æ—¶åˆ©ç”¨ ARP æ‰¾åˆ°æœ¬ç½‘ç»œä¸Šçš„ä¸€ä¸ªè·¯ç”±å™¨çš„ç¡¬ä»¶åœ°å€ï¼Œç„¶åæŠŠå‰©ä¸‹çš„å·¥ä½œäº¤ç»™è·¯ç”±å™¨å»å®Œæˆã€‚</p></li><li><p>å‘é€æ–¹æ˜¯è·¯ç”±å™¨ï¼Œè¦æŠŠ IP æ•°æ®æŠ¥å‘é€åˆ°å¦ä¸€ä¸ªç½‘ç»œä¸Šçš„ä¸€ä¸ªä¸»æœºã€‚è¿™æ—¶åˆ©ç”¨ ARP æ‰¾åˆ°æœ¬ç½‘ç»œä¸Šçš„å¦ä¸€ä¸ªè·¯ç”±å™¨çš„ç¡¬ä»¶åœ°å€ï¼Œç„¶åæŠŠå‰©ä¸‹çš„å·¥ä½œäº¤ç»™è¿™ä¸ªè·¯ç”±å™¨å»å®Œæˆã€‚</p></li><li><p>å‘é€æ–¹æ˜¯è·¯ç”±å™¨ï¼Œè¦æŠŠ IP æ•°æ®æŠ¥å‘é€åˆ°æœ¬ç½‘ç»œä¸Šçš„ä¸€ä¸ªä¸»æœºã€‚è¿™æ—¶åˆ©ç”¨ ARP æ‰¾åˆ°ç›®çš„ä¸»æœºçš„ç¡¬ä»¶åœ°å€ã€‚</p></li></ol><h2 id="ping-æŸä¸ªåŸŸåçš„æ•´ä¸ªè¿‡ç¨‹"><a href="#ping-æŸä¸ªåŸŸåçš„æ•´ä¸ªè¿‡ç¨‹" class="headerlink" title="ping æŸä¸ªåŸŸåçš„æ•´ä¸ªè¿‡ç¨‹"></a>ping æŸä¸ªåŸŸåçš„æ•´ä¸ªè¿‡ç¨‹</h2><p><strong>PING æ˜¯åº”ç”¨å±‚ç›´æ¥ä½¿ç”¨ç½‘ç»œå±‚ ICMP çš„ä¸€ä¸ªä¾‹å­ï¼Œæ²¡æœ‰ç»è¿‡ä¼ è¾“å±‚çš„ TCP æˆ– UDPã€‚</strong></p><ol><li><p>ä¸»æœºæŸ¥æ‰¾æœ¬åœ°ç³»ç»Ÿ hosts æ–‡ä»¶çš„ DNS ç¼“å­˜ï¼Œå¦‚æœå­˜åœ¨è¯¥åŸŸåå¯¹åº”çš„ IPï¼Œåˆ™è·å– IPï¼Œè·³è½¬åˆ°ç¬¬ 8 æ­¥ï¼›å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™ç»§ç»­ã€‚</p></li><li><p>ä¸»æœºå‘æœ¬ç½‘ç»œè·¯ç”±å™¨å‘èµ·è¯·æ±‚ï¼ŒæŸ¥æ‰¾è·¯ç”± DNS ç¼“å­˜ï¼Œå¦‚æœå­˜åœ¨è¯¥åŸŸåå¯¹äºçš„ IPï¼Œåˆ™è·å– IPï¼Œè·³è½¬åˆ°ç¬¬ 8 æ­¥ï¼›å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™ç»§ç»­ã€‚</p></li><li><p>è·¯ç”±å™¨å‘æœ¬åœ° ISPï¼ˆäº’è”ç½‘æä¾›å•†ï¼‰çš„ DNS æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼ŒæŸ¥æ‰¾ DNS æœåŠ¡å™¨çš„ç¼“å­˜ï¼Œå¦‚æœå­˜åœ¨è¯¥åŸŸåå¯¹åº”çš„ IPï¼Œåˆ™è·³è½¬åˆ°ç¬¬ 7 æ­¥ï¼›å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™ç»§ç»­ã€‚</p></li><li><p>æœ¬åœ° DNS æœåŠ¡å™¨å‘æ ¹åŸŸåæœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼Œæ ¹åŸŸåæœåŠ¡å™¨å‘Šè¯‰æœ¬åœ°æœåŠ¡å™¨ï¼Œä¸‹ä¸€æ¬¡åº”æŸ¥è¯¢çš„é¡¶çº§åŸŸåæœåŠ¡å™¨ dns.com çš„ IP åœ°å€ã€‚</p></li><li><p>æœ¬åœ°åŸŸåæœåŠ¡å™¨å‘é¡¶çº§åŸŸåæœåŠ¡å™¨ dns.com è¿›è¡ŒæŸ¥è¯¢ï¼Œé¡¶çº§åŸŸåæœåŠ¡å™¨ dns.com å‘Šè¯‰æœ¬åœ°åŸŸåæœåŠ¡å™¨ï¼Œä¸‹ä¸€æ­¥åº”æŸ¥è¯¢çš„æƒé™æœåŠ¡å™¨ dns.abc.com çš„ IP åœ°å€ã€‚</p></li><li><p>æœ¬åœ°åŸŸåæœåŠ¡å™¨å‘æƒé™åŸŸåæœåŠ¡å™¨ dns.abc.com è¿›è¡ŒæŸ¥è¯¢ï¼Œæƒé™åŸŸåæœåŠ¡å™¨ dns.abc.com å‘Šè¯‰æœ¬åœ°åŸŸåæœåŠ¡å™¨ï¼Œæ‰€æŸ¥è¯¢çš„ä¸»æœºçš„ IP åœ°å€ã€‚ </p></li><li><p>æœ¬åœ°åŸŸåæœåŠ¡å™¨æœ€åæŠŠæŸ¥è¯¢ç»“æœâ€”â€”è¯¥åŸŸåå¯¹åº”çš„ IP åœ°å€å‘Šè¯‰ç»™ä¸»æœºã€‚</p></li><li><p>è‡³æ­¤ï¼Œä¸»æœºçŸ¥é“äº†è¯¥åŸŸåçš„ IP åœ°å€ã€‚</p><hr><p> <em>ä»¥ä¸Šéƒ¨åˆ†ä¸»è¦æ˜¯æ ¹æ®åŸŸåè·å–å¯¹åº”çš„ IP åœ°å€ï¼Œæ¶‰åŠ DNS è§£æ</em></p></li><li><p>ä¸»æœºé€šè¿‡å­ç½‘æ©ç åˆ¤æ–­è¯¥ IP åœ°å€æ˜¯æœ¬ç½‘æ®µè¿˜æ˜¯è·¨ç½‘æ®µï¼Œç”±äºæœ¬ç½‘æ®µæ¯”è¾ƒç®€å•ï¼Œæˆ‘ä»¬ä»¥è·¨ç½‘æ®µè¿›è¡Œè®²è§£ã€‚</p></li><li><p>ä¸»æœºå…ˆæŸ¥çœ‹æœ¬åœ° ARP é«˜é€Ÿç¼“å­˜ï¼ŒæŸ¥çœ‹è¡¨ä¸­æ˜¯å¦æœ‰æœ¬ç½‘ç»œè·¯ç”±å™¨ï¼ˆç½‘å…³ï¼‰çš„ MAC åœ°å€ï¼Œå¦‚æœæœ‰ï¼Œåˆ™è·å– MAC åœ°å€ï¼Œè·³è½¬åˆ°ç¬¬ 12 æ­¥ï¼›å¦‚æœæ²¡æœ‰ï¼Œåˆ™ç»§ç»­ã€‚</p></li><li><p>ä¸»æœºä½¿ç”¨ ARP è§£æåè®®è·å–åˆ°æœ¬ç½‘æ®µè·¯ç”±çš„ MAC åœ°å€ã€‚</p></li><li><p>è‡³æ­¤ï¼Œä¸»æœºçŸ¥é“æœ¬ç½‘ç»œä¸€ä¸ªè·¯ç”±çš„ MAC åœ°å€ã€‚</p><hr><p><em>ä»¥ä¸Šéƒ¨åˆ†ä¸»è¦æ˜¯è·å–æœ¬ç½‘ç»œä¸€ä¸ªè·¯ç”±çš„ MAC åœ°å€ï¼Œæ¶‰åŠ ARP</em></p></li><li><p>ä¸»æœºå°† ICMP æŠ¥æ–‡å°è£…æˆ IP æ•°æ®æŠ¥ï¼ŒIP æ•°æ®æŠ¥çš„æºåœ°å€ä¸ºä¸»æœºçš„ IP åœ°å€ï¼Œç›®çš„åœ°å€æ˜¯åŸŸåå¯¹åº”çš„ IP åœ°å€ï¼›</p></li><li><p>ä¸»æœºå°† IP æ•°æ®æŠ¥å°è£…æˆ MAC å¸§ï¼ŒMAC å¸§çš„æºåœ°å€ä¸ºä¸»æœºçš„ MAC åœ°å€ï¼Œç›®çš„åœ°å€æ˜¯è·¯ç”±å™¨çš„ MAC åœ°å€ï¼›</p></li><li><p>è·¯ç”±å™¨æ¥æ”¶åˆ° ICMP æŠ¥æ–‡ä¹‹åï¼Œå‘ç° MAC å¸§çš„ç›®çš„åœ°å€æ˜¯è‡ªå·±ï¼ŒIP åœ°å€æ˜¯ä¸»æœºæƒ³è¦è®¿é—®çš„ IP åœ°å€ï¼Œåˆ™å°† MAC å¸§çš„æºåœ°å€æ”¹ä¸ºè‡ªå·±çš„ MAC åœ°å€ï¼Œç›®çš„åœ°å€æ”¹ä¸ºæœ¬ç½‘æ®µå¦ä¸€ä¸ªè·¯ç”±çš„ MAC åœ°å€ï¼ˆä¹Ÿè¦é€šè¿‡ ARP åè®®è·å–ï¼‰ï¼Œè½¬å‘ä¸‹å»ã€‚</p></li><li><p>ç›´åˆ°æœ€åä¸€ä¸ªè·¯ç”±æ ¹æ® ARP åè®®ï¼Œæ‰¾åˆ°äº†ä¸»æœºæƒ³è¦è®¿é—®çš„ IP åœ°å€å¯¹åº”çš„ä¸»æœºçš„ MAC åœ°å€ï¼Œç„¶åå°† ICMP æŠ¥æ–‡å°è£…æˆ MAC å¸§å‘é€ç»™è¯¥åŸŸåä¸»æœºã€‚</p></li><li><p>ç”±äº ARP åè®®å…·æœ‰ç›¸äº’å­¦ä¹ æ€§ï¼ŒåŸŸåä¸»æœºæ¥æ”¶åˆ°ä¸»æœºå‘é€çš„ ICMP å›é€è¯·æ±‚æŠ¥æ–‡ä¹‹åï¼Œå°†å‘æœ¬ç½‘ç»œè·¯ç”±å‘é€ ICMP å›é€å›ç­”æŠ¥æ–‡ï¼Œè¯¥è·¯ç”±åˆä¼šè½¬å‘ä¸‹å»ã€‚</p></li><li><p>å½“ä¸»æœºæ”¶åˆ°åŸŸåä¸»æœºå‘é€çš„ ICMP å›é€å›ç­”æŠ¥æ–‡ä¹‹åï¼Œè¿™æ ·å°±è¡¨æ˜è¯¥ä¸»æœºåˆ°åŸŸåä¸»æœºæ˜¯è¿é€šå¯è¾¾çš„ã€‚</p></li></ol><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://blog.csdn.net/guoweimelon/article/details/50865642">ping æŸä¸ªåŸŸåçš„è¯¦ç»†è¿‡ç¨‹</a><br><a href="https://blog.51cto.com/wanicy/335207">ping è¿‡ç¨‹è¯¦è§£</a><br><a href="http://www.firewall.cx/networking-topics/routing/181-routing-process.html">THE IP ROUTING PROCESS - STEP-BY-STEP ANALYSIS</a><br><a href="https://www.jianshu.com/p/65710069d934">ç†è§£ ARP åè®®</a><br><a href="https://cizixs.com/2017/07/31/arp-protocol/">ARP åè®®è§£æ</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> ç½‘ç»œ </tag>
            
            <tag> TCP/IP </tag>
            
            <tag> è½¬è½½ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å®‰è£… Python3 æç¤ºæ‰¾ä¸åˆ° _ctypes æ¨¡å—</title>
      <link href="blog/2019-11-12/no-module-named-ctypes/"/>
      <url>blog/2019-11-12/no-module-named-ctypes/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><p>ä»Šå¤©åœ¨è™šæ‹Ÿæœºå®‰è£… Python3 çš„æ—¶å€™é‡åˆ°ä¸‹é¢çš„æŠ¥é”™ï¼š<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">File <span class="string">&quot;/usr/local/lib/python3.7/multiprocessing/sharedctypes.py&quot;</span>, line 10, <span class="keyword">in</span> &lt;</span><br><span class="line">module&gt;</span><br><span class="line">   import ctypes</span><br><span class="line">   File <span class="string">&quot;/usr/local/lib/python3.7/ctypes/__init__.py&quot;</span>, line 7, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">      from _ctypes import Union, Structure, Array</span><br><span class="line">ImportError: No module named <span class="string">&#x27;_ctypes&#x27;</span></span><br></pre></td></tr></table></figure></p><h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> RHEL/Fedora/CentOS</span></span><br><span class="line">sudo yum install libffi-devel</span><br><span class="line">---</span><br><span class="line"><span class="meta">#</span><span class="bash"> Debian/Ubuntu:</span></span><br><span class="line">sudo apt-get install libffi-dev</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://stackoverflow.com/questions/27022373/python3-importerror-no-module-named-ctypes-when-using-value-from-module-mul">ImportError: No module named â€˜_ctypesâ€™</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®°ä¸€æ¬¡ MySQL å†…å­˜ä¸è¶³é”™è¯¯</title>
      <link href="blog/2019-11-05/mysqld-out-of-memory/"/>
      <url>blog/2019-11-05/mysqld-out-of-memory/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h2 id="ç¼˜èµ·"><a href="#ç¼˜èµ·" class="headerlink" title="ç¼˜èµ·"></a>ç¼˜èµ·</h2><p>ä»Šå¤©åœ¨è®¿é—®åšå®¢çš„æ—¶å€™ï¼Œç™»å½•é¦–é¡µå‘ç°æ— æ³•æ­£å¸¸åŠ è½½åšæ–‡ã€‚å› ä¸ºä¹‹å‰ä¹Ÿå‡ºç°è¿‡è¿™ç§é”™è¯¯ï¼Œæ€€ç–‘è¿˜æ˜¯å› ä¸ºæ•°æ®åº“çš„é—®é¢˜ï¼Œæ‰€ä»¥æœæ–­æŸ¥çœ‹ MySQL æ—¥å¿—ï¼š<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vi /var/<span class="built_in">log</span>/mariadb/mariadb.log </span><br></pre></td></tr></table></figure><br>gg æ‰“åˆ°æ–‡ä»¶æœ€åï¼Œåˆ†ææ—¥å¿—ï¼š<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">191104 17:48:04 mysqld_safe Number of processes running now: 0</span><br><span class="line">191104 17:48:05 mysqld_safe mysqld restarted</span><br><span class="line">191104 17:48:05 [Note] &#x2F;usr&#x2F;libexec&#x2F;mysqld (mysqld 5.5.64-MariaDB) starting as process 11169 ...</span><br><span class="line">191104 17:48:05 InnoDB: The InnoDB memory heap is disabled</span><br><span class="line">191104 17:48:05 InnoDB: Mutexes and rw_locks use GCC atomic builtins</span><br><span class="line">191104 17:48:05 InnoDB: Compressed tables use zlib 1.2.7</span><br><span class="line">191104 17:48:05 InnoDB: Using Linux native AIO</span><br><span class="line">191104 17:48:05 InnoDB: Initializing buffer pool, size &#x3D; 128.0M</span><br><span class="line">InnoDB: mmap(137756672 bytes) failed; errno 12</span><br><span class="line">191104 17:48:05 InnoDB: Completed initialization of buffer pool</span><br><span class="line">191104 17:48:05 InnoDB: Fatal error: cannot allocate memory for the buffer pool</span><br><span class="line">**é”™è¯¯ä¿¡æ¯ä»æ­¤è¡Œå¼€å§‹**</span><br><span class="line">191104 17:48:05 [ERROR] Plugin &#39;InnoDB&#39; init function returned error.</span><br><span class="line">191104 17:48:05 [ERROR] Plugin &#39;InnoDB&#39; registration as a STORAGE ENGINE failed.</span><br><span class="line">191104 17:48:05 [ERROR] mysqld: Out of memory (Needed 128917504 bytes)</span><br><span class="line">191104 17:48:05 [Note] Plugin &#39;FEEDBACK&#39; is disabled.</span><br><span class="line">191104 17:48:05 [ERROR] Unknown&#x2F;unsupported storage engine: InnoDB</span><br><span class="line">191104 17:48:05 [ERROR] Aborting</span><br><span class="line"></span><br><span class="line">191104 17:48:05 [Note] &#x2F;usr&#x2F;libexec&#x2F;mysqld: Shutdown complete</span><br><span class="line">**æœåŠ¡åœæ­¢**</span><br><span class="line">191104 17:48:05 mysqld_safe mysqld from pid file &#x2F;var&#x2F;run&#x2F;mariadb&#x2F;mariadb.pid ended</span><br></pre></td></tr></table></figure><br>ç¡®è®¤æ˜¯ MySQL æœåŠ¡çš„é—®é¢˜ï¼Œé¦–å…ˆæ‰‹åŠ¨æŠŠ MySQL å¯åŠ¨èµ·æ¥ï¼Œä¿è¯åº”ç”¨æ­£å¸¸ä½¿ç”¨ï¼š<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">systemctl restart mariadb</span><br></pre></td></tr></table></figure><br>ä¹‹åæœåŠ¡æ¢å¤æ­£å¸¸</p><h2 id="å¢åŠ -swap-åˆ†åŒº"><a href="#å¢åŠ -swap-åˆ†åŒº" class="headerlink" title="å¢åŠ  swap åˆ†åŒº"></a>å¢åŠ  swap åˆ†åŒº</h2><div class="note warning modern"><p>ä½¿ç”¨ swap å¿…é¡»è¦çŸ¥é“å®ƒå­˜åœ¨çš„ç¼ºç‚¹ï¼Œä»¥ä¾¿åˆ¤æ–­ä½•æ—¶ä½¿ç”¨äº¤æ¢åˆ†åŒºã€‚<br>ä½¿ç”¨äº¤æ¢åˆ†åŒºçš„å¥½å¤„æ˜¯å¯ä»¥ä¸€å®šç¨‹åº¦çš„ç¼“è§£å†…å­˜ç©ºé—´ç´§å¼ çš„é—®é¢˜ã€‚<br>ç„¶è€Œï¼Œç”±äº CPU æ‰€è¯»å–çš„æ•°æ®éƒ½æ¥è‡ªäºå†…å­˜ï¼Œè€Œäº¤æ¢åˆ†åŒºåˆ™æ˜¯å­˜æ”¾åœ¨ç£ç›˜ä¸Šçš„ï¼Œç£ç›˜çš„é€Ÿåº¦å’Œå†…å­˜æ¯”è¾ƒèµ·æ¥æ…¢äº†å¥½å‡ ä¸ªæ•°é‡çº§ï¼Œå¦‚æœä¸åœçš„è¯»å†™ swapï¼Œé‚£ä¹ˆå¯¹ç³»ç»Ÿçš„æ€§èƒ½è‚¯å®šæœ‰å½±å“ï¼Œå°¤å…¶æ˜¯å½“ç³»ç»Ÿå†…å­˜å¾ˆåƒç´§çš„æ—¶å€™ï¼Œè¯»å†™ swap ç©ºé—´å‘ç”Ÿçš„é¢‘ç‡ä¼šå¾ˆé«˜ï¼Œå¯¼è‡´ç³»ç»Ÿè¿è¡Œå¾ˆæ…¢ã€‚</p></div><p>å› ä¸ºæœ¬èº«å†…å­˜å¾ˆå°åªæœ‰ 1Gï¼Œè€Œ 5.6ï¼ˆï¼Ÿï¼‰ä¹‹åé»˜è®¤ä½¿ç”¨ innodb å¼•æ“ï¼Œè¿™ä¸ªå¼•æ“åˆå¾ˆæ¶ˆè€—å†…å­˜ã€‚æ‰€ä»¥æœ€å¥½çš„åŠæ³•æ˜¯ä½¿ç”¨å¤§å†…å­˜æˆ–è€…å°† MySQL é™çº§åˆ°ä¸€ä¸ªåˆé€‚çš„ç‰ˆæœ¬ï¼Œä½†æ˜¯ï¼Œå¦‚æœä¸æ˜¯çœŸçš„å–œæ¬¢ï¼Œè°æ„¿æ„åšä¸€æ¡èˆ”ç‹—å‘¢ï¼Ÿå¦‚æœä¸æ˜¯æ²¡é’±ï¼Œè°æ„¿æ„ç”¨ä½é…æœåŠ¡å™¨å‘¢ã€‚æ‰€ä»¥ï¼Œé€€è€Œæ±‚å…¶æ¬¡çš„åŠæ³•å°±æ˜¯å¢åŠ ä¸€ä¸ª swap åˆ†åŒºï¼Œåœ¨å†…å­˜ä¸è¶³æ—¶ï¼Œä½¿ç”¨ swap åˆ†åŒºã€‚<br>æ¥ä¸‹æ¥è®°å½•åˆ›å»ºä¸€ä¸ª 1024M çš„ swap åˆ†åŒºçš„åŠæ³•ã€‚<br><div class="note info modern"><p><strong>æ›´æ–°</strong><br>äº¤æ¢åˆ†åŒºå¤§å°çš„è®¾ç½®å»ºè®®å€¼ï¼š<br>å†…å­˜å°äº 4GB æ—¶ï¼Œæ¨èä¸å°‘äº 2GB çš„ swap ç©ºé—´<br>å†…å­˜ 4GB~16GBï¼Œæ¨èä¸å°‘äº 4GB çš„ swap ç©ºé—´</p></div></p><h3 id="åˆ›å»º-swap-æ–‡ä»¶"><a href="#åˆ›å»º-swap-æ–‡ä»¶" class="headerlink" title="åˆ›å»º swap æ–‡ä»¶"></a>åˆ›å»º swap æ–‡ä»¶</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dd <span class="keyword">if</span>=/dev/zero of=/swapfile bs=1024 of=1048576 <span class="comment"># 1024*1024</span></span><br></pre></td></tr></table></figure><h3 id="é…ç½®-swap-æ–‡ä»¶"><a href="#é…ç½®-swap-æ–‡ä»¶" class="headerlink" title="é…ç½® swap æ–‡ä»¶"></a>é…ç½® swap æ–‡ä»¶</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkswap /swapfile</span><br></pre></td></tr></table></figure><h3 id="ç«‹å³å¯ç”¨-swap-æ–‡ä»¶"><a href="#ç«‹å³å¯ç”¨-swap-æ–‡ä»¶" class="headerlink" title="ç«‹å³å¯ç”¨ swap æ–‡ä»¶"></a>ç«‹å³å¯ç”¨ swap æ–‡ä»¶</h3><p>è€Œä¸æ˜¯é‡å¯ä¹‹åæ‰ç”Ÿæ•ˆ<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">swapon /swapfile</span><br></pre></td></tr></table></figure></p><h3 id="é…ç½®é‡å¯ç”Ÿæ•ˆ"><a href="#é…ç½®é‡å¯ç”Ÿæ•ˆ" class="headerlink" title="é…ç½®é‡å¯ç”Ÿæ•ˆ"></a>é…ç½®é‡å¯ç”Ÿæ•ˆ</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vi /etc/fstab</span><br></pre></td></tr></table></figure><p>æœ€åä¸€è¡Œè¿½åŠ <br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/swapfile       swap    swap defaults   0    0</span><br></pre></td></tr></table></figure></p><h3 id="éªŒè¯"><a href="#éªŒè¯" class="headerlink" title="éªŒè¯"></a>éªŒè¯</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@VM_0_16_centos imoyao]<span class="comment"># free -m</span></span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:            991         697          70           0         223         120</span><br><span class="line">Swap:          1023           0        1023</span><br><span class="line">[root@VM_0_16_centos imoyao]<span class="comment"># cat /proc/swaps </span></span><br><span class="line">FilenameTypeSizeUsedPriority</span><br><span class="line">/swapfile                               file1048572520-2</span><br></pre></td></tr></table></figure><p>å‚è€ƒ<a href="https://www.aimz8.com/?p=286">MariaDB åœ¨ä½é… VPS ä¸Šå´©æºƒé—®é¢˜å¤„ç†æ–¹æ¡ˆ</a></p><h2 id="è®¾ç½®-MySQL-è‡ªåŠ¨é‡å¯"><a href="#è®¾ç½®-MySQL-è‡ªåŠ¨é‡å¯" class="headerlink" title="è®¾ç½® MySQL è‡ªåŠ¨é‡å¯"></a>è®¾ç½® MySQL è‡ªåŠ¨é‡å¯</h2><h3 id="æ˜¯å¦è®¾ç½®-MySQL-æœåŠ¡-enable"><a href="#æ˜¯å¦è®¾ç½®-MySQL-æœåŠ¡-enable" class="headerlink" title="æ˜¯å¦è®¾ç½® MySQL æœåŠ¡ enable"></a>æ˜¯å¦è®¾ç½® MySQL æœåŠ¡ enable</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">systemctl is-enabled mariadb</span><br></pre></td></tr></table></figure><p>å¦‚æœè¿”å›ä¸æ˜¯<code>enabled</code>åˆ™ä½¿ç”¨å‘½ä»¤<code>systemctl enable mariadb</code>è¿›è¡Œä½¿èƒ½</p><h3 id="ç¼–è¾‘é…ç½®"><a href="#ç¼–è¾‘é…ç½®" class="headerlink" title="ç¼–è¾‘é…ç½®"></a>ç¼–è¾‘é…ç½®</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/etc/systemd/system/multi-user.target.wants/mariadb.service</span><br></pre></td></tr></table></figure><h3 id="ä¿®æ”¹é…ç½®"><a href="#ä¿®æ”¹é…ç½®" class="headerlink" title="ä¿®æ”¹é…ç½®"></a>ä¿®æ”¹é…ç½®</h3><p>åœ¨<code>Service</code>é…ç½®é¡¹ä¸­å¢åŠ å¦‚ä¸‹é…ç½®:<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># nu:30</span><br><span class="line">[Service]</span><br><span class="line">â€¦â€¦</span><br><span class="line">Restart&#x3D;always</span><br><span class="line">RestartSec&#x3D;3</span><br><span class="line">â€¦â€¦</span><br></pre></td></tr></table></figure></p><h3 id="é…ç½®ç”Ÿæ•ˆ"><a href="#é…ç½®ç”Ÿæ•ˆ" class="headerlink" title="é…ç½®ç”Ÿæ•ˆ"></a>é…ç½®ç”Ÿæ•ˆ</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># é‡æ–°å¯åŠ¨æ¥é‡å¯¼Systemdé…ç½®ï¼š</span></span><br><span class="line">sudo systemctl daemon-reload</span><br><span class="line"><span class="comment"># é‡æ–°å¯åŠ¨MariaDBæœåŠ¡</span></span><br><span class="line">systemctl restart mariadb</span><br></pre></td></tr></table></figure><p>å‚è§</p><ul><li><a href="https://www.codebye.com/how-to-config-centos7-mariadb-service-auto-start-after-reboot-or-crash.html">å¦‚ä½•é…ç½® CentOS7 mariadb æœåŠ¡åœ¨å´©æºƒæˆ–é‡å¯åè‡ªåŠ¨å¯åŠ¨</a>   </li><li><a href="http://chengms.com/?p=151">mariadb åœ¨ä½é… ECS ä¸Šå´©æºƒé—®é¢˜</a>  </li></ul><h2 id="ä¿®æ”¹-MySQL-é…ç½®"><a href="#ä¿®æ”¹-MySQL-é…ç½®" class="headerlink" title="ä¿®æ”¹ MySQL é…ç½®"></a>ä¿®æ”¹ MySQL é…ç½®</h2><p>(è°ƒå° innodb_buffer_pool_size å‚æ•°)<br>å‚è§</p><ul><li><a href="https://www.v2ex.com/t/276069">MySQL5.7.12 å ç”¨å†…å­˜è¿‡å¤šçš„åŸå› åˆ°åº•æ˜¯ä»€ä¹ˆ?</a> </li><li><a href="https://www.v2ex.com/t/276069">MySQL è°ƒä¼˜ä¹‹ innodb_buffer_pool_size å¤§å°è®¾ç½®</a>  </li><li><a href="https://segmentfault.com/a/1190000017992793">mariadb å†…å­˜å ç”¨ä¼˜åŒ–</a>  </li><li><a href="https://segmentfault.com/a/1190000003072283">MySQL å¿…é¡»è°ƒæ•´çš„ 10 é¡¹é…ç½®ä¼˜åŒ–</a>  </li><li><a href="https://blog.csdn.net/sunny05296/article/details/78916775">MySQL è°ƒä¼˜ä¹‹ innodb_buffer_pool_size å¤§å°è®¾ç½®</a>  </li><li><a href="http://www.bluestep.cc/%E4%BD%8E%E9%85%8D%E6%9C%8D%E5%8A%A1%E5%99%A8vps%E8%BF%90%E8%A1%8Cmysql%E7%BB%8F%E5%B8%B8%E5%B4%A9%E6%BA%83%EF%BC%9Aerror-mysqld-out-of-memory-needed-128663552-bytes/">ä½é…æœåŠ¡å™¨ VPS è¿è¡Œ MYSQL ç»å¸¸å´©æºƒï¼š[ERROR] mysqld: Out of memory (Needed 128663552 bytes)</a>  </li></ul><h2 id="ç‰ˆæœ¬ä¿¡æ¯"><a href="#ç‰ˆæœ¬ä¿¡æ¯" class="headerlink" title="ç‰ˆæœ¬ä¿¡æ¯"></a>ç‰ˆæœ¬ä¿¡æ¯</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysql --version</span><br><span class="line">mysql  Ver 15.1 Distrib 5.5.64-MariaDB, <span class="keyword">for</span> Linux (x86_64) using readline 5.1</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@VM_0_16_centos imoyao]<span class="comment"># cat /etc/system-release</span></span><br><span class="line">CentOS Linux release 7.6.1810 (Core) </span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šæ–‡ä¸­ä»¥<code>MariaDB</code>ç¤ºä¾‹ï¼Œå…³äºå…¶ä¸<code>MySQL</code>çš„å…³ç³»åœ¨æ­¤ä¸åšè¿‡å¤šè¯´æ˜ï¼Œå¦‚æœä½¿ç”¨<code>MySQL</code>ä½œä¸ºæ•°æ®åº“ï¼Œä»¥ä¸Šé…ç½®å‘½ä»¤å¯èƒ½ç•¥æœ‰ä¸åŒã€‚</p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><ul><li><a href="https://bobcares.com/blog/mysqld-out-of-memory/">â€œmysqld: out of memoryâ€ â€“ 4 major reasons why you get this error</a></li><li><a href="https://blog.konghy.cn/2019/11/16/linux-swap/">Linux åˆ›å»ºäº¤æ¢ï¼ˆswapï¼‰åˆ†åŒº | Huotyâ€™s Blog</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Projects </category>
          
          <category> IdealYard </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
            <tag> MariaDB </tag>
            
            <tag> æ•°æ®åº“ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ceph-calamari å®‰è£…è®°å½•</title>
      <link href="blog/2019-10-23/ceph-calamari-install-guide/"/>
      <url>blog/2019-10-23/ceph-calamari-install-guide/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><div class="note danger no-icon modern"><h2 id="è¿‡æ—¶æç¤º-Deprecated"><a href="#è¿‡æ—¶æç¤º-Deprecated" class="headerlink" title="è¿‡æ—¶æç¤º @Deprecated"></a>è¿‡æ—¶æç¤º @Deprecated</h2><p>åŸºäº<a href="http://liyichao.github.io/posts/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3-ceph-mgr.html"><em>æœ¬æ–‡</em></a>æåˆ°çš„åŸå› ï¼Œä¸å†å¯¹è¯¥é¡¹ç›®è¿›è¡Œè·Ÿè¿›ã€ç»´æŠ¤å’Œç»§ç»­æ¢ç´¢ã€‚è¯¥æ–‡ä¸å†æ›´æ–°ã€‚</p></div><hr><h2 id="å…‹éš†æºç "><a href="#å…‹éš†æºç " class="headerlink" title="å…‹éš†æºç "></a>å…‹éš†æºç </h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir /tmp/calamari-repo</span><br><span class="line"><span class="built_in">cd</span> /tmp/calamari-repo </span><br><span class="line">git <span class="built_in">clone</span> https://github.com/ceph/calamari.git</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/ceph/Diamond.git </span><br><span class="line">git <span class="built_in">clone</span> https://github.com/ceph/calamari-clients.git</span><br></pre></td></tr></table></figure><h2 id="æ„å»º-calamari-server-çš„-rpm-åŒ…"><a href="#æ„å»º-calamari-server-çš„-rpm-åŒ…" class="headerlink" title="æ„å»º calamari server çš„ rpm åŒ…"></a>æ„å»º calamari server çš„ rpm åŒ…</h2><h2 id="ç”Ÿæˆ-diamond-å®‰è£…åŒ…"><a href="#ç”Ÿæˆ-diamond-å®‰è£…åŒ…" class="headerlink" title="ç”Ÿæˆ diamond å®‰è£…åŒ…"></a>ç”Ÿæˆ diamond å®‰è£…åŒ…</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> ../Diamond</span><br><span class="line">git checkout origin/calamari</span><br><span class="line">yum install rpm-build -y</span><br><span class="line">make rpm</span><br></pre></td></tr></table></figure><p>å°† diamond-<version>.noarch.rpm å¤åˆ¶åˆ°æ‰€æœ‰çš„ ceph æœåŠ¡å™¨ï¼Œæ‰§è¡Œå®‰è£…ï¼š<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> dist/</span><br><span class="line"><span class="comment"># æ–¹æ¡ˆ1</span></span><br><span class="line">yum install python-configobj</span><br><span class="line">rpm -ivh diamond-&lt;version&gt;.noarch.rpm</span><br><span class="line"><span class="comment"># æ–¹æ¡ˆ2</span></span><br><span class="line">yum localinstall diamond-3.4.67-0.noarch.rpm</span><br></pre></td></tr></table></figure></p><h2 id="å®‰è£…-salt-minion"><a href="#å®‰è£…-salt-minion" class="headerlink" title="å®‰è£… salt-minion"></a>å®‰è£… salt-minion</h2><p>åœ¨æ‰€æœ‰çš„ ceph æœåŠ¡å™¨ä¸Šå®‰è£… salt-minion<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum install salt-minion</span><br></pre></td></tr></table></figure><br>åˆ›å»º<code>/etc/salt/minion.d/calamari.conf</code>ï¼Œå†…å®¹ä¸ºï¼š<br>master: {SERVER NODE HOSTNAME}<br>{SERVER NODE HOSTNAME}å¯¹åº” calamari æœåŠ¡å™¨çš„åŸŸåã€‚<br>å¯åŠ¨ salt-minion æœåŠ¡ï¼š<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">service salt-minion restart</span><br></pre></td></tr></table></figure></p><h2 id="é—®é¢˜è®°å½•"><a href="#é—®é¢˜è®°å½•" class="headerlink" title="é—®é¢˜è®°å½•"></a>é—®é¢˜è®°å½•</h2><h3 id="Ceph-servers-are-connected-to-Calamari-but-no-Ceph-cluster-has-been-created-yet"><a href="#Ceph-servers-are-connected-to-Calamari-but-no-Ceph-cluster-has-been-created-yet" class="headerlink" title="Ceph servers are connected to Calamari, but no Ceph cluster has been created yet"></a>Ceph servers are connected to Calamari, but no Ceph cluster has been created yet</h3><p>å®‰è£…å®Œæˆä¹‹åï¼Œé¦–é¡µå‡ºç°å¦‚ä¸‹æç¤ºï¼š</p><p><img src= "/img/loading.svg" data-lazy-src="/images/snipaste_20191106_133550.jpg" alt="New-Calamari-Installation"><br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">This appears to be the first time you have started Calamari and there are no clusters currently configured.</span><br><span class="line"></span><br><span class="line">*some* Ceph servers are connected to Calamari, but no Ceph cluster has been</span><br><span class="line">created yet. Please use ceph-deploy to create a cluster; please see the</span><br><span class="line">Inktank Ceph Enterprise documentation for more details.</span><br></pre></td></tr></table></figure><br>å…·ä½“<a href="https://github.com/ceph/calamari/issues/518">è§æ­¤å¤„</a>    </p><h4 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•"></a>è§£å†³åŠæ³•</h4><ul><li>æ‰§è¡Œ<code>salt &#39;*&#39; ceph.get_heartbeats</code>ï¼Œè¿”å›å¦‚ä¸‹:<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">node2:</span><br><span class="line">    The minion function caused an exception: Traceback (most recent call last):</span><br><span class="line">      File &quot;/usr/lib/python2.7/site-packages/salt/minion.py&quot;, line 1200, in _thread_return</span><br><span class="line">        return_data = func(*args, **kwargs)</span><br><span class="line">      File &quot;/var/cache/salt/minion/extmods/modules/ceph.py&quot;, line 534, in get_heartbeats</span><br><span class="line">        service_data = service_status(filename)</span><br><span class="line">      File &quot;/var/cache/salt/minion/extmods/modules/ceph.py&quot;, line 593, in service_status</span><br><span class="line">        fsid = json.loads(admin_socket(socket_path, [&#x27;status&#x27;], &#x27;json&#x27;))[&#x27;cluster_fsid&#x27;]</span><br><span class="line">    KeyError: &#x27;cluster_fsid&#x27;</span><br><span class="line">â€¦â€¦ # It is same.</span><br><span class="line">    The minion function caused an exception: Traceback (most recent call last):</span><br><span class="line">      File &quot;/usr/lib/python2.7/site-packages/salt/minion.py&quot;, line 1200, in _thread_return</span><br><span class="line">        return_data = func(*args, **kwargs)</span><br><span class="line">      File &quot;/var/cache/salt/minion/extmods/modules/ceph.py&quot;, line 534, in get_heartbeats</span><br><span class="line">        service_data = service_status(filename)</span><br><span class="line">      File &quot;/var/cache/salt/minion/extmods/modules/ceph.py&quot;, line 593, in service_status</span><br><span class="line">        fsid = json.loads(admin_socket(socket_path, [&#x27;status&#x27;], &#x27;json&#x27;))[&#x27;cluster_fsid&#x27;]</span><br><span class="line">    KeyError: &#x27;cluster_fsid&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li>ä¿®æ”¹ä»£ç <code>AdminSocketError</code> ä¸º <code>(AdminSocketError,KeyError)</code>ï¼š<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    fsid = json.loads(admin_socket(socket_path, [<span class="string">&#x27;status&#x27;</span>], <span class="string">&#x27;json&#x27;</span>))[<span class="string">&#x27;cluster_fsid&#x27;</span>]</span><br><span class="line"><span class="keyword">except</span> (AdminSocketError,KeyError):  <span class="comment"># æ­¤å¤„ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ Exception</span></span><br><span class="line">    <span class="comment"># older osd/mds daemons don&#x27;t support &#x27;status&#x27;; try our best</span></span><br><span class="line">   <span class="keyword">pass</span>             <span class="comment"># æ­¤å¤„ä»£ç ä¸å˜</span></span><br></pre></td></tr></table></figure><strong>æ³¨æ„</strong>: åœ¨<code>admin</code>èŠ‚ç‚¹ï¼Œä»£ç å¯èƒ½åœ¨ <code>/opt/calamari/salt/salt/_modules/ceph.py</code> è€Œåœ¨å…¶ä»–èŠ‚ç‚¹ï¼Œä»£ç å¯èƒ½åœ¨<code>/var/cache/salt/minion/extmods/modules/ceph.py</code>ã€‚</li><li>åœ¨<code>admin</code>èŠ‚ç‚¹æ‰§è¡Œ<code>salt &quot;*&quot; saltutil.sync_all</code>æˆ–è€…<code>systemctl restart salt-minion</code>ï¼Œè¿”å›:<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">node3:</span><br><span class="line">    ----------</span><br><span class="line">    beacons:</span><br><span class="line">    grains:</span><br><span class="line">    modules:</span><br><span class="line">    output:</span><br><span class="line">    renderers:</span><br><span class="line">    returners:</span><br><span class="line">    sdb:</span><br><span class="line">    states:</span><br><span class="line">    utils:</span><br><span class="line">â€¦â€¦</span><br><span class="line">node2:</span><br><span class="line">    ----------</span><br><span class="line">    beacons:</span><br><span class="line">    grains:</span><br><span class="line">    modules:</span><br><span class="line">    output:</span><br><span class="line">    renderers:</span><br><span class="line">    returners:</span><br><span class="line">    sdb:</span><br><span class="line">    states:</span><br><span class="line">    utils:</span><br></pre></td></tr></table></figure></li><li>ç„¶åï¼Œåœ¨<code>admin</code>èŠ‚ç‚¹æ‰§è¡Œ<code>salt &#39;*&#39; ceph.get_heartbeats</code>ï¼Œè¿”å›:<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">node2:</span><br><span class="line">    |_</span><br><span class="line">      ----------</span><br><span class="line">      boot_time:</span><br><span class="line">          1573005001</span><br><span class="line">      ceph_version:</span><br><span class="line">          2:13.2.6-0.el7</span><br><span class="line">      services:</span><br><span class="line">          ----------</span><br><span class="line">          ceph-mgr.node2:</span><br><span class="line">              ----------</span><br><span class="line">              cluster:</span><br><span class="line">                  ceph</span><br><span class="line">              fsid:</span><br><span class="line">                  47071b01-394e-4a62-bb2d-cfe3c19637f7</span><br><span class="line">              id:</span><br><span class="line">                  node2</span><br><span class="line">              status:</span><br><span class="line">                  None</span><br><span class="line">              type:</span><br><span class="line">                  mgr</span><br><span class="line">              version:</span><br><span class="line">                  13.2.6</span><br><span class="line">          ceph-osd.0:</span><br><span class="line">              ----------</span><br><span class="line">              cluster:</span><br><span class="line">                  ceph</span><br><span class="line">              fsid:</span><br><span class="line">                  47071b01-394e-4a62-bb2d-cfe3c19637f7</span><br><span class="line">              id:</span><br><span class="line">                  0</span><br><span class="line">              status:</span><br><span class="line">                  None</span><br><span class="line">              type:</span><br><span class="line">                  osd</span><br><span class="line">              version:</span><br><span class="line">                  13.2.6</span><br><span class="line">    |_</span><br><span class="line">      ----------</span><br><span class="line">â€¦â€¦</span><br></pre></td></tr></table></figure></li><li>è®¿é—®é¡µé¢ï¼Œè·å–åˆ°å¦‚æ­¤æ˜¾ç¤º<br><img src= "/img/loading.svg" data-lazy-src="/images/snipaste_20191106_102957.jpg" alt="500_error">   <h3 id="500-é”™è¯¯ï¼Œè¯·è”ç³»ç®¡ç†å‘˜"><a href="#500-é”™è¯¯ï¼Œè¯·è”ç³»ç®¡ç†å‘˜" class="headerlink" title="500 é”™è¯¯ï¼Œè¯·è”ç³»ç®¡ç†å‘˜"></a>500 é”™è¯¯ï¼Œè¯·è”ç³»ç®¡ç†å‘˜</h3><a href="https://tracker.ceph.com/issues/13476">æ­¤å¤„</a>æœ‰å…³äºè¯¥é—®é¢˜çš„æè¿°ã€‚</li><li>æŸ¥çœ‹ calamari æ—¥å¿—<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">tailf /var/log/calamari/calamari.log </span><br></pre></td></tr></table></figure>è·å–åˆ°ä»¥ä¸‹é”™è¯¯ï¼š<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">2019-11-05 21:02:19,605 - metric_access - django.request No graphite data for ceph.cluster.47071b01-394e-4a62-bb2d-cfe3c19637f7.df.total_used_bytes</span><br><span class="line">2019-11-05 21:02:19,606 - metric_access - django.request No graphite data for ceph.cluster.47071b01-394e-4a62-bb2d-cfe3c19637f7.df.total_used</span><br><span class="line">2019-11-05 21:02:19,606 - metric_access - django.request No graphite data for ceph.cluster.47071b01-394e-4a62-bb2d-cfe3c19637f7.df.total_space</span><br><span class="line">2019-11-05 21:02:19,607 - metric_access - django.request No graphite data for ceph.cluster.47071b01-394e-4a62-bb2d-cfe3c19637f7.df.total_avail</span><br><span class="line">2019-11-05 21:02:19,608 - ERROR - django.request Internal Server Error: /api/v1/cluster/47071b01-394e-4a62-bb2d-cfe3c19637f7/space</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/django/core/handlers/base.py&quot;, line 115, in get_response</span><br><span class="line">    response = callback(request, *callback_args, **callback_kwargs)</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/rest_framework/viewsets.py&quot;, line 78, in view</span><br><span class="line">    return self.dispatch(request, *args, **kwargs)</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/calamari_rest_api-0.1-py2.7.egg/calamari_rest/views/rpc_view.py&quot;, line 94, in dispatch</span><br><span class="line">    self.client.close()</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/zerorpc/core.py&quot;, line 293, in close</span><br><span class="line">    SocketBase.close(self)</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/zerorpc/socket.py&quot;, line 37, in close</span><br><span class="line">    self._events.close()</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/zerorpc/events.py&quot;, line 198, in close</span><br><span class="line">    self._send.close()</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/zerorpc/events.py&quot;, line 50, in close</span><br><span class="line">    self._send_task.kill()</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/gevent/greenlet.py&quot;, line 235, in kill</span><br><span class="line">    waiter.get()</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/gevent/hub.py&quot;, line 575, in get</span><br><span class="line">    return self.hub.switch()</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/gevent/hub.py&quot;, line 338, in switch</span><br><span class="line">    return greenlet.switch(self)</span><br><span class="line">LostRemote: Lost remote after 10s heartbeat</span><br><span class="line"></span><br><span class="line">------</span><br><span class="line"></span><br><span class="line">2019-11-05 23:59:43,586 - ERROR - django.request Internal Server Error: /api/v1/cluster/47071b01-394e-4a62-bb2d-cfe3c19637f7/health_counters</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/django/core/handlers/base.py&quot;, line 115, in get_response</span><br><span class="line">    response = callback(request, *callback_args, **callback_kwargs)</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/rest_framework/viewsets.py&quot;, line 78, in view</span><br><span class="line">    return self.dispatch(request, *args, **kwargs)</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/calamari_rest_api-0.1-py2.7.egg/calamari_rest/views/rpc_view.py&quot;, line 91, in dispatch</span><br><span class="line">    return super(RPCViewSet, self).dispatch(request, *args, **kwargs)</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/django/views/decorators/csrf.py&quot;, line 77, in wrapped_view</span><br><span class="line">    return view_func(*args, **kwargs)</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/rest_framework/views.py&quot;, line 399, in dispatch</span><br><span class="line">    response = self.handle_exception(exc)</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/calamari_rest_api-0.1-py2.7.egg/calamari_rest/views/rpc_view.py&quot;, line 108, in handle_exception</span><br><span class="line">    return super(RPCViewSet, self).handle_exception(exc)</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/rest_framework/views.py&quot;, line 396, in dispatch</span><br><span class="line">    response = handler(request, *args, **kwargs)</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/calamari_rest_api-0.1-py2.7.egg/calamari_rest/views/v1.py&quot;, line 315, in get</span><br><span class="line">    counters = self.generate(osd_data, mds_data, mon_status, pg_summary)</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/calamari_rest_api-0.1-py2.7.egg/calamari_rest/views/v1.py&quot;, line 167, in generate</span><br><span class="line">    &#x27;mds&#x27;: cls._calculate_mds_counters(mds_map),</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/calamari_rest_api-0.1-py2.7.egg/calamari_rest/views/v1.py&quot;, line 295, in _calculate_mds_counters</span><br><span class="line">    up = len(mds_map[&#x27;up&#x27;])</span><br><span class="line">TypeError: &#x27;NoneType&#x27; object has no attribute &#x27;__getitem__&#x27;</span><br><span class="line"></span><br><span class="line">--------</span><br><span class="line"></span><br><span class="line">2019-11-06 00:00:53,567 - ERROR - django.request Internal Server Error: /api/v1/cluster/47071b01-394e-4a62-bb2d-cfe3c19637f7/osd</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/django/core/handlers/base.py&quot;, line 115, in get_response</span><br><span class="line">    response = callback(request, *callback_args, **callback_kwargs)</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/rest_framework/viewsets.py&quot;, line 78, in view</span><br><span class="line">    return self.dispatch(request, *args, **kwargs)</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/calamari_rest_api-0.1-py2.7.egg/calamari_rest/views/rpc_view.py&quot;, line 91, in dispatch</span><br><span class="line">    return super(RPCViewSet, self).dispatch(request, *args, **kwargs)</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/django/views/decorators/csrf.py&quot;, line 77, in wrapped_view</span><br><span class="line">    return view_func(*args, **kwargs)</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/rest_framework/views.py&quot;, line 399, in dispatch</span><br><span class="line">    response = self.handle_exception(exc)</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/calamari_rest_api-0.1-py2.7.egg/calamari_rest/views/rpc_view.py&quot;, line 108, in handle_exception</span><br><span class="line">    return super(RPCViewSet, self).handle_exception(exc)</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/rest_framework/views.py&quot;, line 396, in dispatch</span><br><span class="line">    response = handler(request, *args, **kwargs)</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/calamari_rest_api-0.1-py2.7.egg/calamari_rest/views/v1.py&quot;, line 417, in get</span><br><span class="line">    osds, osds_by_pg_state = self.generate(pg_summary, osd_map, server_info, servers)</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/calamari_rest_api-0.1-py2.7.egg/calamari_rest/views/v1.py&quot;, line 365, in generate</span><br><span class="line">    for pool_id, osds in osd_map.osds_by_pool.items():</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/calamari_common-0.1-py2.7.egg/calamari_common/util.py&quot;, line 8, in wrapper</span><br><span class="line">    rv = function(*args)</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/calamari_common-0.1-py2.7.egg/calamari_common/types.py&quot;, line 206, in osds_by_pool</span><br><span class="line">    for rule in [r for r in self.data[&#x27;crush&#x27;][&#x27;rules&#x27;] if r[&#x27;ruleset&#x27;] == pool[&#x27;crush_ruleset&#x27;]]:</span><br><span class="line">KeyError: &#x27;crush_ruleset&#x27;</span><br><span class="line">2019-11-06 00:00:54,566 - metric_access - django.request No graphite data for ceph.cluster.47071b01-394e-4a62-bb2d-cfe3c19637f7.pool.1.num_objects</span><br></pre></td></tr></table></figure>æŸ¥çœ‹ <code>cthulhu</code> æ—¥å¿—<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">tailf /var/log/calamari/cthulhu.log</span><br></pre></td></tr></table></figure>è¿”å›å¦‚ä¸‹ï¼š<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">2019-11-05 22:05:31,371 - WARNING - cthulhu Ignoring event salt/job/20191105220531366943/ret/node1</span><br><span class="line">2019-11-05 22:05:31,371 - WARNING - cthulhu.request_collection on_completion: unknown jid 20191105220531366943, return: None</span><br><span class="line">2019-11-05 22:05:38,283 - WARNING - cthulhu.request_collection on_completion: unknown jid 20191105220538277178, return: None</span><br><span class="line">2019-11-05 22:05:38,283 - WARNING - cthulhu Ignoring event salt/job/20191105220538277178/ret/node3</span><br><span class="line">2019-11-05 22:05:38,383 - WARNING - cthulhu Ignoring event salt/job/20191105220538379133/ret/node2</span><br><span class="line">2019-11-05 22:05:38,384 - WARNING - cthulhu.request_collection on_completion: unknown jid 20191105220538379133, return: None</span><br><span class="line">2019-11-05 22:05:41,384 - WARNING - cthulhu Abandoning fetch for mds_map started at 2019-11-06 03:05:31.344465+00:00</span><br><span class="line">2019-11-05 22:05:41,385 - ERROR - cthulhu Exception handling message with tag ceph/cluster/47071b01-394e-4a62-bb2d-cfe3c19637f7</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/calamari_cthulhu-0.1-py2.7.egg/cthulhu/manager/cluster_monitor.py&quot;, line 244, in _run</span><br><span class="line">    self.on_heartbeat(data[&#x27;id&#x27;], data[&#x27;data&#x27;])</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/calamari_cthulhu-0.1-py2.7.egg/cthulhu/gevent_util.py&quot;, line 35, in wrapped</span><br><span class="line">    return func(*args, **kwargs)</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/calamari_cthulhu-0.1-py2.7.egg/cthulhu/manager/cluster_monitor.py&quot;, line 346, in on_heartbeat</span><br><span class="line">    cluster_data[&#x27;versions&#x27;][sync_type.str])</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/calamari_cthulhu-0.1-py2.7.egg/cthulhu/manager/cluster_monitor.py&quot;, line 99, in on_version</span><br><span class="line">    self.fetch(reported_by, sync_type)</span><br><span class="line">  File &quot;/opt/calamari/venv/lib/python2.7/site-packages/calamari_cthulhu-0.1-py2.7.egg/cthulhu/manager/cluster_monitor.py&quot;, line 109, in fetch</span><br><span class="line">    client = LocalClient(config.get(&#x27;cthulhu&#x27;, &#x27;salt_config_path&#x27;))</span><br><span class="line">  File &quot;/usr/lib/python2.7/site-packages/salt/client/__init__.py&quot;, line 126, in __init__</span><br><span class="line">    self.opts = salt.config.client_config(c_path)</span><br><span class="line">  File &quot;/usr/lib/python2.7/site-packages/salt/config.py&quot;, line 2203, in client_config</span><br><span class="line">  File &quot;/usr/lib/python2.7/site-packages/salt/utils/xdg.py&quot;, line 13, in xdg_config_dir</span><br><span class="line">  File &quot;/opt/calamari/venv/lib64/python2.7/posixpath.py&quot;, line 269, in expanduser</span><br><span class="line">KeyError: &#x27;getpwuid(): uid not found: 0&#x27;</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2></li><li><a href="https://www.cnblogs.com/gaohong/p/4669524.html">å®‰è£…éƒ¨ç½² Ceph Calamari</a></li><li><a href="https://www.cnblogs.com/flytor/p/11425135.html">åœ¨ CentOS 7 å®‰è£… Calamari</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> CEPH </tag>
            
            <tag> Calamari </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019 é¢è¯•è®°å½•</title>
      <link href="blog/2019-10-18/interview-2019/"/>
      <url>blog/2019-10-18/interview-2019/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h2 id="FunPlus-å°è§†é¢‘ä¸šåŠ¡"><a href="#FunPlus-å°è§†é¢‘ä¸šåŠ¡" class="headerlink" title="FunPlus (å°è§†é¢‘ä¸šåŠ¡)"></a>FunPlus (å°è§†é¢‘ä¸šåŠ¡)</h2><h3 id="æ•°æ®åº“çš„äº‹åŠ¡éš”ç¦»æœºåˆ¶"><a href="#æ•°æ®åº“çš„äº‹åŠ¡éš”ç¦»æœºåˆ¶" class="headerlink" title="æ•°æ®åº“çš„äº‹åŠ¡éš”ç¦»æœºåˆ¶"></a>æ•°æ®åº“çš„äº‹åŠ¡éš”ç¦»æœºåˆ¶</h3><h4 id="éš”ç¦»çº§åˆ«"><a href="#éš”ç¦»çº§åˆ«" class="headerlink" title="éš”ç¦»çº§åˆ«"></a>éš”ç¦»çº§åˆ«</h4><ul><li><p>READ UNCOMMITTEDï¼ˆæœªæäº¤è¯»ï¼‰<br>è¿™ä¸ªçº§åˆ«ï¼Œäº‹åŠ¡ä¸­çš„ä¿®æ”¹ï¼Œå³ä½¿æ²¡æœ‰æäº¤ï¼Œå¯¹å…¶ä»–äº‹åŠ¡ä¹Ÿéƒ½æ˜¯å¯è§çš„ã€‚äº‹åŠ¡å¯ä»¥è¯»å–æœªæäº¤çš„æ•°æ®ï¼Œè¢«ç§°ä¸ºè„è¯»ï¼ˆDirty Readï¼‰ï¼Œè¿™ä¸ªçº§åˆ«æ€§èƒ½ä¸ä¼šæ¯”å…¶ä»–çº§åˆ«å¥½å¤ªå¤šï¼Œä½†ç¼ºä¹å…¶ä»–çº§åˆ«çš„å¾ˆå¤šå¥½å¤„ï¼Œä¸€èˆ¬å¾ˆå°‘ä½¿ç”¨ã€‚</p></li><li><p>READ COMMITTEDï¼ˆæäº¤è¯»ï¼‰<br>è¿™ä¸ªçº§åˆ«æ˜¯å¤§å¤šæ•°æ•°æ®åº“ç³»ç»Ÿçš„é»˜è®¤éš”ç¦»çº§åˆ«ï¼ˆä½† MySQL ä¸æ˜¯ï¼‰ã€‚ä¸€ä¸ªäº‹åŠ¡ä»å¼€å§‹ç›´åˆ°æäº¤ä¹‹å‰ï¼Œæ‰€åšçš„ä»»ä½•ä¿®æ”¹å¯¹å…¶ä»–äº‹åŠ¡éƒ½æ˜¯ä¸å¯è§çš„ã€‚è¿™ä¸ªçº§åˆ«ä¹Ÿå«ä½œä¸å¯é‡å¤è¯»ï¼ˆnonrepeatable readï¼‰ï¼Œå› ä¸ºä¸¤æ¬¡æ‰§è¡ŒåŒæ ·çš„æŸ¥è¯¢ï¼Œå¯èƒ½ä¼šå¾—åˆ°ä¸ä¸€æ ·çš„ç»“æœã€‚</p></li><li><p>REPEATABLE READï¼ˆå¯é‡å¤è¯»ï¼‰<br>è¯¥çº§åˆ«ä¿è¯äº†åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­å¤šæ¬¡è¯»å–åŒæ ·è®°å½•çš„ç»“æœæ˜¯ä¸€è‡´çš„ï¼Œä½†ä¾ç„¶æ— æ³•è§£å†³å¦å¤–ä¸€ä¸ªå¹»è¯»ï¼ˆPhantom Readï¼‰çš„é—®é¢˜ã€‚å¹»è¯»ï¼ŒæŒ‡çš„æ˜¯å½“æŸä¸ªäº‹åŠ¡åœ¨è¯»å–æŸä¸ªèŒƒå›´å†…çš„è®°å½•æ—¶ï¼Œå¦å¤–ä¸€ä¸ªäº‹åŠ¡åˆåœ¨è¯¥èŒƒå›´å†…æ’å…¥äº†æ–°çš„è®°å½•ï¼Œå½“ä¹‹å‰çš„äº‹åŠ¡å†æ¬¡è¯»å–è¯¥èŒƒå›´çš„è®°å½•æ—¶ï¼Œä¼šäº§ç”Ÿå¹»è¡Œï¼ˆPhantom Rowï¼‰ã€‚InnoDB å’Œ XtraDB å­˜å‚¨å¼•æ“é€šè¿‡å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMVCCï¼‰è§£å†³äº†å¹»è¯»çš„é—®é¢˜ã€‚å¯é‡å¤è¯»æ˜¯ MySQL çš„é»˜è®¤äº‹åŠ¡éš”ç¦»çº§åˆ«ã€‚</p></li><li><p>SERIALIZABLEï¼ˆå¯ä¸²è¡ŒåŒ–ï¼‰<br>æœ€é«˜çš„éš”ç¦»çº§åˆ«ï¼Œå¼ºåˆ¶äº‹åŠ¡ä¸²è¡Œæ‰§è¡Œï¼Œé¿å…äº†å‰é¢è¯´çš„å¹»è¯»çš„é—®é¢˜ã€‚ä½†æ¯æ¬¡è¯»éƒ½éœ€è¦è·å¾—è¡¨çº§å…±äº«é”ï¼Œè¯»å†™ç›¸äº’éƒ½ä¼šé˜»å¡ã€‚</p></li></ul><p>æ‰€æœ‰éš”ç¦»çº§åˆ«</p><ol><li><p>read uncommitted : è¯»å–å°šæœªæäº¤çš„æ•°æ® ï¼šå“ªä¸ªé—®é¢˜éƒ½ä¸èƒ½è§£å†³</p></li><li><p>read committedï¼šè¯»å–å·²ç»æäº¤çš„æ•°æ® ï¼šå¯ä»¥è§£å†³è„è¯» â€”- oracle é»˜è®¤çš„</p></li><li><p>repeatable readï¼šå¯é‡å¤è¯»ï¼šå¯ä»¥è§£å†³è„è¯» å’Œ ä¸å¯é‡å¤è¯» â€”- mysql é»˜è®¤çš„</p></li><li><p>serializableï¼šä¸²è¡ŒåŒ–ï¼šå¯ä»¥è§£å†³ è„è¯» ä¸å¯é‡å¤è¯» å’Œ è™šè¯»â€”-ç›¸å½“äºé”è¡¨</p></li></ol><table><thead><tr><th>äº‹åŠ¡éš”ç¦»çº§åˆ«</th><th>è„è¯»</th><th>å¯é‡å¤è¯»</th><th>å¹»è¯»</th></tr></thead><tbody><tr><td>æœªæäº¤è¯»ï¼ˆread uncommitedï¼‰</td><td>Ã—</td><td>Ã—</td><td>Ã—</td></tr><tr><td>æäº¤è¯»ï¼ˆread commitedï¼‰</td><td>âˆš</td><td>Ã—</td><td>Ã—</td></tr><tr><td>å¯é‡å¤è¯»ï¼ˆrepeatable readï¼‰</td><td>âˆš</td><td>âˆš</td><td>Ã—</td></tr><tr><td>ä¸²è¡ŒåŒ–ï¼ˆserialziable)</td><td>âˆš</td><td>âˆš</td><td>âˆš</td></tr></tbody></table><p>æ³¨ï¼šÃ—è¡¨ç¤ºæœ‰è¯¥é—®é¢˜ï¼Œâˆšè¡¨ç¤ºè§£å†³è¯¥é—®é¢˜ã€‚</p><ol><li><p>è„è¯»ï¼šäº‹åŠ¡ A è¯»å–äº†äº‹åŠ¡ B æ›´æ–°çš„æ•°æ®ï¼Œç„¶å B è¿›è¡Œå›æ»šæ“ä½œï¼Œé‚£ä¹ˆ A è¯»å–åˆ°çš„æ•°æ®æ˜¯è„æ•°æ®ï¼›</p></li><li><p>ä¸å¯é‡å¤è¯»ï¼šäº‹åŠ¡ A å¤šæ¬¡è¯»å–åŒä¸€æ•°æ®ï¼Œäº‹åŠ¡ B åœ¨äº‹åŠ¡ A å¤šæ¬¡è¯»å–çš„è¿‡ç¨‹ä¸­ï¼Œå¯¹æ•°æ®ä½œäº†æ›´æ–°å¹¶æäº¤ï¼Œå¯¼è‡´äº‹åŠ¡ A å¤šæ¬¡è¯»å–åŒä¸€æ•°æ®æ—¶ï¼Œç»“æœä¸ä¸€è‡´;</p></li><li><p>å¹»è¯»ï¼šâ€œå½“äº‹åŠ¡ A è¦å¯¹æ•°æ®è¡¨ä¸­æŸä¸ªå­—æ®µçš„æ‰€æœ‰å€¼è¿›ä¿®æ”¹æ“ä½œï¼Œæ­¤æ—¶æœ‰ä¸€ä¸ªäº‹åŠ¡æ˜¯æ’å…¥ä¸€æ¡è®°å½• å¹¶æäº¤ç»™æ•°æ®åº“ï¼Œå½“æäº¤äº‹åŠ¡ A çš„ç”¨æˆ·å†æ¬¡æŸ¥çœ‹æ—¶å°±ä¼šå‘ç°æœ‰ä¸€è¡Œæ•°æ®æœªè¢«ä¿®æ”¹ï¼Œå…¶å®æ˜¯äº‹åŠ¡ B åˆšåˆšæ·»åŠ è¿›å»çš„â€ï¼Œè¿™å°±æ˜¯å¹»è¯»ï¼›</p></li></ol><p>éš”ç¦»çº§åˆ«è¶Šé«˜ï¼Œè¶Šèƒ½ä¿è¯æ•°æ®çš„å®Œæ•´æ€§å’Œç»Ÿä¸€æ€§ï¼Œä½†æ˜¯å¯¹å¹¶å‘æ€§èƒ½çš„å½±å“ä¹Ÿè¶Šå¤§ã€‚å¯¹äºå¤šæ•°åº”ç”¨ç¨‹åºï¼Œå¯ä»¥ä¼˜å…ˆè€ƒè™‘æŠŠæ•°æ®åº“ç³»ç»Ÿçš„éš”ç¦»çº§åˆ«è®¾ä¸º Read Committedã€‚å®ƒèƒ½å¤Ÿé¿å…è„è¯»ï¼Œè€Œä¸”å…·æœ‰è¾ƒå¥½çš„å¹¶å‘æ€§èƒ½ã€‚å°½ç®¡å®ƒä¼šå¯¼è‡´ä¸å¯é‡å¤è¯»ã€å¹»è¯»å’Œç¬¬äºŒç±»ä¸¢å¤±æ›´æ–°è¿™äº›å¹¶å‘é—®é¢˜ï¼Œåœ¨å¯èƒ½å‡ºç°è¿™ç±»é—®é¢˜çš„ä¸ªåˆ«åœºåˆï¼Œå¯ä»¥ç”±åº”ç”¨ç¨‹åºé‡‡ç”¨æ‚²è§‚é”æˆ–ä¹è§‚é”æ¥æ§åˆ¶ã€‚</p><p><a href="https://blog.csdn.net/xiancaione/article/details/82157019">MySQL äº‹åŠ¡éš”ç¦»æœºåˆ¶&amp;é”</a><br><a href="https://blog.csdn.net/taylor_tao/article/details/7063639">MySQL éš”ç¦»çº§åˆ«</a><br><a href="https://blog.csdn.net/weixin_39651041/article/details/79980202">æ•°æ®åº“äº‹åŠ¡å’Œå››ç§éš”ç¦»çº§åˆ«</a><br><a href="http://tech.dianwoda.com/2018/09/06/rr-yu-rcge-chi-ji-bie-de-yi-tong/">RR(REPEATABLE-READ) ä¸ RC(READ-COMMITED) éš”ç¦»çº§åˆ«çš„å¼‚åŒ</a></p><h3 id="flask-ç»„ä»¶åŠæºç å‰–æ"><a href="#flask-ç»„ä»¶åŠæºç å‰–æ" class="headerlink" title="flask ç»„ä»¶åŠæºç å‰–æ"></a>flask ç»„ä»¶åŠæºç å‰–æ</h3><ul><li><a href="https://www.jianshu.com/p/8f01ad89406d">Flask è‡ªå¸¦çš„å¸¸ç”¨ç»„ä»¶ä»‹ç»</a><ol><li>session</li><li>flashï¼Œæ¶ˆæ¯é—ªç°</li><li>jsonifyï¼Œè¿”å› json åŒ–æ•°æ®</li><li>blueprintï¼Œæ„å»ºå¤§å‹åº”ç”¨æ¡ç†åŒ–</li><li>gï¼ŒFlask ä¸­çš„å…¨å±€å˜é‡ g ï¼Œå¯ä»¥ä¸ºç‰¹å®šè¯·æ±‚ä¸´æ—¶å­˜å‚¨ä»»ä½•éœ€è¦çš„æ•°æ®å¹¶ä¸”æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå½“è¯·æ±‚ç»“æŸæ—¶ï¼Œè¿™ä¸ªå¯¹è±¡ä¼šè¢«é”€æ¯ï¼Œä¸‹ä¸€ä¸ªæ–°çš„è¯·æ±‚åˆ°æ¥æ—¶åˆä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„ gã€‚</li><li>abortï¼Œè‡ªå®šä¹‰é”™è¯¯</li><li>current_appï¼Œåº”ç”¨ä¸Šä¸‹æ–‡</li></ol></li><li><a href="https://segmentfault.com/a/1190000009152550">ä¸€ä¸ª Flask åº”ç”¨è¿è¡Œè¿‡ç¨‹å‰–æ</a></li><li><a href="https://www.jianshu.com/p/2a2407f66438">Flask çš„è¯·æ±‚å¤„ç†æµç¨‹å’Œä¸Šä¸‹æ–‡</a></li><li><a href="https://cizixs.com/2017/01/10/flask-insight-introduction/">flask æºç è§£æ</a></li><li><a href="https://www.cnblogs.com/weihengblog/p/9490561.html">Flask æºç è§£æ:Flask åº”ç”¨æ‰§è¡Œæµç¨‹åŠåŸç†</a></li><li><a href="https://www.cnblogs.com/Utopia-Clint/p/10824238.html">Flask é¢è¯•é¢˜</a></li><li><a href="https://blog.csdn.net/bestallen/article/details/54342120">Flask æºç è§£è¯» | æµ…è°ˆ Flask åŸºæœ¬å·¥ä½œæµç¨‹</a></li></ul><h3 id="redis-ä¸­çš„æ•°æ®ç±»å‹ï¼Œå…¶ä¸­åˆ—è¡¨å’Œæœ‰åºé›†åˆæœ‰ä»€ä¹ˆåŒºåˆ«"><a href="#redis-ä¸­çš„æ•°æ®ç±»å‹ï¼Œå…¶ä¸­åˆ—è¡¨å’Œæœ‰åºé›†åˆæœ‰ä»€ä¹ˆåŒºåˆ«" class="headerlink" title="redis ä¸­çš„æ•°æ®ç±»å‹ï¼Œå…¶ä¸­åˆ—è¡¨å’Œæœ‰åºé›†åˆæœ‰ä»€ä¹ˆåŒºåˆ«"></a>redis ä¸­çš„æ•°æ®ç±»å‹ï¼Œå…¶ä¸­åˆ—è¡¨å’Œæœ‰åºé›†åˆæœ‰ä»€ä¹ˆåŒºåˆ«</h3><h4 id="list-åˆ—è¡¨"><a href="#list-åˆ—è¡¨" class="headerlink" title="list åˆ—è¡¨"></a>list åˆ—è¡¨</h4><p>List å†…éƒ¨æ•°æ®ç»“æ„æ˜¯åŒå‘é“¾è¡¨ï¼Œå¯ä»¥åœ¨é“¾è¡¨å·¦ã€å³ä¸¤è¾¹åˆ†åˆ«æ“ä½œï¼Œæ‰€ä»¥æ’å…¥æ•°æ®çš„é€Ÿåº¦å¾ˆå¿«ã€‚</p><p>ä¹Ÿå¯ä»¥æŠŠ list çœ‹æˆä¸€ç§é˜Ÿåˆ—ï¼Œæ‰€ä»¥åœ¨å¾ˆå¤šæ—¶å€™å¯ä»¥ç”¨ redis ç”¨ä½œæ¶ˆæ¯é˜Ÿåˆ—ï¼Œè¿™ä¸ªæ—¶å€™å®ƒçš„ä½œç”¨ç±»ä¼¼äº activeMqï¼›</p><p>ä½†æ˜¯ç¼ºç‚¹å°±æ˜¯åœ¨æ•°æ®é‡æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œè®¿é—®æŸä¸ªæ•°æ®çš„æ—¶é—´å¯èƒ½ä¼šå¾ˆé•¿ï¼Œä½†é’ˆå¯¹è¿™ç§æƒ…å†µï¼Œå¯ä»¥ä½¿ç”¨ zsetã€‚</p><p>åº”ç”¨æ¡ˆä¾‹æœ‰æ—¶é—´è½´æ•°æ®ï¼Œè¯„è®ºåˆ—è¡¨ï¼Œæ¶ˆæ¯ä¼ é€’ç­‰ç­‰ï¼Œå®ƒå¯ä»¥æä¾›ç®€ä¾¿çš„åˆ†é¡µï¼Œè¯»å†™æ“ä½œã€‚</p><h4 id="Set-é›†åˆ"><a href="#Set-é›†åˆ" class="headerlink" title="Set é›†åˆ"></a>Set é›†åˆ</h4><p>Set å°±æ˜¯ä¸€ä¸ªé›†åˆï¼Œå†…éƒ¨æ•°æ®ç»“æ„æ˜¯æ•´æ•°é›†åˆ(intset)ã€HASH è¡¨ï¼Œé›†åˆçš„æ¦‚å¿µå°±æ˜¯ä¸€å †<strong>ä¸é‡å¤å€¼</strong>çš„ç»„åˆã€‚åˆ©ç”¨ Redis æä¾›çš„ Set æ•°æ®ç»“æ„ï¼Œå¯ä»¥å­˜å‚¨ä¸€äº›é›†åˆæ€§çš„æ•°æ®ã€‚</p><p>æ¯”å¦‚åœ¨å¾®åšåº”ç”¨ä¸­ï¼Œå¯ä»¥å°†ä¸€ä¸ªç”¨æˆ·æ‰€æœ‰çš„å…³æ³¨äººå­˜åœ¨ä¸€ä¸ªé›†åˆä¸­ï¼Œå°†å…¶æ‰€æœ‰ç²‰ä¸å­˜åœ¨ä¸€ä¸ªé›†åˆã€‚</p><p>å› ä¸º Redis éå¸¸äººæ€§åŒ–çš„ä¸ºé›†åˆæä¾›äº†æ±‚äº¤é›†ã€å¹¶é›†ã€å·®é›†ç­‰æ“ä½œï¼Œé‚£ä¹ˆå°±å¯ä»¥éå¸¸æ–¹ä¾¿çš„å®ç°å¦‚å…±åŒå…³æ³¨ã€å…±åŒå–œå¥½ã€äºŒåº¦å¥½å‹ç­‰åŠŸèƒ½ï¼Œå¯¹ä¸Šé¢çš„æ‰€æœ‰é›†åˆæ“ä½œï¼Œä½ è¿˜å¯ä»¥ä½¿ç”¨ä¸åŒçš„å‘½ä»¤é€‰æ‹©å°†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯è¿˜æ˜¯å­˜é›†åˆ°ä¸€ä¸ªæ–°çš„é›†åˆä¸­ã€‚</p><p>1.å…±åŒå¥½å‹ã€äºŒåº¦å¥½å‹<br>2.åˆ©ç”¨å”¯ä¸€æ€§ï¼Œå¯ä»¥ç»Ÿè®¡è®¿é—®ç½‘ç«™çš„æ‰€æœ‰ç‹¬ç«‹ IP<br>3.å¥½å‹æ¨èçš„æ—¶å€™ï¼Œæ ¹æ® tag æ±‚äº¤é›†ï¼Œå¤§äºæŸä¸ªé˜ˆå€¼ï¼ˆthresholdï¼‰å°±å¯ä»¥æ¨è</p><h4 id="Zset-é›†åˆï¼ˆSorted-Setsï¼‰"><a href="#Zset-é›†åˆï¼ˆSorted-Setsï¼‰" class="headerlink" title="Zset é›†åˆï¼ˆSorted Setsï¼‰"></a>Zset é›†åˆï¼ˆSorted Setsï¼‰</h4><p>Sorted Set æœ‰ç‚¹åƒ Set å’Œ Hash çš„ç»“åˆä½“ã€‚</p><p>å’Œ Set ä¸€æ ·ï¼Œå®ƒé‡Œé¢çš„å…ƒç´ æ˜¯å”¯ä¸€çš„ï¼Œä½†æ˜¯ Set é‡Œé¢çš„å…ƒç´ æ˜¯æ— åºçš„ï¼Œè€Œ Sorted Set é‡Œé¢çš„å…ƒç´ éƒ½å¸¦æœ‰ä¸€ä¸ªæµ®ç‚¹å€¼ï¼Œå«åšåˆ†æ•°ï¼ˆscoreï¼‰ï¼Œå†…éƒ¨æ•°æ®ç»“æ„<strong>è·³è·ƒè¡¨</strong>ï¼Œæ‰€ä»¥è¿™ä¸€ç‚¹å’Œ Hash æœ‰ç‚¹åƒï¼Œå› ä¸ºæ¯ä¸ªå…ƒç´ éƒ½æ˜ å°„åˆ°äº†ä¸€ä¸ªå€¼ã€‚<br>ä½¿å®ƒåœ¨ set çš„åŸºç¡€ä¸Šå¢åŠ äº†ä¸€ä¸ª<strong>é¡ºåºå±æ€§</strong>ï¼Œè¿™ä¸€å±æ€§åœ¨æ·»åŠ ä¿®æ”¹å…ƒç´ çš„æ—¶å€™å¯ä»¥æŒ‡å®šï¼Œæ¯æ¬¡æŒ‡å®šåï¼Œzset ä¼šè‡ªåŠ¨é‡æ–°æŒ‰æ–°çš„å€¼è°ƒæ•´é¡ºåºã€‚å¯ä»¥å¯¹æŒ‡å®šé”®çš„å€¼è¿›è¡Œæ’åºæƒé‡çš„è®¾å®šï¼Œå®ƒåº”ç”¨æ’åæ¨¡å—æ¯”è¾ƒå¤šã€‚</p><p>æ¯”å¦‚ä¸€ä¸ªå­˜å‚¨å…¨ç­åŒå­¦æˆç»©çš„ Sorted Setsï¼Œå…¶é›†åˆ value å¯ä»¥æ˜¯åŒå­¦çš„å­¦å·ï¼Œè€Œ score å°±å¯ä»¥æ˜¯å…¶è€ƒè¯•å¾—åˆ†ï¼Œè¿™æ ·åœ¨æ•°æ®æ’å…¥é›†åˆçš„æ—¶å€™ï¼Œå°±å·²ç»è¿›è¡Œäº†å¤©ç„¶çš„æ’åºã€‚å¦å¤–è¿˜å¯ä»¥ç”¨ Sorted Sets æ¥åšå¸¦æƒé‡çš„é˜Ÿåˆ—ï¼Œæ¯”å¦‚æ™®é€šæ¶ˆæ¯çš„ score ä¸º 1ï¼Œé‡è¦æ¶ˆæ¯çš„ score ä¸º 2ï¼Œç„¶åå·¥ä½œçº¿ç¨‹å¯ä»¥é€‰æ‹©æŒ‰ score çš„å€’åºæ¥è·å–å·¥ä½œä»»åŠ¡ï¼Œè®©é‡è¦çš„ä»»åŠ¡ä¼˜å…ˆæ‰§è¡Œã€‚</p><p>zset é›†åˆå¯ä»¥å®Œæˆæœ‰åºæ‰§è¡Œã€æŒ‰ç…§<code>ä¼˜å…ˆçº§æ‰§è¡Œ</code>çš„æƒ…å†µï¼›</p><ul><li><a href="https://www.cnblogs.com/xuzhengzong/p/7724841.html">redis äº”ç§æ•°æ®ç»“æ„è¯¦è§£ï¼ˆstringï¼Œlistï¼Œsetï¼Œzsetï¼Œhashï¼‰</a>   </li><li><a href="https://www.cnblogs.com/tangge/p/10698821.html">Redis å®æˆ˜ - listã€set å’Œ Sorted Set</a>    </li></ul><h2 id="ç‹¬åˆ°ç§‘æŠ€"><a href="#ç‹¬åˆ°ç§‘æŠ€" class="headerlink" title="ç‹¬åˆ°ç§‘æŠ€"></a>ç‹¬åˆ°ç§‘æŠ€</h2><h3 id="è¿›ç¨‹çº¿ç¨‹ä»¥åŠåç¨‹"><a href="#è¿›ç¨‹çº¿ç¨‹ä»¥åŠåç¨‹" class="headerlink" title="è¿›ç¨‹çº¿ç¨‹ä»¥åŠåç¨‹"></a>è¿›ç¨‹çº¿ç¨‹ä»¥åŠåç¨‹</h3><ol><li><p>è¿›ç¨‹<br>è¿›ç¨‹æ˜¯å…·æœ‰ä¸€å®šç‹¬ç«‹åŠŸèƒ½çš„ç¨‹åºå…³äºæŸä¸ªæ•°æ®é›†åˆä¸Šçš„ä¸€æ¬¡è¿è¡Œæ´»åŠ¨ï¼Œ<strong>è¿›ç¨‹æ˜¯ç³»ç»Ÿè¿›è¡Œèµ„æºåˆ†é…å’Œè°ƒåº¦çš„åŸºæœ¬å•ä½</strong>ã€‚æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„ç‹¬ç«‹å†…å­˜ç©ºé—´ï¼Œä¸åŒè¿›ç¨‹é€šè¿‡è¿›ç¨‹é—´é€šä¿¡*ï¼ˆIPCï¼‰æ¥é€šä¿¡ã€‚ç”±äºè¿›ç¨‹æ¯”è¾ƒé‡é‡ï¼Œå æ®ç‹¬ç«‹çš„å†…å­˜ï¼Œæ‰€ä»¥ä¸Šä¸‹æ–‡è¿›ç¨‹é—´çš„åˆ‡æ¢å¼€é”€ï¼ˆæ ˆã€å¯„å­˜å™¨ã€è™šæ‹Ÿå†…å­˜ã€æ–‡ä»¶å¥æŸ„ç­‰ï¼‰æ¯”è¾ƒå¤§ï¼Œä½†ç›¸å¯¹æ¯”è¾ƒç¨³å®šå®‰å…¨ã€‚</p></li><li><p>çº¿ç¨‹<br><strong>çº¿ç¨‹æ˜¯è¿›ç¨‹çš„ä¸€ä¸ªå®ä½“ï¼Œæ˜¯ CPU è°ƒåº¦å’Œåˆ†æ´¾çš„åŸºæœ¬å•ä½</strong>ï¼Œå®ƒæ˜¯æ¯”è¿›ç¨‹æ›´å°çš„èƒ½ç‹¬ç«‹è¿è¡Œçš„åŸºæœ¬å•ä½ã€‚çº¿ç¨‹è‡ªå·±åŸºæœ¬ä¸Šä¸æ‹¥æœ‰ç³»ç»Ÿèµ„æºï¼Œåªæ‹¥æœ‰ä¸€ç‚¹åœ¨è¿è¡Œä¸­å¿…ä¸å¯å°‘çš„èµ„æº(å¦‚ç¨‹åºè®¡æ•°å™¨ï¼Œä¸€ç»„å¯„å­˜å™¨å’Œæ ˆ)ï¼Œä½†æ˜¯å®ƒå¯ä¸åŒå±ä¸€ä¸ªè¿›ç¨‹çš„å…¶ä»–çš„çº¿ç¨‹å…±äº«è¿›ç¨‹æ‰€æ‹¥æœ‰çš„å…¨éƒ¨èµ„æºã€‚çº¿ç¨‹é—´é€šä¿¡ä¸»è¦é€šè¿‡å…±äº«å†…å­˜ï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢å¾ˆå¿«ï¼Œèµ„æºå¼€é”€è¾ƒå°‘ï¼Œä½†ç›¸æ¯”è¿›ç¨‹ä¸å¤Ÿç¨³å®šå®¹æ˜“ä¸¢å¤±æ•°æ®ã€‚</p></li><li><p>åç¨‹<br>åç¨‹æ˜¯ä¸€ç§<strong>ç”¨æˆ·æ€</strong>çš„<strong>è½»é‡çº§çº¿ç¨‹</strong>ï¼Œ<strong>åç¨‹çš„è°ƒåº¦å®Œå…¨ç”±ç”¨æˆ·æ§åˆ¶</strong>ã€‚<strong>åç¨‹æ‹¥æœ‰è‡ªå·±çš„å¯„å­˜å™¨ä¸Šä¸‹æ–‡å’Œæ ˆ</strong>ã€‚åç¨‹è°ƒåº¦åˆ‡æ¢æ—¶ï¼Œå°†å¯„å­˜å™¨ä¸Šä¸‹æ–‡å’Œæ ˆä¿å­˜åˆ°å…¶ä»–åœ°æ–¹ï¼Œåœ¨åˆ‡å›æ¥çš„æ—¶å€™ï¼Œæ¢å¤å…ˆå‰ä¿å­˜çš„å¯„å­˜å™¨ä¸Šä¸‹æ–‡å’Œæ ˆï¼Œç›´æ¥æ“ä½œæ ˆåˆ™åŸºæœ¬æ²¡æœ‰å†…æ ¸åˆ‡æ¢çš„å¼€é”€ï¼Œå¯ä»¥ä¸åŠ é”çš„è®¿é—®å…¨å±€å˜é‡ï¼Œæ‰€ä»¥ä¸Šä¸‹æ–‡çš„åˆ‡æ¢éå¸¸å¿«ã€‚å¯ä»¥åˆ©ç”¨åˆ°å¹¶å‘ä¼˜åŠ¿ï¼Œåˆå¯ä»¥<strong>é¿å…åå¤ç³»ç»Ÿè°ƒç”¨å’Œè¿›ç¨‹åˆ‡æ¢é€ æˆçš„å¼€é”€</strong>ã€‚</p></li></ol><h4 id="åŒºåˆ«"><a href="#åŒºåˆ«" class="headerlink" title="åŒºåˆ«"></a>åŒºåˆ«</h4><ul><li>è¿›ç¨‹ä¸çº¿ç¨‹æ¯”è¾ƒ<br>çº¿ç¨‹æ˜¯æŒ‡è¿›ç¨‹å†…çš„ä¸€ä¸ªæ‰§è¡Œå•å…ƒï¼Œä¹Ÿæ˜¯è¿›ç¨‹å†…çš„å¯è°ƒåº¦å®ä½“ã€‚çº¿ç¨‹ä¸è¿›ç¨‹çš„åŒºåˆ«:</li></ul><ol><li>åœ°å€ç©ºé—´:çº¿ç¨‹æ˜¯è¿›ç¨‹å†…çš„ä¸€ä¸ªæ‰§è¡Œå•å…ƒï¼Œè¿›ç¨‹å†…è‡³å°‘æœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œå®ƒä»¬å…±äº«è¿›ç¨‹çš„åœ°å€ç©ºé—´ï¼Œè€Œè¿›ç¨‹æœ‰è‡ªå·±ç‹¬ç«‹çš„åœ°å€ç©ºé—´ï¼›</li><li>èµ„æºæ‹¥æœ‰:è¿›ç¨‹æ˜¯èµ„æºåˆ†é…å’Œæ‹¥æœ‰çš„å•ä½ï¼ŒåŒä¸€ä¸ªè¿›ç¨‹å†…çš„çº¿ç¨‹å…±äº«è¿›ç¨‹çš„èµ„æºï¼›</li><li>çº¿ç¨‹æ˜¯å¤„ç†å™¨è°ƒåº¦çš„åŸºæœ¬å•ä½ï¼Œä½†è¿›ç¨‹ä¸æ˜¯ï¼›</li><li>æ¯ä¸ªç‹¬ç«‹çš„çº¿ç¨‹æœ‰ä¸€ä¸ªç¨‹åºè¿è¡Œçš„å…¥å£ã€é¡ºåºæ‰§è¡Œåºåˆ—å’Œç¨‹åºçš„å‡ºå£ï¼Œä½†æ˜¯çº¿ç¨‹ä¸èƒ½å¤Ÿç‹¬ç«‹æ‰§è¡Œï¼Œå¿…é¡»ä¾å­˜åœ¨åº”ç”¨ç¨‹åºä¸­ï¼Œç”±åº”ç”¨ç¨‹åºæä¾›å¤šä¸ªçº¿ç¨‹æ‰§è¡Œæ§åˆ¶ï¼›</li></ol><ul><li>åç¨‹ä¸çº¿ç¨‹è¿›è¡Œæ¯”è¾ƒ</li></ul><ol><li>ä¸€ä¸ªçº¿ç¨‹å¯ä»¥å¤šä¸ªåç¨‹ï¼Œä¸€ä¸ªè¿›ç¨‹ä¹Ÿå¯ä»¥å•ç‹¬æ‹¥æœ‰å¤šä¸ªåç¨‹ï¼Œè¿™æ · python ä¸­åˆ™èƒ½ä½¿ç”¨å¤šæ ¸ CPUï¼›</li><li>çº¿ç¨‹è¿›ç¨‹éƒ½æ˜¯åŒæ­¥æœºåˆ¶ï¼Œè€Œåç¨‹åˆ™æ˜¯<strong>å¼‚æ­¥</strong>ï¼›</li><li>åç¨‹èƒ½ä¿ç•™ä¸Šä¸€æ¬¡è°ƒç”¨æ—¶çš„çŠ¶æ€ï¼Œæ¯æ¬¡è¿‡ç¨‹é‡å…¥æ—¶ï¼Œå°±ç›¸å½“äºè¿›å…¥ä¸Šä¸€æ¬¡è°ƒç”¨çš„çŠ¶æ€ï¼›<br>å†…æ ¸æ€çš„çº¿ç¨‹æ˜¯ç”±æ“ä½œç³»ç»Ÿæ¥è¿›è¡Œè°ƒåº¦çš„ï¼Œåœ¨åˆ‡æ¢çº¿ç¨‹ä¸Šä¸‹æ–‡æ—¶ï¼Œè¦å…ˆä¿å­˜ä¸Šä¸€ä¸ªçº¿ç¨‹çš„ä¸Šä¸‹æ–‡ï¼Œç„¶åæ‰§è¡Œä¸‹ä¸€ä¸ªçº¿ç¨‹ï¼Œå½“æ¡ä»¶æ»¡è¶³æ—¶ï¼Œåˆ‡æ¢å›ä¸Šä¸€ä¸ªçº¿ç¨‹ï¼Œå¹¶æ¢å¤ä¸Šä¸‹æ–‡ã€‚åç¨‹ä¹Ÿæ˜¯å¦‚æ­¤ï¼ˆæŒ‡éœ€è¦åˆ‡æ¢ â†’ ä¿å­˜ â†’ æ¢å¤ä¸Šä¸‹æ–‡ï¼‰ã€‚åªä¸è¿‡ï¼Œç”¨æˆ·æ€çš„çº¿ç¨‹ä¸æ˜¯ç”±æ“ä½œç³»ç»Ÿæ¥è°ƒåº¦çš„ï¼Œè€Œæ˜¯ç”±ç¨‹åºå‘˜æ¥è°ƒåº¦çš„ï¼Œæ˜¯åœ¨ç”¨æˆ·æ€çš„ã€‚<br><a href="https://www.cnblogs.com/lxmhhy/p/6041001.html">è¿›ç¨‹å’Œçº¿ç¨‹ã€åç¨‹çš„åŒºåˆ«</a></li></ol><h3 id="äºŒå‰æ ‘çš„æ·±åº¦ä¼˜å…ˆç®—æ³•å’Œå¹¿åº¦ä¼˜å…ˆç®—æ³•"><a href="#äºŒå‰æ ‘çš„æ·±åº¦ä¼˜å…ˆç®—æ³•å’Œå¹¿åº¦ä¼˜å…ˆç®—æ³•" class="headerlink" title="äºŒå‰æ ‘çš„æ·±åº¦ä¼˜å…ˆç®—æ³•å’Œå¹¿åº¦ä¼˜å…ˆç®—æ³•"></a>äºŒå‰æ ‘çš„æ·±åº¦ä¼˜å…ˆç®—æ³•å’Œå¹¿åº¦ä¼˜å…ˆç®—æ³•</h3><p>äºŒå‰æ ‘çš„<strong>æ·±åº¦ä¼˜å…ˆ</strong>éå†çš„éé€’å½’çš„é€šç”¨åšæ³•æ˜¯<strong>é‡‡ç”¨æ ˆ</strong>ï¼Œ<strong>å¹¿åº¦ä¼˜å…ˆ</strong>éå†çš„éé€’å½’çš„é€šç”¨åšæ³•æ˜¯<strong>é‡‡ç”¨é˜Ÿåˆ—</strong>ã€‚<br>1ï¼šæ ‘çš„æ·±åº¦ä¼˜å…ˆéå†ä¸»è¦åˆ†ä¸ºï¼šå‰åºéå†ã€ä¸­åºéå†ä»¥åŠååºéå†</p><pre><code>- å‰åºéå†ï¼šè‹¥äºŒå‰æ ‘ä¸ºç©ºåˆ™ç»“æŸï¼Œå¦åˆ™ä¾æ¬¡å…ˆè®¿é—®æ ¹èŠ‚ç‚¹ï¼Œç„¶åè®¿é—®å·¦å­æ ‘ï¼Œæœ€åè®¿é—®å³å­æ ‘ã€‚- ä¸­åºéå†ï¼šè‹¥äºŒå‰æ ‘ä¸ºç©ºåˆ™ç»“æŸï¼Œå¦åˆ™å…ˆè®¿é—®æ ¹èŠ‚ç‚¹çš„å·¦å­æ ‘ï¼Œç„¶åè®¿é—®æ ¹èŠ‚ç‚¹ï¼Œæœ€åè®¿é—®å³å­æ•°ã€‚- ååºéå†ï¼šè‹¥äºŒå‰æ ‘ä¸ºç©ºåˆ™ç»“æŸï¼Œå¦åˆ™å…ˆè®¿é—®æ ¹èŠ‚ç‚¹çš„å·¦å­æ ‘ï¼Œç„¶åè®¿é—®å³å­æ•°ï¼Œæœ€åè®¿é—®æ ¹èŠ‚ç‚¹ã€‚ æ·±åº¦ä¼˜å…ˆä¸€èˆ¬é‡‡ç”¨é€’å½’çš„æ–¹å¼å®ç°ï¼Œé€’å½’çš„æ·±åº¦ä¸ºæ ‘çš„é«˜åº¦ã€‚</code></pre><p>2ï¼šæ ‘çš„å¹¿åº¦ä¼˜å…ˆç®—æ³•ï¼šå¹¿åº¦ä¼˜å…ˆæ˜¯æŒ‰ç…§å±‚æ¬¡æ¥éå†æ ‘çš„èŠ‚ç‚¹ï¼Œå…ˆæ˜¯æ ¹èŠ‚ç‚¹ï¼Œç„¶åä¾æ¬¡éå†ç¬¬äºŒå±‚å­èŠ‚ç‚¹ï¼Œå½“ç¬¬äºŒå±‚å­èŠ‚ç‚¹éå†å®Œåï¼Œåœ¨ä¾æ¬¡éå†ç¬¬ä¸‰å±‚å­èŠ‚ç‚¹ã€‚å¹¿åº¦ä¼˜å…ˆé‡‡ç”¨é˜Ÿåˆ—æ¥è®°å½•å½“å‰å¯éå†çš„èŠ‚ç‚¹ï¼Œå½“éå†æŸä¸ªèŠ‚ç‚¹æ—¶ï¼Œå°†å…¶å·¦å­©å­å’Œå³å­©å­ç»“ç‚¹ä¾æ¬¡å…¥é˜Ÿï¼Œå¾…è¯¥å±‚éå†å®Œäº†ä»¥åï¼Œå†ä¾æ¬¡éå†ä¸‹ä¸€å±‚å„¿å­ç»“ç‚¹ã€‚<br>3ï¼šéé€’å½’å®ç°ç‰¹ç‚¹ï¼š æ·±åº¦ä¼˜å…ˆä¸€èˆ¬é‡‡ç”¨é€’å½’å®ç°ï¼Œå¦‚æ”¹ç”¨éé€’å½’ï¼Œåˆ™å¯éœ€è¦æ¥æ¨¡æ‹Ÿæ ˆï¼Œå½“éœ€è¦å…ˆéå†å½“å‰èŠ‚ç‚¹çš„å„¿å­ç»“ç‚¹æ—¶ï¼ˆä¾‹å¦‚ä¸­åºéå†ï¼‰éœ€è¦å°†å…¶å‹å…¥æ ˆä¸­ï¼Œå…ˆéå†å…¶å„¿å­ç»“ç‚¹ï¼Œç„¶åå†å°†å…¶å¼¹å‡ºæ ˆï¼Œéå†å½“å‰èŠ‚ç‚¹ã€‚å¹¿åº¦ä¼˜å…ˆä¸€èˆ¬é‡‡ç”¨éé€’å½’æ¥å®ç°ï¼Œç”¨ä¸€ä¸ªé˜Ÿåˆ—æ¥ä¿å­˜ä¾æ¬¡éœ€è¦éå†çš„èŠ‚ç‚¹ã€‚ </p><ol><li><a href="https://www.masantu.com/blog/2019-10-28/binary-tree-BFS-and-DFS/">äºŒå‰æ ‘æ·±åº¦ä¼˜å…ˆéå†ï¼ˆDFSï¼‰å’Œå¹¿åº¦ä¼˜å…ˆéå†ï¼ˆBFSï¼‰</a></li><li><a href="https://www.nowcoder.com/questionTerminal/b194924b44b144e8a238819a0a6dae42">ç®€è¿°æ ‘çš„æ·±åº¦ä¼˜å…ˆç®—æ³•ã€å¹¿åº¦ä¼˜å…ˆç®—æ³•ï¼ŒåŠéé€’å½’å®ç°çš„ç‰¹ç‚¹</a>   </li><li><a href="https://nullcc.github.io/2018/06/07/%E5%B9%BF%E5%BA%A6%E4%BC%98%E5%85%88%E6%90%9C%E7%B4%A2(BFS">å¹¿åº¦ä¼˜å…ˆæœç´¢(BFS)å’Œæ·±åº¦ä¼˜å…ˆæœç´¢(DFS)</a>%E5%92%8C%E6%B7%B1%E5%BA%A6%E4%BC%98%E5%85%88%E6%90%9C%E7%B4%A2(DFS)/)<blockquote><p><a href="https://nullcc.github.io/2018/06/07/å¹¿åº¦ä¼˜å…ˆæœç´¢(BFS)å’Œæ·±åº¦ä¼˜å…ˆæœç´¢(DFS)/">https://nullcc.github.io/2018/06/07/å¹¿åº¦ä¼˜å…ˆæœç´¢(BFS)å’Œæ·±åº¦ä¼˜å…ˆæœç´¢(DFS)/</a></p></blockquote></li></ol><h3 id="Python-åƒåœ¾å›æ”¶æœºåˆ¶"><a href="#Python-åƒåœ¾å›æ”¶æœºåˆ¶" class="headerlink" title="Python åƒåœ¾å›æ”¶æœºåˆ¶"></a>Python åƒåœ¾å›æ”¶æœºåˆ¶</h3><p><a href="https://wiki.masantu.com/wiki/%F0%9F%92%BB%E5%B7%A5%E4%BD%9C/%F0%9F%90%8DPython/%E9%9D%A2%E8%AF%95/interview-of-python/#Python-%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6">Python åƒåœ¾å›æ”¶æœºåˆ¶</a></p><ul><li>å¼•ç”¨è®¡æ•°<br>PyObject æ˜¯æ¯ä¸ªå¯¹è±¡å¿…æœ‰çš„å†…å®¹ï¼Œå…¶ä¸­ ob_refcnt å°±æ˜¯åšä¸ºå¼•ç”¨è®¡æ•°ã€‚å½“ä¸€ä¸ªå¯¹è±¡æœ‰æ–°çš„å¼•ç”¨æ—¶ï¼Œå®ƒçš„ ob_refcnt å°±ä¼šå¢åŠ ï¼Œå½“å¼•ç”¨å®ƒçš„å¯¹è±¡è¢«åˆ é™¤ï¼Œå®ƒçš„ ob_refcnt å°±ä¼šå‡å°‘ã€‚å¼•ç”¨è®¡æ•°ä¸º 0 æ—¶ï¼Œè¯¥å¯¹è±¡ç”Ÿå‘½å°±ç»“æŸäº†ã€‚</li><li>æ ‡è®°-æ¸…é™¤æœºåˆ¶<br>åŸºæœ¬æ€è·¯æ˜¯å…ˆæŒ‰éœ€åˆ†é…ï¼Œç­‰åˆ°æ²¡æœ‰ç©ºé—²å†…å­˜çš„æ—¶å€™ä»å¯„å­˜å™¨å’Œç¨‹åºæ ˆä¸Šçš„å¼•ç”¨å‡ºå‘ï¼Œéå†ä»¥å¯¹è±¡ä¸ºèŠ‚ç‚¹ã€ä»¥å¼•ç”¨ä¸ºè¾¹æ„æˆçš„å›¾ï¼ŒæŠŠæ‰€æœ‰å¯ä»¥è®¿é—®åˆ°çš„å¯¹è±¡æ‰“ä¸Šæ ‡è®°ï¼Œç„¶åæ¸…æ‰«ä¸€éå†…å­˜ç©ºé—´ï¼ŒæŠŠæ‰€æœ‰æ²¡æ ‡è®°çš„å¯¹è±¡é‡Šæ”¾ã€‚</li><li>åˆ†ä»£æŠ€æœ¯<br>åˆ†ä»£å›æ”¶æ˜¯ä¸€ç§ä»¥ç©ºé—´æ¢æ—¶é—´çš„æ“ä½œæ–¹å¼ï¼ŒPython å°†å†…å­˜æ ¹æ®å¯¹è±¡çš„å­˜æ´»æ—¶é—´åˆ’åˆ†ä¸ºä¸åŒçš„é›†åˆï¼Œæ¯ä¸ªé›†åˆç§°ä¸ºä¸€ä¸ªä»£ï¼ŒPython å°†å†…å­˜åˆ†ä¸ºäº† 3â€œä»£â€ï¼Œåˆ†åˆ«ä¸ºå¹´è½»ä»£ï¼ˆç¬¬ 0 ä»£ï¼‰ã€ä¸­å¹´ä»£ï¼ˆç¬¬ 1 ä»£ï¼‰ã€è€å¹´ä»£ï¼ˆç¬¬ 2 ä»£ï¼‰ï¼Œä»–ä»¬å¯¹åº”çš„æ˜¯ 3 ä¸ªé“¾è¡¨ï¼Œå®ƒä»¬çš„åƒåœ¾æ”¶é›†é¢‘ç‡ä¸å¯¹è±¡çš„å­˜æ´»æ—¶é—´çš„å¢å¤§è€Œå‡å°ã€‚æ–°åˆ›å»ºçš„å¯¹è±¡éƒ½ä¼šåˆ†é…åœ¨å¹´è½»ä»£ï¼Œå¹´è½»ä»£é“¾è¡¨çš„æ€»æ•°è¾¾åˆ°ä¸Šé™æ—¶ï¼ŒPython åƒåœ¾æ”¶é›†æœºåˆ¶å°±ä¼šè¢«è§¦å‘ï¼ŒæŠŠé‚£äº›å¯ä»¥è¢«å›æ”¶çš„å¯¹è±¡å›æ”¶æ‰ï¼Œè€Œé‚£äº›ä¸ä¼šå›æ”¶çš„å¯¹è±¡å°±ä¼šè¢«ç§»åˆ°ä¸­å¹´ä»£å»ï¼Œä¾æ­¤ç±»æ¨ï¼Œè€å¹´ä»£ä¸­çš„å¯¹è±¡æ˜¯å­˜æ´»æ—¶é—´æœ€ä¹…çš„å¯¹è±¡ï¼Œç”šè‡³æ˜¯å­˜æ´»äºæ•´ä¸ªç³»ç»Ÿçš„ç”Ÿå‘½å‘¨æœŸå†…ã€‚åŒæ—¶ï¼Œåˆ†ä»£å›æ”¶æ˜¯å»ºç«‹åœ¨æ ‡è®°æ¸…é™¤æŠ€æœ¯åŸºç¡€ä¹‹ä¸Šã€‚</li></ul><p>åˆ†ä»£å›æ”¶çš„æ•´ä½“æ€æƒ³æ˜¯ï¼šå°†ç³»ç»Ÿä¸­çš„æ‰€æœ‰å†…å­˜å—æ ¹æ®å…¶å­˜æ´»æ—¶é—´åˆ’åˆ†ä¸ºä¸åŒçš„é›†åˆï¼Œæ¯ä¸ªé›†åˆå°±æˆä¸ºä¸€ä¸ªâ€œä»£â€ï¼Œåƒåœ¾æ”¶é›†é¢‘ç‡éšç€â€œä»£â€çš„å­˜æ´»æ—¶é—´çš„å¢å¤§è€Œå‡å°ï¼Œå­˜æ´»æ—¶é—´é€šå¸¸åˆ©ç”¨ç»è¿‡å‡ æ¬¡åƒåœ¾å›æ”¶æ¥åº¦é‡ã€‚</p><h3 id="Python-ä¼ å€¼è¿˜æ˜¯ä¼ å¼•ç”¨"><a href="#Python-ä¼ å€¼è¿˜æ˜¯ä¼ å¼•ç”¨" class="headerlink" title="Python ä¼ å€¼è¿˜æ˜¯ä¼ å¼•ç”¨"></a>Python ä¼ å€¼è¿˜æ˜¯ä¼ å¼•ç”¨</h3><p>python å‚æ•°ä¼ é€’é‡‡ç”¨çš„æ˜¯â€œ<strong>ä¼ å¯¹è±¡å¼•ç”¨</strong>â€çš„æ–¹å¼ã€‚è¿™ç§æ–¹å¼ç›¸å½“äºä¼ å€¼å’Œä¼ å¼•ç”¨çš„ä¸€ç§ç»¼åˆã€‚å¦‚æœå‡½æ•°æ”¶åˆ°çš„æ˜¯ä¸€ä¸ªä¸å¯å˜å¯¹è±¡ï¼ˆæ•°å­—ã€å­—ç¬¦æˆ–å…ƒç»„ï¼‰çš„å¼•ç”¨ï¼Œå°±ä¸èƒ½ç›´æ¥ä¿®æ”¹åŸå§‹å¯¹è±¡â€”â€”ç›¸å½“äºé€šè¿‡â€˜å€¼ä¼ é€’â€™æ¥ä¼ é€’å¯¹è±¡ã€‚å¦‚æœå‡½æ•°æ”¶åˆ°çš„æ˜¯ä¸€ä¸ªå¯å˜å¯¹è±¡ï¼ˆå­—å…¸ã€åˆ—è¡¨ï¼‰çš„å¼•ç”¨ï¼Œå°±èƒ½ä¿®æ”¹å¯¹è±¡çš„åŸå§‹å€¼â€”â€”ç›¸å½“äºâ€˜ä¼ å¼•ç”¨â€™æ¥ä¼ é€’å¯¹è±¡ã€‚</p><p><a href="https://www.masantu.com/blog/2019-04-13/python-pass-by-object-reference/">Python ä¼ å€¼è¿˜æ˜¯ä¼ å¼•ç”¨ï¼Ÿ| é€šè¿‡å¯¹è±¡å¼•ç”¨ä¼ é€’</a></p><h2 id="ä¸­å¤©è”ç§‘"><a href="#ä¸­å¤©è”ç§‘" class="headerlink" title="ä¸­å¤©è”ç§‘"></a>ä¸­å¤©è”ç§‘</h2><h3 id="ç±»å±æ€§å’Œå®ä¾‹å±æ€§çš„åŒºåˆ«ï¼Œå¦‚ä½•åˆ¤æ–­ç±»-A-æ˜¯å¦æœ‰å±æ€§-x"><a href="#ç±»å±æ€§å’Œå®ä¾‹å±æ€§çš„åŒºåˆ«ï¼Œå¦‚ä½•åˆ¤æ–­ç±»-A-æ˜¯å¦æœ‰å±æ€§-x" class="headerlink" title="ç±»å±æ€§å’Œå®ä¾‹å±æ€§çš„åŒºåˆ«ï¼Œå¦‚ä½•åˆ¤æ–­ç±» A æ˜¯å¦æœ‰å±æ€§ x"></a>ç±»å±æ€§å’Œå®ä¾‹å±æ€§çš„åŒºåˆ«ï¼Œå¦‚ä½•åˆ¤æ–­ç±» A æ˜¯å¦æœ‰å±æ€§ x</h3><p><a href="https://github.com/imoyao/interview_python#4-%E7%B1%BB%E5%8F%98%E9%87%8F%E5%92%8C%E5%AE%9E%E4%BE%8B%E5%8F%98%E9%87%8F">ç±»å˜é‡å’Œå®ä¾‹å˜é‡</a><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span></span><br><span class="line">    X = <span class="string">&#x27;Hello&#x27;</span>     <span class="comment"># ç±»å±æ€§</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,name=<span class="string">&#x27;World&#x27;</span></span>):</span></span><br><span class="line">        self.name = name    <span class="comment"># å®ä¾‹å±æ€§</span></span><br><span class="line"></span><br><span class="line">a = A(<span class="string">&#x27;foo&#x27;</span>)</span><br><span class="line">print(A.X)  <span class="comment"># Hello</span></span><br><span class="line">print(a.name)   <span class="comment">#foo</span></span><br><span class="line">print(<span class="built_in">hasattr</span>(a,<span class="string">&#x27;X&#x27;</span>))   <span class="comment"># True</span></span><br><span class="line">print(<span class="built_in">hasattr</span>(A,<span class="string">&#x27;X&#x27;</span>))   <span class="comment"># True</span></span><br><span class="line">print(<span class="built_in">hasattr</span>(A,<span class="string">&#x27;name&#x27;</span>))    <span class="comment"># False</span></span><br><span class="line">print(<span class="built_in">hasattr</span>(a,<span class="string">&#x27;name&#x27;</span>))    <span class="comment"># True</span></span><br><span class="line"><span class="built_in">setattr</span>(a,<span class="string">&#x27;name&#x27;</span>,<span class="string">&#x27;bar&#x27;</span>)</span><br><span class="line"><span class="built_in">setattr</span>(A,<span class="string">&#x27;X&#x27;</span>,<span class="string">&#x27;Bye&#x27;</span>)</span><br><span class="line">print(a.name)   <span class="comment"># bar</span></span><br><span class="line">print(A.X)  <span class="comment"># Bye</span></span><br></pre></td></tr></table></figure></p><h3 id="ä»€ä¹ˆæ˜¯åˆ—è¡¨æ¨å¯¼å¼ï¼Ÿå¦‚ä½•ç”¨ä¸€è¡Œä»£ç åˆ¤æ–­ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹é¢æ–‡ä»¶æ•°å¤§äº-10-ä¸ªçš„å­ç›®å½•"><a href="#ä»€ä¹ˆæ˜¯åˆ—è¡¨æ¨å¯¼å¼ï¼Ÿå¦‚ä½•ç”¨ä¸€è¡Œä»£ç åˆ¤æ–­ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹é¢æ–‡ä»¶æ•°å¤§äº-10-ä¸ªçš„å­ç›®å½•" class="headerlink" title="ä»€ä¹ˆæ˜¯åˆ—è¡¨æ¨å¯¼å¼ï¼Ÿå¦‚ä½•ç”¨ä¸€è¡Œä»£ç åˆ¤æ–­ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹é¢æ–‡ä»¶æ•°å¤§äº 10 ä¸ªçš„å­ç›®å½•"></a>ä»€ä¹ˆæ˜¯åˆ—è¡¨æ¨å¯¼å¼ï¼Ÿå¦‚ä½•ç”¨ä¸€è¡Œä»£ç åˆ¤æ–­ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹é¢æ–‡ä»¶æ•°å¤§äº 10 ä¸ªçš„å­ç›®å½•</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">print([_ <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_file_more_than_10</span>(<span class="params">root_dir_fp=<span class="literal">None</span>, limit=<span class="number">10</span></span>):</span></span><br><span class="line">    <span class="keyword">if</span> root_dir_fp <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        root_dir_fp = os.path.split((os.path.abspath(__file__)))[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> [dirpath <span class="keyword">for</span> dirpath, _, filenames <span class="keyword">in</span> os.walk(root_dir_fp) <span class="keyword">if</span></span><br><span class="line">            <span class="built_in">len</span>(filenames) &gt; limit]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    print(find_file_more_than_10())</span><br></pre></td></tr></table></figure><h3 id="ä»€ä¹ˆæ˜¯åç¨‹ï¼Ÿä»€ä¹ˆæ˜¯ç”Ÿæˆå™¨"><a href="#ä»€ä¹ˆæ˜¯åç¨‹ï¼Ÿä»€ä¹ˆæ˜¯ç”Ÿæˆå™¨" class="headerlink" title="ä»€ä¹ˆæ˜¯åç¨‹ï¼Ÿä»€ä¹ˆæ˜¯ç”Ÿæˆå™¨"></a>ä»€ä¹ˆæ˜¯åç¨‹ï¼Ÿä»€ä¹ˆæ˜¯ç”Ÿæˆå™¨</h3><ul><li>ç”Ÿæˆå™¨<br><code>yield</code>å’Œç”Ÿæˆå™¨è¡¨è¾¾å¼<code>(i for i in range(10))</code>ã€‚</li></ul><h2 id="é‡‘å±±äº‘"><a href="#é‡‘å±±äº‘" class="headerlink" title="é‡‘å±±äº‘"></a>é‡‘å±±äº‘</h2><h3 id="å•ä¾‹æ¨¡å¼ï¼Œå¦‚ä½•å®ç°ï¼Ÿä»¥åŠå¦‚ä½•åˆ¤æ–­åªæœ‰è¿™ä¸€ä¸ªå®ä¾‹"><a href="#å•ä¾‹æ¨¡å¼ï¼Œå¦‚ä½•å®ç°ï¼Ÿä»¥åŠå¦‚ä½•åˆ¤æ–­åªæœ‰è¿™ä¸€ä¸ªå®ä¾‹" class="headerlink" title="å•ä¾‹æ¨¡å¼ï¼Œå¦‚ä½•å®ç°ï¼Ÿä»¥åŠå¦‚ä½•åˆ¤æ–­åªæœ‰è¿™ä¸€ä¸ªå®ä¾‹"></a>å•ä¾‹æ¨¡å¼ï¼Œå¦‚ä½•å®ç°ï¼Ÿä»¥åŠå¦‚ä½•åˆ¤æ–­åªæœ‰è¿™ä¸€ä¸ªå®ä¾‹</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span>:</span>    <span class="comment"># py3</span></span><br><span class="line">_instance = &#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__new__</span>(<span class="params">cls,*args,**kwargs</span>):</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> cls._instance:</span><br><span class="line">cls._instance = <span class="built_in">super</span>(Singleton,cls).__new__(cls,*args,**kwargs)</span><br><span class="line"><span class="keyword">return</span> cls._instance</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">deco_singleton</span>(<span class="params">cls</span>):</span></span><br><span class="line">_instance = &#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">wrapper</span>(<span class="params">*args,**kwargs</span>):</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> cls <span class="keyword">in</span> _instance:</span><br><span class="line">_instance[cls] = cls(*args,**kwargs)</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> _instance[cls]</span><br><span class="line"><span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"><span class="meta">@deco_singleton</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span></span><br><span class="line"><span class="keyword">pass</span></span><br></pre></td></tr></table></figure><h3 id="æ­»é”äº§ç”Ÿçš„åŸå› "><a href="#æ­»é”äº§ç”Ÿçš„åŸå› " class="headerlink" title="æ­»é”äº§ç”Ÿçš„åŸå› "></a>æ­»é”äº§ç”Ÿçš„åŸå› </h3><h3 id="ping-åŸŸåçš„è¿‡ç¨‹"><a href="#ping-åŸŸåçš„è¿‡ç¨‹" class="headerlink" title="ping åŸŸåçš„è¿‡ç¨‹"></a>ping åŸŸåçš„è¿‡ç¨‹</h3><p><a href="https://www.masantu.com/blog/2019-11-19/the-detail-of-ping-a-domain/">ping æŸåŸŸåçš„è¿‡ç¨‹è¯¦è§£</a></p><h3 id="select-å’Œ-epoll-åŒºåˆ«"><a href="#select-å’Œ-epoll-åŒºåˆ«" class="headerlink" title="select å’Œ epoll åŒºåˆ«"></a>select å’Œ epoll åŒºåˆ«</h3><ol><li><a href="https://blog.ansheng.me/article/python-full-stack-way-io-multiplexing.html">Python å…¨æ ˆä¹‹è·¯ç³»åˆ—ä¹‹ IO å¤šè·¯å¤ç”¨</a></li><li><a href="https://www.cnblogs.com/anker/p/3265058.html">selectã€pollã€epoll ä¹‹é—´çš„åŒºåˆ«æ€»ç»“[æ•´ç†]</a></li><li><a href="https://www.haiyun.me/archives/1056.html">Python å¼‚æ­¥éé˜»å¡ IO å¤šè·¯å¤ç”¨ Select/Poll/Epoll ä½¿ç”¨</a></li><li><a href="https://www.jianshu.com/p/cdfddb026db0">Python ä½¿ç”¨ select å’Œ epoll å®ç° IO å¤šè·¯å¤ç”¨å®ç°å¹¶å‘æœåŠ¡å™¨</a></li><li><a href="https://harveyqing.gitbooks.io/python-read-and-write/content/python_advance/how_to_use_linux_epoll.html">How To Use Linux epoll with Python</a></li></ol><h2 id="è‰¾æ™®è‰¾"><a href="#è‰¾æ™®è‰¾" class="headerlink" title="è‰¾æ™®è‰¾"></a>è‰¾æ™®è‰¾</h2><h3 id="Redisçš„æ•°æ®ç±»å‹éƒ½æœ‰å“ªäº›ï¼Œå¦‚æœè¦å®ç°è®¡æ•°å™¨åŠŸèƒ½ï¼Œåº”è¯¥é€‰ç”¨å“ªç§æ•°æ®ç±»å‹ï¼Ÿä½¿ç”¨-Redisï¼Œå¦‚æœå†…å­˜æ»¡äº†ä¼šæ€ä¹ˆæ ·"><a href="#Redisçš„æ•°æ®ç±»å‹éƒ½æœ‰å“ªäº›ï¼Œå¦‚æœè¦å®ç°è®¡æ•°å™¨åŠŸèƒ½ï¼Œåº”è¯¥é€‰ç”¨å“ªç§æ•°æ®ç±»å‹ï¼Ÿä½¿ç”¨-Redisï¼Œå¦‚æœå†…å­˜æ»¡äº†ä¼šæ€ä¹ˆæ ·" class="headerlink" title="Redisçš„æ•°æ®ç±»å‹éƒ½æœ‰å“ªäº›ï¼Œå¦‚æœè¦å®ç°è®¡æ•°å™¨åŠŸèƒ½ï¼Œåº”è¯¥é€‰ç”¨å“ªç§æ•°æ®ç±»å‹ï¼Ÿä½¿ç”¨ Redisï¼Œå¦‚æœå†…å­˜æ»¡äº†ä¼šæ€ä¹ˆæ ·"></a><strong>Redis</strong>çš„æ•°æ®ç±»å‹éƒ½æœ‰å“ªäº›ï¼Œå¦‚æœè¦å®ç°è®¡æ•°å™¨åŠŸèƒ½ï¼Œåº”è¯¥é€‰ç”¨å“ªç§æ•°æ®ç±»å‹ï¼Ÿä½¿ç”¨ Redisï¼Œå¦‚æœå†…å­˜æ»¡äº†ä¼šæ€ä¹ˆæ ·</h3><ul><li>æ•°æ®ç±»å‹<br>stringï¼Œlistï¼Œsetï¼Œzsetï¼Œhash</li><li>è®¡æ•°å™¨/é™æµå™¨åŠŸèƒ½</li></ul><ol><li>å¯ä»¥é€‰ç”¨<code>string</code>ç±»å‹ï¼Œè°ƒç”¨<code>incr()</code>æ–¹æ³•ï¼Œå‚è§<a href="https://redis.io/commands/INCR">INCR</a><br>æ¯æ¬¡è‡ªå¢åŠ  1<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">redis&gt;</span><span class="bash"> SET mykey <span class="string">&quot;10&quot;</span></span></span><br><span class="line">&quot;OK&quot;</span><br><span class="line"><span class="meta">redis&gt;</span><span class="bash"> INCR mykey</span></span><br><span class="line">(integer) 11</span><br><span class="line"><span class="meta">redis&gt;</span><span class="bash"> GET mykey</span></span><br><span class="line">&quot;11&quot;</span><br></pre></td></tr></table></figure></li><li>å¯ä»¥é€‰ç”¨<code>hash</code>ç±»å‹ï¼Œè°ƒç”¨<code>hincrby()</code>æ–¹æ³•ï¼Œå‚è§<a href="https://redis.io/commands/hincrby">HINCRBY</a><br>å¯¹å…³è”çš„ç»Ÿè®¡é¡¹è¿›è¡Œç»Ÿä¸€ç®¡ç†ï¼›<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">redis&gt;</span><span class="bash"> HSET myhash field 5</span></span><br><span class="line">(integer) 1</span><br><span class="line"><span class="meta">redis&gt;</span><span class="bash"> HINCRBY myhash field 1</span></span><br><span class="line">(integer) 6</span><br><span class="line"><span class="meta">redis&gt;</span><span class="bash"> HINCRBY myhash field -1</span></span><br><span class="line">(integer) 5</span><br><span class="line"><span class="meta">redis&gt;</span><span class="bash"> HINCRBY myhash field -10</span></span><br><span class="line">(integer) -5</span><br></pre></td></tr></table></figure></li><li>å¯ä»¥é€‰ç”¨<code>set</code>ç±»å‹ï¼Œè°ƒç”¨<code>sadd()</code>æ–¹æ³•ï¼Œå‚è§<a href="https://redis.io/commands/SADD">SADD</a><br>å¤šæ¬¡è°ƒç”¨åªåŠ ä¸€ï¼Œé˜²ä½œå¼Šåˆ·æ•°æ®ç­‰ï¼›<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">redis&gt;</span><span class="bash"> SADD myset <span class="string">&quot;Hello&quot;</span></span></span><br><span class="line">(integer) 1</span><br><span class="line"><span class="meta">redis&gt;</span><span class="bash"> SADD myset <span class="string">&quot;World&quot;</span></span></span><br><span class="line">(integer) 1</span><br><span class="line"><span class="meta">redis&gt;</span><span class="bash"> SADD myset <span class="string">&quot;World&quot;</span></span></span><br><span class="line">(integer) 0</span><br><span class="line"><span class="meta">redis&gt;</span><span class="bash"> SMEMBERS myset</span></span><br><span class="line">1) &quot;Hello&quot;</span><br><span class="line">2) &quot;World&quot;</span><br></pre></td></tr></table></figure>æ›´å¤š Python å®ä¾‹åº”ç”¨:<a href="https://juejin.im/post/5da6923c5188252f192d2835"><em>Redis å¤šæ–¹å¼å®ç°è®¡æ•°å™¨åŠŸèƒ½ï¼ˆé™„ä»£ç ï¼‰</em></a></li></ol><h4 id="å†…å­˜æ»¡äº†"><a href="#å†…å­˜æ»¡äº†" class="headerlink" title="å†…å­˜æ»¡äº†"></a>å†…å­˜æ»¡äº†</h4><p>æ­¤æ—¶ä¸èƒ½ç»§ç»­å†™å…¥æ•°æ®ï¼Œè€Œä¸”ç³»ç»Ÿçš„å…¶ä»–æ“ä½œä»»åŠ¡ä¹Ÿä¼šå—åˆ°å½±å“ã€‚ä¸ºé˜²æ­¢è¿™ç§ç°è±¡å‘ç”Ÿï¼Œåº”è¯¥å¯ç”¨å†…å­˜æ·˜æ±°ç­–ç•¥ã€‚<br><a href="https://blog.csdn.net/u014590757/article/details/79788076">Redis å†…å­˜æ»¡äº†çš„å‡ ç§è§£å†³æ–¹æ³•</a><br><a href="https://juejin.im/post/5dc81b4df265da4d4d0cfebc">Redis è¿‡æœŸâ€“æ·˜æ±°æœºåˆ¶çš„è§£æå’Œå†…å­˜å ç”¨è¿‡é«˜çš„è§£å†³æ–¹æ¡ˆ</a></p><h4 id="æ›´å¤š"><a href="#æ›´å¤š" class="headerlink" title="æ›´å¤š"></a>æ›´å¤š</h4><p><a href="https://www.kancloud.cn/mangyusisha/php/701563">10 ä¸ªå¸¸è§çš„ Redis é¢è¯•â€åˆéš¾â€é—®é¢˜</a></p><h3 id="å¸¸è§çŠ¶æ€ç é”™è¯¯ï¼Ÿ301ã€302-é”™è¯¯åŠåŒºåˆ«ï¼Ÿ502-é”™è¯¯å‡ºç°æ—¶åº”è¯¥æ€ä¹ˆè§£å†³"><a href="#å¸¸è§çŠ¶æ€ç é”™è¯¯ï¼Ÿ301ã€302-é”™è¯¯åŠåŒºåˆ«ï¼Ÿ502-é”™è¯¯å‡ºç°æ—¶åº”è¯¥æ€ä¹ˆè§£å†³" class="headerlink" title="å¸¸è§çŠ¶æ€ç é”™è¯¯ï¼Ÿ301ã€302 é”™è¯¯åŠåŒºåˆ«ï¼Ÿ502 é”™è¯¯å‡ºç°æ—¶åº”è¯¥æ€ä¹ˆè§£å†³"></a>å¸¸è§çŠ¶æ€ç é”™è¯¯ï¼Ÿ301ã€302 é”™è¯¯åŠåŒºåˆ«ï¼Ÿ502 é”™è¯¯å‡ºç°æ—¶åº”è¯¥æ€ä¹ˆè§£å†³</h3><ul><li>301/302<br>è·³è½¬ï¼Œ301 redirect: 301 ä»£è¡¨<strong>æ°¸ä¹…æ€§</strong>è½¬ç§»(Permanently Moved)ï¼›302 redirect: 302 ä»£è¡¨<strong>æš‚æ—¶æ€§</strong>è½¬ç§»(Temporarily Moved )</li></ul><p>å‚è§<a href="http://blog.csdn.net/grandPang/article/details/47448395">http çŠ¶æ€ç  301 å’Œ 302 è¯¦è§£åŠåŒºåˆ«â€”â€”è¾›é…¸çš„æ¢ç´¢ä¹‹è·¯</a></p><ul><li>502 Bad Gateway Error</li></ul><p>å¯¹ç”¨æˆ·è®¿é—®è¯·æ±‚çš„å“åº”è¶…æ—¶é”™è¯¯</p><ol><li>DNS æµ‹è¯•ï¼Œping æµ‹è¯•</li><li>æ£€æŸ¥é˜²ç«å¢™ç«¯å£ï¼Œæ£€æŸ¥é˜²ç«å¢™æ—¥å¿—</li><li>æ•°æ®åº“è°ƒç”¨å»¶è¿Ÿ</li><li>ç½‘ç»œæœåŠ¡è¿›ç¨‹æ˜¯å¦æ­£å¸¸ </li></ol><h4 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h4><ol><li><a href="https://www.zhihu.com/question/21647204">502 Bad Gateway æ€ä¹ˆè§£å†³ï¼Ÿ</a></li><li><a href="https://www.keycdn.com/support/502-bad-gateway">How to Solve 502 Bad Gateway Issues?</a></li></ol><h2 id="åèƒœå¤©æˆ"><a href="#åèƒœå¤©æˆ" class="headerlink" title="åèƒœå¤©æˆ"></a>åèƒœå¤©æˆ</h2><h3 id="ç±»å±æ€§çš„ç»§æ‰¿"><a href="#ç±»å±æ€§çš„ç»§æ‰¿" class="headerlink" title="ç±»å±æ€§çš„ç»§æ‰¿"></a>ç±»å±æ€§çš„ç»§æ‰¿</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Parent</span>:</span></span><br><span class="line">    x = <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Child1</span>(<span class="params">Parent</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Child2</span>(<span class="params">Parent</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">a = Parent()</span><br><span class="line">b = Child1()</span><br><span class="line">c = Child2()</span><br><span class="line"></span><br><span class="line">print(a.x,b.x,c.x)  <span class="comment"># (10, 10, 10)</span></span><br><span class="line">a.x = <span class="number">20</span></span><br><span class="line">print(a.x,b.x,c.x)  <span class="comment"># (20, 10, 10)</span></span><br><span class="line">b.x = <span class="number">30</span></span><br><span class="line">print(a.x,b.x,c.x)  <span class="comment"># (20, 30, 10)</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span></span><br><span class="line">    x = <span class="string">&#x27;a&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span>:</span></span><br><span class="line">    x = <span class="string">&#x27;b&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span>(<span class="params">A,B</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">D</span>(<span class="params">B,A</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">print(A.x,B.x,C.x,D.x)  <span class="comment"># (&#x27;a&#x27;, &#x27;b&#x27;, &#x27;a&#x27;, &#x27;b&#x27;)</span></span><br><span class="line">A.x = <span class="string">&#x27;a1&#x27;</span></span><br><span class="line">print(A.x,B.x,C.x,D.x)  <span class="comment"># (&#x27;a1&#x27;, &#x27;b&#x27;, &#x27;a1&#x27;, &#x27;b&#x27;)</span></span><br><span class="line">B.x = <span class="string">&#x27;b1&#x27;</span></span><br><span class="line">print(A.x,B.x,C.x,D.x)  <span class="comment"># (&#x27;a1&#x27;, &#x27;b1&#x27;, &#x27;a1&#x27;, &#x27;b1&#x27;)</span></span><br><span class="line">C.x = <span class="string">&#x27;c&#x27;</span></span><br><span class="line">print(A.x,B.x,C.x,D.x)  <span class="comment"># (&#x27;a1&#x27;, &#x27;b1&#x27;, &#x27;c&#x27;, &#x27;b1&#x27;)</span></span><br></pre></td></tr></table></figure><h2 id="æ›´å¤š-1"><a href="#æ›´å¤š-1" class="headerlink" title="æ›´å¤š"></a>æ›´å¤š</h2><p><a href="https://juejin.im/post/5cf7ea91e51d4576bc1a0dc2">å­—èŠ‚è·³åŠ¨ã€è…¾è®¯åå°å¼€å‘é¢ç»åˆ†äº«(2019.5)</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> é¢è¯• </tag>
            
            <tag> è®°å½• </tag>
            
            <tag> åç«¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ğŸPyTricks | å¦‚ä½•æ›´æ–°ä¸€ä¸ªåµŒå¥—å­—å…¸çš„å€¼ï¼Ÿ</title>
      <link href="blog/2019-09-25/update-value-of-a-nested-dictionary-of-varying-depth/"/>
      <url>blog/2019-09-25/update-value-of-a-nested-dictionary-of-varying-depth/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> collections</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">update_nested_dict</span>(<span class="params">orig_dict, new_dict</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    æ›´æ–°åµŒå¥—å­—å…¸</span></span><br><span class="line"><span class="string">    params = &#123;&#x27;state&#x27;:&#x27;1&#x27;,&#x27;message&#x27;:&#x27;9527&#x27;,&#x27;result&#x27;:&#123;&#x27;hello&#x27;:&#x27;world&#x27;,&#x27;foo&#x27;:&#x27;bar&#x27;,&#x27;age&#x27;:32&#125;&#125;</span></span><br><span class="line"><span class="string">    new_dict = &#123;&#x27;name&#x27;:&#x27;Peter&#x27;&#125;</span></span><br><span class="line"><span class="string">    &#123;&#x27;state&#x27;: &#x27;1&#x27;, &#x27;message&#x27;: &#x27;9527&#x27;, &#x27;name&#x27;: &#x27;Peter&#x27;, &#x27;result&#x27;: &#123;&#x27;age&#x27;: 32, &#x27;foo&#x27;: &#x27;bar&#x27;, &#x27;hello&#x27;: &#x27;world&#x27;&#125;&#125;</span></span><br><span class="line"><span class="string">    ---</span></span><br><span class="line"><span class="string">    new_dict = &#123;&#x27;result&#x27;:&#123;&#x27;foo&#x27;:&#x27;baz&#x27;&#125;&#125;</span></span><br><span class="line"><span class="string">    &#123;&#x27;state&#x27;: &#x27;1&#x27;, &#x27;message&#x27;: &#x27;9527&#x27;, &#x27;result&#x27;: &#123;&#x27;age&#x27;: 32, &#x27;foo&#x27;: &#x27;baz&#x27;, &#x27;hello&#x27;: &#x27;world&#x27;&#125;&#125;</span></span><br><span class="line"><span class="string">    new_dict = &#123;&#x27;result&#x27;:&#123;&#x27;name&#x27;:&#x27;Peter&#x27;&#125;&#125;</span></span><br><span class="line"><span class="string">    &#123;&#x27;state&#x27;: &#x27;1&#x27;, &#x27;message&#x27;: &#x27;9527&#x27;, &#x27;result&#x27;: &#123;&#x27;age&#x27;: 32, &#x27;foo&#x27;: &#x27;bar&#x27;, &#x27;hello&#x27;: &#x27;world&#x27;, &#x27;name&#x27;: &#x27;Peter&#x27;&#125;&#125;</span></span><br><span class="line"><span class="string">    ---</span></span><br><span class="line"><span class="string">    new_dict = &#123;&#x27;result&#x27;:&#123;&#x27;hobbies&#x27;:[&#x27;reading&#x27;,&#x27;fishing&#x27;,&#x27;play game&#x27;]&#125;&#125;</span></span><br><span class="line"><span class="string">    &#123;&#x27;state&#x27;: &#x27;1&#x27;, &#x27;message&#x27;: &#x27;9527&#x27;, &#x27;result&#x27;: &#123;&#x27;age&#x27;: 32, &#x27;foo&#x27;: &#x27;bar&#x27;, &#x27;hello&#x27;: &#x27;world&#x27;, &#x27;hobbies&#x27;: [&#x27;reading&#x27;, &#x27;fishing&#x27;, &#x27;play game&#x27;]&#125;&#125;</span></span><br><span class="line"><span class="string">    ---</span></span><br><span class="line"><span class="string">    params = &#123;&#x27;state&#x27;:&#x27;1&#x27;,&#x27;message&#x27;:&#x27;9527&#x27;,&#x27;result&#x27;:&#123;&#x27;hello&#x27;:&#x27;world&#x27;,&#x27;foo&#x27;:&#x27;bar&#x27;,&#x27;age&#x27;:32,&#x27;hobbies&#x27;:[&#x27;coding&#x27;]&#125;&#125;</span></span><br><span class="line"><span class="string">    new_dict = &#123;&#x27;result&#x27;:&#123;&#x27;hobbies&#x27;:[&#x27;reading&#x27;,&#x27;fishing&#x27;,&#x27;play game&#x27;]&#125;&#125;</span></span><br><span class="line"><span class="string">    &#123;&#x27;state&#x27;: &#x27;1&#x27;, &#x27;message&#x27;: &#x27;9527&#x27;, &#x27;result&#x27;: &#123;&#x27;age&#x27;: 32, &#x27;foo&#x27;: &#x27;bar&#x27;, &#x27;hello&#x27;: &#x27;world&#x27;, &#x27;hobbies&#x27;: [&#x27;coding&#x27;, &#x27;reading&#x27;, &#x27;fishing&#x27;, &#x27;play game&#x27;]&#125;&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> key, val <span class="keyword">in</span> new_dict.iteritems():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(val, collections.Mapping):</span><br><span class="line">            tmp = update_nested_dict(orig_dict.get(key, &#123;&#125;), val)</span><br><span class="line">            orig_dict[key] = tmp</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">isinstance</span>(val, <span class="built_in">list</span>):</span><br><span class="line">            orig_dict[key] = (orig_dict.get(key, []) + val)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            orig_dict[key] = new_dict[key]</span><br><span class="line">    <span class="keyword">return</span> orig_dict</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒæ¥æº"><a href="#å‚è€ƒæ¥æº" class="headerlink" title="å‚è€ƒæ¥æº"></a>å‚è€ƒæ¥æº</h2><p><a href="https://stackoverflow.com/questions/3232943/update-value-of-a-nested-dictionary-of-varying-depth">Update value of a nested dictionary of varying depth</a></p>]]></content>
      
      
      <categories>
          
          <category> ğŸPyTricks </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TCP å’Œ UDP çš„åŒºåˆ«</title>
      <link href="blog/2019-09-21/differences-between-tcp-and-udp/"/>
      <url>blog/2019-09-21/differences-between-tcp-and-udp/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><p>TCP ä¼ è¾“æ§åˆ¶åè®®ï¼ˆ Transmission Control Protocolï¼‰å’Œ UDP ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆUser Datagram Protocolï¼‰æ˜¯åœ¨ä¼ è¾“å±‚è¿è¡Œçš„ä¸»è¦åè®®ã€‚ä¼ è¾“æ§åˆ¶åè®®ï¼ˆTCPï¼‰å’Œç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆUDPï¼‰çš„æ“ä½œæ–¹å¼éå¸¸ä¸åŒï¼Œä½ å¯ä»¥æ ¹æ®éœ€è¦é€‰æ‹©ä¼ è¾“æ§åˆ¶åè®®ï¼ˆTCPï¼‰æˆ–ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆUDPï¼‰ã€‚</p><p>TCP ä»£è¡¨ä¼ è¾“æ§åˆ¶åè®®ï¼Œå®ƒä¿è¯æ•°æ®åŒ…çš„ä¼ é€ã€‚è¯¥åè®®æä¾›äº†å¹¿æ³›çš„é”™è¯¯æ£€æŸ¥æœºåˆ¶ï¼Œä¾‹å¦‚æµæ§åˆ¶å’Œæ•°æ®ç¡®è®¤ã€‚ä¼ è¾“æ§åˆ¶åè®®ï¼ˆTCPï¼‰æ˜¯é¢å‘è¿æ¥çš„åè®®ã€‚åœ¨ä¼ è¾“æ•°æ®ä¹‹å‰ï¼Œå¿…é¡»ç¡®ä¿åœ¨å‚ä¸æ•°æ®ä¼ è¾“çš„è®¾å¤‡ä¹‹é—´å»ºç«‹è¿æ¥ã€‚å¦‚æœæ‚¨çš„åº”ç”¨ç¨‹åºéœ€è¦ä¿è¯æ•°æ®çš„ä¼ è¾“ï¼Œåˆ™å¿…é¡»é€‰æ‹© TCP ä½œä¸ºä¼ è¾“å±‚åè®®ã€‚</p><p>UDP ä»£è¡¨ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼Œå®ƒä»¥æ•°æ®æŠ¥æ¨¡å¼è¿è¡Œã€‚åœ¨æ­¤å¤„åº”æ³¨æ„çš„ä¸»è¦åŒºåˆ«æ˜¯ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆUDPï¼‰æ˜¯ä¸€ç§æ— è¿æ¥åè®®ã€‚ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆUDPï¼‰ä»…å…·æœ‰ä½¿ç”¨æ ¡éªŒå’Œçš„åŸºæœ¬é”™è¯¯æ£€æŸ¥æœºåˆ¶ã€‚</p><h2 id="ä¼ è¾“æ§åˆ¶åè®®ï¼ˆTCPï¼‰å’Œç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆUDPï¼‰ä¹‹é—´çš„åŒºåˆ«"><a href="#ä¼ è¾“æ§åˆ¶åè®®ï¼ˆTCPï¼‰å’Œç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆUDPï¼‰ä¹‹é—´çš„åŒºåˆ«" class="headerlink" title="ä¼ è¾“æ§åˆ¶åè®®ï¼ˆTCPï¼‰å’Œç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆUDPï¼‰ä¹‹é—´çš„åŒºåˆ«"></a>ä¼ è¾“æ§åˆ¶åè®®ï¼ˆTCPï¼‰å’Œç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆUDPï¼‰ä¹‹é—´çš„åŒºåˆ«</h2><h3 id="ä¼ è¾“æ§åˆ¶åè®®ï¼ˆTCPï¼‰"><a href="#ä¼ è¾“æ§åˆ¶åè®®ï¼ˆTCPï¼‰" class="headerlink" title="ä¼ è¾“æ§åˆ¶åè®®ï¼ˆTCPï¼‰"></a>ä¼ è¾“æ§åˆ¶åè®®ï¼ˆTCPï¼‰</h3><ol><li><p>TCP æ˜¯é¢å‘è¿æ¥çš„åè®®ï¼Œè¿™æ„å‘³ç€è®¾å¤‡åº”åœ¨ä¼ è¾“æ•°æ®ä¹‹å‰æ‰“å¼€è¿æ¥ï¼Œå¹¶åœ¨ä¼ è¾“æ•°æ®åæ­£å¸¸å…³é—­è¿æ¥ã€‚</p></li><li><p>TCP ç¡®ä¿å°†æ•°æ®å¯é åœ°ä¼ é€’åˆ°ç›®çš„åœ°ã€‚</p></li><li><p>TCP åè®®æä¾›äº†å¹¿æ³›çš„é”™è¯¯æ£€æŸ¥æœºåˆ¶ï¼Œä¾‹å¦‚æµæ§åˆ¶å’Œæ•°æ®ç¡®è®¤ã€‚</p></li><li><p>TCP å…·æœ‰æ•°æ®æ’åºçš„åŠŸèƒ½ã€‚</p></li><li><p>TCP å¯ä»¥ä¿è¯æ•°æ®çš„ä¼ è¾“ã€‚</p></li><li><p>ç”±äºå¹¿æ³›çš„é”™è¯¯æ£€æŸ¥æœºåˆ¶ï¼ŒTCP ç›¸å¯¹è¾ƒæ…¢ã€‚</p></li><li><p>åœ¨ TCP ä¸­ä½¿ç”¨ TCP ç«¯å£å·å¯ä»¥è¿›è¡Œå¤šè·¯å¤ç”¨å’Œå¤šè·¯åˆ†è§£ã€‚</p></li><li><p>åœ¨ TCP ä¸­å¯ä»¥é‡æ–°ä¼ è¾“ä¸¢å¤±çš„æ•°æ®åŒ…ã€‚</p></li></ol><h3 id="ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆUDPï¼‰"><a href="#ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆUDPï¼‰" class="headerlink" title="ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆUDPï¼‰"></a>ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆUDPï¼‰</h3><ol><li><p>UDP æ˜¯é¢å‘æ•°æ®æŠ¥çš„åè®®ï¼Œæ— éœ€ä»»ä½•å¼€é”€å³å¯æ‰“å¼€è¿æ¥ï¼ˆä½¿ç”¨ä¸‰å‘æ¡æ‰‹ï¼‰ï¼Œç»´æŠ¤è¿æ¥ä»¥åŠå…³é—­ï¼ˆç»ˆæ­¢ï¼‰è¿æ¥ã€‚</p></li><li><p>UDP å¯¹äºç½‘ç»œä¼ è¾“çš„å¹¿æ’­/å¤šæ’­ç±»å‹éå¸¸æœ‰æ•ˆã€‚</p></li><li><p>UDP ä»…å…·æœ‰ä½¿ç”¨æ ¡éªŒå’Œçš„åŸºæœ¬é”™è¯¯æ£€æŸ¥æœºåˆ¶ã€‚</p></li><li><p>UDP ä¸­æ²¡æœ‰æ•°æ®æ’åºã€‚</p></li><li><p>UDP ä¸­ä¸èƒ½ä¿è¯æ•°æ®çš„ä¼ é€’ã€‚</p></li><li><p>UDP æ¯” TCP æ›´å¿«ï¼Œæ›´ç®€å•ï¼Œæ›´é«˜æ•ˆã€‚ä½†æ˜¯ï¼ŒUDP çš„å¯é æ€§ä¸å¦‚ TCPã€‚</p></li><li><p>åœ¨ä½¿ç”¨ UDP ç«¯å£å·çš„ UDP ä¸­å¯ä»¥è¿›è¡Œå¤ç”¨å’Œè§£å¤ç”¨ã€‚</p></li><li><p>UDP ä¸­æ²¡æœ‰ä¸¢å¤±åˆ†ç»„çš„é‡ä¼ ã€‚</p></li></ol><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="http://www.omnisecu.com/tcpip/differences-between-tcp-and-udp.php">Differences between TCP and UDP</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> ç½‘ç»œ </tag>
            
            <tag> TCP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TCP ä¸‰æ¬¡æ¡æ‰‹ä¸å››æ¬¡æŒ¥æ‰‹</title>
      <link href="blog/2019-09-20/tcp-connection-3-way-handshake-and-termination-4-way-handshake/"/>
      <url>blog/2019-09-20/tcp-connection-3-way-handshake-and-termination-4-way-handshake/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h2 id="TCP-å¤´éƒ¨"><a href="#TCP-å¤´éƒ¨" class="headerlink" title="TCP å¤´éƒ¨"></a>TCP å¤´éƒ¨</h2><p><img src= "/img/loading.svg" data-lazy-src="/images/tcp-head-en.jpg" alt="tcpå¤´éƒ¨"><br><img src= "/img/loading.svg" data-lazy-src="/images/tcp-head-cn.jpg" alt="tcpå¤´éƒ¨"><br>ä¸Šé¢å°±æ˜¯ TCP åè®®å¤´éƒ¨çš„æ ¼å¼ï¼Œå®ƒéå¸¸é‡è¦ï¼Œæ˜¯ç†è§£å…¶å®ƒå†…å®¹çš„åŸºç¡€ï¼Œä¸‹é¢å°†æ¯ä¸ªå­—æ®µçš„ä¿¡æ¯éƒ½è¯¦ç»†çš„è¯´æ˜ä¸€ä¸‹ï¼š</p><ul><li>Source Port<br>  16 ä½ï¼Œç”¨äºæ ‡è¯†æºç«¯å£å·ï¼ˆå‘é€æœºå™¨ TCP ç«¯å£ï¼‰</li><li>Destination Port<br>  16 ä½ï¼Œç”¨äºæ ‡è¯†ç›®çš„ç«¯å£å·ï¼ˆæ¥æ”¶ç«¯å£ï¼‰</li><li>Sequence Number<br>  32 ä½ï¼Œç”¨äº TCP æ®µçš„å­—èŠ‚çº§åˆ«ç¼–å·ã€‚å¦‚æœä½¿ç”¨ TCP è¿æ¥ï¼Œåˆ™ä¸ºæ•°æ®çš„æ¯ä¸ªå­—èŠ‚åˆ†é…ä¸€ä¸ªåºåˆ—å·ã€‚å¦‚æœè®¾ç½®äº† SYN æ ‡å¿—ï¼ˆåœ¨<em>ä¸‰å‘æ¡æ‰‹è¿æ¥</em>åˆå§‹åŒ–æœŸé—´ï¼‰ï¼Œåˆ™æ˜¯åˆå§‹åºåˆ—å·ã€‚ ç„¶åï¼Œå®é™…ç¬¬ä¸€ä¸ªæ•°æ®å­—èŠ‚çš„åºåˆ—å·å°†æ˜¯æ­¤åºåˆ—å·åŠ  1ã€‚ä¾‹å¦‚ï¼Œè®©è®¾å¤‡åœ¨ç‰¹å®š TCP æŠ¥å¤´ä¸­çš„æ•°æ®çš„ç¬¬ä¸€ä¸ªå­—èŠ‚åœ¨è¯¥å­—æ®µ 50000 ä¸­å°†å…·æœ‰å…¶åºåˆ—å·ã€‚å¦‚æœæ­¤æ•°æ®åŒ…æœ‰ 500 å­—èŠ‚ä¸­çš„æ•°æ®ï¼Œé‚£ä¹ˆæ­¤è®¾å¤‡å‘é€çš„ä¸‹ä¸€ä¸ªæ•°æ®åŒ…å°†å…·æœ‰ 50000 + 500 + 1 = 50501 çš„åºåˆ—å·ã€‚</li><li>Acknowledgment Number<br>  32 ä½ï¼Œç¡®è®¤åºåˆ—å·åŒ…å«å‘é€ç¡®è®¤çš„ä¸€ç«¯æ‰€æœŸæœ›æ”¶åˆ°çš„ä¸‹ä¸€ä¸ªåºå·ï¼Œå› æ­¤ï¼Œç¡®è®¤åºå·åº”å½“æ˜¯ä¸Šæ¬¡å·²æˆåŠŸæ”¶åˆ°æ•°æ®å­—èŠ‚åºå·åŠ  1ã€‚ä¸è¿‡ï¼Œåªæœ‰å½“æ ‡å¿—ä½ä¸­çš„ ACK æ ‡å¿—ï¼ˆä¸‹é¢ä»‹ç»ï¼‰ä¸º 1 æ—¶è¯¥ç¡®è®¤åºåˆ—å·çš„å­—æ®µæ‰æœ‰æ•ˆã€‚ä¸»è¦ç”¨æ¥è§£å†³ä¸ä¸¢åŒ…çš„é—®é¢˜ï¼›</li><li>Header Length<br>  4 ä½ï¼Œæ˜¾ç¤º header ä¸­ 32 ä½å­—çš„æ•°é‡ã€‚éœ€è¦è¿™ä¸ªå€¼æ˜¯å› ä¸ºä»»é€‰å­—æ®µçš„é•¿åº¦æ˜¯å¯å˜çš„ã€‚ä¹Ÿç§°ä¸ºæ•°æ®åç§»å­—æ®µï¼ˆData Offset fieldï¼‰ã€‚ header çš„æœ€å°ä¸º 5 ä¸ªå­—ï¼ˆäºŒè¿›åˆ¶æ¨¡å¼ä¸º 0101ï¼‰ã€‚</li><li>Reserved<br>  6 ä½ï¼Œå¸¸è¢«è®¾ä¸º 0ï¼›</li><li>Control Bit Flags<br>  æˆ‘ä»¬ä¹‹å‰å·²ç»çŸ¥é“ TCP æ˜¯é¢å‘è¿æ¥çš„åè®®ã€‚ é¢å‘è¿æ¥åè®®çš„å«ä¹‰æ˜¯ï¼Œåœ¨å¯ä»¥ä¼ è¾“ä»»ä½•æ•°æ®ä¹‹å‰ï¼Œå¿…é¡»è·å¾—ï¼ˆobtainedï¼‰å¹¶ç¡®è®¤å¯é çš„è¿æ¥ã€‚ æ§åˆ¶ä½æ§åˆ¶ç€è¿æ¥å»ºç«‹ï¼Œæ•°æ®ä¼ è¾“å’Œè¿æ¥ç»ˆæ­¢çš„æ•´ä¸ªè¿‡ç¨‹ã€‚<br>  æ§åˆ¶ä½åˆ—å‡ºå¦‚ä¸‹ï¼šå®ƒä»¬ä¾æ¬¡ä¸º URGï¼ŒACKï¼ŒPSHï¼ŒRSTï¼ŒSYNï¼ŒFINã€‚æ¯ä¸ªæ ‡å¿—ä½çš„å«ä¹‰å¦‚ä¸‹ï¼š   <ol><li>URGï¼šUrgent Pointerï¼Œæ­¤æ ‡å¿—è¡¨ç¤º TCP åŒ…çš„ç´§æ€¥æŒ‡é’ˆåŸŸï¼ˆåé¢é©¬ä¸Šå°±è¦è¯´åˆ°ï¼‰æœ‰æ•ˆï¼Œç”¨æ¥ä¿è¯ TCP è¿æ¥ä¸è¢«ä¸­æ–­ï¼Œå¹¶ä¸”ç£ä¿ƒä¸­é—´å±‚è®¾å¤‡è¦å°½å¿«å¤„ç†è¿™äº›æ•°æ®ï¼›</li><li>ACKï¼šAcknowledgementï¼Œæ­¤æ ‡å¿—è¡¨ç¤ºåº”ç­”åŸŸæœ‰æ•ˆã€‚å°±æ˜¯è¯´å‰é¢æ‰€è¯´çš„ TCP åº”ç­”å·å°†ä¼šåŒ…å«åœ¨ TCP æ•°æ®åŒ…ä¸­ï¼›æœ‰ä¸¤ä¸ªå–å€¼ï¼š0 å’Œ 1ï¼Œä¸º 1 çš„æ—¶å€™è¡¨ç¤ºåº”ç­”åŸŸæœ‰æ•ˆï¼Œåä¹‹ä¸º 0ï¼›</li><li>PSHï¼špushï¼Œè¿™ä¸ªæ ‡å¿—ä½è¡¨ç¤ºä¼ é€æ“ä½œã€‚æ‰€è°“ Push æ“ä½œå°±æ˜¯æŒ‡åœ¨æ•°æ®åŒ…åˆ°è¾¾æ¥æ”¶ç«¯ä»¥åï¼Œç«‹å³ä¼ é€ç»™åº”ç”¨ç¨‹åºï¼Œè€Œä¸æ˜¯åœ¨ç¼“å†²åŒºä¸­æ’é˜Ÿï¼›</li><li>RSTï¼šresetï¼Œè¿™ä¸ªæ ‡å¿—è¡¨ç¤ºè¿æ¥å¤ä½è¯·æ±‚ã€‚ç”¨æ¥å¤ä½é‚£äº›äº§ç”Ÿé”™è¯¯çš„è¿æ¥ï¼Œä¹Ÿè¢«ç”¨æ¥æ‹’ç»é”™è¯¯å’Œéæ³•çš„æ•°æ®åŒ…ï¼›</li><li>SYNï¼šsynchronousï¼Œè¡¨ç¤ºåŒæ­¥åºå·ï¼Œç”¨æ¥å»ºç«‹è¿æ¥ã€‚SYN æ ‡å¿—ä½å’Œ ACK æ ‡å¿—ä½æ­é…ä½¿ç”¨ï¼Œå½“è¿æ¥è¯·æ±‚çš„æ—¶å€™ï¼ŒSYN=1ï¼ŒACK=0ï¼›è¿æ¥è¢«å“åº”çš„æ—¶å€™ï¼ŒSYN=1ï¼ŒACK=1ï¼›è¿™ä¸ªæ ‡å¿—çš„æ•°æ®åŒ…ç»å¸¸è¢«ç”¨æ¥è¿›è¡Œç«¯å£æ‰«æã€‚æ‰«æè€…å‘é€ä¸€ä¸ªåªæœ‰ SYN çš„æ•°æ®åŒ…ï¼Œå¦‚æœå¯¹æ–¹ä¸»æœºå“åº”äº†ä¸€ä¸ªæ•°æ®åŒ…å›æ¥ï¼Œå°±è¡¨æ˜è¿™å°ä¸»æœºå­˜åœ¨è¿™ä¸ªç«¯å£ï¼›ä½†æ˜¯ç”±äºè¿™ç§æ‰«ææ–¹å¼åªæ˜¯è¿›è¡Œ TCP ä¸‰æ¬¡æ¡æ‰‹çš„ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼Œå› æ­¤è¿™ç§æ‰«æçš„æˆåŠŸè¡¨ç¤ºè¢«æ‰«æçš„æœºå™¨ä¸å¾ˆå®‰å…¨ï¼Œä¸€å°å®‰å…¨çš„ä¸»æœºå°†ä¼šå¼ºåˆ¶è¦æ±‚ä¸€ä¸ªè¿æ¥ä¸¥æ ¼çš„è¿›è¡Œ TCP çš„ä¸‰æ¬¡æ¡æ‰‹ï¼›</li><li>FINï¼š finishï¼Œè¡¨ç¤ºå‘é€ç«¯å·²ç»è¾¾åˆ°æ•°æ®æœ«å°¾ã€‚ä¹Ÿå°±æ˜¯è¯´åŒæ–¹çš„æ•°æ®ä¼ é€å®Œæˆï¼Œæ²¡æœ‰æ•°æ®å¯ä»¥ä¼ é€äº†ï¼Œå‘é€ FIN æ ‡å¿—ä½çš„ TCP æ•°æ®åŒ…åï¼Œè¿æ¥å°†è¢«æ–­å¼€ã€‚è¿™ä¸ªæ ‡å¿—çš„æ•°æ®åŒ…ä¹Ÿç»å¸¸è¢«ç”¨äºè¿›è¡Œç«¯å£æ‰«æã€‚<br>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<ul><li>ä¸è¦å°†ç¡®è®¤åºå· ack ä¸æ ‡å¿—ä½ä¸­çš„ ACK ææ··äº†ã€‚</li><li>ç¡®è®¤æ–¹ ack=å‘èµ·æ–¹ req+1ï¼Œä¸¤ç«¯é…å¯¹ã€‚  </li></ul></li></ol></li><li>Window<br>  16bitsï¼Œçª—å£å­—æ®µç”¨æ¥æ§åˆ¶å¯¹æ–¹å‘é€çš„æ•°æ®é‡ï¼Œå•ä½ä¸ºå­—èŠ‚ã€‚ä¹Ÿå°±æ˜¯æœ‰åçš„æ»‘åŠ¨çª—å£ï¼Œç”¨æ¥è¿›è¡Œæµé‡æ§åˆ¶ã€‚TCP è¿æ¥çš„ä¸€ç«¯æ ¹æ®è®¾ç½®çš„ç¼“å­˜ç©ºé—´å¤§å°ç¡®å®šè‡ªå·±çš„æ¥æ”¶çª—å£å¤§å°ï¼Œç„¶åé€šçŸ¥å¯¹æ–¹ä»¥ç¡®å®šå¯¹æ–¹çš„å‘é€çª—å£çš„ä¸Šé™ã€‚</li><li>Checksum<br>  16bits,æ£€éªŒå’Œå­—æ®µæ£€éªŒçš„èŒƒå›´åŒ…æ‹¬é¦–éƒ¨å’Œæ•°æ®è¿™ä¸¤éƒ¨åˆ†ã€‚åœ¨è®¡ç®—æ£€éªŒå’Œæ—¶ï¼Œè¦åœ¨ TCP æŠ¥æ–‡æ®µçš„å‰é¢åŠ ä¸Š 12 å­—èŠ‚çš„ä¼ªé¦–éƒ¨ã€‚</li><li>Urgent Pointer<br>  ç´§æ€¥æŒ‡é’ˆå­—æ®µï¼Œ16bitsï¼Œç´§æ€¥æŒ‡é’ˆæŒ‡å‡ºåœ¨æœ¬æŠ¥æ–‡æ®µä¸­çš„ç´§æ€¥æ•°æ®çš„æœ€åä¸€ä¸ªå­—èŠ‚çš„åºå·ã€‚</li><li>Option<br>  é•¿åº¦å¯å˜ï¼ŒTCP é¦–éƒ¨å¯ä»¥æœ‰å¤šè¾¾ 40 å­—èŠ‚çš„å¯é€‰ä¿¡æ¯ï¼Œç”¨äºæŠŠé™„åŠ ä¿¡æ¯ä¼ é€’ç»™ç»ˆç‚¹ï¼Œæˆ–ç”¨æ¥å¯¹é½å…¶å®ƒé€‰é¡¹ã€‚</li></ul><ol><li><a href="http://www.omnisecu.com/tcpip/tcp-header.php">TCP Header Fields</a></li><li><a href="https://www.inetdaemon.com/tutorials/internet/tcp/tcp_header.shtml">TCP Header</a></li></ol><h2 id="ä¸‰æ¬¡æ¡æ‰‹ä¸å››æ¬¡æŒ¥æ‰‹"><a href="#ä¸‰æ¬¡æ¡æ‰‹ä¸å››æ¬¡æŒ¥æ‰‹" class="headerlink" title="ä¸‰æ¬¡æ¡æ‰‹ä¸å››æ¬¡æŒ¥æ‰‹"></a>ä¸‰æ¬¡æ¡æ‰‹ä¸å››æ¬¡æŒ¥æ‰‹</h2><h3 id="ä¸‰æ¬¡æ¡æ‰‹ï¼ˆ3-way-Handshakeï¼‰"><a href="#ä¸‰æ¬¡æ¡æ‰‹ï¼ˆ3-way-Handshakeï¼‰" class="headerlink" title="ä¸‰æ¬¡æ¡æ‰‹ï¼ˆ3-way Handshakeï¼‰"></a>ä¸‰æ¬¡æ¡æ‰‹ï¼ˆ3-way Handshakeï¼‰</h3><p>æ‰€è°“ä¸‰æ¬¡æ¡æ‰‹(Three-way Handshake)ï¼Œæ˜¯æŒ‡å»ºç«‹ä¸€ä¸ª TCP è¿æ¥æ—¶ï¼Œéœ€è¦å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨æ€»å…±å‘é€ 3 ä¸ªåŒ…ã€‚</p><p>ä¸‰æ¬¡æ¡æ‰‹çš„ç›®çš„æ˜¯è¿æ¥æœåŠ¡å™¨æŒ‡å®šç«¯å£ï¼Œå»ºç«‹ TCP è¿æ¥ï¼Œå¹¶åŒæ­¥è¿æ¥åŒæ–¹çš„åºåˆ—å·å’Œç¡®è®¤å·ï¼Œäº¤æ¢ TCP çª—å£å¤§å°ä¿¡æ¯ã€‚åœ¨ socket ç¼–ç¨‹ä¸­ï¼Œå®¢æˆ·ç«¯æ‰§è¡Œ <code>connect()</code> æ—¶ã€‚å°†è§¦å‘ä¸‰æ¬¡æ¡æ‰‹ã€‚</p><ul><li><p>ç¬¬ä¸€æ¬¡æ¡æ‰‹(SYN=1, ACK=0, ISN=x):<br> è®¾å¤‡ Aï¼ˆå®¢æˆ·ç«¯ï¼‰å‘é€ä¸€ä¸ª <strong>SYN</strong>chronize æ ‡å¿—è®¾ç½®ä¸º 1, <strong>ACK</strong>nowledge æ ‡å¿—è®¾ç½®ä¸º 0ï¼Œä»¥åŠåˆå§‹åºåˆ—å· ISN (Initial Sequence Number) ä¸º x çš„ TCP è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µï¼›</p><p> å‘é€å®Œæ¯•åï¼Œå®¢æˆ·ç«¯è¿›å…¥ <code>SYN_SEND</code> çŠ¶æ€ï¼Œç­‰å¾…æœåŠ¡å™¨çš„ç¡®è®¤ï¼›</p></li><li><p>ç¬¬äºŒæ¬¡æ¡æ‰‹(SYN=1, ACK=1, ISN=y, ACKnum=x+1):<br>  è®¾å¤‡ Bï¼ˆæœåŠ¡å™¨ï¼‰æ¥æ”¶è®¾å¤‡ A çš„ TCP æŠ¥æ–‡æ®µï¼Œå¹¶è¿”å› SYN = 1ï¼ŒACK = 1ï¼ŒISN = Yï¼ˆè®¾å¤‡ B çš„åˆå§‹åºåˆ—å·ï¼‰ï¼Œç¡®è®¤ç¼–å·(Acknowledgment Number )= x + 1ï¼ˆè®¾å¤‡ B æ¥æ”¶åˆ°çš„è®¾å¤‡ A çš„ ISN åŠ  1ï¼‰</p><p> å‘é€å®Œæ¯•åï¼ŒæœåŠ¡å™¨ç«¯è¿›å…¥ <code>SYN_RCVD</code> çŠ¶æ€ã€‚æ­¤æ—¶æœåŠ¡å™¨ä¼šæŠŠæ­¤ç§çŠ¶æ€ä¸‹è¯·æ±‚è¿æ¥æ”¾åœ¨ä¸€ä¸ªé˜Ÿåˆ—é‡Œï¼Œæˆ‘ä»¬æŠŠè¿™ç§é˜Ÿåˆ—ç§°ä¹‹ä¸º<em>åŠè¿æ¥é˜Ÿåˆ—</em>ã€‚</p></li><li><p>ç¬¬ä¸‰æ¬¡æ¡æ‰‹(ACK=1, SYN=0, ACKnum=y+1,seq=x+1)<br>  è®¾å¤‡ A(å®¢æˆ·ç«¯)å‘è®¾å¤‡ B(æœåŠ¡å™¨)å‘é€ä¸€ä¸ª TCP æŠ¥æ–‡æ®µï¼Œä»¥ç¡®è®¤æ¥æ”¶åˆ°è®¾å¤‡ B çš„ ISNï¼Œæ ‡å¿—è®¾ç½®ä¸º ACK = 1ï¼Œåºåˆ—å·(Sequence number)= x+1ï¼Œç¡®è®¤å·(Acknowledgment number)= y+1</p><p> å‘é€å®Œæ¯•åï¼Œå®¢æˆ·ç«¯è¿›å…¥ <code>ESTABLISHED</code> çŠ¶æ€ï¼Œå½“æœåŠ¡å™¨ç«¯æ¥æ”¶åˆ°è¿™ä¸ªåŒ…æ—¶ï¼Œä¹Ÿè¿›å…¥ <code>ESTABLISHED</code> çŠ¶æ€ï¼ŒTCP æ¡æ‰‹ç»“æŸã€‚</p></li></ul><p>å®Œæˆäº†ä¸‰æ¬¡æ¡æ‰‹ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯å»ºç«‹å…¨åŒå·¥é€šä¿¡ï¼ˆfull-duplex communicationï¼‰ï¼Œå¼€å§‹ä½¿ç”¨çº¦å®šçš„åºåˆ—å·å’Œç¡®è®¤å·ï¼ˆ sequence å’Œ acknowledge numbersï¼‰ä¼ é€æ•°æ®ã€‚</p><p>ä¸‰æ¬¡æ¡æ‰‹çš„è¿‡ç¨‹çš„ç¤ºæ„å›¾å¦‚ä¸‹ï¼š</p><p><img src= "/img/loading.svg" data-lazy-src="/images/tcp-connection-made-three-way-handshake.png" alt="three-way-handshake"><br><img src= "/img/loading.svg" data-lazy-src="/images/3-way-handshake.png" alt="three-way-handshake"></p><ul><li><a href="http://www.omnisecu.com/tcpip/tcp-three-way-handshake.php">3 way handshake, TCP Three-way handshake, TCP Synchronization</a></li><li><a href="https://www.inetdaemon.com/tutorials/internet/tcp/3-way_handshake.shtml">TCP 3-Way Handshake (SYN,SYN-ACK,ACK)</a>  </li><li><a href="https://www.geeksforgeeks.org/tcp-3-way-handshake-process/">TCP 3-Way Handshake Process</a> </li><li><a href="https://study-ccna.com/tcp-three-way-handshake/">TCP three-way handshake</a> </li></ul><h3 id="å››æ¬¡æŒ¥æ‰‹ï¼ˆTCP-Connection-Terminationï¼‰"><a href="#å››æ¬¡æŒ¥æ‰‹ï¼ˆTCP-Connection-Terminationï¼‰" class="headerlink" title="å››æ¬¡æŒ¥æ‰‹ï¼ˆTCP Connection Terminationï¼‰"></a>å››æ¬¡æŒ¥æ‰‹ï¼ˆTCP Connection Terminationï¼‰</h3><p>å½“å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨é€šè¿‡ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹äº† TCP è¿æ¥ä»¥åï¼Œæ•°æ®ä¼ é€å®Œæ¯•ï¼Œè‚¯å®šæ˜¯è¦æ–­å¼€ TCP è¿æ¥ã€‚TCP çš„è¿æ¥çš„è§£é™¤éœ€è¦å‘é€å››ä¸ªåŒ…ï¼Œå› æ­¤ç§°ä¸ºå››æ¬¡æŒ¥æ‰‹(Four-way handshake)ã€‚<strong>å®¢æˆ·ç«¯æˆ–æœåŠ¡å™¨å‡å¯ä¸»åŠ¨å‘èµ·æŒ¥æ‰‹åŠ¨ä½œ</strong>ï¼Œåœ¨ socket ç¼–ç¨‹ä¸­ï¼Œä»»ä½•ä¸€æ–¹æ‰§è¡Œ <code>close()</code> æ“ä½œå³å¯äº§ç”ŸæŒ¥æ‰‹æ“ä½œã€‚</p><ul><li><p>ç¬¬ä¸€æ¬¡æŒ¥æ‰‹(FIN=1ï¼Œseq=x)<br> ï¼ˆä»å®¢æˆ·ç«¯è·å¾— FINï¼‰â€”â€”æ­¤å¤„å‡å®šå®¢æˆ·ç«¯åº”ç”¨ç¨‹åºå†³å®šè¦å…³é—­è¿æ¥ã€‚ ï¼ˆè¯·æ³¨æ„ï¼ŒæœåŠ¡å™¨ä¹Ÿå¯ä»¥é€‰æ‹©å…³é—­è¿æ¥ï¼‰ã€‚è¿™å°†å¯¼è‡´å®¢æˆ·ç«¯å°† FIN ä½è®¾ç½®ä¸º 1 çš„ TCP æŠ¥æ–‡æ®µå‘é€åˆ°æœåŠ¡å™¨ï¼Œå¹¶è¿›å…¥ FIN_WAIT_1 çŠ¶æ€ã€‚å½“å®¢æˆ·ç«¯å¤„äº FIN_WAIT_1 çŠ¶æ€æ—¶ï¼Œå®ƒä¼šç­‰å¾…æ¥è‡ªæœåŠ¡å™¨çš„å¸¦æœ‰ ACK ç¡®è®¤ï¼ˆacknowledgmentï¼‰çš„ TCP æ®µã€‚</p><p> å‘é€å®Œæ¯•åï¼Œå®¢æˆ·ç«¯è¿›å…¥ <code>FIN_WAIT_1</code> çŠ¶æ€ï¼Œæ­¤æ—¶ä»ç„¶å¯ä»¥æ¥å—æ•°æ®ã€‚</p></li><li><p>ç¬¬äºŒæ¬¡æŒ¥æ‰‹(ACK=1ï¼ŒACKnum=x+1)<br> ï¼ˆæ¥è‡ªæœåŠ¡å™¨çš„ ACKï¼‰â€”â€”å½“æœåŠ¡å™¨ä»å‘ä»¶äººï¼ˆå®¢æˆ·ç«¯ï¼‰æ”¶åˆ° FIN ä½æ®µæ—¶ï¼ŒæœåŠ¡å™¨ç«‹å³å‘å‘ä»¶äººï¼ˆå®¢æˆ·ç«¯ï¼‰å‘é€ç¡®è®¤ï¼ˆACKï¼‰æŠ¥æ–‡æ®µã€‚Acknowledgment Number ä¸º Sequence Number åŠ  1ï¼›è¡¨æ˜è‡ªå·±æ¥å—åˆ°äº†å®¢æˆ·ç«¯å…³é—­è¿æ¥çš„è¯·æ±‚ï¼Œä½†è¿˜æ²¡æœ‰å‡†å¤‡å¥½å…³é—­è¿æ¥ã€‚</p><p> å‘é€å®Œæ¯•åï¼ŒæœåŠ¡å™¨ç«¯è¿›å…¥ <code>CLOSE_WAIT</code> çŠ¶æ€ï¼Œå®¢æˆ·ç«¯æ¥æ”¶åˆ°è¿™ä¸ªç¡®è®¤åŒ…ä¹‹åï¼Œè¿›å…¥ <code>FIN_WAIT_2</code> çŠ¶æ€ï¼Œç­‰å¾…æœåŠ¡å™¨ç«¯å‘é€å…³é—­è¿æ¥æ®µã€‚</p></li><li><p>ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹(FIN=1ï¼Œseq=y)</p><p> ï¼ˆæ¥è‡ªæœåŠ¡å™¨çš„ FINï¼‰æœåŠ¡å™¨ç«¯å‡†å¤‡å¥½å…³é—­è¿æ¥æ—¶ï¼Œå‘å®¢æˆ·ç«¯å‘é€ç»“æŸè¿æ¥è¯·æ±‚ï¼ŒFIN ç½®ä¸º 1ã€‚</p><p> å‘é€å®Œæ¯•åï¼ŒæœåŠ¡å™¨ç«¯è¿›å…¥ <code>LAST_ACK</code> çŠ¶æ€ï¼Œç­‰å¾…æ¥è‡ªå®¢æˆ·ç«¯çš„æœ€åä¸€ä¸ª ACKã€‚</p></li><li><p>ç¬¬å››æ¬¡æŒ¥æ‰‹(ACK=1ï¼ŒACKnum=y+1)</p><p> ï¼ˆæ¥è‡ªå®¢æˆ·ç«¯çš„ ACKï¼‰å®¢æˆ·ç«¯æ¥æ”¶åˆ°æ¥è‡ªæœåŠ¡å™¨ç«¯çš„å…³é—­è¯·æ±‚ï¼Œå‘é€ä¸€ä¸ªç¡®è®¤æŠ¥æ–‡æ®µï¼Œå¹¶è¿›å…¥ <code>TIME_WAIT</code>çŠ¶æ€ï¼ŒTIME_WAIT çŠ¶æ€å…è®¸å®¢æˆ·ç«¯åœ¨ ACK ä¸¢å¤±çš„æƒ…å†µä¸‹é‡æ–°å‘é€æœ€ç»ˆç¡®è®¤çš„ ACK åŒ…ã€‚</p><p> æœåŠ¡å™¨ç«¯æ¥æ”¶åˆ°è¿™ä¸ªç¡®è®¤åŒ…ä¹‹åï¼Œå…³é—­è¿æ¥ï¼Œè¿›å…¥ <code>CLOSED</code> çŠ¶æ€ã€‚</p><p> å®¢æˆ·ç«¯ç­‰å¾…äº†æŸä¸ªå›ºå®šæ—¶é—´ï¼ˆä¸¤ä¸ªæœ€å¤§æ®µç”Ÿå‘½å‘¨æœŸï¼Œ2MSLï¼Œ2 Maximum Segment Lifetimeï¼‰ä¹‹åï¼Œæ²¡æœ‰æ”¶åˆ°æœåŠ¡å™¨ç«¯çš„ ACK ï¼Œè®¤ä¸ºæœåŠ¡å™¨ç«¯å·²ç»æ­£å¸¸å…³é—­è¿æ¥ï¼Œäºæ˜¯è‡ªå·±ä¹Ÿå…³é—­è¿æ¥ï¼Œè¿›å…¥ <code>CLOSED</code> çŠ¶æ€ã€‚</p><p> å¤„äº TIME_WAIT çŠ¶æ€çš„å®¢æˆ·ç«¯æ‰€èŠ±è´¹çš„æ—¶é—´å–å†³äºå…¶å®ç°ï¼Œä½†å…¸å‹å€¼ä¸º 30 ç§’ï¼Œ1 åˆ†é’Ÿå’Œ 2 åˆ†é’Ÿã€‚ç­‰å¾…ä¹‹åï¼Œè¿æ¥æ­£å¼å…³é—­ï¼Œå¹¶ä¸”å®¢æˆ·ç«¯ä¸Šçš„æ‰€æœ‰èµ„æºï¼ˆåŒ…æ‹¬ç«¯å£å·å’Œç¼“å†²åŒºæ•°æ®ï¼‰éƒ½è¢«é‡Šæ”¾ã€‚</p></li></ul><p>å››æ¬¡æŒ¥æ‰‹çš„ç¤ºæ„å›¾å¦‚ä¸‹ï¼š</p><p><img src= "/img/loading.svg" data-lazy-src="/images/tcp-connection-closed-four-way-handshake.png" alt="four-way-handshake"></p><ul><li><a href="http://www.tcpipguide.com/free/t_TCPConnectionTermination-2.htm">TCP Connection Termination</a>  </li><li><a href="https://www.geeksforgeeks.org/tcp-connection-termination/">TCP Connection Termination</a>   </li></ul><h4 id="å®Œæ•´çŠ¶æ€è½¬æ¢å›¾"><a href="#å®Œæ•´çŠ¶æ€è½¬æ¢å›¾" class="headerlink" title="å®Œæ•´çŠ¶æ€è½¬æ¢å›¾"></a>å®Œæ•´çŠ¶æ€è½¬æ¢å›¾</h4><p><img src= "/img/loading.svg" data-lazy-src="/images/TCP-states-visited-by-ClientSide.png" alt="å®¢æˆ·ç«¯"></p><p><img src= "/img/loading.svg" data-lazy-src="/images/TCP-states-visited-by-ServerSide.png" alt="æœåŠ¡ç«¯"></p><hr><h2 id="ç–‘é—®è§£æƒ‘"><a href="#ç–‘é—®è§£æƒ‘" class="headerlink" title="ç–‘é—®è§£æƒ‘"></a>ç–‘é—®è§£æƒ‘</h2><h3 id="ISN-æ˜¯å›ºå®šçš„å—"><a href="#ISN-æ˜¯å›ºå®šçš„å—" class="headerlink" title="ISN æ˜¯å›ºå®šçš„å—"></a>ISN æ˜¯å›ºå®šçš„å—</h3><p>ä¸‰æ¬¡æ¡æ‰‹çš„ä¸€ä¸ªé‡è¦åŠŸèƒ½æ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯äº¤æ¢ ISN(Initial Sequence Number), ä»¥ä¾¿è®©å¯¹æ–¹çŸ¥é“æ¥ä¸‹æ¥æ¥æ”¶æ•°æ®çš„æ—¶å€™å¦‚ä½•æŒ‰åºåˆ—å·ç»„è£…æ•°æ®ã€‚</p><p>å¦‚æœ ISN æ˜¯å›ºå®šçš„ï¼Œæ”»å‡»è€…å¾ˆå®¹æ˜“çŒœå‡ºåç»­çš„ç¡®è®¤å·ï¼Œå› æ­¤ ISN æ˜¯åŠ¨æ€ç”Ÿæˆçš„ã€‚</p><h3 id="ä¸ºä»€ä¹ˆè¦ä¸‰æ¬¡æ¡æ‰‹"><a href="#ä¸ºä»€ä¹ˆè¦ä¸‰æ¬¡æ¡æ‰‹" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ä¸‰æ¬¡æ¡æ‰‹"></a>ä¸ºä»€ä¹ˆè¦ä¸‰æ¬¡æ¡æ‰‹</h3><p>åœ¨è°¢å¸Œä»è‘—ã€Šè®¡ç®—æœºç½‘ç»œã€‹ç¬¬å››ç‰ˆä¸­è®²â€œä¸‰æ¬¡æ¡æ‰‹â€çš„ç›®çš„æ˜¯â€œä¸ºäº†é˜²æ­¢å·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µçªç„¶åˆä¼ é€åˆ°äº†æœåŠ¡ç«¯ï¼Œå› è€Œäº§ç”Ÿé”™è¯¯â€ã€‚ä¸ºäº†è§£å†³â€œç½‘ç»œä¸­å­˜åœ¨å»¶è¿Ÿçš„é‡å¤åˆ†ç»„â€çš„é—®é¢˜ã€‚    </p><p>ä¸ºä»€ä¹ˆ A è¿˜è¦å‘é€ä¸€æ¬¡ç¡®è®¤å‘¢ï¼Ÿè¿™ä¸»è¦æ˜¯ä¸ºäº†é˜²æ­¢å·±å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µçªç„¶åˆä¼ é€åˆ°äº† B ,å› è€Œäº§ç”Ÿé”™è¯¯ã€‚<br>æ‰€è°“â€œå·±å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µâ€æ˜¯è¿™æ ·äº§ç”Ÿçš„ï¼š</p><blockquote><p>æ­£å¸¸æƒ…å†µä¸‹ï¼šA å‘å‡ºè¿æ¥è¯·æ±‚,ä½†å› è¿æ¥è¯·æ±‚æŠ¥æ–‡ä¸¢å¤±è€Œæœªæ”¶åˆ°ç¡®è®¤ã€‚äºæ˜¯ A å†é‡ä¼ ä¸€æ¬¡è¿æ¥è¯·æ±‚ã€‚åæ¥æ”¶åˆ°äº†ç¡®è®¤ï¼Œå»ºç«‹äº†è¿æ¥ã€‚æ•°æ®ä¼ è¾“å®Œæ¯•åï¼Œå°±é‡Šæ”¾äº†è¿æ¥ã€‚A å…±å‘é€äº†ä¸¤ä¸ªè¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µã€‚å…¶ä¸­ï¼Œç¬¬ä¸€ä¸ªä¸¢å¤±ï¼Œç¬¬äºŒä¸ªåˆ°è¾¾äº† Bã€‚æ²¡æœ‰â€œå·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µâ€ã€‚</p><p>ç°å‡å®šå‡ºç°ä¸€ç§å¼‚å¸¸æƒ…å†µï¼šå³ A å‘å‡ºçš„ç¬¬ä¸€ä¸ªè¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µå¹¶æ²¡æœ‰ä¸¢å¤±ï¼Œè€Œæ˜¯åœ¨æŸäº›ç½‘ç»œç»“ç‚¹é•¿æ—¶é—´æ»ç•™äº†ï¼Œä»¥è‡´å»¶è¯¯åˆ°è¿æ¥é‡Šæ”¾ä»¥åçš„æŸä¸ªæ—¶é—´æ‰åˆ°è¾¾ Bã€‚æœ¬æ¥è¿™æ˜¯ä¸€ä¸ªæ—©å·±å¤±æ•ˆçš„æŠ¥æ–‡æ®µã€‚ä½† B æ”¶åˆ°æ­¤å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µåï¼Œå°±è¯¯è®¤ä¸ºæ˜¯ A åˆå‘å‡ºä¸€æ¬¡æ–°çš„è¿æ¥è¯·æ±‚ã€‚äºæ˜¯å°±å‘ A å‘å‡ºç¡®è®¤æŠ¥æ–‡æ®µï¼ŒåŒæ„å»ºç«‹è¿æ¥ï¼Œå‡å®šä¸é‡‡ç”¨â€œä¸‰æ¬¡æ¡æ‰‹â€ï¼Œé‚£ä¹ˆåªè¦ B å‘å‡ºç¡®è®¤ï¼Œæ–°çš„è¿æ¥å°±å»ºç«‹äº†ã€‚<br>ç”±äºç°åœ¨ A å¹¶æ²¡æœ‰å‘å‡ºå»ºç«‹è¿æ¥çš„è¯·æ±‚ã€‚å› æ­¤ä¸ä¼šç†ç¬ B çš„ç¡®è®¤ã€‚ä¹Ÿä¸ä¼šå‘ B å‘é€æ•°æ®ã€‚ä½† B å´ä»¥ä¸ºæ–°çš„è¿è¾“è¿æ¥å·±ç»å»ºç«‹äº†ï¼Œå¹¶ä¸€ç›´ç­‰å¾… A å‘æ¥æ•°æ®ã€‚B çš„è®¸å¤šèµ„æºå°±è¿™æ ·ç™½ç™½æµªè´¹äº†ã€‚<br>é‡‡ç”¨ä¸‰æ¬¡æ¡æ‰‹çš„åŠæ³•å¯ä»¥é˜²æ­¢ä¸Šè¿°ç°è±¡çš„å‘ç”Ÿã€‚ä¾‹å¦‚åœ¨åˆšæ‰çš„æƒ…å†µä¸‹ï¼ŒA ä¸ä¼šå‘ B çš„ç¡®è®¤å‘å‡ºç¡®è®¤ã€‚B ç”±äºæ”¶ä¸åˆ°ç¡®è®¤ã€‚å°±çŸ¥é“ A å¹¶æ²¡æœ‰è¦æ±‚å»ºç«‹è¿æ¥ã€‚</p></blockquote><p>è¿™å°±å¾ˆæ˜ç™½äº†ï¼Œ<strong>é˜²æ­¢æœåŠ¡å™¨ç«¯çš„ä¸€ç›´ç­‰å¾…è€Œæµªè´¹èµ„æº</strong>ã€‚</p><p>åœ¨ Google Groups çš„ TopLanguage ä¸­çœ‹åˆ°ä¸€å¸–è®¨è®º TCPâ€œä¸‰æ¬¡æ¡æ‰‹â€è§‰å¾—å¾ˆæœ‰æ„æ€ã€‚è´´ä¸»æå‡ºâ€œTCP å»ºç«‹è¿æ¥ä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿâ€çš„é—®é¢˜ï¼Œåœ¨ä¼—å¤šå›å¤ä¸­ï¼Œæœ‰ä¸€æ¡å›å¤å†™é“ï¼šâ€œè¿™ä¸ªé—®é¢˜çš„æœ¬è´¨æ˜¯ï¼šä¿¡é“ä¸å¯é , ä½†æ˜¯é€šä¿¡åŒå‘éœ€è¦å°±æŸä¸ªé—®é¢˜è¾¾æˆä¸€è‡´ã€‚è€Œè¦è§£å†³è¿™ä¸ªé—®é¢˜, æ— è®ºä½ åœ¨æ¶ˆæ¯ä¸­åŒ…å«ä»€ä¹ˆä¿¡æ¯, ä¸‰æ¬¡é€šä¿¡æ˜¯ç†è®ºä¸Šçš„æœ€å°å€¼ã€‚æ‰€ä»¥ä¸‰æ¬¡æ¡æ‰‹ä¸æ˜¯ TCP æœ¬èº«çš„è¦æ±‚, è€Œæ˜¯ä¸ºäº†æ»¡è¶³â€åœ¨ä¸å¯é ä¿¡é“ä¸Šå¯é åœ°ä¼ è¾“ä¿¡æ¯â€è¿™ä¸€éœ€æ±‚æ‰€å¯¼è‡´çš„ã€‚è¯·æ³¨æ„è¿™é‡Œçš„æœ¬è´¨éœ€æ±‚,ä¿¡é“ä¸å¯é , æ•°æ®ä¼ è¾“è¦å¯é ã€‚ä¸‰æ¬¡è¾¾åˆ°äº†, é‚£åé¢ä½ æƒ³æ¥ç€æ¡æ‰‹ä¹Ÿå¥½, å‘æ•°æ®ä¹Ÿå¥½, è·Ÿè¿›è¡Œå¯é ä¿¡æ¯ä¼ è¾“çš„éœ€æ±‚å°±æ²¡å…³ç³»äº†ã€‚å› æ­¤,å¦‚æœä¿¡é“æ˜¯å¯é çš„, å³æ— è®ºä»€ä¹ˆæ—¶å€™å‘å‡ºæ¶ˆæ¯, å¯¹æ–¹ä¸€å®šèƒ½æ”¶åˆ°, æˆ–è€…ä½ ä¸å…³å¿ƒæ˜¯å¦è¦ä¿è¯å¯¹æ–¹æ”¶åˆ°ä½ çš„æ¶ˆæ¯, é‚£å°±èƒ½åƒ UDP é‚£æ ·ç›´æ¥å‘é€æ¶ˆæ¯å°±å¯ä»¥äº†ã€‚â€è¿™å¯è§†ä¸ºå¯¹â€œä¸‰æ¬¡æ¡æ‰‹â€ç›®çš„çš„å¦ä¸€ç§è§£ç­”æ€è·¯ã€‚</p><h3 id="é€šä¿—ç†è§£"><a href="#é€šä¿—ç†è§£" class="headerlink" title="é€šä¿—ç†è§£"></a>é€šä¿—ç†è§£</h3><p>ä½†æ˜¯ä¸ºä»€ä¹ˆä¸€å®šè¦è¿›è¡Œä¸‰æ¬¡æ¡æ‰‹æ¥ä¿è¯è¿æ¥æ˜¯åŒå·¥çš„å‘¢ï¼Œä¸€æ¬¡ä¸è¡Œä¹ˆï¼Ÿä¸¤æ¬¡ä¸è¡Œä¹ˆï¼Ÿæˆ‘ä»¬ä¸¾ä¸€ä¸ªç°å®ç”Ÿæ´»ä¸­ä¸¤ä¸ªäººè¿›è¡Œè¯­è¨€æ²Ÿé€šçš„ä¾‹å­æ¥æ¨¡æ‹Ÿä¸‰æ¬¡æ¡æ‰‹ã€‚<br>å¼•ç”¨ç½‘ä¸Šçš„ä¸€äº›é€šä¿—æ˜“æ‡‚çš„ä¾‹å­ï¼Œè™½ç„¶ä¸å¤ªæ­£ç¡®ï¼Œåé¢ä¼šæŒ‡å‡ºï¼Œä½†æ˜¯ä¸å¦¨ç¢æˆ‘ä»¬ç†è§£ï¼Œå¤§ä½“å°±æ˜¯è¿™ä¹ˆä¸ªç†è§£æ³•ã€‚</p><ul><li>ç¬¬ä¸€æ¬¡å¯¹è¯ï¼š<br>è€å©†è®©ç”²å‡ºå»æ‰“é…±æ²¹ï¼ŒåŠè·¯ç¢°åˆ°ä¸€ä¸ªæœ‹å‹ä¹™ï¼Œç”²é—®äº†ä¸€å¥ï¼šå“¥ä»¬ä½ åƒé¥­äº†ä¹ˆï¼Ÿ<br>ç»“æœä¹™å¸¦ç€è€³æœºå¬æ­Œå‘¢ï¼Œæ ¹æœ¬æ²¡å¬åˆ°ï¼Œæ²¡ååº”ã€‚ç”²å¿ƒé‡Œæƒ³ï¼šè·Ÿä½ è¯´è¯ä¹Ÿæ²¡ä¸ªéŸ³ï¼Œä¸è·Ÿä½ è¯´äº†ï¼Œæ²Ÿé€šå¤±è´¥ã€‚è¯´æ˜ä¹™æ¥å—ä¸åˆ°ç”²ä¼ è¿‡æ¥çš„ä¿¡æ¯çš„æƒ…å†µä¸‹æ²Ÿé€šè‚¯å®šæ˜¯å¤±è´¥çš„ã€‚<br>å¦‚æœä¹™å¬åˆ°äº†ç”²è¯´çš„è¯ï¼Œé‚£ä¹ˆç¬¬ä¸€æ¬¡å¯¹è¯æˆåŠŸï¼Œæ¥ä¸‹æ¥è¿›è¡Œç¬¬äºŒæ¬¡å¯¹è¯ã€‚</li><li>ç¬¬äºŒæ¬¡å¯¹è¯ï¼š<br>ä¹™å¬åˆ°äº†ç”²è¯´çš„è¯ï¼Œä½†æ˜¯ä»–æ˜¯è€å¤–ï¼Œä¸­æ–‡ä¸å¥½ï¼Œä¸çŸ¥é“ç”²è¯´çš„å•¥æ„æ€ä¹Ÿä¸çŸ¥é“æ€æ ·å›ç­”ï¼Œäºæ˜¯éšä¾¿å›ç­”äº†ä¸€å¥å­¦è¿‡çš„ä¸­æ–‡ ï¼šæˆ‘å»å•æ‰€äº†ã€‚ç”²ä¸€å¬ç«‹åˆ»ç¬‘å–·äº†ï¼Œâ€œå»å•æ‰€åƒé¥­â€?é“ä¸åŒä¸ç›¸ä¸ºè°‹ï¼Œç¦»ä½ è¿œç‚¹å§ï¼Œæ²Ÿé€šå¤±è´¥ã€‚è¯´æ˜ä¹™æ— æ³•åšå‡ºæ­£ç¡®åº”ç­”çš„æƒ…å†µä¸‹æ²Ÿé€šå¤±è´¥ã€‚<br>å¦‚æœä¹™å¬åˆ°äº†ç”²çš„è¯ï¼Œåšå‡ºäº†æ­£ç¡®çš„åº”ç­”ï¼Œå¹¶ä¸”è¿˜è¿›è¡Œäº†åé—®ï¼šæˆ‘åƒé¥­äº†ï¼Œä½ å‘¢ï¼Ÿé‚£ä¹ˆç¬¬äºŒæ¬¡æ¡æ‰‹æˆåŠŸã€‚<br>é€šè¿‡å‰ä¸¤æ¬¡å¯¹è¯è¯æ˜äº†ä¹™èƒ½å¤Ÿå¬æ‡‚ç”²è¯´çš„è¯ï¼Œå¹¶ä¸”èƒ½åšå‡ºæ­£ç¡®çš„åº”ç­”ã€‚ æ¥ä¸‹æ¥è¿›è¡Œç¬¬ä¸‰æ¬¡å¯¹è¯ã€‚</li><li>ç¬¬ä¸‰æ¬¡å¯¹è¯ï¼š<br>ç”²åˆšå’Œä¹™æ‰“äº†ä¸ªæ‹›å‘¼ï¼Œçªç„¶è€å©†å–Šä»–ï¼Œâ€œä½ ä¸ªæ­»é¬¼ï¼Œæ‰“ä¸ªé…±æ²¹å’‹è¿™ä¹ˆåŠå¤©ï¼Œçœ‹æˆ‘å›å®¶å’‹æ”¶æ‹¾ä½ â€ï¼Œç”²æ˜¯ä¸ªå¦»ç®¡ä¸¥ï¼Œå¬å®Œå“å¾—äºŒè¯ä¸è¯´å°±è·‘å›å®¶äº†ï¼ŒæŠŠä¹™è‡ªå·±æ™¾é‚£äº†ã€‚ä¹™å¿ƒæƒ³ï¼šè¿™ä»€ä¹ˆäººå•Šï¼Œå¾—ï¼Œæˆ‘ä¹Ÿå›å®¶å§ï¼Œæ²Ÿé€šå¤±è´¥ã€‚è¯´æ˜ç”²æ— æ³•åšå‡ºåº”ç­”çš„æƒ…å†µä¸‹æ²Ÿé€šå¤±è´¥ã€‚<br>å¦‚æœç”²ä¹Ÿåšå‡ºäº†æ­£ç¡®çš„åº”ç­”ï¼šæˆ‘ä¹Ÿåƒäº†ã€‚é‚£ä¹ˆç¬¬ä¸‰æ¬¡å¯¹è¯æˆåŠŸï¼Œä¸¤äººå·²ç»å»ºç«‹èµ·äº†é¡ºç•…çš„æ²Ÿé€šæ¸ é“ï¼Œæ¥ä¸‹æ¥å¼€å§‹æŒç»­çš„èŠå¤©ã€‚<br>é€šè¿‡ç¬¬äºŒæ¬¡å’Œç¬¬ä¸‰æ¬¡çš„å¯¹è¯è¯æ˜äº†ç”²èƒ½å¤Ÿå¬æ‡‚ä¹™è¯´çš„è¯ï¼Œå¹¶ä¸”èƒ½åšå‡ºæ­£ç¡®çš„åº”ç­”ã€‚<br>å¯è§ï¼Œä¸¤ä¸ªäººè¿›è¡Œæœ‰æ•ˆçš„è¯­è¨€æ²Ÿé€šï¼Œè¿™ä¸‰æ¬¡å¯¹è¯çš„è¿‡ç¨‹æ˜¯å¿…é¡»çš„ã€‚<br>ä¸ºäº†ä¿è¯æœåŠ¡ç«¯èƒ½æ”¶æ¥å—åˆ°å®¢æˆ·ç«¯çš„ä¿¡æ¯å¹¶èƒ½åšå‡ºæ­£ç¡®çš„åº”ç­”è€Œè¿›è¡Œå‰ä¸¤æ¬¡(ç¬¬ä¸€æ¬¡å’Œç¬¬äºŒæ¬¡)æ¡æ‰‹ï¼Œä¸ºäº†ä¿è¯å®¢æˆ·ç«¯èƒ½å¤Ÿæ¥æ”¶åˆ°æœåŠ¡ç«¯çš„ä¿¡æ¯å¹¶èƒ½åšå‡ºæ­£ç¡®çš„åº”ç­”è€Œè¿›è¡Œåä¸¤æ¬¡(ç¬¬äºŒæ¬¡å’Œç¬¬ä¸‰æ¬¡)æ¡æ‰‹ã€‚<br>è¿™ä¸ªä¾‹å­ä¸¾å¾—æŒºå¥½çš„ã€‚ä¸è¿‡ä¸ªäººæ„Ÿè§‰ä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡è€Œä¸æ˜¯äºŒæ¬¡ï¼Œä¸æ˜¯å› ä¸ºä¸ºäº†è¯æ˜ç”²èƒ½å¬æ‡‚ä¹™å¹¶å›åº”ï¼ˆç¬¬äºŒæ¬¡ä¹™èƒ½æ­£ç¡®çš„å“åº”ç”²è¯´æ˜ä¿©äººä¹‹é—´æ²Ÿé€šå·²æ— éšœç¢äº†ï¼‰ï¼Œè€Œæ˜¯æ€•å‡ºç°ä»¥ä¸‹æƒ…å†µè€Œæµªè´¹æ„Ÿæƒ…ã€‚è¿™ä¸ªæƒ…æ™¯æ˜¯è¿™æ ·çš„ï¼ˆä¾‹å­æœ‰ç‚¹ä¸å®é™…æ„ä¼šå°±å¥½ï¼‰ï¼šç”²åœ¨è·¯ä¸Šè·Ÿä¹™æ‰“æ‹›å‘¼ï¼Œç”±äºåˆ®é£ä»€ä¹ˆçš„è¿™å¥æ´»è¢«å¹è·‘äº†ï¼Œç„¶åç”²åˆè·Ÿæ‰“äº†ä¸ªæ‹›å‘¼ï¼Œä¹™å¬åˆ°äº†å¹¶ä½œå‡ºäº†å›åº”ã€‚æ­¤æ—¶ä¸ç®¡æ˜¯ä¸‰æ¬¡æ¡æ‰‹è¿˜æ˜¯ä¸¤æ¬¡æ¡æ‰‹ä¸¤ä¸ªäººéƒ½èƒ½æ„‰å¿«çš„æ²Ÿé€šã€‚0.1 ç§’åä¿©äººå››æ¬¡æŒ¥æ‰‹å‘Šåˆ«äº†ã€‚æ­¤æ—¶è¢«é£åˆ®è·‘çš„é‚£å¥è¯åˆä¼ åˆ°äº†ä¹™çš„è€³æœµé‡Œï¼Œä¹™è®¤ä¸ºç”²åˆè¦è·Ÿä»–æ²Ÿé€šï¼Œæ‰€ä»¥åšå‡ºäº†å“åº”çš„å›åº”ã€‚ï¼ˆé—®é¢˜å‡ºç°äº†ï¼‰å‡å¦‚é‡‡ç”¨ 2 æ¬¡æ¡æ‰‹ï¼Œä¹™å°±è®¤å®šäº†ç”²è¦è·Ÿä»–æ²Ÿé€šï¼Œäºæ˜¯å°±ä¸åœçš„ç­‰ï¼Œæµªè´¹æ„Ÿæƒ…ã€‚å¯å¦‚æœæ˜¯é‡‡ç”¨ 3 æ¬¡æ¡æ‰‹ï¼Œä¹™ç­‰äº†ä¸€ä¼šåå‘ç°ç”²æ²¡æœ‰å›åº”ä»–å°±è®¤ä¸ºç”²èµ°äº†ç„¶åè‡ªå·±ä¹Ÿå°±èµ°äº†ï¼<br>è¿™å°±å¾ˆæ˜ç™½äº†ï¼Œå…¶å®ç¬¬ä¸‰æ­¥æ˜¯é˜²æ­¢äº†ä¹™çš„ä¸€ç›´ç­‰å¾…è€Œæµªè´¹è‡ªå·±çš„æ—¶é—´ï¼Œè€Œä¸æ˜¯ä¸ºäº†ä¿è¯ç”²èƒ½å¤Ÿæ­£ç¡®å›åº”ä¹™çš„ä¿¡æ¯ã€‚</li></ul><h3 id="ä¸ºä»€ä¹ˆè¦å››æ¬¡åˆ†æ‰‹"><a href="#ä¸ºä»€ä¹ˆè¦å››æ¬¡åˆ†æ‰‹" class="headerlink" title="ä¸ºä»€ä¹ˆè¦å››æ¬¡åˆ†æ‰‹"></a>ä¸ºä»€ä¹ˆè¦å››æ¬¡åˆ†æ‰‹</h3><p>TCP åè®®æ˜¯ä¸€ç§é¢å‘è¿æ¥çš„ã€å¯é çš„ã€åŸºäºå­—èŠ‚æµçš„è¿è¾“å±‚é€šä¿¡åè®®ã€‚<br>TCP æ˜¯å…¨åŒå·¥æ¨¡å¼ï¼Œè¿™å°±æ„å‘³ç€ï¼Œå½“ä¸»æœº 1 å‘å‡º FIN æŠ¥æ–‡æ®µæ—¶ï¼Œåªæ˜¯è¡¨ç¤ºä¸»æœº 1 å·²ç»æ²¡æœ‰æ•°æ®è¦å‘é€äº†ï¼Œä¸»æœº 1 å‘Šè¯‰ä¸»æœº 2ï¼Œå®ƒçš„æ•°æ®å·²ç»å…¨éƒ¨å‘é€å®Œæ¯•äº†ï¼›ä½†æ˜¯ï¼Œè¿™ä¸ªæ—¶å€™ä¸»æœº 1 è¿˜æ˜¯å¯ä»¥æ¥å—æ¥è‡ªä¸»æœº 2 çš„æ•°æ®ï¼›å½“ä¸»æœº 2 è¿”å› ACK æŠ¥æ–‡æ®µæ—¶ï¼Œè¡¨ç¤ºå®ƒå·²ç»çŸ¥é“ä¸»æœº 1 æ²¡æœ‰æ•°æ®å‘é€äº†ï¼Œä½†æ˜¯ä¸»æœº 2 è¿˜æ˜¯å¯ä»¥å‘é€æ•°æ®åˆ°ä¸»æœº 1 çš„ï¼›å½“ä¸»æœº 2 ä¹Ÿå‘é€äº† FIN æŠ¥æ–‡æ®µæ—¶ï¼Œè¿™ä¸ªæ—¶å€™å°±è¡¨ç¤ºä¸»æœº 2 ä¹Ÿæ²¡æœ‰æ•°æ®è¦å‘é€äº†ï¼Œå°±ä¼šå‘Šè¯‰ä¸»æœº 1ï¼Œæˆ‘ä¹Ÿæ²¡æœ‰æ•°æ®è¦å‘é€äº†ï¼Œä¹‹åå½¼æ­¤å°±ä¼šæ„‰å¿«åœ°ä¸­æ–­è¿™æ¬¡ TCP è¿æ¥ã€‚<br>å¦‚æœè¦æ­£ç¡®çš„ç†è§£å››æ¬¡åˆ†æ‰‹çš„åŸç†ï¼Œå°±éœ€è¦äº†è§£å››æ¬¡åˆ†æ‰‹è¿‡ç¨‹ä¸­çš„çŠ¶æ€å˜åŒ–ï¼š  </p><ul><li>FIN_WAIT_1: è¿™ä¸ªçŠ¶æ€è¦å¥½å¥½è§£é‡Šä¸€ä¸‹ï¼Œå…¶å® FIN_WAIT_1 å’Œ FIN_WAIT_2 çŠ¶æ€çš„çœŸæ­£å«ä¹‰éƒ½æ˜¯è¡¨ç¤ºç­‰å¾…å¯¹æ–¹çš„ FIN æŠ¥æ–‡ã€‚è€Œè¿™ä¸¤ç§çŠ¶æ€çš„åŒºåˆ«æ˜¯ï¼šFIN_WAIT_1 çŠ¶æ€å®é™…ä¸Šæ˜¯å½“ SOCKET åœ¨ ESTABLISHED çŠ¶æ€æ—¶ï¼Œå®ƒæƒ³ä¸»åŠ¨å…³é—­è¿æ¥ï¼Œå‘å¯¹æ–¹å‘é€äº† FIN æŠ¥æ–‡ï¼Œæ­¤æ—¶è¯¥ SOCKET å³è¿›å…¥åˆ° FIN_WAIT_1 çŠ¶æ€ã€‚è€Œå½“å¯¹æ–¹å›åº” ACK æŠ¥æ–‡åï¼Œåˆ™è¿›å…¥åˆ° FIN_WAIT_2 çŠ¶æ€ï¼Œå½“ç„¶åœ¨å®é™…çš„æ­£å¸¸æƒ…å†µä¸‹ï¼Œæ— è®ºå¯¹æ–¹ä½•ç§æƒ…å†µä¸‹ï¼Œéƒ½åº”è¯¥é©¬ä¸Šå›åº” ACK æŠ¥æ–‡ï¼Œæ‰€ä»¥ FIN_WAIT_1 çŠ¶æ€ä¸€èˆ¬æ˜¯æ¯”è¾ƒéš¾è§åˆ°çš„ï¼Œè€Œ FIN_WAIT_2 çŠ¶æ€è¿˜æœ‰æ—¶å¸¸å¸¸å¯ä»¥ç”¨ netstat çœ‹åˆ°ã€‚ï¼ˆä¸»åŠ¨æ–¹ï¼‰</li><li>FIN_WAIT_2ï¼šä¸Šé¢å·²ç»è¯¦ç»†è§£é‡Šäº†è¿™ç§çŠ¶æ€ï¼Œå®é™…ä¸Š FIN_WAIT_2 çŠ¶æ€ä¸‹çš„ SOCKETï¼Œè¡¨ç¤ºåŠè¿æ¥ï¼Œä¹Ÿå³æœ‰ä¸€æ–¹è¦æ±‚ close è¿æ¥ï¼Œä½†å¦å¤–è¿˜å‘Šè¯‰å¯¹æ–¹ï¼Œæˆ‘æš‚æ—¶è¿˜æœ‰ç‚¹æ•°æ®éœ€è¦ä¼ é€ç»™ä½ (ACK ä¿¡æ¯)ï¼Œç¨åå†å…³é—­è¿æ¥ã€‚ï¼ˆä¸»åŠ¨æ–¹ï¼‰</li><li>CLOSE_WAITï¼šè¿™ç§çŠ¶æ€çš„å«ä¹‰å…¶å®æ˜¯è¡¨ç¤ºåœ¨ç­‰å¾…å…³é—­ã€‚æ€ä¹ˆç†è§£å‘¢ï¼Ÿå½“å¯¹æ–¹ close ä¸€ä¸ª SOCKET åå‘é€ FIN æŠ¥æ–‡ç»™è‡ªå·±ï¼Œä½ ç³»ç»Ÿæ¯«æ— ç–‘é—®åœ°ä¼šå›åº”ä¸€ä¸ª ACK æŠ¥æ–‡ç»™å¯¹æ–¹ï¼Œæ­¤æ—¶åˆ™è¿›å…¥åˆ° CLOSE_WAIT çŠ¶æ€ã€‚æ¥ä¸‹æ¥å‘¢ï¼Œå®é™…ä¸Šä½ çœŸæ­£éœ€è¦è€ƒè™‘çš„äº‹æƒ…æ˜¯å¯Ÿçœ‹ä½ æ˜¯å¦è¿˜æœ‰æ•°æ®å‘é€ç»™å¯¹æ–¹ï¼Œå¦‚æœæ²¡æœ‰çš„è¯ï¼Œé‚£ä¹ˆä½ ä¹Ÿå°±å¯ä»¥ close è¿™ä¸ª SOCKETï¼Œå‘é€ FIN æŠ¥æ–‡ç»™å¯¹æ–¹ï¼Œä¹Ÿå³å…³é—­è¿æ¥ã€‚æ‰€ä»¥ä½ åœ¨ CLOSE_WAIT çŠ¶æ€ä¸‹ï¼Œéœ€è¦å®Œæˆçš„äº‹æƒ…æ˜¯ç­‰å¾…ä½ å»å…³é—­è¿æ¥ã€‚ï¼ˆè¢«åŠ¨æ–¹ï¼‰</li><li>LAST_ACK: è¿™ä¸ªçŠ¶æ€è¿˜æ˜¯æ¯”è¾ƒå®¹æ˜“å¥½ç†è§£çš„ï¼Œå®ƒæ˜¯è¢«åŠ¨å…³é—­ä¸€æ–¹åœ¨å‘é€ FIN æŠ¥æ–‡åï¼Œæœ€åç­‰å¾…å¯¹æ–¹çš„ ACK æŠ¥æ–‡ã€‚å½“æ”¶åˆ° ACK æŠ¥æ–‡åï¼Œä¹Ÿå³å¯ä»¥è¿›å…¥åˆ° CLOSED å¯ç”¨çŠ¶æ€äº†ã€‚ï¼ˆè¢«åŠ¨æ–¹ï¼‰</li><li>TIME_WAIT: è¡¨ç¤ºæ”¶åˆ°äº†å¯¹æ–¹çš„ FIN æŠ¥æ–‡ï¼Œå¹¶å‘é€å‡ºäº† ACK æŠ¥æ–‡ï¼Œå°±ç­‰ 2MSL åå³å¯å›åˆ° CLOSED å¯ç”¨çŠ¶æ€äº†ã€‚å¦‚æœ FINWAIT1 çŠ¶æ€ä¸‹ï¼Œæ”¶åˆ°äº†å¯¹æ–¹åŒæ—¶å¸¦ FIN æ ‡å¿—å’Œ ACK æ ‡å¿—çš„æŠ¥æ–‡æ—¶ï¼Œå¯ä»¥ç›´æ¥è¿›å…¥åˆ° TIME_WAIT çŠ¶æ€ï¼Œè€Œæ— é¡»ç»è¿‡ FIN_WAIT_2 çŠ¶æ€ã€‚ï¼ˆä¸»åŠ¨æ–¹ï¼‰</li><li>CLOSED: è¡¨ç¤ºè¿æ¥ä¸­æ–­ã€‚</li></ul><h3 id="ä¸ºä»€ä¹ˆè¿æ¥çš„æ—¶å€™æ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œå…³é—­çš„æ—¶å€™å´æ˜¯å››æ¬¡æ¡æ‰‹"><a href="#ä¸ºä»€ä¹ˆè¿æ¥çš„æ—¶å€™æ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œå…³é—­çš„æ—¶å€™å´æ˜¯å››æ¬¡æ¡æ‰‹" class="headerlink" title="ä¸ºä»€ä¹ˆè¿æ¥çš„æ—¶å€™æ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œå…³é—­çš„æ—¶å€™å´æ˜¯å››æ¬¡æ¡æ‰‹"></a>ä¸ºä»€ä¹ˆè¿æ¥çš„æ—¶å€™æ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œå…³é—­çš„æ—¶å€™å´æ˜¯å››æ¬¡æ¡æ‰‹</h3><p>å› ä¸ºå½“ Server ç«¯æ”¶åˆ° Client ç«¯çš„ SYN è¿æ¥è¯·æ±‚æŠ¥æ–‡åï¼Œå¯ä»¥ç›´æ¥å‘é€ SYN+ACK æŠ¥æ–‡ã€‚å…¶ä¸­ ACK æŠ¥æ–‡æ˜¯ç”¨æ¥åº”ç­”çš„ï¼ŒSYN æŠ¥æ–‡æ˜¯ç”¨æ¥åŒæ­¥çš„ã€‚ä½†æ˜¯å…³é—­è¿æ¥æ—¶ï¼Œå½“ Server ç«¯æ”¶åˆ° FIN æŠ¥æ–‡æ—¶ï¼Œå¾ˆå¯èƒ½å¹¶ä¸ä¼šç«‹å³å…³é—­ SOCKETï¼Œæ‰€ä»¥åªèƒ½å…ˆå›å¤ä¸€ä¸ª ACK æŠ¥æ–‡ï¼Œå‘Šè¯‰ Client ç«¯ï¼Œâ€ä½ å‘çš„ FIN æŠ¥æ–‡æˆ‘æ”¶åˆ°äº†â€ã€‚åªæœ‰ç­‰åˆ°æˆ‘ Server ç«¯æ‰€æœ‰çš„æŠ¥æ–‡éƒ½å‘é€å®Œäº†ï¼Œæˆ‘æ‰èƒ½å‘é€ FIN æŠ¥æ–‡ï¼Œå› æ­¤ä¸èƒ½ä¸€èµ·å‘é€ã€‚æ•…éœ€è¦å››æ­¥æ¡æ‰‹ã€‚</p><h3 id="ä¸ºä»€ä¹ˆ-TIME-WAIT-çŠ¶æ€éœ€è¦ç»è¿‡-2MSL-maximum-segment-lifetimeï¼šæœ€å¤§æŠ¥æ–‡æ®µç”Ÿå­˜æ—¶é—´-æ‰èƒ½è¿”å›åˆ°-CLOSE-çŠ¶æ€"><a href="#ä¸ºä»€ä¹ˆ-TIME-WAIT-çŠ¶æ€éœ€è¦ç»è¿‡-2MSL-maximum-segment-lifetimeï¼šæœ€å¤§æŠ¥æ–‡æ®µç”Ÿå­˜æ—¶é—´-æ‰èƒ½è¿”å›åˆ°-CLOSE-çŠ¶æ€" class="headerlink" title="ä¸ºä»€ä¹ˆ TIME_WAIT çŠ¶æ€éœ€è¦ç»è¿‡ 2MSL(maximum segment lifetimeï¼šæœ€å¤§æŠ¥æ–‡æ®µç”Ÿå­˜æ—¶é—´)æ‰èƒ½è¿”å›åˆ° CLOSE çŠ¶æ€"></a>ä¸ºä»€ä¹ˆ TIME_WAIT çŠ¶æ€éœ€è¦ç»è¿‡ 2MSL(maximum segment lifetimeï¼šæœ€å¤§æŠ¥æ–‡æ®µç”Ÿå­˜æ—¶é—´)æ‰èƒ½è¿”å›åˆ° CLOSE çŠ¶æ€</h3><ol><li><p>å¯é åœ°å®ç° TCP å…¨åŒå·¥è¿æ¥çš„ç»ˆæ­¢<br> åœ¨è¿›è¡Œå…³é—­è¿æ¥å››è·¯æ¡æ‰‹åè®®æ—¶ï¼Œæœ€åçš„ ACK æ˜¯ç”±ä¸»åŠ¨å…³é—­ç«¯å‘å‡ºçš„ï¼Œå¦‚æœè¿™ä¸ªæœ€ç»ˆçš„ ACK ä¸¢å¤±ï¼ŒæœåŠ¡å™¨å°†é‡å‘æœ€ç»ˆçš„ FINï¼Œå› æ­¤å®¢æˆ·ç«¯å¿…é¡»ç»´æŠ¤çŠ¶æ€ä¿¡æ¯å…è®¸å®ƒé‡å‘æœ€ç»ˆçš„ ACKã€‚å¦‚æœä¸ç»´æŒè¿™ä¸ªçŠ¶æ€ä¿¡æ¯ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯å°†å“åº” RST åˆ†èŠ‚ï¼ŒæœåŠ¡å™¨å°†æ­¤åˆ†èŠ‚è§£é‡Šæˆä¸€ä¸ªé”™è¯¯ï¼ˆåœ¨ java ä¸­ä¼šæŠ›å‡º connection reset çš„ SocketException)ã€‚å› è€Œï¼Œè¦å®ç° TCP å…¨åŒå·¥è¿æ¥çš„æ­£å¸¸ç»ˆæ­¢ï¼Œå¿…é¡»å¤„ç†ç»ˆæ­¢åºåˆ—å››ä¸ªåˆ†èŠ‚ä¸­ä»»ä½•ä¸€ä¸ªåˆ†èŠ‚çš„ä¸¢å¤±æƒ…å†µï¼Œä¸»åŠ¨å…³é—­çš„å®¢æˆ·ç«¯å¿…é¡»ç»´æŒçŠ¶æ€ä¿¡æ¯è¿›å…¥ TIME_WAIT çŠ¶æ€ã€‚</p></li><li><p>å…è®¸è€çš„é‡å¤åˆ†èŠ‚åœ¨ç½‘ç»œä¸­æ¶ˆé€<br> TCP åˆ†èŠ‚å¯èƒ½ç”±äºè·¯ç”±å™¨å¼‚å¸¸è€Œâ€œè¿·é€”â€ï¼Œåœ¨è¿·é€”æœŸé—´ï¼ŒTCP å‘é€ç«¯å¯èƒ½å› ç¡®è®¤è¶…æ—¶è€Œé‡å‘è¿™ä¸ªåˆ†èŠ‚ï¼Œè¿·é€”çš„åˆ†èŠ‚åœ¨è·¯ç”±å™¨ä¿®å¤åä¹Ÿä¼šè¢«é€åˆ°æœ€ç»ˆç›®çš„åœ°ï¼Œè¿™ä¸ªåŸæ¥çš„è¿·é€”åˆ†èŠ‚å°±ç§°ä¸º lost duplicateã€‚åœ¨å…³é—­ä¸€ä¸ª TCP è¿æ¥åï¼Œé©¬ä¸Šåˆé‡æ–°å»ºç«‹èµ·ä¸€ä¸ªç›¸åŒçš„ IP åœ°å€å’Œç«¯å£ä¹‹é—´çš„ TCP è¿æ¥ï¼Œåä¸€ä¸ªè¿æ¥è¢«ç§°ä¸ºå‰ä¸€ä¸ªè¿æ¥çš„åŒ–èº« ï¼ˆincarnation)ï¼Œé‚£ä¹ˆæœ‰å¯èƒ½å‡ºç°è¿™ç§æƒ…å†µï¼Œå‰ä¸€ä¸ªè¿æ¥çš„è¿·é€”é‡å¤åˆ†ç»„åœ¨å‰ä¸€ä¸ªè¿æ¥ç»ˆæ­¢åå‡ºç°ï¼Œä»è€Œè¢«è¯¯è§£æˆä»å±äºæ–°çš„åŒ–èº«ã€‚ä¸ºäº†é¿å…è¿™ä¸ªæƒ…å†µï¼ŒTCP ä¸å…è®¸å¤„äº TIME_WAIT çŠ¶æ€çš„è¿æ¥å¯åŠ¨ä¸€ä¸ªæ–°çš„åŒ–èº«ï¼Œå› ä¸º TIME_WAIT çŠ¶æ€æŒç»­ 2MSLï¼Œå°±å¯ä»¥ä¿è¯å½“æˆåŠŸå»ºç«‹ä¸€ä¸ª TCP è¿æ¥çš„æ—¶å€™ï¼Œæ¥è‡ªè¿æ¥å…ˆå‰åŒ–èº«çš„é‡å¤åˆ†ç»„å·²ç»åœ¨ç½‘ç»œä¸­æ¶ˆé€ã€‚</p></li></ol><p><a href="https://blog.csdn.net/unix21/article/details/16918307">ä¸ºä»€ä¹ˆ TCP çš„ TIME_WAIT çŠ¶æ€è¦ä¿æŒ 2MSL?</a><br><a href="http://docs.52im.net/extend/docs/book/tcpip/vol1/18/">18.6.1 2MSL ç­‰å¾…çŠ¶æ€</a>â€¨â€¨â€¨</p><h3 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h3><ul><li><a href="http://people.na.infn.it/~garufi/didattica/CorsoAcq/Trasp/Lezione9/tcpip_ill/tcp_conn.htm">TCP Connection Establishment and Termination</a></li><li><a href="https://www.inetdaemon.com/tutorials/internet/tcp/index.shtml">Transmission Control Protocol (TCP) Tutorials</a></li><li><a href="https://github.com/jawil/blog/issues/14">é€šä¿—å¤§ç™½è¯æ¥ç†è§£ TCP åè®®çš„ä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡åˆ†æ‰‹</a></li><li><a href="http://blog.csdn.net/oney139/article/details/8103223">TCP ä¸‰æ¬¡æ¡æ‰‹è¯¦è§£åŠé‡Šæ”¾è¿æ¥è¿‡ç¨‹</a></li><li><a href="https://www.jellythink.com/archives/240">ç®€æ TCP çš„ä¸‰æ¬¡æ¡æ‰‹ä¸å››æ¬¡åˆ†æ‰‹</a></li><li><a href="https://www.cnblogs.com/zhanglei93/p/6574714.html">TCP åè®®è®¾è®¡åŸç†</a></li><li><a href="http://blog.csdn.net/whuslei/article/details/6667471">TCP åè®®ä¸­çš„ä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹(å›¾è§£)</a></li><li><a href="https://www.cnblogs.com/yuilin/archive/2012/11/05/2755298.html">ç†è§£ TCP ä¸ºä»€ä¹ˆéœ€è¦è¿›è¡Œä¸‰æ¬¡æ¡æ‰‹(ç™½è¯)</a></li><li><a href="https://www.zhihu.com/question/24853633">TCP ä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œä¸ºä»€ä¹ˆä¸æ˜¯ä¸¤æ¬¡æˆ–å››æ¬¡ï¼Ÿ</a></li><li><a href="https://juejin.im/post/58e36d35b123db15eb748856">é¢è¯•æ—¶ï¼Œä½ è¢«é—®åˆ°è¿‡ TCP/IP åè®®å—?</a></li><li><a href="https://hit-alibaba.github.io/interview/basic/network/TCP.html">TCP åè®®</a></li><li><a href="http://www.cnblogs.com/hnrainll/archive/2011/10/14/2212415.html">TCP ä¸‰æ¬¡æ¡æ‰‹åŠå››æ¬¡æŒ¥æ‰‹è¯¦ç»†å›¾è§£</a></li><li><a href="http://www.cnblogs.com/rootq/articles/1377355.html">TCP åè®®ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹åˆ†æ</a></li><li><a href="http://baike.baidu.com/subview/32754/8048820.htm">ç™¾åº¦ç™¾ç§‘ï¼šSYN æ”»å‡»</a></li><li><a href="http://www.tldp.org/HOWTO/html_single/TCP-Keepalive-HOWTO/">TCP-Keepalive-HOWTO</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ è®°å½• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç½‘ç»œ </tag>
            
            <tag> TCP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸ºä»€ä¹ˆ Redis è¿™ä¹ˆå¿«ï¼Ÿ</title>
      <link href="blog/2019-09-19/why-redis-is-so-fast/"/>
      <url>blog/2019-09-19/why-redis-is-so-fast/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h2 id="å¤ªé•¿ä¸çœ‹ç‰ˆ"><a href="#å¤ªé•¿ä¸çœ‹ç‰ˆ" class="headerlink" title="å¤ªé•¿ä¸çœ‹ç‰ˆ"></a>å¤ªé•¿ä¸çœ‹ç‰ˆ</h2><ol><li><p>Redis æ˜¯åŸºäºå†…å­˜çš„è®¿é—®ï¼Œå†…å­˜çš„è¯»å†™é€Ÿåº¦éå¸¸å¿«ï¼›</p></li><li><p>Redis æ˜¯å•çº¿ç¨‹çš„æ¨¡å‹ã€‚ä¿è¯äº†æ¯ä¸ªæ“ä½œçš„åŸå­æ€§ï¼Œçœå»äº†å¾ˆå¤šä¸Šä¸‹æ–‡åˆ‡æ¢çº¿ç¨‹çš„æ—¶é—´ä»¥åŠç«æ€è€Œäº§ç”Ÿçš„æ¶ˆè€—ï¼›</p></li><li><p>Redis ä½¿ç”¨å¤šè·¯å¤ç”¨æŠ€æœ¯ï¼Œå¯ä»¥å¤„ç†å¹¶å‘çš„è¿æ¥ã€‚éé˜»å¡ IO å†…éƒ¨å®ç°é‡‡ç”¨ epollï¼Œé‡‡ç”¨äº† epoll+è‡ªå·±å®ç°çš„ç®€å•çš„äº‹ä»¶è½®è¯¢ï¼ˆevent loopï¼‰æ¡†æ¶ã€‚epoll ä¸­çš„è¯»ã€å†™ã€å…³é—­ã€è¿æ¥éƒ½è½¬åŒ–æˆäº†äº‹ä»¶ï¼Œç„¶ååˆ©ç”¨ epoll çš„å¤šè·¯å¤ç”¨ç‰¹æ€§ï¼Œç»ä¸åœ¨ io ä¸Šæµªè´¹ä¸€ç‚¹æ—¶é—´ã€‚</p></li><li><p>æ•°æ®ç»“æ„ã€‚Redis å…¨ç¨‹ä½¿ç”¨ hash ç»“æ„ï¼Œè¯»å–é€Ÿåº¦å¿«ï¼Œè¿˜æœ‰ä¸€äº›ç‰¹æ®Šçš„æ•°æ®ç»“æ„ï¼Œå¯¹æ•°æ®å­˜å‚¨è¿›è¡Œäº†ä¼˜åŒ–ï¼Œå¦‚å‹ç¼©è¡¨ï¼Œå¯¹çŸ­æ•°æ®è¿›è¡Œå‹ç¼©å­˜å‚¨ï¼Œå†å¦‚ï¼Œè·³è¡¨ï¼Œä½¿ç”¨æœ‰åºçš„æ•°æ®ç»“æ„åŠ å¿«è¯»å–çš„é€Ÿåº¦ã€‚</p></li></ol><h2 id="ä¸ºä»€ä¹ˆ-Redis-ä½¿ç”¨å•çº¿ç¨‹"><a href="#ä¸ºä»€ä¹ˆ-Redis-ä½¿ç”¨å•çº¿ç¨‹" class="headerlink" title="ä¸ºä»€ä¹ˆ Redis ä½¿ç”¨å•çº¿ç¨‹"></a>ä¸ºä»€ä¹ˆ Redis ä½¿ç”¨å•çº¿ç¨‹</h2><p>å› ä¸º Redis æ˜¯åŸºäºå†…å­˜çš„æ“ä½œï¼ŒCPU ä¸æ˜¯ Redis çš„ç“¶é¢ˆï¼ŒRedis çš„ç“¶é¢ˆæœ€æœ‰å¯èƒ½æ˜¯æœºå™¨å†…å­˜çš„å¤§å°æˆ–è€…ç½‘ç»œå¸¦å®½ã€‚æ—¢ç„¶å•çº¿ç¨‹å®¹æ˜“å®ç°ï¼Œè€Œä¸” CPU ä¸ä¼šæˆä¸ºç“¶é¢ˆï¼Œé‚£å°±é¡ºç†æˆç« åœ°é‡‡ç”¨å•çº¿ç¨‹çš„æ–¹æ¡ˆã€‚</p><h3 id="è¯¦ç»†åŸå› "><a href="#è¯¦ç»†åŸå› " class="headerlink" title="è¯¦ç»†åŸå› "></a>è¯¦ç»†åŸå› </h3><ol><li><p>ä¸éœ€è¦å„ç§é”çš„æ€§èƒ½æ¶ˆè€—</p><p> Redis çš„æ•°æ®ç»“æ„å¹¶ä¸å…¨æ˜¯ç®€å•çš„ Key-Valueï¼Œè¿˜æœ‰ listï¼Œhash ç­‰å¤æ‚çš„ç»“æ„ï¼Œè¿™äº›ç»“æ„æœ‰å¯èƒ½ä¼šè¿›è¡Œå¾ˆç»†ç²’åº¦çš„æ“ä½œï¼Œæ¯”å¦‚åœ¨å¾ˆé•¿çš„åˆ—è¡¨åé¢æ·»åŠ ä¸€ä¸ªå…ƒç´ ï¼Œåœ¨ hash å½“ä¸­æ·»åŠ æˆ–è€…åˆ é™¤</p><p> ä¸€ä¸ªå¯¹è±¡ã€‚è¿™äº›æ“ä½œå¯èƒ½å°±éœ€è¦åŠ éå¸¸å¤šçš„é”ï¼Œå¯¼è‡´çš„ç»“æœæ˜¯åŒæ­¥å¼€é”€å¤§å¤§å¢åŠ ã€‚</p><p> æ€»ä¹‹ï¼Œåœ¨å•çº¿ç¨‹çš„æƒ…å†µä¸‹ï¼Œå°±ä¸ç”¨å»è€ƒè™‘å„ç§é”çš„é—®é¢˜ï¼Œä¸å­˜åœ¨åŠ é”é‡Šæ”¾é”æ“ä½œï¼Œæ²¡æœ‰å› ä¸ºå¯èƒ½å‡ºç°æ­»é”è€Œå¯¼è‡´çš„æ€§èƒ½æ¶ˆè€—ã€‚</p></li><li><p>å•çº¿ç¨‹å¤šè¿›ç¨‹é›†ç¾¤æ–¹æ¡ˆ</p><p> å•çº¿ç¨‹çš„å¨åŠ›å®é™…ä¸Šéå¸¸å¼ºå¤§ï¼Œæ¯æ ¸å¿ƒæ•ˆç‡ä¹Ÿéå¸¸é«˜ï¼Œå¤šçº¿ç¨‹è‡ªç„¶æ˜¯å¯ä»¥æ¯”å•çº¿ç¨‹æœ‰æ›´é«˜çš„æ€§èƒ½ä¸Šé™ï¼Œä½†æ˜¯åœ¨ä»Šå¤©çš„è®¡ç®—ç¯å¢ƒä¸­ï¼Œå³ä½¿æ˜¯å•æœºå¤šçº¿ç¨‹çš„ä¸Šé™ä¹Ÿå¾€å¾€ä¸èƒ½æ»¡è¶³éœ€è¦äº†ï¼Œéœ€è¦è¿›ä¸€æ­¥æ‘¸ç´¢çš„æ˜¯å¤šæœåŠ¡å™¨é›†ç¾¤åŒ–çš„æ–¹æ¡ˆï¼Œè¿™äº›æ–¹æ¡ˆä¸­å¤šçº¿ç¨‹çš„æŠ€æœ¯ç…§æ ·æ˜¯ç”¨ä¸ä¸Šçš„ã€‚</p><p> æ‰€ä»¥å•çº¿ç¨‹ã€å¤šè¿›ç¨‹çš„é›†ç¾¤ä¸å¤±ä¸ºä¸€ä¸ªæ—¶é«¦çš„è§£å†³æ–¹æ¡ˆã€‚</p></li><li><p>CPU æ¶ˆè€—</p><p> é‡‡ç”¨å•çº¿ç¨‹ï¼Œé¿å…äº†ä¸å¿…è¦çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œç«äº‰æ¡ä»¶ï¼Œä¹Ÿä¸å­˜åœ¨å¤šè¿›ç¨‹æˆ–è€…å¤šçº¿ç¨‹å¯¼è‡´çš„åˆ‡æ¢è€Œæ¶ˆè€— CPUã€‚</p></li></ol><h2 id="ä½†æ˜¯å¦‚æœ-CPU-æˆä¸º-Redis-ç“¶é¢ˆï¼Œæˆ–è€…ä¸æƒ³è®©æœåŠ¡å™¨å…¶ä»–-CUP-æ ¸é—²ç½®ï¼Œé‚£æ€ä¹ˆåŠ"><a href="#ä½†æ˜¯å¦‚æœ-CPU-æˆä¸º-Redis-ç“¶é¢ˆï¼Œæˆ–è€…ä¸æƒ³è®©æœåŠ¡å™¨å…¶ä»–-CUP-æ ¸é—²ç½®ï¼Œé‚£æ€ä¹ˆåŠ" class="headerlink" title="ä½†æ˜¯å¦‚æœ CPU æˆä¸º Redis ç“¶é¢ˆï¼Œæˆ–è€…ä¸æƒ³è®©æœåŠ¡å™¨å…¶ä»– CUP æ ¸é—²ç½®ï¼Œé‚£æ€ä¹ˆåŠ"></a>ä½†æ˜¯å¦‚æœ CPU æˆä¸º Redis ç“¶é¢ˆï¼Œæˆ–è€…ä¸æƒ³è®©æœåŠ¡å™¨å…¶ä»– CUP æ ¸é—²ç½®ï¼Œé‚£æ€ä¹ˆåŠ</h2><p>å¯ä»¥è€ƒè™‘å¤šèµ·å‡ ä¸ª Redis è¿›ç¨‹ï¼ŒRedis æ˜¯ key-value æ•°æ®åº“ï¼Œä¸æ˜¯å…³ç³»æ•°æ®åº“ï¼Œæ•°æ®ä¹‹é—´æ²¡æœ‰çº¦æŸã€‚åªè¦å®¢æˆ·ç«¯åˆ†æ¸…å“ªäº› key æ”¾åœ¨å“ªä¸ª Redis è¿›ç¨‹ä¸Šå°±å¯ä»¥äº†ã€‚</p><h2 id="Redis-å•çº¿ç¨‹çš„ä¼˜åŠ£åŠ¿"><a href="#Redis-å•çº¿ç¨‹çš„ä¼˜åŠ£åŠ¿" class="headerlink" title="Redis å•çº¿ç¨‹çš„ä¼˜åŠ£åŠ¿"></a>Redis å•çº¿ç¨‹çš„ä¼˜åŠ£åŠ¿</h2><ol><li><p>å•è¿›ç¨‹å•çº¿ç¨‹ä¼˜åŠ¿</p><ul><li>ä»£ç æ›´æ¸…æ™°ï¼Œå¤„ç†é€»è¾‘æ›´ç®€å•ï¼›</li><li>ä¸ç”¨å»è€ƒè™‘å„ç§é”çš„é—®é¢˜ï¼Œä¸å­˜åœ¨åŠ é”é‡Šæ”¾é”æ“ä½œï¼Œæ²¡æœ‰å› ä¸ºå¯èƒ½å‡ºç°æ­»é”è€Œå¯¼è‡´çš„æ€§èƒ½æ¶ˆè€—ï¼›</li><li>ä¸å­˜åœ¨å¤šè¿›ç¨‹æˆ–è€…å¤šçº¿ç¨‹å¯¼è‡´çš„åˆ‡æ¢è€Œæ¶ˆè€— CPUï¼› </li></ul></li><li><p>å•è¿›ç¨‹å•çº¿ç¨‹å¼Šç«¯<br> æ— æ³•å‘æŒ¥å¤šæ ¸ CPU æ€§èƒ½ï¼Œä¸è¿‡å¯ä»¥é€šè¿‡åœ¨å•æœºå¼€å¤šä¸ª Redis å®ä¾‹æ¥å®Œå–„ï¼›</p></li></ol><h2 id="IO-å¤šè·¯å¤ç”¨æŠ€æœ¯"><a href="#IO-å¤šè·¯å¤ç”¨æŠ€æœ¯" class="headerlink" title="IO å¤šè·¯å¤ç”¨æŠ€æœ¯"></a>IO å¤šè·¯å¤ç”¨æŠ€æœ¯</h2><p>Redis é‡‡ç”¨ç½‘ç»œ IO å¤šè·¯å¤ç”¨æŠ€æœ¯æ¥ä¿è¯åœ¨å¤šè¿æ¥çš„æ—¶å€™ï¼Œç³»ç»Ÿçš„é«˜ååé‡ã€‚</p><p>è¿™é‡Œâ€œå¤šè·¯â€æŒ‡çš„æ˜¯å¤šä¸ªç½‘ç»œè¿æ¥ï¼Œâ€œå¤ç”¨â€æŒ‡çš„æ˜¯å¤ç”¨åŒä¸€ä¸ªçº¿ç¨‹ã€‚é‡‡ç”¨å¤šè·¯ I/O å¤ç”¨æŠ€æœ¯å¯ä»¥è®©å•ä¸ªçº¿ç¨‹é«˜æ•ˆçš„å¤„ç†å¤šä¸ªè¿æ¥è¯·æ±‚ï¼ˆå°½é‡å‡å°‘ç½‘ç»œ IO çš„æ—¶é—´æ¶ˆè€—ï¼‰ï¼Œä¸” Redis åœ¨å†…å­˜ä¸­æ“ä½œæ•°æ®çš„é€Ÿåº¦éå¸¸å¿«ï¼ˆå†…å­˜å†…çš„æ“ä½œä¸ä¼šæˆä¸ºè¿™é‡Œçš„æ€§èƒ½ç“¶é¢ˆï¼‰ï¼Œä¸»è¦ä»¥ä¸Šä¸¤ç‚¹é€ å°±äº† Redis å…·æœ‰å¾ˆé«˜çš„ååé‡ã€‚</p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><ul><li><a href="https://blog.csdn.net/u011663149/article/details/85307615">Redis ä¸ºä»€ä¹ˆæ˜¯å•çº¿ç¨‹ã€åŠé«˜å¹¶å‘å¿«çš„å¤§åŸå› è¯¦è§£</a></li><li><a href="https://www.jianshu.com/p/3d54131ee94c">Redis ä¸ºä»€ä¹ˆå¿«ï¼Ÿ</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> æ•°æ®åº“ </tag>
            
            <tag> Redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æˆ‘çš„åšå®¢ idealyard å¾…åŠäº‹é¡¹è®°å½•</title>
      <link href="blog/2019-08-29/blog-idealyard-TODO/"/>
      <url>blog/2019-08-29/blog-idealyard-TODO/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h2 id="BUGs-è®°å½•"><a href="#BUGs-è®°å½•" class="headerlink" title="BUGs è®°å½•"></a>BUGs è®°å½•</h2><h3 id="å‰ç«¯"><a href="#å‰ç«¯" class="headerlink" title="å‰ç«¯"></a>å‰ç«¯</h3><ul><li style="list-style: none"><input type="checkbox" checked></input> æ–°å»ºæ–‡ç« æŠ¥é”™ï¼›</li><li style="list-style: none"><input type="checkbox" checked></input> é¦–é¡µæ— é™æ»šåŠ¨æ—¶æç¤º<code>Duplicate keys detected: &#39;xxxx&#39;. This may cause an update error.</code></li><li style="list-style: none"><input type="checkbox" checked></input> ç”¨æˆ·æ³¨å†Œé¡µé¢ï¼›<ul><li style="list-style: none"><input type="checkbox" checked></input> ç”¨æˆ·æ³¨å†ŒæˆåŠŸï¼Œä½†æ˜¯è·³è½¬é¦–é¡µä¹‹åæ˜¾ç¤ºé—®é¢˜ï¼›</li></ul></li><li style="list-style: none"><input type="checkbox" checked></input> ç”¨æˆ·å†™æ–‡ç« æ—¶ï¼Œä½œè€…ä¸æ˜¯å½“å‰ç™»å½•ç”¨æˆ·ï¼›</li><li style="list-style: none"><input type="checkbox" checked></input> ç‚¹å‡»é¡µå†…é”šç‚¹ï¼Œè·³è½¬åˆ°æ–‡ç« åˆ†ç±»é¡µé¢ï¼Œåº”è¯¥åœ¨æœ¬é¡µé¢å†…è·³è½¬ï¼›</li><li style="list-style: none"><input type="checkbox" checked></input> cookie ä¸­å¯†ç æ²¡æœ‰åŠ å¯†ï¼›<br>è§£å†³åŠæ³•<a href="https://www.cnblogs.com/xiaolucky/p/11165179.html">å‚è€ƒè¿™é‡Œ</a></li><li style="list-style: none"><input type="checkbox" checked></input> token è¶…æ—¶æ—¶å¼¹å‡ºå¾ˆå¤š message,åº”è¯¥ä½¿ç”¨æ›´å‹å¥½çš„æ–¹å¼ï¼æˆ–è€…ç²¾å‡†æç¤ºï¼Œä¸€æ¬¡åªæç¤ºä¸€æ¡å³å¯ï¼›<br>  è§£å†³åŠæ³•ï¼š<a href="https://segmentfault.com/a/1190000020173021">å¦‚ä½•è®© Element UI çš„ Message æ¶ˆæ¯æç¤ºæ¯æ¬¡åªå¼¹å‡ºä¸€ä¸ª</a></li><li style="list-style: none"><input type="checkbox" checked></input> æ ‡ç­¾äº‘  <ol><li><del>å‚è€ƒ<a href="https://github.com/MikeCoder/hexo-tag-cloud">è¿™é‡Œ</a></del></li><li><a href="https://juejin.im/post/5c99a0f7e51d454e9b3c3343">è¿™é‡Œ</a></li><li><del><a href="https://github.com/nobalmohan/vue-tag-cloud">è¿™é‡Œ</a></del><br>æœ€ç»ˆå‚è€ƒ<a href="https://github.com/SeregPie/VueWordCloud">VueWordCloud</a> å®ç°ï¼›</li></ol></li><li style="list-style: none"><input type="checkbox" checked></input> è®°ä½å¯†ç ï¼›</li><li style="list-style: none"><input type="checkbox" checked></input> æ ‡ç­¾ã€åˆ†ç±»é¡µé¢ï¼Œitem æ•°é‡ä¸º 0 æ—¶ï¼Œç‚¹å‡»äº‹ä»¶ disableï¼›</li><li><p>[x] æ‰¾å›å¯†ç ï¼›</p><ul><li style="list-style: none"><input type="checkbox" checked></input> å‰ç«¯å¼‚å¸¸å¤„ç†ï¼›</li></ul></li><li><p>[x] ç›˜å¤ä¹‹ç™½</p><blockquote><p>æœ‰ç ”ç©¶æ˜¾ç¤ºï¼Œæ‰“å­—çš„æ—¶å€™ä¸å–œæ¬¢åœ¨ä¸­æ–‡å’Œè‹±æ–‡ä¹‹é—´åŠ ç©ºæ ¼çš„äººï¼Œæ„Ÿæƒ…è·¯éƒ½èµ°å¾—å¾ˆè¾›è‹¦ï¼Œæœ‰ä¸ƒæˆçš„æ¯”ä¾‹ä¼šåœ¨ 34 å²çš„æ—¶å€™è·Ÿè‡ªå·±ä¸çˆ±çš„äººç»“å©šï¼Œè€Œå…¶é¤˜ä¸‰æˆçš„äººæœ€ååªèƒ½æŠŠé—ç”¢ç•™ç»™è‡ªå·±çš„çŒ«ã€‚æ¯•ç«Ÿçˆ±æƒ…è·Ÿä¹¦å†™éƒ½éœ€è¦é€‚æ—¶åœ°ç•™ç™½ã€‚<br><a href="https://github.com/sparanoid/chinese-copywriting-guidelines">ä¸­æ–‡æ–‡æ¡ˆæ’ç‰ˆæŒ‡åŒ—</a></p><ol><li><a href="https://github.com/hustcc/hint">python ç‰ˆæœ¬</a></li><li><a href="https://github.com/hjiang/scripts/blob/master/add-space-between-latin-and-cjk">python ç‰ˆæœ¬</a></li><li><a href="https://github.com/hustcc/lint-md/tree/master/packages/lint-md">JS ç‰ˆæœ¬</a></li></ol></blockquote></li><li style="list-style: none"><input type="checkbox" checked></input> é¦–é¡µæ‘˜è¦ä¿¡æ¯è·å–é”™è¯¯</li><li style="list-style: none"><input type="checkbox" checked></input> æ¦‚è§ˆé¡µï¼ˆindexï¼‰æ˜¾ç¤º</li><li style="list-style: none"><input type="checkbox" checked></input> æ›´æ–°æ–‡ç« ï¼Œå¯¹åŸæœ‰æ ‡ç­¾åˆ é™¤æ—¶ï¼Œä¸æˆåŠŸï¼Œä½†æ–°åŠ æ­£å¸¸</li><li style="list-style: none"><input type="checkbox" checked></input> é¦–é¡µç‚¹å‡»æŸ¥çœ‹å…¨éƒ¨è¿›å…¥ç©ºç™½é¡µ</li><li style="list-style: none"><input type="checkbox" checked></input> ç¼–è¾‘æ–‡ç« æ—¶å·²ç»å­˜åœ¨çš„æ ‡ç­¾ä¼šäºŒæ¬¡æ·»åŠ ï¼ˆæŸ¥è¯¢ä¸­é—´è¡¨å¯ä»¥çœ‹åˆ°å†™äº†ä¸¤æ¬¡ï¼ï¼‰<br>  <del>1. æ–°å»ºæ ‡ç­¾å¤±è´¥</del><br>  <del>2. æ ‡é¢˜æ— æ³•ä¿®æ”¹ï¼ˆç›®å‰æœ‰è¯¥å…¥å£ï¼Œæ­£å¸¸æ¥è¯´åº”è¯¥æ˜¯å¯ä»¥æ›´æ–°çš„&lt;é™¤éä»£ç æ²¡æœ‰è¿™å—é€»è¾‘ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™ä¸æ·»åŠ ï¼Œæ–‡ç« æ–°å»ºä¹‹åå°±ä¸è¦æ”¹å˜é“¾æ¥äº†&gt;ï¼‰</del></li><li style="list-style: none"><input type="checkbox" checked></input> æ–‡ç« è¯¦æƒ…é¡µ header ä¸‹åˆ’çº¿æ˜¾ç¤ºå¼‚å¸¸</li></ul><h3 id="åç«¯"><a href="#åç«¯" class="headerlink" title="åç«¯"></a>åç«¯</h3><ul><li style="list-style: none"><input type="checkbox" checked></input> æ•°æ®åº“è¿ç§»æŠ¥é”™  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">werkzeug.utils.ImportStringError: import_string() failed for &#39;mains.bp&#39;. Possible reasons are:</span><br><span class="line"></span><br><span class="line">- missing __init__.py in a package;</span><br><span class="line">- package or module path not included in sys.path;</span><br><span class="line">- duplicated package or module name taking precedence in sys.path;</span><br><span class="line">- missing module, class, function or variable;</span><br><span class="line"></span><br><span class="line">Debugged import:</span><br><span class="line"></span><br><span class="line">- &#39;mains&#39; not found.</span><br><span class="line"></span><br><span class="line">Original exception:</span><br><span class="line"></span><br><span class="line">ModuleNotFoundError: No module named &#39;mains&#39;</span><br></pre></td></tr></table></figure></li><li style="list-style: none"><input type="checkbox" checked></input> æœªæ³¨å†Œç”¨æˆ·ç™»å½•ï¼ˆå‡ç”¨æˆ·ï¼‰æ— æç¤ºï¼Œåå°æŠ¥é”™:  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">TypeError: unauthorized() takes 0 positional arguments but 1 was given</span><br></pre></td></tr></table></figure></li><li style="list-style: none"><input type="checkbox" checked></input> é¦–é¡µçƒ­é—¨æ ‡ç­¾åº”è¯¥æ˜¾ç¤ºæœ€çƒ­ï¼Œè€Œä¸æ˜¯å…¨éƒ¨</li><li style="list-style: none"><input type="checkbox" checked></input> é¦–é¡µç‚¹æ ‡ç­¾åç§°ï¼Œè¿›å»ä¹‹åçš„åç§° title ä¸å¯¹</li></ul><h2 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h2><h3 id="å·²å®Œæˆ"><a href="#å·²å®Œæˆ" class="headerlink" title="å·²å®Œæˆ"></a>å·²å®Œæˆ</h3><ul><li style="list-style: none"><input type="checkbox" checked></input> æ–‡ç« é˜…è¯»è®¡æ•°</li><li style="list-style: none"><input type="checkbox" checked></input> æ·»åŠ è·å–ç”¨æˆ·ä¿¡æ¯ API</li><li style="list-style: none"><input type="checkbox" checked></input> åšå®¢è‡ªå·±ä¿®æ”¹  <ul><li style="list-style: none"><input type="checkbox" checked></input> view é¡µé¢éœ€è¦ summary,å› ä¸ºåœ¨ç¼–è¾‘æ—¶ï¼Œæ‘˜è¦ä¸èƒ½æ¶ˆå¤±ï¼›  </li><li style="list-style: none"><input type="checkbox" checked></input> ç¼–è¾‘æ—¶éœ€è¦å¯¹æ–°çš„å’Œæ—§çš„æ ‡ç­¾å¯¹æ¯”ï¼Œæ­£å¸¸ä¸èµ° add é€»è¾‘ï¼›  </li><li style="list-style: none"><input type="checkbox" checked></input> ç¼–è¾‘æ—¶åº”è¯¥æ˜¯ post è¯·æ±‚ï¼Œå°†ç”¨æˆ·æäº¤çš„å…¨é‡æ›´æ–°ï¼Œæ²¡æœ‰çš„ç½®ç©ºï¼›</li></ul></li><li style="list-style: none"><input type="checkbox" checked></input> åšå®¢ä½œè€…è‡ªå·±åˆ é™¤</li><li style="list-style: none"><input type="checkbox" checked></input> slug é€‰é¡¹åœ¨æ›´æ–°æ–‡ç« æ—¶åº”è¯¥æ˜¯ä¸å¯è§çš„ï¼ˆurl ç¡®å®šä¹‹åä¸å¯ä¿®æ”¹ï¼ï¼‰</li><li style="list-style: none"><input type="checkbox" checked></input> é“¾æ¥ç”± id å˜æˆæ•°å­—å’Œ slug çš„ç»„åˆ</li><li style="list-style: none"><input type="checkbox" checked></input> æ‰¾å›å¯†ç <ul><li style="list-style: none"><input type="checkbox" checked></input> ç”Ÿæˆéšæœºå¯†ç ï¼Œç»™ç”¨æˆ·å‘é€æ˜æ–‡ï¼Œå¹¶æŠŠæ•°æ®åº“ä¸­æ•°æ®åŠ å¯†æ›´æ–°ä¿å­˜ï¼›</li><li style="list-style: none"><input type="checkbox" checked></input> ç”¨æˆ·è¾“å…¥ä¸€æ¬¡ä¹‹åè¿‡æœŸï¼›ï¼ˆRedisï¼Ÿ<del>Celery æ¸…é™¤ï¼Ÿ</del>ï¼‰</li><li style="list-style: none"><input type="checkbox" checked></input> é€šè¿‡åˆ™è®¾ç½®å¯†ç ï¼Œå¦åˆ™é‡æ–°å‘é€å¹¶é‡æ–°è®¾ç½®å¯†ç ï¼›</li></ul></li></ul><h3 id="å¾…å®Œæˆ"><a href="#å¾…å®Œæˆ" class="headerlink" title="å¾…å®Œæˆ"></a>å¾…å®Œæˆ</h3><ul><li style="list-style: none"><input type="checkbox" checked></input> <del>è®¿é—®å·²åˆ é™¤æ–‡ç« æ—¶ï¼Œä¸ä¼šè·³è½¬åˆ°é¦–é¡µï¼</del><ul><li style="list-style: none"><input type="checkbox"></input> ç›®å‰å¯ä»¥è·³è½¬ï¼Œä½†æ˜¯ç”±äº abort() å‡½æ•°ï¼Œå¯¼è‡´ä¼šæœ‰æŠ¥é”™é—ªç°ã€‚</li></ul></li><li style="list-style: none"><input type="checkbox"></input> ç”¨æˆ·é‚®ç®±éªŒè¯ï¼Œå¦‚æœæ²¡æœ‰éªŒè¯ï¼Œåˆ™åœ¨é¦–é¡µæç¤ºç”¨æˆ·å»éªŒè¯ï¼Œå®ŒæˆéªŒè¯ä¹‹åæ‰å¯ä»¥å†™æ–‡ç« ï¼›å¦åˆ™ç™»å½•ä¹Ÿæ— æ³•è¿›è¡Œæœ‰æ•ˆæ“ä½œã€‚<ul><li style="list-style: none"><input type="checkbox" checked></input> æ¶ˆæ¯æç¤ºå·²å®Œæˆï¼›</li><li style="list-style: none"><input type="checkbox"></input> éœ€è¦å®Œæˆæ¿€æ´»é‚®ç®±ï¼›</li></ul></li><li style="list-style: none"><input type="checkbox"></input> ä½¿ç”¨ swagger ç”Ÿæˆ Flask RESTful<br>å‚è€ƒ<a href="https://segmentfault.com/a/1190000010144742">ä½¿ç”¨ swagger ç”Ÿæˆ Flask RESTful API - å¤å¯ºæ¯”çš„å¯º - SegmentFault æ€å¦</a></li><li><p>[ ] <code>vendor</code>æ–‡ä»¶è¿‡å¤§ï¼Œå¯¼è‡´é¦–é¡µåˆ·æ–°æ—¶é—´è¿‡é•¿ï¼›</p><p>å‚è€ƒ 1. <a href="https://forum.vuejs.org/t/vue-cli-vendor-js/37246">è¿™é‡Œ</a>  2. <a href="https://segmentfault.com/q/1010000008832754">è¿™é‡Œ</a>  3. <a href="https://www.jianshu.com/p/e78c2210c410">è¿™é‡Œ</a></p></li><li style="list-style: none"><input type="checkbox"></input> ä½¿ç”¨<code>ç›˜å¤ä¹‹ç™½</code>ä¹‹åä¸èƒ½è¾“å…¥<code>emoji</code>è¡¨æƒ…ï¼›<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pymysql.err.InternalError: (1366, &quot;Incorrect string value: &#39;\\xF0\\x9F\\x98\\x98&lt;&#x2F;...&#39; for column &#39;content_html&#39; at row 1&quot;)</span><br></pre></td></tr></table></figure></li><li style="list-style: none"><input type="checkbox"></input> é“¾æ¥çš„ slug ä¸­ç›´æ¥æŠŠ emoji ä¹Ÿç»™æ˜¾ç¤ºå‡ºæ¥äº†ï¼Œæ­¤å¤„éœ€è¦å¯¹ emoji è¿›è¡Œè¿‡æ»¤æˆ–è€…è½¬æ¢ä¸ºå­—ç¬¦è¯´æ˜ã€‚<ol><li><a href="https://stackoverflow.com/questions/33404752/removing-emojis-from-a-string-in-python">removing emojis from a string in Python - Stack Overflow</a></li><li><a href="https://stackoverflow.com/questions/43797500/python-replace-unicode-emojis-with-ascii-characters/43813727#43813727">Python - replace unicode emojis with ASCII characters - Stack Overflow</a></li></ol></li><li style="list-style: none"><input type="checkbox"></input> éœ€è¦å¢åŠ ç”¨æˆ·è¯¦æƒ…é¡µï¼ˆabout?ï¼‰ï¼Œå¯ç¼–è¾‘ç”¨æˆ·ä¿¡æ¯ï¼›</li><li style="list-style: none"><input type="checkbox"></input> ä½¿<code>aside</code>ä¾§è¾¹æ å›ºå®šï¼Œä¸ä¼šéšé¼ æ ‡æ»šåŠ¨æ¶ˆå¤±ï¼›</li><li style="list-style: none"><input type="checkbox"></input> å‚è€ƒåšå®¢åç«¯ç®¡ç†ç³»ç»Ÿï¼›<ul><li><a href="https://github.com/uncleLian/vue-blog">åŸºäº vue å…¨å®¶æ¡¶ + element-ui æ„å»ºçš„ä¸€ä¸ªåå°ç®¡ç†é›†æˆè§£å†³æ–¹æ¡ˆ</a></li><li><a href="https://github.com/taylorchen709/vue-admin">vue-admin</a></li><li><a href="https://github.com/PanJiaChen/vue-element-admin">vue-element-admin</a></li></ul></li><li style="list-style: none"><input type="checkbox"></input> è‡ªé€‚åº”æ—¶ footer åªæœ‰åŠä¸ªï¼›</li><li style="list-style: none"><input type="checkbox"></input> æ—¶é—´çº¿æ— æ³•æ­£å¸¸æ˜¾ç¤ºï¼›</li><li style="list-style: none"><input type="checkbox"></input> ä½¿ç”¨<code>celery</code>å¤‡ä»½åšå®¢<ol><li>æ¯åˆ›å»ºä¸€ç¯‡æ–‡ç« ï¼›è‡ªåŠ¨ç”Ÿæˆ<code>xxxx.md</code>ç”¨äºé™æ€åšå®¢ï¼›</li><li>æ¯ä¸ªæœˆå¤‡ä»½æ•°æ®åº“ï¼›å°†æ•°æ®åº“é€šè¿‡é‚®ä»¶å‘é€åˆ°æœ¬äººé‚®ç®±ï¼›</li></ol></li><li style="list-style: none"><input type="checkbox" checked></input> å‘é€é‚®ä»¶æ”¹ä¸º<code>Celery</code>å¼‚æ­¥</li></ul><hr><p>ä¼˜å…ˆçº§ä¸­ç­‰</p><ul><li style="list-style: none"><input type="checkbox"></input> ç®¡ç†å‘˜è´¦æˆ·</li><li style="list-style: none"><input type="checkbox"></input> æ ‡ç­¾ç®¡ç†å‘˜æ‰‹åŠ¨æ·»åŠ </li><li style="list-style: none"><input type="checkbox"></input> åˆ†ç±»ç®¡ç†å‘˜æ‰‹åŠ¨æ·»åŠ </li><li style="list-style: none"><input type="checkbox"></input> i18nï¼ˆen&amp;zhï¼‰</li><li style="list-style: none"><input type="checkbox"></input> å‰ç«¯æ–‡ä»¶å¤ªå¤§<a href="https://www.dongwm.com/post/optimize-javascript/">ç»§ç»­ä¼˜åŒ–åšå®¢ Vue+Webpack ç”Ÿæˆçš„ Javascript æ–‡ä»¶ä½“ç§¯ - å°æ˜æ˜ s Ã  domicile</a></li></ul><hr><p>ä¼˜å…ˆçº§ä½</p><ul><li style="list-style: none"><input type="checkbox"></input> ç§»åŠ¨ç«¯è‡ªé€‚åº”</li></ul>]]></content>
      
      
      <categories>
          
          <category> Projects </category>
          
          <category> IdealYard </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flask </tag>
            
            <tag> TODO </tag>
            
            <tag> åšå®¢ </tag>
            
            <tag> å¼€æº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•ä½¿ç”¨ Gunicorn+Gevent+Supervisor+Nginx éƒ¨ç½² Flask åº”ç”¨</title>
      <link href="blog/2019-08-07/how-to-deploy-flask-with-nginx-gunicorn-gevent-supervisor/"/>
      <url>blog/2019-08-07/how-to-deploy-flask-with-nginx-gunicorn-gevent-supervisor/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h2 id="ç»„ä»¶ä»‹ç»"><a href="#ç»„ä»¶ä»‹ç»" class="headerlink" title="ç»„ä»¶ä»‹ç»"></a>ç»„ä»¶ä»‹ç»</h2><ol><li><p>Nginx: é«˜æ€§èƒ½<code>Web</code>æœåŠ¡å™¨ï¼Œè´Ÿè´£åå‘ä»£ç†ï¼›</p></li><li><p>gunicorn: ï¼ˆGreen Unicornï¼Œç»¿è‰²ç‹¬è§’å…½ï¼‰é«˜æ€§èƒ½ uWSGI æœåŠ¡å™¨ï¼›</p></li><li><p>gevent: å°†<code>Python</code>åŒæ­¥ä»£ç è½¬æ¢ä¸ºå¼‚æ­¥çš„åè®®åº“ï¼›</p></li><li><p>supervisor: ç›‘æ§æœåŠ¡æµç¨‹çš„å·¥å…·ï¼›</p></li></ol><h2 id="ç‰ˆæœ¬ä¿¡æ¯"><a href="#ç‰ˆæœ¬ä¿¡æ¯" class="headerlink" title="ç‰ˆæœ¬ä¿¡æ¯"></a>ç‰ˆæœ¬ä¿¡æ¯</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">-bash-4.2<span class="comment"># gunicorn --version</span></span><br><span class="line">gunicorn (version 19.9.0)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="å®‰è£…-gunicorn-å’Œ-gevent"><a href="#å®‰è£…-gunicorn-å’Œ-gevent" class="headerlink" title="å®‰è£… gunicorn å’Œ gevent"></a>å®‰è£… gunicorn å’Œ gevent</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip install gunicorn</span><br><span class="line">pip install gevent</span><br></pre></td></tr></table></figure><h2 id="é…ç½®-gunicorn"><a href="#é…ç½®-gunicorn" class="headerlink" title="é…ç½® gunicorn"></a>é…ç½® gunicorn</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># gun.py</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> gevent.monkey</span><br><span class="line"></span><br><span class="line">gevent.monkey.patch_all()</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> multiprocessing</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">&#x27;log&#x27;</span>):</span><br><span class="line">    os.mkdir(<span class="string">&#x27;log&#x27;</span>)</span><br><span class="line">debug = <span class="literal">True</span></span><br><span class="line">loglevel = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="comment"># ç»‘å®šçš„ipåŠç«¯å£å·</span></span><br><span class="line">bind = <span class="string">&#x27;0.0.0.0:5000&#x27;</span></span><br><span class="line">pidfile = <span class="string">&#x27;log/gunicorn.pid&#x27;</span></span><br><span class="line">logfile = <span class="string">&#x27;log/debug.log&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨çš„è¿›ç¨‹æ•°</span></span><br><span class="line">workers = multiprocessing.cpu_count() * <span class="number">2</span> + <span class="number">1</span></span><br><span class="line">worker_class = <span class="string">&#x27;gunicorn.workers.ggevent.GeventWorker&#x27;</span></span><br><span class="line"></span><br><span class="line">x_forwarded_for_header = <span class="string">&#x27;X-FORWARDED-FOR&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="å¯åŠ¨æœåŠ¡"><a href="#å¯åŠ¨æœåŠ¡" class="headerlink" title="å¯åŠ¨æœåŠ¡"></a>å¯åŠ¨æœåŠ¡</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">-bash-4.2<span class="comment"># gunicorn -k gevent -c gun.py runserver:app</span></span><br><span class="line">[2019-08-07 16:00:20 +0800] [32111] [DEBUG] Current configuration:</span><br><span class="line">  config: gun.py</span><br><span class="line">  <span class="built_in">bind</span>: [<span class="string">&#x27;0.0.0.0:5000&#x27;</span>]</span><br><span class="line">  backlog: 2048</span><br><span class="line">  workers: 3</span><br><span class="line">  worker_class: gevent</span><br><span class="line">  threads: 1</span><br><span class="line"><span class="comment"># â€¦â€¦â€¦â€¦ çœç•¥ä¸­é—´éƒ¨åˆ†</span></span><br><span class="line">  ciphers: TLSv1</span><br><span class="line">  raw_paste_global_conf: []</span><br><span class="line">[2019-08-07 16:00:20 +0800] [32111] [INFO] Starting gunicorn 19.9.0</span><br><span class="line">[2019-08-07 16:00:20 +0800] [32111] [DEBUG] Arbiter booted</span><br><span class="line">[2019-08-07 16:00:20 +0800] [32111] [INFO] Listening at: http://0.0.0.0:5000 (32111)</span><br><span class="line">[2019-08-07 16:00:20 +0800] [32111] [INFO] Using worker: gevent</span><br><span class="line">[2019-08-07 16:00:20 +0800] [32115] [INFO] Booting worker with pid: 32115</span><br><span class="line">[2019-08-07 16:00:20 +0800] [32116] [INFO] Booting worker with pid: 32116</span><br><span class="line">[2019-08-07 16:00:20 +0800] [32117] [INFO] Booting worker with pid: 32117</span><br><span class="line">[2019-08-07 16:00:20 +0800] [32111] [DEBUG] 3 workers</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ­¤æ—¶æ­£å¸¸è®¿é—®<code>http://10.10.15.111:5000/</code>åº”è¯¥å¯ä»¥çœ‹åˆ°é¦–é¡µä¿¡æ¯æç¤ºè¡¨ç¤ºè¿æ¥æœåŠ¡æ­£å¸¸ã€‚<br><strong>æ³¨æ„</strong>ï¼šæ­¤å¤„ ip å’Œç«¯å£å‡ç”±è‡ªå·±è®¾ç½®ï¼Œæ‰€ä»¥è®¿é—®æ—¶åº”è¯¥åšç›¸åº”è°ƒæ•´ã€‚<br>å¦‚æœæ— æ³•æ­£å¸¸è®¿é—®ï¼Œåˆ™éœ€è¦éªŒè¯é˜²ç«å¢™æ˜¯å¦æ­£å¸¸ï¼š  </p><ul><li>CentOS 7 ä»¥ä¸‹ç‰ˆæœ¬  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŸ¥è¯¢</span></span><br><span class="line">-bash-4.2<span class="comment"># iptables -nL|grep 5000</span></span><br><span class="line"><span class="comment"># å¼€æ”¾æŒ‡å®šç«¯å£</span></span><br><span class="line">-bash-4.2<span class="comment"># iptables -I INPUT -p tcp --dport 5000 -j ACCEPT</span></span><br><span class="line"><span class="comment"># å†æ¬¡æŸ¥è¯¢</span></span><br><span class="line">-bash-4.2<span class="comment"># iptables -nL|grep 5000</span></span><br><span class="line">ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0            tcp dpt:5000</span><br></pre></td></tr></table></figure></li><li>CentOS 7<br>ä½¿ç”¨<code>firewall-cmd</code>ç®¡ç†é˜²ç«å¢™ç«¯å£<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">firewall-cmd --query-port=5000/tcp      <span class="comment"># no</span></span><br><span class="line">firewall-cmd --add-port=5000/tcp --permanent</span><br><span class="line">firewall-cmd --reload</span><br><span class="line">firewall-cmd --query-port=5000/tcp  <span class="comment"># yes</span></span><br><span class="line">systemctl status firewall</span><br><span class="line">systemctl status firewalld</span><br><span class="line">systemctl restart firewalld</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…-nginx-å’Œ-supervisor"><a href="#å®‰è£…-nginx-å’Œ-supervisor" class="headerlink" title="å®‰è£… nginx å’Œ supervisor"></a>å®‰è£… nginx å’Œ supervisor</h2></li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum -y install nginx supervisor</span><br></pre></td></tr></table></figure><h3 id="é…ç½®-nginx"><a href="#é…ç½®-nginx" class="headerlink" title="é…ç½® nginx"></a>é…ç½® nginx</h3><p>é»˜è®¤å®‰è£…çš„ Nginx é…ç½®æ–‡ä»¶<code>/etc/nginx/nginx.conf</code>å†…æœ‰å¦‚ä¸‹é…ç½®</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">include /etc/nginx/conf.d/*.conf;</span><br></pre></td></tr></table></figure><p>å³ä»å¤–éƒ¨ç›®å½•<code>/etc/nginx/conf.d/</code>æ–‡ä»¶å¤¹ä¸‹è¿˜å¼•å…¥äº†å…¶ä»–é…ç½®æ–‡ä»¶ã€‚<br>è¿™æ ·ï¼Œæˆ‘ä»¬ä¸ä¿®æ”¹é»˜è®¤é…ç½®ï¼Œåªåœ¨<code>/etc/nginx/conf.d/</code>ç›®å½•ä¸‹å¢åŠ ä¸€ä¸ª<code>***.conf</code>ï¼Œæ¥åœ¨å¤–é¢å¢åŠ æ–°é…ç½®ã€‚</p><p>åœ¨<code>/etc/nginx/conf.d/</code>å¢åŠ <code>app.conf</code>ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen  80;     <span class="comment"># å¦‚æœ80ç«¯å£è¢«å ç”¨ï¼Œå¯ä»¥ä½¿ç”¨å…¶ä»–ç«¯å£ï¼Œè®°å¾—åœ¨é˜²ç«å¢™ä¸­æ‰“å¼€ç›¸åº”ç«¯å£</span></span><br><span class="line">    server_name localhost;</span><br><span class="line">    charset utf-8;Â </span><br><span class="line">    access_log /var/pmmt/access.log;</span><br><span class="line">    error_log /var/pmmt/error.log;</span><br><span class="line"></span><br><span class="line">    client_max_body_size 100M;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">            proxy_pass  http://0.0.0.0:5000;</span><br><span class="line">            proxy_http_version 1.1;</span><br><span class="line">            proxy_connect_timeout 300;</span><br><span class="line">            proxy_send_timeout 300;</span><br><span class="line">            proxy_read_timeout 300;</span><br><span class="line">            send_timeout 300;</span><br><span class="line">            proxy_set_header Upgrade <span class="variable">$http_upgrade</span>;</span><br><span class="line">            proxy_set_header Connection <span class="string">&quot;upgrade&quot;</span>;</span><br><span class="line">            proxy_set_header Host <span class="variable">$http_host</span>;</span><br><span class="line">            proxy_set_header X-Scheme <span class="variable">$scheme</span>;</span><br><span class="line">            proxy_set_header X-Forwarded-For <span class="variable">$remote_addr</span>;</span><br><span class="line">            proxy_set_header X-Forwarded-Port <span class="variable">$server_port</span>;</span><br><span class="line">            proxy_set_header X-Request-Start <span class="variable">$msec</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¯åŠ¨æœåŠ¡-1"><a href="#å¯åŠ¨æœåŠ¡-1" class="headerlink" title="å¯åŠ¨æœåŠ¡"></a>å¯åŠ¨æœåŠ¡</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">systemctl start nginx</span><br></pre></td></tr></table></figure><ul><li>æŠ¥é”™<code>nginx: [emerg] getpwnam(&quot;nginx&quot;) failed in /etc/nginx/nginx.conf:5</code><br>æŸ¥çœ‹é…ç½®è¯¥è¡Œå†…å®¹ä¸º<code>user nginx;</code>ï¼Œæ·»åŠ ç”¨æˆ·<code>useradd nginx</code>ï¼›</li></ul><h3 id="æŠ¥é”™"><a href="#æŠ¥é”™" class="headerlink" title="æŠ¥é”™"></a>æŠ¥é”™</h3><ul><li><p>ERR_CONTENT_LENGTH_MISMATCH<br>  æŸ¥çœ‹ nginx é”™è¯¯æ—¥å¿—</p>  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ tailf /var/<span class="built_in">log</span>/nginx/error.log</span><br><span class="line">2019/08/09 03:04:21 [crit] 24616<span class="comment">#0: *204 open() &quot;/var/lib/nginx/tmp/proxy/2/03/0000000032&quot; failed (13: Permission denied) while reading upstream, client: 10.10.15.199, server: localhost, request: &quot;GET /static/js/app.1b53c809113e333c2727.js.map HTTP/1.1&quot;, upstream: &quot;http://0.0.0.0:5000/static/js/app.1b53c809113e333c2727.js.map&quot;, host: &quot;10.10.15.111:82&quot;</span></span><br></pre></td></tr></table></figure><p>  å‚è€ƒè¿™é‡Œï¼š<a href="https://blog.csdn.net/mr_ooo/article/details/81068369">ERR_CONTENT_LENGTH_MISMATCH è§£å†³æ–¹æ³•</a>      </p></li><li>è¿›å…¥é¦–é¡µå‡ºç°<code>403 Forbidden</code><ol><li>nginx å¯åŠ¨ç”¨æˆ·å’Œé…ç½®ä¸­çš„å·¥ä½œç”¨æˆ·ä¸ä¸€è‡´ï¼ˆæ³¨æ„ï¼šå¦‚æœä½ çš„<code>nginx</code>æœåŠ¡æ˜¯<code>root</code>ç”¨æˆ·è¿è¡Œï¼Œåˆ™é…ç½®ä¸­<code>user</code>é¡¹é…ç½®ä¸º<code>root</code>ï¼‰ï¼›</li><li>é…ç½®æ–‡ä»¶ä¸­ç¼ºå°‘ index index.html index.htm index.php è¡Œï¼›</li><li>nginx ç”¨æˆ·æ²¡æœ‰ç›¸åº”å·¥ä½œç›®å½•çš„æ“ä½œæƒé™ï¼ˆ<code>chown -R nginx:nginx WORK_DIR_PATH</code>ï¼‰ï¼›</li><li>é˜²ç«å¢™è®¾ç½®ã€‚<br>å‚è€ƒè¿™é‡Œï¼š<a href="https://blog.csdn.net/onlysunnyboy/article/details/75270533">è§£å†³ Nginx å‡ºç° 403 forbidden (13: Permission denied)æŠ¥é”™çš„å››ç§æ–¹æ³•</a></li></ol></li></ul><h2 id="é…ç½®-Supervisor"><a href="#é…ç½®-Supervisor" class="headerlink" title="é…ç½® Supervisor"></a>é…ç½® Supervisor</h2><p>é¦–å…ˆæ£€æŸ¥æ˜¯å¦å­˜åœ¨é…ç½®æ–‡ä»¶ï¼Œä¸€èˆ¬é…ç½®æ–‡ä»¶çš„è·¯å¾„æ˜¯<code>/etc/supervisord.conf</code>ï¼Œå¦‚æœé…ç½®æ–‡ä»¶ä¸å­˜åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å‘½ä»¤æ¥ç”Ÿæˆï¼š<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">echo_supervisord_conf &gt; /etc/supervisord.conf</span><br></pre></td></tr></table></figure><br>é…ç½®æ–‡ä»¶çš„å†…å®¹å¾ˆå¤šï¼Œé¡¹ç›®é…ç½®å¯ä»¥å‚ç…§<a href="http://www.supervisord.org/introduction.html">å®˜ç½‘æ–‡æ¡£</a></p><p>æ‰“å¼€é…ç½®æ–‡ä»¶çš„æœ€åä¸€è¡Œ<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">;[include]</span><br><span class="line">;files = /etc/supervisord/*.conf    <span class="comment"># æ³¨æ„ï¼šæœ¬äººå®‰è£…ç‰ˆæœ¬ä¸ºiniæ ¼å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬è‡ªå†™çš„é…ç½®ä¹Ÿåº”è¯¥è°ƒæ•´ä¸ºç›¸åº”çš„.iniæ ¼å¼[include] \n files = supervisord.d/*.ini </span></span><br></pre></td></tr></table></figure><br>é»˜è®¤ä¸€èˆ¬æ˜¯æ³¨é‡Šæ‰çš„ï¼Œæˆ‘ä»¬å¯ä»¥å–æ¶ˆæ³¨é‡Šï¼Œè¿™è¡Œé…ç½®çš„ä½œç”¨ä¹Ÿå¾ˆæµ…æ˜¾ï¼Œå°±æ˜¯å¯¼å…¥è®¾ç½®çš„è·¯å¾„ä¸‹çš„æ‰€æœ‰<code>conf</code>æ–‡ä»¶ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬å¦‚æœæœ‰å¤šä¸ªé¡¹ç›®å¯ä»¥ä¸ç”¨éƒ½å†™åœ¨åŒä¸€ä¸ªé…ç½®æ–‡ä»¶é‡Œï¼Œå¯ä»¥ä¸€ä¸ªé¡¹ç›®ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œæ›´é€‚åˆç®¡ç†ã€‚è¿™é‡Œçš„è·¯å¾„ä¹Ÿæ˜¯å¯ä»¥æŒ‰ç…§å®é™…éœ€æ±‚éšæ„æ›´æ”¹ã€‚<br>æ‰‹åŠ¨å¯åŠ¨ Supervisord<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">supervisord -c /etc/supervisord.conf</span><br></pre></td></tr></table></figure><br>åœ¨è®¾ç½®çš„è·¯å¾„ä¸‹æ–°å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå‘½ä»¤è¯·æ ¹æ®ä¸Šä¸€æ­¥è®¾ç½®çš„æ‰©å±•åã€‚<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[program:project_name]</span><br><span class="line"><span class="built_in">command</span>=/usr/bin/gunicorn -c gun.py runserver:app       <span class="comment"># å…·ä½“è·¯å¾„æ ¹æ®è‡ªå·±å®‰è£…æˆ–è€…è™šæ‹Ÿç¯å¢ƒä¸­çš„ä½ç½®è¿›è¡Œé…ç½®</span></span><br><span class="line">directory=/project_path/        <span class="comment"># é¡¹ç›®è·¯å¾„</span></span><br><span class="line">startsecs=0</span><br><span class="line">stopwaitsecs=0</span><br><span class="line">autostart=<span class="literal">true</span></span><br><span class="line">autorestart=<span class="literal">true</span></span><br></pre></td></tr></table></figure><br><code>project_name</code>æŒ‰ç…§ä½ çš„å®é™…éœ€æ±‚ä¿®æ”¹ï¼Œä½œä¸ºä½ è¿™ä¸ªæœåŠ¡çš„å”¯ä¸€æ ‡è¯†ï¼Œç”¨äºå¯åŠ¨åœæ­¢æœåŠ¡æ—¶ä½¿ç”¨ã€‚<br><code>command</code>ä¿®æ”¹ä¸ºæµ‹è¯•<code>gunicorn</code>æ—¶ä½¿ç”¨çš„å‘½ä»¤ï¼Œå»ºè®®ä½¿ç”¨ç»å¯¹è·¯å¾„ã€‚<br><code>directory</code>æŒ‡å®šäº†å·¥ä½œè·¯å¾„ï¼Œé€šå¸¸è®¾ç½®ä¸ºé¡¹ç›®æ ¹ç›®å½•ï¼Œæˆ‘ä»¬å¡«å†™çš„ gun.py å’Œ app éƒ½æ˜¯åŸºäºè¿™ä¸ªè·¯å¾„çš„ã€‚</p><p>ç®¡ç†<code>Supervisor</code>çš„é¡¹ç›®æ˜¯ä½¿ç”¨<code>supervisorctl</code>å‘½ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥å¯åŠ¨é¡¹ç›®è¯•è¯•çœ‹</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">supervisorctl start PROJECT_NAME</span><br></pre></td></tr></table></figure><p>å¦‚æœæ²¡æœ‰æŠ¥é”™ï¼Œåº”è¯¥å¯ä»¥å’Œä¸Šä¸€æ­¥æµ‹è¯•<code>gunicorn</code>ä¸€æ ·å¯ä»¥æ­£å¸¸è®¿é—®é¡¹ç›®äº†ã€‚<br>éªŒè¯<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">-bash-4.2<span class="comment"># supervisorctl</span></span><br><span class="line">app                              RUNNING   pid 24639, uptime 0:20:55</span><br></pre></td></tr></table></figure></p><h3 id="æŠ¥é”™è®°å½•"><a href="#æŠ¥é”™è®°å½•" class="headerlink" title="æŠ¥é”™è®°å½•"></a>æŠ¥é”™è®°å½•</h3><ul><li>Error: Another program is already listening on a port that one of our HTTP servers is configured to use.  Shut this program down first before starting supervisord. For help, use /usr/bin/supervisord -h  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¯ä»¥æŸ¥çœ‹supervisor.sockå¹¶åˆ é™¤ </span></span><br><span class="line">-bash-4.2<span class="comment"># find / -name supervisor.sock </span></span><br><span class="line">/run/supervisor/supervisor.sock</span><br><span class="line">-bash-4.2<span class="comment"># unlink /run/supervisor/supervisor.sock</span></span><br></pre></td></tr></table></figure>å†æ¬¡é‡æ–°å¯åŠ¨<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">-bash-4.2<span class="comment"># supervisord -c /etc/supervisord.conf</span></span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒæ¥æº"><a href="#å‚è€ƒæ¥æº" class="headerlink" title="å‚è€ƒæ¥æº"></a>å‚è€ƒæ¥æº</h2></li></ul><ol><li><a href="https://programmer.help/blogs/5c13afa73d10a.html">Huawei Cloud Centos7 Flask+Gunicorn+Gevent+Supervisor+Nginx Multi-site Production Environment Deployment</a></li><li><a href="https://www.jianshu.com/p/192e62a5cdd2">Flask + Nginx + Gunicorn + Gevent éƒ¨ç½²</a></li><li><a href="https://www.jianshu.com/p/65fae00615b9">gunicorn+gevent+nginx éƒ¨ç½² flask åº”ç”¨</a></li><li><a href="https://blog.csdn.net/spark_csdn/article/details/80790929">CentOS ä¸Š Flask + uWSGI + Nginx éƒ¨ç½²</a></li><li><a href="https://www.zhihu.com/question/38528616">Nginxã€Gunicorn åœ¨æœåŠ¡å™¨ä¸­åˆ†åˆ«èµ·ä»€ä¹ˆä½œç”¨</a></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Flask </tag>
            
            <tag> Web å¼€å‘ </tag>
            
            <tag> Nginx </tag>
            
            <tag> éƒ¨ç½² </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python3 æŠ¥é”™&quot;TypeError:a-bytes-like-object-is-required,not-&#39;str&#39;&quot;è§£å†³åŠæ³•</title>
      <link href="blog/2019-07-11/a-bytes-like-object-is-required-not-str-python3/"/>
      <url>blog/2019-07-11/a-bytes-like-object-is-required-not-str-python3/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><p>ä»Šå¤©åœ¨è§£æä¸€ä¸ªå·¥å…·è¾“å‡ºé—®é¢˜æ—¶é‡åˆ°è¿™ä¸¤ä¸ªç¼–ç é”™è¯¯ï¼Œè®°å½•ä¸€ä¸‹ã€‚</p><ul><li>TypeError: a bytes-like object is required, not â€˜strâ€™</li><li>UnicodeDecodeError: â€˜utf-8â€™ codec canâ€™t decode byte 0xb3 in position 38: invalid start byte<a id="more"></a></li></ul><h2 id="TL-DR"><a href="#TL-DR" class="headerlink" title="TL;DR"></a>TL;DR</h2><blockquote><p>å¯¼è‡´è¿™ä¸ªé—®é¢˜ä¸»è¦çš„åŸå› æ˜¯ä½ è°ƒç”¨çš„æ˜¯å­—ç¬¦<code>str</code>ç±»å‹çš„æ–¹æ³•è€Œä½ ç»™ä¼ é€’çš„æ˜¯ä¸€ä¸ªå­—èŠ‚<code>byte</code>ç±»å‹çš„å¯¹è±¡ã€‚</p></blockquote><h2 id="å…ˆä¸Šä»£ç "><a href="#å…ˆä¸Šä»£ç " class="headerlink" title="å…ˆä¸Šä»£ç "></a>å…ˆä¸Šä»£ç </h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ExecCommandError</span>(<span class="params">Exception</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ExecCommand</span>:</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">cust_popen_list</span>(<span class="params">cmdlist, close_fds=<span class="literal">True</span></span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        subprocess.callåªæ¥å—æ•°ç»„å˜é‡ä½œä¸ºå‘½ä»¤ï¼Œå¹¶å°†æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä½œä¸ºå‘½ä»¤ï¼Œå‰©ä¸‹çš„å…¨éƒ¨ä½œä¸ºè¯¥å‘½ä»¤çš„å‚æ•°ã€‚</span></span><br><span class="line"><span class="string">        :param cmdlist:</span></span><br><span class="line"><span class="string">        :param close_fds:</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        lastcmdlist = <span class="built_in">list</span>()</span><br><span class="line">        lastcmdlist.extend(cmdlist)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            proc = subprocess.Popen(lastcmdlist, shell=<span class="literal">False</span>, stdout=subprocess.PIPE, stderr=subprocess.PIPE,</span><br><span class="line">                                    close_fds=close_fds)</span><br><span class="line">            retcode = proc.wait()</span><br><span class="line">            <span class="keyword">return</span> retcode, proc</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">raise</span> (ExecCommandError, e)</span><br><span class="line">            </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HwMaker</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.retcode = <span class="number">1</span></span><br><span class="line">        self.proc = <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">exec_command</span>(<span class="params">cmd_list=<span class="literal">None</span></span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        è°ƒç”¨æ‰§è¡Œå‘½ä»¤çš„ç¨‹åº</span></span><br><span class="line"><span class="string">        :param cmd_list: list,</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">assert</span> cmd_list</span><br><span class="line">        cmd = ExecCommand()</span><br><span class="line">        <span class="keyword">return</span> cmd.cust_popen_list(cmd_list)</span><br><span class="line">        </span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">make_label</span>(<span class="params">label</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        å¦‚æœä»¥ç©ºæ ¼åˆ†å‰²ï¼Œåˆ™æ›¿æ¢ä¸º with_under_case,æœ€åè°ƒç”¨lower()è¿”å›lower_with_under_case</span></span><br><span class="line"><span class="string">        :param label:</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        split_label = label.split()</span><br><span class="line">        label = <span class="string">&#x27;_&#x27;</span>.join([span.lower() <span class="keyword">for</span> span <span class="keyword">in</span> split_label]) <span class="keyword">if</span> <span class="built_in">len</span>(split_label) &gt; <span class="number">1</span> <span class="keyword">else</span> label.lower()</span><br><span class="line">        <span class="keyword">return</span> label</span><br><span class="line">        </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SensorMaker</span>(<span class="params">HwMaker</span>):</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">secs2hours</span>(<span class="params">secs</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        ç§’è½¬åŒ–ä¸ºå°æ—¶</span></span><br><span class="line"><span class="string">        :param secs:</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        mm, ss = <span class="built_in">divmod</span>(secs, <span class="number">60</span>)</span><br><span class="line">        hh, mm = <span class="built_in">divmod</span>(mm, <span class="number">60</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;%d:%02d:%02d&quot;</span> % (hh, mm, ss)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse_vertical_line</span>(<span class="params">self, parser_data</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        ä»¥â€œ|â€ åˆ†å‰²ä¹‹åè·å–æœ‰ç”¨ä¿¡æ¯</span></span><br><span class="line"><span class="string">        :param parser_data:</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        _expect_info = <span class="built_in">dict</span>()</span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> parser_data:</span><br><span class="line">            strip_line = line.strip().decode(<span class="string">&#x27;utf-8&#x27;</span>, <span class="string">&quot;ignore&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;|&#x27;</span> <span class="keyword">in</span> strip_line:</span><br><span class="line">                item, value = [item.strip() <span class="keyword">for</span> item <span class="keyword">in</span> strip_line.split(<span class="string">&#x27;|&#x27;</span>)]</span><br><span class="line">                lower_label = self.make_label(item)</span><br><span class="line">                _expect_info[lower_label] = value</span><br><span class="line">        <span class="keyword">return</span> _expect_info</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">ipmi_pminfo</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">         [SlaveAddress = B2h] [Module 2]</span></span><br><span class="line"><span class="string">         Item                           |                Value</span></span><br><span class="line"><span class="string">         ----                           |                -----</span></span><br><span class="line"><span class="string">         Status                         |     [STATUS OK](00h)</span></span><br><span class="line"><span class="string">         AC Input Voltage               |              237.0 V</span></span><br><span class="line"><span class="string">         AC Input Current               |               0.36 A</span></span><br><span class="line"><span class="string">         DC 12V Output Voltage          |              12.04 V</span></span><br><span class="line"><span class="string">         DC 12V Output Current          |               5.07 A</span></span><br><span class="line"><span class="string">         Temperature 1                  |              34C/94F</span></span><br><span class="line"><span class="string">         Temperature 2                  |              37C/98F</span></span><br><span class="line"><span class="string">         Fan 1                          |             5400 RPM</span></span><br><span class="line"><span class="string">         Fan 2                          |              985 RPM</span></span><br><span class="line"><span class="string">         DC 12V Output Power            |                 61 W</span></span><br><span class="line"><span class="string">         AC Input Power                 |                 78 W</span></span><br><span class="line"><span class="string">         PMBus Revision                 |               0xD222</span></span><br><span class="line"><span class="string">         PWS Serial Number              |      Â³Â³Â³Â³Â³Â³Â³UÂ³Â³Â³Â³Â³Â³Â³</span></span><br><span class="line"><span class="string">         PWS Module Number              |         Â³Â³Â³Â³Â³Â³Â³Â³Â³Â³Â³Â³</span></span><br><span class="line"><span class="string">         PWS Revision                   |               Â³Â³Â³Â³Â³Â³</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">         out: &#123;&#x27;status&#x27;: &#x27;[STATUS OK](00h)&#x27;,</span></span><br><span class="line"><span class="string">             &#x27;ac_input_voltage&#x27;: &#x27;237.0 V&#x27;,</span></span><br><span class="line"><span class="string">             &#x27;ac_input_current&#x27;: &#x27;0.39 A&#x27;,</span></span><br><span class="line"><span class="string">             &#x27;dc_12v_output_voltage&#x27;: &#x27;12.04 V&#x27;,</span></span><br><span class="line"><span class="string">             &#x27;dc_12v_output_current&#x27;: &#x27;5.19 A&#x27;,</span></span><br><span class="line"><span class="string">             &#x27;temperature_1&#x27;: &#x27;34C/94F&#x27;,</span></span><br><span class="line"><span class="string">             &#x27;temperature_2&#x27;: &#x27;37C/98F&#x27;,</span></span><br><span class="line"><span class="string">             &#x27;fan_1&#x27;: &#x27;5424 RPM&#x27;,</span></span><br><span class="line"><span class="string">             &#x27;fan_2&#x27;: &#x27;985 RPM&#x27;,</span></span><br><span class="line"><span class="string">             &#x27;dc_12v_output_power&#x27;: &#x27;63 W&#x27;,</span></span><br><span class="line"><span class="string">             &#x27;ac_input_power&#x27;: &#x27;71 W&#x27;,</span></span><br><span class="line"><span class="string">             &#x27;pmbus_revision&#x27;: &#x27;0xD222&#x27;,</span></span><br><span class="line"><span class="string">             &#x27;pws_serial_number&#x27;: &#x27;U&#x27;,</span></span><br><span class="line"><span class="string">             &#x27;pws_module_number&#x27;: &#x27;&#x27;,</span></span><br><span class="line"><span class="string">             &#x27;pws_revision&#x27;: &#x27;&#x27;&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        _pm_info = &#123;&#125;</span><br><span class="line">        _cmd = [<span class="string">&#x27;ipmicfg&#x27;</span>, <span class="string">&#x27;-pminfo&#x27;</span>]</span><br><span class="line">        self.retcode, self.proc = self.exec_command(_cmd)</span><br><span class="line">        <span class="keyword">if</span> self.retcode == <span class="number">0</span>:</span><br><span class="line">            <span class="comment"># æˆªå–æœ‰ç”¨è¡Œï¼ˆæ’é™¤å‰ä¸‰è¡Œï¼‰</span></span><br><span class="line">            out_data = self.out_data()</span><br><span class="line">            <span class="keyword">if</span> out_data:</span><br><span class="line">                _pm_info = self.parse_vertical_line(out_data[<span class="number">3</span>:])</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">return</span> _pm_info</span><br></pre></td></tr></table></figure><h2 id="åŸå› è§£é‡ŠåŠè§£å†³æ–¹æ¡ˆ"><a href="#åŸå› è§£é‡ŠåŠè§£å†³æ–¹æ¡ˆ" class="headerlink" title="åŸå› è§£é‡ŠåŠè§£å†³æ–¹æ¡ˆ"></a>åŸå› è§£é‡ŠåŠè§£å†³æ–¹æ¡ˆ</h2><p>å…³äº<code>TypeError: a bytes-like object is required, not &#39;str&#39;</code>é”™è¯¯ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å¤ç°ä¸€ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">In [16]: a &#x3D; b&#39;123|456&#39;</span><br><span class="line"></span><br><span class="line">In [17]: a.split(&#39;|&#39;)                                                                                         </span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">TypeError                                 Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input-17-d4229c89bf5f&gt; in &lt;module&gt;</span><br><span class="line">----&gt; 1 a.split(&#39;|&#39;)</span><br><span class="line"></span><br><span class="line">TypeError: a bytes-like object is required, not &#39;str&#39;</span><br></pre></td></tr></table></figure><br>æ‰€ä»¥æç¤ºç±»å‹é”™è¯¯ï¼Œå¦‚æœä½ çš„<em>å­—èŠ‚</em>æ˜¯<code>byte</code>å‹ï¼Œå¯ä»¥å°è¯•å…ˆ<code>decode</code>è½¬ä¸º<em>å­—ç¬¦</em>ç±»å‹ä¹‹åå†æ‰§è¡Œç›¸åº”çš„<code>str</code>æ–¹æ³•ã€‚</p><h3 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•"></a>è§£å†³åŠæ³•</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">In [20]: a &#x3D; b&#39;123|456&#39;                                                                                        </span><br><span class="line">In [21]: a.decode(&#39;utf-8&#39;).split(&#39;|&#39;)                                                                         </span><br><span class="line">Out[21]: [&#39;123&#39;, &#39;456&#39;]</span><br></pre></td></tr></table></figure><p>å…³äºé—®é¢˜<code>UnicodeDecodeError: &#39;utf-8&#39; codec can&#39;t decode byte 0xb3 in position 38: invalid start byte</code>ï¼Œä¸»è¦æ˜¯å› ä¸ºç»“æœä¸­æœ‰<code>Â³Â³Â³Â³Â³Â³Â³UÂ³Â³Â³Â³Â³Â³Â³</code>,è¿™ä¸ªæ²¡æœ‰åŠæ³•æŒ‰ç…§<code>utf-8</code>è§£ç ã€‚<br>å‡ºç°å¼‚å¸¸æŠ¥é”™æ˜¯ç”±äºè®¾ç½®äº†<code>decode()</code>æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°<code>errors</code>ä¸ºä¸¥æ ¼ï¼ˆ<code>strict</code>ï¼‰å½¢å¼é€ æˆçš„ï¼Œå› ä¸ºé»˜è®¤å°±æ˜¯è¿™ä¸ªå‚æ•°ï¼Œå°†å…¶æ›´æ”¹ä¸º<code>ignore</code>å³å¯ã€‚</p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><ul><li><a href="https://blog.csdn.net/wang7807564/article/details/78164855/">Python3 è§£å†³ UnicodeDecodeError: â€˜utf-8â€™ codec canâ€™t decode byte..é—®é¢˜ ç»ˆæè§£å†³æ–¹æ¡ˆ</a></li><li><a href="https://stackoverflow.com/questions/33054527/typeerror-a-bytes-like-object-is-required-not-str-when-writing-to-a-file-in">TypeError: a bytes-like object is required, not â€˜strâ€™ when writing to a file in Python3</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> Python3 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•åœ¨ Vue ä¸­å®ç°æ˜¾ç¤ºå…¨éƒ¨çš„åŠŸèƒ½ï¼Ÿ</title>
      <link href="blog/2019-07-05/how-to-make-show-all-with-Vue/"/>
      <url>blog/2019-07-05/how-to-make-show-all-with-Vue/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h2 id="åŠŸèƒ½åˆ†æ"><a href="#åŠŸèƒ½åˆ†æ" class="headerlink" title="åŠŸèƒ½åˆ†æ"></a>åŠŸèƒ½åˆ†æ</h2><p>æˆ‘ä»¬å¯ä»¥ç®€å•åˆ†æä¸€ä¸‹åŠŸèƒ½å®ç°ï¼š</p><ol><li>æ˜¾ç¤ºå†…å®¹æ˜¯ä»åå°ä¸€æ¬¡æ€§è·å–åˆ°çš„ï¼Œä¸å­˜åœ¨ç‚¹å‡»â€œé˜…è¯»æ›´å¤šâ€å†å»è¯·æ±‚ä¸€æ¬¡åå°è·å–å‰©ä½™æ•°æ®çš„å¯èƒ½ï¼›</li><li>é€šè¿‡ç¬¬ä¸€æ­¥å…¶å®å¯ä»¥å¾—å‡ºï¼Œç½‘ç«™æ˜¯é€šè¿‡æ§åˆ¶æ˜¾ç¤ºå…ƒç´ çš„é«˜åº¦æ¥å®ç°è¿™ä¸€åŠŸèƒ½ï¼Œè€Œéæ§åˆ¶å†…å®¹çš„è·å–ï¼›</li><li>å¯ä»¥çœ‹åˆ°â€œé˜…è¯»æ›´å¤šâ€æŒ‰é’®ä¸Šæœ‰ä¸€å±‚æ¸å˜é®ç½©å±‚ï¼Œç½‘ç«™é€šè¿‡è¿™ä¸€é®ç½©æŒ¡ä½å‰©ä½™å†…å®¹ã€‚</li></ol><h2 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang&#x3D;&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset&#x3D;&quot;UTF-8&quot;&gt;</span><br><span class="line">  &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1.0&quot;&gt;</span><br><span class="line">  &lt;meta http-equiv&#x3D;&quot;X-UA-Compatible&quot; content&#x3D;&quot;ie&#x3D;edge&quot;&gt;</span><br><span class="line">  &lt;title&gt;Document&lt;&#x2F;title&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;div id&#x3D;&quot;app&quot;&gt;</span><br><span class="line">    &lt;div v-for&#x3D;&quot;(item, key) in testItems&quot; v-show&#x3D;&quot;key&lt;limitShowNum&quot;&gt;</span><br><span class="line">      &#123;&#123;item&#125;&#125;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;el-button @click&#x3D;&quot;showMore&quot; type&#x3D;&quot;text&quot; style&#x3D;&quot;color:#79bbff;&quot;&gt;&#123;&#123;showAllTip&#125;&#125;&lt;&#x2F;el-button&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;https:&#x2F;&#x2F;unpkg.com&#x2F;element-ui&#x2F;lib&#x2F;theme-chalk&#x2F;index.css&quot;&gt;</span><br><span class="line">&lt;!-- å¼•å…¥ç»„ä»¶åº“ --&gt;</span><br><span class="line">&lt;script src&#x3D;&quot;https:&#x2F;&#x2F;unpkg.com&#x2F;element-ui&#x2F;lib&#x2F;index.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">  &lt;script src&#x3D;&quot;https:&#x2F;&#x2F;unpkg.com&#x2F;vue&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">  &lt;script&gt;</span><br><span class="line">    var app &#x3D; new Vue(&#123;</span><br><span class="line">      el: &#39;#app&#39;,</span><br><span class="line">      data()&#123;</span><br><span class="line">        return&#123;</span><br><span class="line">          testItems: [&#39;æµ·å®¢è°ˆç€›æ´²ï¼ŒçƒŸæ¶›å¾®èŒ«ä¿¡éš¾æ±‚ï¼›&#39;, &#39;è¶Šäººè¯­å¤©å§¥ï¼Œäº‘éœæ˜ç­æˆ–å¯ç¹ã€‚&#39;, &#39;å¤©å§¥è¿å¤©å‘å¤©æ¨ªï¼ŒåŠ¿æ‹”äº”å²³æ©èµ¤åŸã€‚&#39;, &#39;å¤©å°å››ä¸‡å…«åƒä¸ˆï¼Œå¯¹æ­¤æ¬²å€’ä¸œå—å€¾ã€‚&#39;, &#39;æˆ‘æ¬²å› ä¹‹æ¢¦å´è¶Šï¼Œä¸€å¤œé£åº¦é•œæ¹–æœˆã€‚&#39;, &#39;æ¹–æœˆç…§æˆ‘å½±ï¼Œé€æˆ‘è‡³å‰¡æºªã€‚&#39;, &#39;è°¢å…¬å®¿å¤„ä»Šå°šåœ¨ï¼Œæ¸Œæ°´è¡æ¼¾æ¸…çŒ¿å•¼ã€‚&#39;, &#39;è„šè‘—è°¢å…¬å±ï¼Œèº«ç™»é’äº‘æ¢¯ã€‚&#39;, &#39;åŠå£è§æµ·æ—¥ï¼Œç©ºä¸­é—»å¤©é¸¡ã€‚&#39;, &#39;åƒå²©ä¸‡è½¬è·¯ä¸å®šï¼Œè¿·èŠ±å€šçŸ³å¿½å·²æšã€‚&#39;, &#39;ç†Šå’†é¾™åŸæ®·å²©æ³‰ï¼Œæ —æ·±æ—å…®æƒŠå±‚å·…ã€‚&#39;, &#39;äº‘é’é’å…®æ¬²é›¨ï¼Œæ°´æ¾¹æ¾¹å…®ç”ŸçƒŸã€‚&#39;, &#39;åˆ—ç¼ºéœ¹é›³ï¼Œä¸˜å³¦å´©æ‘§ã€‚&#39;, &#39;æ´å¤©çŸ³æ‰‰ï¼Œè¨‡ç„¶ä¸­å¼€ã€‚&#39;, &#39;é’å†¥æµ©è¡ä¸è§åº•ï¼Œæ—¥æœˆç…§è€€é‡‘é“¶å°ã€‚&#39;, &#39;éœ“ä¸ºè¡£å…®é£ä¸ºé©¬ï¼Œäº‘ä¹‹å›å…®çº·çº·è€Œæ¥ä¸‹ã€‚&#39;, &#39;è™é¼“ç‘Ÿå…®é¸¾å›è½¦ï¼Œä»™ä¹‹äººå…®åˆ—å¦‚éº»ã€‚&#39;, &#39;å¿½é­‚æ‚¸ä»¥é­„åŠ¨ï¼ŒææƒŠèµ·è€Œé•¿å—Ÿã€‚&#39;, &#39;æƒŸè§‰æ—¶ä¹‹æ•å¸­ï¼Œå¤±å‘æ¥ä¹‹çƒŸéœã€‚&#39;, &#39;ä¸–é—´è¡Œä¹äº¦å¦‚æ­¤ï¼Œå¤æ¥ä¸‡äº‹ä¸œæµæ°´ã€‚&#39;, &#39;åˆ«å›å»å…®ä½•æ—¶è¿˜ï¼Ÿä¸”æ”¾ç™½é¹¿é’å´–é—´ã€‚é¡»è¡Œå³éª‘è®¿åå±±ã€‚&#39;, &#39;å®‰èƒ½æ‘§çœ‰æŠ˜è…°äº‹æƒè´µï¼Œä½¿æˆ‘ä¸å¾—å¼€å¿ƒé¢œï¼&#39;],</span><br><span class="line">          isShow: true,</span><br><span class="line">  showAllTip: &#39;æˆ‘å…¨éƒ½è¦ ğŸ˜œ&#39;,</span><br><span class="line">  limitShowNum: 5,</span><br><span class="line">      defaultShowNum:5</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;</span><br><span class="line">        &#x2F;&#x2F; åŠŸèƒ½å®ç°</span><br><span class="line">        showMore()&#123;</span><br><span class="line">let showDataLen &#x3D; this.testItems.length</span><br><span class="line">this.isShow &#x3D; !this.isShow;</span><br><span class="line">this.limitShowNum &#x3D; this.isShow? this.defaultShowNum: showDataLen;</span><br><span class="line">this.showAllTip &#x3D; this.isShow?&#39;æˆ‘å…¨éƒ½è¦ ğŸ˜œ&#39;:&#39;æ”¶èµ·&#39;</span><br><span class="line">&#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &lt;&#x2F;script&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure><h2 id="åŠŸèƒ½æ¼”ç¤º"><a href="#åŠŸèƒ½æ¼”ç¤º" class="headerlink" title="åŠŸèƒ½æ¼”ç¤º"></a>åŠŸèƒ½æ¼”ç¤º</h2><p>æ­¤å¤„æ˜¾ç¤ºä¸ç›´æ¥ä»£ç è¿è¡Œæ•ˆæœä¸ä¸€æ ·ï¼Œä¸»è¦æ˜¯å› ä¸ºæ ·å¼ä»¥åŠæ·»åŠ  i æ ‡ç­¾å›¾æ ‡ç­‰å¯¼è‡´ï¼›æ ·å¼ä¸ä¼šå†™çš„è¯å¯ä»¥å‚è€ƒ<code>element-ui</code>å®˜æ–¹æ–‡æ¡£çš„å®ç°ã€‚</p><p><img src= "/img/loading.svg" data-lazy-src="/images/show_all_example.gif" alt="æ˜¾ç¤ºå…¨éƒ¨ä¸æŠ˜å "></p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://blog.csdn.net/XuM222222/article/details/80189355">åˆ©ç”¨ vue å®ç°â€œæ˜¾ç¤ºæ›´å¤šâ€åŠŸèƒ½</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> å‰ç«¯ </tag>
            
            <tag> Vue </tag>
            
            <tag> element-ui </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>flask-sqlalchemy ä¸­çš„å¤šå¯¹å¤šå…³ç³»æ¨¡å‹é—®é¢˜è®°å½•</title>
      <link href="blog/2019-07-03/flask-sqlalchemy-many-to-many/"/>
      <url>blog/2019-07-03/flask-sqlalchemy-many-to-many/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can<span class="string">&#x27;t proceed with initialization of other mappers. Triggering mapper: &#x27;</span>mapped class Article-&gt;iy_article<span class="string">&#x27;. Original exception was: Error creating backref &#x27;</span>articles<span class="string">&#x27; on relationship &#x27;</span>Article.tags<span class="string">&#x27;: property of that name exists on mapper &#x27;</span>mapped class Tag-&gt;iy_tag<span class="string">&#x27;</span></span><br></pre></td></tr></table></figure><p>å‡ºç°è¿™ä¸ªé”™è¯¯æ˜¯å› ä¸ºä¸¤ä¸ªå…³ç³»è¡¨ä¸­äº’ç›¸å®šä¹‰ï¼Œæ„æ€æ˜¯ä½ çš„ä»£ç ä¸­å¯èƒ½åŒæ—¶åŒ…å«ä¸‹é¢çš„è¯­å¥ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># class Article:</span></span><br><span class="line"></span><br><span class="line">tags = db.relationship(<span class="string">&#x27;Tag&#x27;</span>, secondary=posts_tags_table, backref=db.backref(<span class="string">&#x27;articles&#x27;</span>, lazy=<span class="string">&#x27;dynamic&#x27;</span>),</span><br><span class="line">                               lazy=<span class="string">&quot;dynamic&quot;</span>)</span><br><span class="line"><span class="comment"># Class Tag:                            </span></span><br><span class="line">articles = db.relationship(<span class="string">&#x27;Article&#x27;</span>, secondary=posts_tags_table,</span><br><span class="line">    <span class="comment">#                            back_populates=&#x27;tags&#x27;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="è§£é‡Š"><a href="#è§£é‡Š" class="headerlink" title="è§£é‡Š"></a>è§£é‡Š</h3><p>å½“æ‚¨ä½¿ç”¨<code>backref</code>æ—¶ï¼Œ<code>SQLAlchemy</code>ä¼šè‡ªåŠ¨åˆ›å»ºå‘åå…³è”ï¼Œå› æ­¤å®ƒï¼ˆ<code>backref</code>ï¼‰<strong>åªåº”è¯¥</strong>åœ¨å…³ç³»çš„ä¸€ä¾§ä½¿ç”¨ã€‚æ‰€ä»¥åº”è¯¥åˆ é™¤ä¸Šé¢å…¶ä¸­çš„ä¸€å¥å®šä¹‰ã€‚</p><p>å‚è§è¿™é‡ŒğŸ‘‰ <a href="https://stackoverflow.com/questions/39869793/when-do-i-need-to-use-sqlalchemy-back-populates">when-do-i-need-to-use-sqlalchemy-back-populates</a></p><h2 id="é—®é¢˜-1"><a href="#é—®é¢˜-1" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlalchemy.orm.exc.StaleDataError: DELETE statement on table <span class="string">&#x27;iy_post_tags&#x27;</span> expected to delete 4 row(s); Only 24 were matched.</span><br></pre></td></tr></table></figure><h3 id="å¤„ç†è¿‡ç¨‹"><a href="#å¤„ç†è¿‡ç¨‹" class="headerlink" title="å¤„ç†è¿‡ç¨‹"></a>å¤„ç†è¿‡ç¨‹</h3><p>å‡ºç°è¿™ä¸ªé—®é¢˜åŸå› æ˜¯åœ¨å¤šå¯¹å¤šå…³ç³»çš„å…³è”è¡¨ä¸­ï¼Œå‡ºç°äº†é‡å¤æ•°æ®ã€‚<br>ä¹¦ä¸Šè¯´</p><blockquote><p>å°†æŸä¸ª Book çš„ Writer å±æ€§è®¾ç½®ä¸º None,å°±ä¼šè§£é™¤ä¸ Writer å¯¹è±¡çš„å…³ç³»ã€‚</p></blockquote><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">post_obj = Article.query.<span class="built_in">filter</span>(Article.post_id == post_id).one()</span><br><span class="line"><span class="keyword">if</span> post_obj:</span><br><span class="line">    body_id = post_obj.body_id</span><br><span class="line">    post_obj.tags = <span class="literal">None</span></span><br><span class="line">    db.session.commit()</span><br></pre></td></tr></table></figure><p>å¤±è´¥ï¼ğŸ˜</p><p>å†æ¬¡å‚è€ƒğŸ‘‰ <a href="https://seagullbird.xyz/posts/how-to-delete-many-to-many-in-sqlalchemy/">How to delete a Many-to-Many relationship in Flask-SQLAlchemy</a><br>ä½œè€…æåˆ°å¯èƒ½æ˜¯å› ä¸ºå¯¹æ•°æ®æ‰‹åŠ¨å¤„ç†çš„é—®é¢˜ã€‚</p><h3 id="éªŒè¯"><a href="#éªŒè¯" class="headerlink" title="éªŒè¯"></a>éªŒè¯</h3><p>æŸ¥è¯¢æ•°æ®è¡¨ä¸­æ˜¯å¦å­˜åœ¨é‡å¤æ•°æ®ï¼š<br><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">delete</span> <span class="keyword">from</span> iy_post_tags <span class="keyword">where</span> post_id<span class="operator">=</span><span class="number">26</span>;</span><br><span class="line">Query OK, <span class="number">2</span> <span class="keyword">rows</span> affected (<span class="number">0.22</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> iy_post_tags;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+--------+</span></span><br><span class="line"><span class="operator">|</span> post_id <span class="operator">|</span> tag_id <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+--------+</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">20</span> <span class="operator">|</span>      <span class="number">7</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">21</span> <span class="operator">|</span>      <span class="number">7</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">22</span> <span class="operator">|</span>      <span class="number">7</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">23</span> <span class="operator">|</span>      <span class="number">7</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">24</span> <span class="operator">|</span>      <span class="number">7</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">24</span> <span class="operator">|</span>      <span class="number">7</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">20</span> <span class="operator">|</span>      <span class="number">7</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">25</span> <span class="operator">|</span>      <span class="number">7</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">27</span> <span class="operator">|</span>      <span class="number">7</span> <span class="operator">|</span>    <span class="comment">-- æ³¨æ„è¿™ä¸¤è¡Œï¼Œè¡¨ä¸­å‡ºç°åŒä¸€ç¯‡æ–‡ç« ï¼Œæ ‡ç­¾ç›¸åŒè®°å½•ä¸¤æ¬¡çš„æƒ…å†µï¼Œæ­¤æ—¶åˆ é™¤æ“ä½œå°±ä¼šæŠ¥é”™</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">27</span> <span class="operator">|</span>      <span class="number">7</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+--------+</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><br>çš„ç¡®å­˜åœ¨é‡å¤æ•°æ®ï¼Œå¯ä»¥æ‰‹åŠ¨åˆ é™¤ã€‚</p><p>å¦‚æœæ— æ³•åˆ é™¤ï¼Œå¯ä»¥å‚è€ƒ<a href="https://stackoverflow.com/questions/36002638/how-to-fix-sqlalchemy-sawarning-delete-statement-on-table-expected-to-delete-1">è¿™é‡Œ</a>çš„æ–¹æ¡ˆï¼šä¿®æ”¹è¡¨ç»“æ„ï¼Œè§£é™¤ç¡®è®¤åˆ é™¤ã€‚</p><h3 id="åˆ©ç”¨ä»£ç é™åˆ¶æ°¸ä¹…è§£å†³"><a href="#åˆ©ç”¨ä»£ç é™åˆ¶æ°¸ä¹…è§£å†³" class="headerlink" title="åˆ©ç”¨ä»£ç é™åˆ¶æ°¸ä¹…è§£å†³"></a>åˆ©ç”¨ä»£ç é™åˆ¶æ°¸ä¹…è§£å†³</h3><p>åˆ©ç”¨ä¸»é”®å”¯ä¸€çº¦æŸï¼Œåœ¨åˆ›å»ºä¸­é—´è¡¨çš„æ—¶å€™è¿›è¡Œé™åˆ¶<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è®¾ç½®ï¼š primary_key=True</span></span><br><span class="line">article_tag_rel = sa.Table(<span class="string">&#x27;article_tag_rel&#x27;</span>, Base.metadata,</span><br><span class="line">    sa.Column(<span class="string">&#x27;tag_id&#x27;</span>, sa.Integer, ForeignKey(<span class="string">&#x27;tag.id&#x27;</span>), primary_key=<span class="literal">True</span>),</span><br><span class="line">    sa.Column(<span class="string">&#x27;article_id&#x27;</span>, sa.Integer, ForeignKey(<span class="string">&#x27;article.id&#x27;</span>), primary_key=<span class="literal">True</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä¸Šé¢çš„ä¸€ç§ç®€ä¾¿å†™æ³•</span></span><br><span class="line"><span class="keyword">import</span> db</span><br><span class="line">posts_tags_table = db.Table(<span class="string">&#x27;iy_post_tags&#x27;</span>, db.Model.metadata,</span><br><span class="line">                            db.Column(<span class="string">&#x27;post_id&#x27;</span>, db.Integer, db.ForeignKey(<span class="string">&#x27;iy_article.post_id&#x27;</span>)),</span><br><span class="line">                            db.Column(<span class="string">&#x27;tag_id&#x27;</span>, db.Integer, db.ForeignKey(<span class="string">&#x27;iy_tag.id&#x27;</span>)),</span><br><span class="line">                            db.PrimaryKeyConstraint(<span class="string">&#x27;tag_id&#x27;</span>, <span class="string">&#x27;post_id&#x27;</span>)</span><br><span class="line">                            )</span><br></pre></td></tr></table></figure></p><ul><li>å‚è§<a href="https://github.com/kvesteri/sqlalchemy-continuum/issues/65">è¿™é‡Œ</a></li><li>è¿˜æœ‰<a href="https://stackoverflow.com/questions/36002638/how-to-fix-sqlalchemy-sawarning-delete-statement-on-table-expected-to-delete-1">è¿™é‡Œ</a>æ˜¯ä¿®æ”¹è¡¨ç»“æ„ï¼›</li><li><a href="https://stackoverflow.com/questions/41941273/deleting-from-a-sqlalchemy-many-to-many-matches-the-wrong-number-of-rows">è¿™é‡Œ</a></li></ul><p>å‡ºç°è¿™ä¸ªé—®é¢˜ï¼Œå¯èƒ½æ˜¯å› ä¸ºåˆ é™¤ä¸»é”®å­—æ®µçš„æ—¶å€™ï¼Œ<code>tags</code> å«æœ‰å¯¹ <code>post_id</code> çš„å¼•ç”¨ã€‚<br>å…·ä½“è®¨è®ºå‚è§<a href="https://groups.google.com/forum/#!topic/sqlalchemy/vfoTsQkqfHI">è¿™é‡Œ</a></p><blockquote><p>A human being should be able to change a diaper, plan an invasion, butcher a hog, conn a ship, design a building, write a sonnet, balance accounts, build a wall, set a bone, comfort the dying, take orders, give orders, cooperate, act alone, solve equations, analyze a new problem, pitch manure, program a computer, cook a tasty meal, fight efficiently, die gallantly. Specialization is for insects.</p><p>ä¸€ä¸ªäººåº”è¯¥èƒ½å¤Ÿæ¢å°¿å¸ƒï¼Œç­–åˆ’æˆ˜äº‰ï¼Œæ€çŒªï¼Œå¼€èˆ¹ï¼Œè®¾è®¡æˆ¿å­ï¼Œå†™åå››è¡Œè¯—ï¼Œç»“ç®—è´¦æˆ·ï¼Œç Œå¢™ï¼Œæ¥è„±è‡¼çš„éª¨å¤´ï¼Œå®‰æ…°æ¿’æ­»çš„äººï¼Œæœä»å‘½ä»¤ï¼Œå‘å¸ƒå·ä»¤ï¼Œæºæ‰‹åˆä½œï¼Œç‹¬ç«‹è¡ŒåŠ¨ï¼Œè§£æ•°å­¦æ–¹ç¨‹ï¼Œåˆ†ææ–°é—®é¢˜ï¼Œé“²ç²ªï¼Œç”µè„‘ç¼–ç¨‹ï¼Œåšå‡ºå¯å£çš„é¥­ï¼Œå–„æ‰“æ¶ï¼Œå‹‡æ•¢åœ°æ­»å»ã€‚åªæœ‰æ˜†è™«æ‰å›¿äºä¸€é—¨ã€‚</p><footer><strong>Robert A. Heinlein</strong><cite>ã€Šæ—¶é—´è¶³å¤Ÿä½ çˆ±ã€‹</cite></footer></blockquote>]]></content>
      
      
      <categories>
          
          <category> Projects </category>
          
          <category> IdealYard </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flask </tag>
            
            <tag> SqlAlchemy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•ä½¿ç”¨ flask-celery å®ç°å¼‚æ­¥ä»»åŠ¡ï¼Ÿ</title>
      <link href="blog/2019-06-18/how-to-use-celery-with-flask/"/>
      <url>blog/2019-06-18/how-to-use-celery-with-flask/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h1 id="å…ˆå†³æ¡ä»¶"><a href="#å…ˆå†³æ¡ä»¶" class="headerlink" title="å…ˆå†³æ¡ä»¶"></a>å…ˆå†³æ¡ä»¶</h1><ul><li><code>redis</code>ç‰ˆæœ¬<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">redis-cli --version</span><br><span class="line">redis-cli 5.0.4</span><br></pre></td></tr></table></figure></li><li><code>celery</code>ç‰ˆæœ¬<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">celery --version</span><br><span class="line">4.3.0 (rhubarb)</span><br></pre></td></tr></table></figure></li><li><code>Flask</code>å’Œ <code>Python</code> ç‰ˆæœ¬<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">flask --version</span><br><span class="line">Flask 1.0.2</span><br><span class="line">Python 3.6.5 (default, Apr  1 2018, 05:46:30) </span><br><span class="line">[GCC 7.3.0]</span><br></pre></td></tr></table></figure></li><li><code>Linux</code> ç‰ˆæœ¬<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">lsb_release -a</span><br><span class="line">No LSB modules are available.</span><br><span class="line">Distributor ID:Ubuntu</span><br><span class="line">Description:Ubuntu 18.04 LTS</span><br><span class="line">Release:18.04</span><br><span class="line">Codename:bionic</span><br><span class="line"><span class="comment"># ---</span></span><br><span class="line">uname -a</span><br><span class="line">Linux <span class="built_in">local</span> 4.15.0-22-generic <span class="comment">#24-Ubuntu SMP Wed May 16 12:15:17 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="Celeryæ˜¯ä»€ä¹ˆ"><a href="#Celeryæ˜¯ä»€ä¹ˆ" class="headerlink" title="Celeryæ˜¯ä»€ä¹ˆ"></a><code>Celery</code>æ˜¯ä»€ä¹ˆ</h2></li></ul><h3 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h3><p><code>Celery</code> æ˜¯ä¸€ä¸ªâ€œè‡ªå¸¦ç”µæ± â€çš„ä¸“æ³¨äºå®æ—¶å¤„ç†å’Œä»»åŠ¡è°ƒåº¦çš„åˆ†å¸ƒå¼ä»»åŠ¡é˜Ÿåˆ—ï¼ŒåŒæ—¶æä¾›æ“ä½œå’Œç»´æŠ¤åˆ†å¸ƒå¼ç³»ç»Ÿæ‰€éœ€çš„<strong>å·¥å…·</strong>ã€‚</p><h3 id="æ•´ä½“æ¶æ„"><a href="#æ•´ä½“æ¶æ„" class="headerlink" title="æ•´ä½“æ¶æ„"></a>æ•´ä½“æ¶æ„</h3><p><img src= "/img/loading.svg" data-lazy-src="/images/structure-of-celery.png" alt="celeryæ¶æ„å›¾"></p><center><span>celeryæ¶æ„å›¾</span></center><p><code>Celery</code>æ”¯æŒå®šæ—¶ä»»åŠ¡ï¼ˆCelery Beatï¼‰å’Œå¼‚æ­¥æ‰§è¡Œ(Async Task)ä¸¤ç§æ¨¡å¼ã€‚åŒæ­¥æ¨¡å¼ä¸ºä»»åŠ¡è°ƒç”¨æ–¹ç­‰å¾…ä»»åŠ¡æ‰§è¡Œå®Œæˆï¼Œè¿™ç§æ–¹å¼ç­‰åŒäº RPC(Remote Procedure Call)ï¼Œ å¼‚æ­¥æ–¹å¼ä¸ºä»»åŠ¡åœ¨åå°æ‰§è¡Œï¼Œè°ƒç”¨æ–¹è°ƒç”¨åå°±å»åšå…¶ä»–å·¥ä½œï¼Œä¹‹åå†æ ¹æ®éœ€è¦æ¥æŸ¥çœ‹ä»»åŠ¡ç»“æœã€‚<code>Celery</code>è‡ªå·±æ²¡æœ‰å®ç°æ¶ˆæ¯é˜Ÿåˆ—ï¼Œè€Œæ˜¯ç›´æ¥å·²å­˜åœ¨çš„æ¶ˆæ¯é˜Ÿåˆ—ä½œä¸º<code>Broker</code>è§’è‰²ã€‚</p><h3 id="ç»„ä»¶"><a href="#ç»„ä»¶" class="headerlink" title="ç»„ä»¶"></a>ç»„ä»¶</h3><p>ä½¿ç”¨ <code>Celery</code> è¿è¡Œåå°ä»»åŠ¡å¹¶ä¸åƒåœ¨çº¿ç¨‹ä¸­è¿™æ ·åšé‚£ä¹ˆç®€å•ï¼Œä½†æ˜¯å¥½å¤„å¤šå¤šã€‚<code>Celery</code> å…·æœ‰åˆ†å¸ƒå¼æ¶æ„ï¼Œä½¿åº”ç”¨æ›´åŠ æ˜“äºæ‰©å±•ã€‚ä¸€ä¸ª <code>Celery</code> å®‰è£…æœ‰ä¸‰ä¸ªæ ¸å¿ƒç»„ä»¶ï¼š</p><ul><li><code>Celery</code> å®¢æˆ·ç«¯: ç”¨äºå‘å¸ƒåå°ä½œä¸šã€‚å½“ä¸ <code>Flask</code> ä¸€èµ·å·¥ä½œçš„æ—¶å€™ï¼Œå®¢æˆ·ç«¯ä¸ <code>Flask</code> åº”ç”¨ä¸€èµ·è¿è¡Œã€‚</li><li>Celery workers: ä»»åŠ¡æ¶ˆè´¹è€…ï¼Œæ˜¯è¿è¡Œåå°ä½œä¸šçš„è¿›ç¨‹ã€‚<code>Celery</code> æ”¯æŒæœ¬åœ°å’Œè¿œç¨‹çš„ <code>workers</code>ï¼Œå› æ­¤ä½ å°±å¯ä»¥åœ¨ <code>Flask</code> æœåŠ¡å™¨ä¸Šå¯åŠ¨ä¸€ä¸ªå•ç‹¬çš„ <code>worker</code>ï¼Œéšåéšç€ä½ çš„åº”ç”¨éœ€æ±‚çš„å¢åŠ è€Œæ–°å¢æ›´å¤šçš„ <code>workers</code>ã€‚</li><li>æ¶ˆæ¯ä»£ç†ï¼ˆ<code>Broker</code>ï¼‰: å®¢æˆ·ç«¯é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—å’Œ <code>workers</code> è¿›è¡Œé€šä¿¡ï¼Œ<code>Celery</code> æ”¯æŒå¤šç§æ–¹å¼æ¥å®ç°è¿™äº›é˜Ÿåˆ—ã€‚å¸¸è§çš„ä¸º <code>RabbitMQ</code> å’Œ <code>Redis</code>ã€‚</li><li>ä»»åŠ¡ç»“æœå­˜å‚¨ï¼šç”¨æ¥å­˜å‚¨<code>workers</code>æ‰§è¡Œçš„ä»»åŠ¡ç»“æœã€‚<br>è¯¦è§<a href="http://docs.jinkan.org/docs/celery/getting-started/introduction.html#id19">Celery æ˜¯â€¦â€¦</a></li></ul><h2 id="Celeryçš„å®‰è£…é…ç½®"><a href="#Celeryçš„å®‰è£…é…ç½®" class="headerlink" title="Celeryçš„å®‰è£…é…ç½®"></a><code>Celery</code>çš„å®‰è£…é…ç½®</h2><h3 id="å®‰è£…-Celery"><a href="#å®‰è£…-Celery" class="headerlink" title="å®‰è£… Celery"></a>å®‰è£… <code>Celery</code></h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip install celery</span><br></pre></td></tr></table></figure><p>å®‰è£…æ—¶ä¼šè‡ªåŠ¨è§£å†³ä¾èµ–ï¼š<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Installing collected packages: vine, amqp, kombu, billiard, celery</span><br></pre></td></tr></table></figure><br>éªŒè¯<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">celery --version</span><br><span class="line">4.3.0 (rhubarb)</span><br></pre></td></tr></table></figure></p><h3 id="ä¸-redis-ç»“åˆä½¿ç”¨"><a href="#ä¸-redis-ç»“åˆä½¿ç”¨" class="headerlink" title="ä¸ redis ç»“åˆä½¿ç”¨"></a>ä¸ <code>redis</code> ç»“åˆä½¿ç”¨</h3><p>redis å®‰è£…å¯ä»¥å‚è€ƒä¹‹å‰å†™çš„è¿™ç¯‡æ–‡ç« <a href="https://imoyao.github.io/blog/2019-04-11/how-to-install-Redis-on-Linux/">Linux ä¸‹å¦‚ä½•å®‰è£… Redisï¼Ÿ</a></p><p><strong>æ³¨æ„</strong>ï¼š æ­¤å¤„éœ€è¦åŒæ—¶å®‰è£…<code>redis</code>å®¢æˆ·ç«¯å’Œ<code>redis</code>çš„<code>Python</code>æ”¯æŒã€‚</p><h3 id="éªŒè¯ç»“æœ"><a href="#éªŒè¯ç»“æœ" class="headerlink" title="éªŒè¯ç»“æœ"></a>éªŒè¯ç»“æœ</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">imoyao@local:~$ redis-cli</span><br><span class="line">127.0.0.1:6379&gt; keys *</span><br><span class="line">1) &quot;_kombu.binding.celery&quot;</span><br><span class="line">2) &quot;celery-task-meta-a9db6911-e15a-4b9e-b321-958f5298652a&quot;</span><br><span class="line">3) &quot;celery-task-meta-e22b0603-8117-4f0d-ac6b-ad621738e256&quot;</span><br><span class="line">4) &quot;unacked_mutex&quot;</span><br><span class="line">5) &quot;_kombu.binding.celery.pidbox&quot;</span><br><span class="line">6) &quot;celery-task-meta-aac524bd-cb47-4493-b0dd-9712a98a3f14&quot;</span><br><span class="line">7) &quot;_kombu.binding.celeryev&quot;</span><br><span class="line">8) &quot;celery-task-meta-ccd8d274-7f14-4abc-8244-e80f01932097&quot;</span><br><span class="line">9) &quot;celery-task-meta-3b2b3efa-4ad7-4c7e-b92d-27636eaeaa6b&quot;</span><br><span class="line">127.0.0.1:6379&gt; get celery-task-meta-a9db6911-e15a-4b9e-b321-958f5298652a</span><br><span class="line">&quot;&#123;\&quot;status\&quot;: \&quot;SUCCESS\&quot;, \&quot;result\&quot;: 30, \&quot;traceback\&quot;: null, \&quot;children\&quot;: [], \&quot;task_id\&quot;: \&quot;a9db6911-e15a-4b9e-b321-958f5298652a\&quot;, \&quot;date_done\&quot;: \&quot;2019-06-13T18:43:43.491009\&quot;&#125;&quot;</span><br></pre></td></tr></table></figure><h2 id="å¦‚ä½•åœ¨é¡¹ç›®ä¸­ä½¿ç”¨Celery"><a href="#å¦‚ä½•åœ¨é¡¹ç›®ä¸­ä½¿ç”¨Celery" class="headerlink" title="å¦‚ä½•åœ¨é¡¹ç›®ä¸­ä½¿ç”¨Celery"></a>å¦‚ä½•åœ¨é¡¹ç›®ä¸­ä½¿ç”¨<code>Celery</code></h2><p>ä»¥ä¸<code>Flask</code>ç»“åˆä¸ºä¾‹(ä½¿ç”¨<code>redis</code>ä½œä¸º<code>backend</code>)</p><ul><li>åˆ›å»º<code>celery</code>å®ä¾‹</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># app\__init__.py</span></span><br><span class="line"><span class="keyword">from</span> celery <span class="keyword">import</span> Celery</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">init_celery</span>(<span class="params">app</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    å‚è§ï¼šhttp://docs.jinkan.org/docs/flask/patterns/celery.html</span></span><br><span class="line"><span class="string">    åˆå§‹åŒ–celery</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    celery = Celery(app.import_name, broker=app.config[<span class="string">&#x27;CELERY_BROKER_URL&#x27;</span>])</span><br><span class="line">    celery.conf.update(app.config)</span><br><span class="line">    TaskBase = celery.Task</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">ContextTask</span>(<span class="params">TaskBase</span>):</span></span><br><span class="line">        abstract = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">__call__</span>(<span class="params">self, *args, **kwargs</span>):</span></span><br><span class="line">            <span class="keyword">with</span> app.app_context():</span><br><span class="line">                <span class="keyword">return</span> TaskBase.__call__(self, *args, **kwargs)</span><br><span class="line"></span><br><span class="line">    celery.Task = ContextTask</span><br><span class="line">    <span class="keyword">return</span> celery</span><br></pre></td></tr></table></figure><ul><li>åˆ›å»ºåå°ä»»åŠ¡</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> celery.utils.log <span class="keyword">import</span> get_task_logger</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> app <span class="keyword">import</span> create_app, init_celery</span><br><span class="line"></span><br><span class="line">lg = get_task_logger(__name__)      <span class="comment"># è®°å½•æ—¥å¿—</span></span><br><span class="line">celery = init_celery(create_app(os.getenv(<span class="string">&#x27;FLASK_CONFIG&#x27;</span>, <span class="string">&#x27;default&#x27;</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># @celery.task(name=&#x27;pmrearend.task.log_it&#x27;)        # æ­¤å¤„æ˜¯è§£å†³å¯¼å…¥å¤±è´¥çš„ä¸€ç§æ–¹æ¡ˆï¼Œä½†æ˜¯æ„Ÿè§‰ä¸å¤Ÿä¼˜é›…ï¼Œéœ€è¦æ·±å…¥äº†è§£</span></span><br><span class="line"><span class="meta">@celery.task</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">log_it</span>(<span class="params">num1, num2</span>):</span></span><br><span class="line">    msg = num1 + num2</span><br><span class="line">    print(msg)</span><br><span class="line">    lg.debug(<span class="string">&quot;in log_test()&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> msg</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># task = log_it.delay(5,8)</span></span><br><span class="line">    task = log_it.apply_async(args=[<span class="number">10</span>, <span class="number">20</span>], countdown=<span class="number">10</span>)</span><br></pre></td></tr></table></figure><ul><li>æ–°å»ºç›®å½•åŠæ–‡ä»¶  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo mkdir -p /var/<span class="built_in">log</span>/celery/</span><br><span class="line">sudo touch /var/<span class="built_in">log</span>/celery/celery.log </span><br></pre></td></tr></table></figure></li><li><p>å¯åŠ¨ celery worker æœåŠ¡</p>  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">celery -A task worker -l debug -f /var/<span class="built_in">log</span>/celery/celery.log</span><br></pre></td></tr></table></figure></li></ul><hr><h3 id="é‡åˆ°çš„é—®é¢˜è®°å½•"><a href="#é‡åˆ°çš„é—®é¢˜è®°å½•" class="headerlink" title="é‡åˆ°çš„é—®é¢˜è®°å½•"></a>é‡åˆ°çš„é—®é¢˜è®°å½•</h3><ol><li><p>sqlalchemy.exc.InvalidRequestError</p> <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlalchemy.exc.InvalidRequestError: Table <span class="string">&#x27;user&#x27;</span> is already defined <span class="keyword">for</span> this MetaData instance.  </span><br><span class="line">Specify <span class="string">&#x27;extend_existing=True&#x27;</span> to redefine options and columns on an existing Table object.</span><br><span class="line"></span><br></pre></td></tr></table></figure><p> è§£å†³ï¼šåœ¨å¯¹åº” model ä¸­æ·»åŠ <code>&#39;extend_existing&#39;: True</code></p> <figure class="highlight python"><table><tr><td class="code"><pre><span class="line">__table_args__ = &#123;<span class="string">&#x27;extend_existing&#x27;</span>: <span class="literal">True</span>&#125;</span><br></pre></td></tr></table></figure></li><li><p>celery: command not found</p> <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo: celery: <span class="built_in">command</span> not found</span><br></pre></td></tr></table></figure><p> è§£å†³ï¼šæŒ‰ç…§ç»å¯¹è·¯å¾„è°ƒç”¨<code>celery</code></p> <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">which</span> celery</span><br><span class="line">/home/imoyao/envs/py3flk/bin/celery</span><br></pre></td></tr></table></figure><p> æ›¿æ¢æ­¤å¤„<code>celery</code>çš„ä½ç½®å³å¯è¿è¡Œï¼ˆTODOï¼šä¸å¤Ÿä¼˜é›…ï¼Œæš‚æ—¶æµ‹è¯•æ€§è§£å†³æ–¹æ¡ˆï¼‰</p> <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo /home/imoyao/envs/py3flk/bin/celery -A pmrearend.task worker -l debug -f /var/<span class="built_in">log</span>/celery/celery.log</span><br></pre></td></tr></table></figure></li><li><p>æ²¡æœ‰å¯¼å…¥<code>task</code>æ¨¡å—</p> <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[2019-06-14 02:32:40,115: ERROR/MainProcess] Received unregistered task of <span class="built_in">type</span> <span class="string">&#x27;pmrearend.log_it&#x27;</span>.</span><br><span class="line">The message has been ignored and discarded.</span><br><span class="line"></span><br><span class="line">Did you remember to import the module containing this task?</span><br><span class="line">Or maybe you<span class="string">&#x27;re using relative imports?</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure><p> è§£å†³ï¼šæ¯ä¸ªä»»åŠ¡å¿…é¡»æœ‰ä¸åŒçš„åç§°ã€‚å¦‚æœæ²¡æœ‰æ˜¾ç¤ºæä¾›åç§°ï¼Œä»»åŠ¡è£…é¥°å™¨å°†ä¼šè‡ªåŠ¨äº§ç”Ÿä¸€ä¸ªï¼Œäº§ç”Ÿçš„åç§°ä¼šåŸºäºè¿™äº›ä¿¡æ¯ï¼š 1ï¼‰ä»»åŠ¡å®šä¹‰æ‰€åœ¨çš„æ¨¡å—ï¼Œ 2ï¼‰ä»»åŠ¡å‡½æ•°çš„åç§°</p><p> æ˜¾ç¤ºè®¾ç½®ä»»åŠ¡åç§°çš„ä¾‹å­ï¼šåœ¨è£…é¥°å™¨<a href="mailto:`@app.task">`@app.task</a><code>ä¸­åŠ å…¥å‚æ•°</code>name<code>ï¼Œå°±å¯ä»¥è¢«</code>celery`è¯»å–åˆ°ã€‚  </p> <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@celery.task(<span class="params">name=<span class="string">&#x27;pmrearend.task.log_it&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">log_it</span>(<span class="params">num1, num2</span>):</span></span><br><span class="line">    msg = num1 + num2</span><br><span class="line">    print(msg)</span><br><span class="line">    lg.debug(<span class="string">&quot;in log_test()&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> msg</span><br><span class="line">```   </span><br><span class="line">æ­£å¸¸è¿è¡Œç»“æœ</span><br><span class="line"></span><br><span class="line">```plain</span><br><span class="line">[<span class="number">2019</span>-06-<span class="number">14</span> 02:<span class="number">43</span>:<span class="number">43</span>,<span class="number">139</span>: DEBUG/MainProcess] TaskPool: Apply &lt;function _fast_trace_task at <span class="number">0x7f72a03fef28</span>&gt; (args:(<span class="string">&#x27;pmrearend.task.log_it&#x27;</span>, <span class="string">&#x27;a9db6911-e15a-4b9e-b321-958f5298652a&#x27;</span>, &#123;<span class="string">&#x27;lang&#x27;</span>: <span class="string">&#x27;py&#x27;</span>, <span class="string">&#x27;task&#x27;</span>: <span class="string">&#x27;pmrearend.task.log_it&#x27;</span>, <span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;a9db6911-e15a-4b9e-b321-958f5298652a&#x27;</span>, <span class="string">&#x27;shadow&#x27;</span>: <span class="literal">None</span>, <span class="string">&#x27;eta&#x27;</span>: <span class="string">&#x27;2019-06-13T18:43:43.139123+00:00&#x27;</span>, <span class="string">&#x27;expires&#x27;</span>: <span class="literal">None</span>, <span class="string">&#x27;group&#x27;</span>: <span class="literal">None</span>, <span class="string">&#x27;retries&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;timelimit&#x27;</span>: [<span class="literal">None</span>, <span class="literal">None</span>], <span class="string">&#x27;root_id&#x27;</span>: <span class="string">&#x27;a9db6911-e15a-4b9e-b321-958f5298652a&#x27;</span>, <span class="string">&#x27;parent_id&#x27;</span>: <span class="literal">None</span>, <span class="string">&#x27;argsrepr&#x27;</span>: <span class="string">&#x27;[10, 20]&#x27;</span>, <span class="string">&#x27;kwargsrepr&#x27;</span>: <span class="string">&#x27;&#123;&#125;&#x27;</span>, <span class="string">&#x27;origin&#x27;</span>: <span class="string">&#x27;gen4669@local&#x27;</span>, <span class="string">&#x27;reply_to&#x27;</span>: <span class="string">&#x27;a2563c50-9249-3718-85a8-9ad44174831c&#x27;</span>, <span class="string">&#x27;correlation_id&#x27;</span>: <span class="string">&#x27;a9db6911-e15a-4b9e-b321-958f5298652a&#x27;</span>, <span class="string">&#x27;delivery_info&#x27;</span>: &#123;<span class="string">&#x27;exchange&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;routing_key&#x27;</span>: <span class="string">&#x27;celery&#x27;</span>, <span class="string">&#x27;priority&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;redelivered&#x27;</span>: <span class="literal">None</span>&#125;&#125;, <span class="string">b&#x27;[[10, 20], &#123;&#125;, &#123;&quot;callbacks&quot;: null, &quot;errbacks&quot;: null, &quot;chain&quot;: null, &quot;chord&quot;: null&#125;]&#x27;</span>, <span class="string">&#x27;application/json&#x27;</span>, <span class="string">&#x27;utf-8&#x27;</span>) kwargs:&#123;&#125;)</span><br><span class="line">[2019-06-14 02:43:43,281: DEBUG/MainProcess] basic.qos: prefetch_count-&gt;4</span><br><span class="line">[<span class="number">2019</span>-06-<span class="number">14</span> 02:<span class="number">43</span>:<span class="number">43</span>,<span class="number">284</span>: WARNING/ForkPoolWorker-<span class="number">1</span>] <span class="number">30</span></span><br><span class="line">[<span class="number">2019</span>-06-<span class="number">14</span> 02:<span class="number">43</span>:<span class="number">43</span>,<span class="number">286</span>: DEBUG/MainProcess] Task accepted: pmrearend.task.log_it[a9db6911-e15a-4b9e-b321-958f5298652a] pid:<span class="number">4089</span></span><br><span class="line">[<span class="number">2019</span>-06-<span class="number">14</span> 02:<span class="number">43</span>:<span class="number">43</span>,<span class="number">287</span>: DEBUG/ForkPoolWorker-<span class="number">1</span>] pmrearend.task.log_it[a9db6911-e15a-4b9e-b321-958f5298652a]: <span class="keyword">in</span> log_test()</span><br><span class="line">[<span class="number">2019</span>-06-<span class="number">14</span> 02:<span class="number">43</span>:<span class="number">43</span>,<span class="number">504</span>: INFO/ForkPoolWorker-<span class="number">1</span>] Task pmrearend.task.log_it[a9db6911-e15a-4b9e-b321-958f5298652a] succeeded <span class="keyword">in</span> <span class="number">0.22014467700500973</span>s: <span class="number">30</span></span><br><span class="line">[<span class="number">2019</span>-06-<span class="number">14</span> 02:<span class="number">43</span>:<span class="number">44</span>,<span class="number">751</span>: INFO/MainProcess] Received task: pmrearend.task.log_it[aac524bd-cb47-<span class="number">4493</span>-b0dd-9712a98a3f14]  ETA:[<span class="number">2019</span>-06-<span class="number">13</span> <span class="number">18</span>:<span class="number">43</span>:<span class="number">54.619709</span>+<span class="number">00</span>:<span class="number">00</span>] </span><br><span class="line">[2019-06-14 02:43:44,752: DEBUG/MainProcess] basic.qos: prefetch_count-&gt;5</span><br><span class="line">[<span class="number">2019</span>-06-<span class="number">14</span> 02:<span class="number">43</span>:<span class="number">54</span>,<span class="number">621</span>: DEBUG/MainProcess] TaskPool: Apply &lt;function _fast_trace_task at <span class="number">0x7f72a03fef28</span>&gt; (args:(<span class="string">&#x27;pmrearend.task.log_it&#x27;</span>, <span class="string">&#x27;aac524bd-cb47-4493-b0dd-9712a98a3f14&#x27;</span>, &#123;<span class="string">&#x27;lang&#x27;</span>: <span class="string">&#x27;py&#x27;</span>, <span class="string">&#x27;task&#x27;</span>: <span class="string">&#x27;pmrearend.task.log_it&#x27;</span>, <span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;aac524bd-cb47-4493-b0dd-9712a98a3f14&#x27;</span>, <span class="string">&#x27;shadow&#x27;</span>: <span class="literal">None</span>, <span class="string">&#x27;eta&#x27;</span>: <span class="string">&#x27;2019-06-13T18:43:54.619709+00:00&#x27;</span>, <span class="string">&#x27;expires&#x27;</span>: <span class="literal">None</span>, <span class="string">&#x27;group&#x27;</span>: <span class="literal">None</span>, <span class="string">&#x27;retries&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;timelimit&#x27;</span>: [<span class="literal">None</span>, <span class="literal">None</span>], <span class="string">&#x27;root_id&#x27;</span>: <span class="string">&#x27;aac524bd-cb47-4493-b0dd-9712a98a3f14&#x27;</span>, <span class="string">&#x27;parent_id&#x27;</span>: <span class="literal">None</span>, <span class="string">&#x27;argsrepr&#x27;</span>: <span class="string">&#x27;[10, 20]&#x27;</span>, <span class="string">&#x27;kwargsrepr&#x27;</span>: <span class="string">&#x27;&#123;&#125;&#x27;</span>, <span class="string">&#x27;origin&#x27;</span>: <span class="string">&#x27;gen4706@local&#x27;</span>, <span class="string">&#x27;reply_to&#x27;</span>: <span class="string">&#x27;ee66dc1c-aebd-3111-9ef4-f07a71943fc0&#x27;</span>, <span class="string">&#x27;correlation_id&#x27;</span>: <span class="string">&#x27;aac524bd-cb47-4493-b0dd-9712a98a3f14&#x27;</span>, <span class="string">&#x27;delivery_info&#x27;</span>: &#123;<span class="string">&#x27;exchange&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;routing_key&#x27;</span>: <span class="string">&#x27;celery&#x27;</span>, <span class="string">&#x27;priority&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;redelivered&#x27;</span>: <span class="literal">None</span>&#125;&#125;, <span class="string">b&#x27;[[10, 20], &#123;&#125;, &#123;&quot;callbacks&quot;: null, &quot;errbacks&quot;: null, &quot;chain&quot;: null, &quot;chord&quot;: null&#125;]&#x27;</span>, <span class="string">&#x27;application/json&#x27;</span>, <span class="string">&#x27;utf-8&#x27;</span>) kwargs:&#123;&#125;)</span><br><span class="line">[2019-06-14 02:43:54,631: DEBUG/MainProcess] basic.qos: prefetch_count-&gt;4</span><br><span class="line">[<span class="number">2019</span>-06-<span class="number">14</span> 02:<span class="number">43</span>:<span class="number">54</span>,<span class="number">637</span>: WARNING/ForkPoolWorker-<span class="number">1</span>] <span class="number">30</span></span><br><span class="line">[<span class="number">2019</span>-06-<span class="number">14</span> 02:<span class="number">43</span>:<span class="number">54</span>,<span class="number">639</span>: DEBUG/ForkPoolWorker-<span class="number">1</span>] pmrearend.task.log_it[aac524bd-cb47-<span class="number">4493</span>-b0dd-9712a98a3f14]: <span class="keyword">in</span> log_test()</span><br><span class="line">[<span class="number">2019</span>-06-<span class="number">14</span> 02:<span class="number">43</span>:<span class="number">54</span>,<span class="number">645</span>: DEBUG/MainProcess] Task accepted: pmrearend.task.log_it[aac524bd-cb47-<span class="number">4493</span>-b0dd-9712a98a3f14] pid:<span class="number">4089</span></span><br><span class="line">[<span class="number">2019</span>-06-<span class="number">14</span> 02:<span class="number">43</span>:<span class="number">54</span>,<span class="number">650</span>: INFO/ForkPoolWorker-<span class="number">1</span>] Task pmrearend.task.log_it[aac524bd-cb47-<span class="number">4493</span>-b0dd-9712a98a3f14] succeeded <span class="keyword">in</span> <span class="number">0.012691148993326351</span>s: <span class="number">30</span></span><br></pre></td></tr></table></figure><h2 id="é—®é¢˜è®°å½•"><a href="#é—®é¢˜è®°å½•" class="headerlink" title="é—®é¢˜è®°å½•"></a>é—®é¢˜è®°å½•</h2></li></ol><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">celery.platforms.LockFailed: [Errno 13] Permission denied: <span class="string">&#x27;/home/xxx/celerybeat.pid&#x27;</span></span><br><span class="line">```    </span><br><span class="line">pid æ–‡ä»¶æ²¡æœ‰æƒé™ï¼›è¿™ç§æƒ…å†µæœ‰ä¸¤ç§è§£å†³åŠæ³•ï¼š</span><br><span class="line"></span><br><span class="line">- ä¿®æ”¹ pid æ–‡ä»¶å­˜å‚¨è·¯å¾„ï¼Œæ”¾åˆ°å½“å‰æ‰§è¡Œç”¨æˆ·æœ‰æƒé™çš„ä½ç½®</span><br><span class="line"></span><br><span class="line">    ```bash</span><br><span class="line">    celery beat -A celeryapp --loglevel=INFO --pidfile=<span class="string">&quot;/tmp/celerybeat.pid&quot;</span>        <span class="comment"># ä¿®æ”¹è·¯å¾„</span></span><br></pre></td></tr></table></figure><ul><li>å¯¹ pid æ–‡ä»¶æ‰€åœ¨ç›®å½•åŠ æƒé™ï¼Œç„¶åæ‰§è¡Œï¼š<br><code>bashchown -R YOUR_USER_NAME:YOUR_USER_NAME  CURRENT_PATHcelery -A celery_worker:celery beat --loglevel=INFO</code>plain<br><a href="https://github.com/celery/celery/issues/3828">å‚è§è¿™é‡Œ</a></li></ul><h2 id="æ³¨æ„é—®é¢˜"><a href="#æ³¨æ„é—®é¢˜" class="headerlink" title="æ³¨æ„é—®é¢˜"></a>æ³¨æ„é—®é¢˜</h2><p><strong>ä¸è¦</strong>å°† task å†™è¿›ç±»ä¸­ï¼Œå› ä¸ºå¯èƒ½å¯¼è‡´æ‰§è¡Œå‡ºé”™ç­‰å„ç§é—®é¢˜ï¼Œå¦‚æœçœŸçš„è¦è¿™ä¹ˆåšï¼Œå¯ä»¥å‚è€ƒè¿™é‡Œï¼š<br>å‚è§ <a href="https://stackoverflow.com/questions/9250317/using-class-methods-as-celery-tasks">using class methods as celery tasks</a></p><h2 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h2><p>å› ä¸ºä¸ªäººæ—¶é—´å…³ç³»ï¼Œè¿™ä¸ªæš‚æ—¶æ²¡æœ‰å­¦å®Œã€‚å…³äº<code>Celery</code>çš„ä½¿ç”¨éœ€è¦è¿›ä¸€æ­¥å®è·µå­¦ä¹ ã€‚</p><h2 id="å‚è€ƒé˜…è¯»"><a href="#å‚è€ƒé˜…è¯»" class="headerlink" title="å‚è€ƒé˜…è¯»"></a>å‚è€ƒé˜…è¯»</h2><p><a href="http://docs.celeryproject.org/en/latest/">Celery 4.3.0 documentation Â»</a><br><a href="https://www.jianshu.com/p/807efde55d81">åœ¨ Flask ä¸­ä½¿ç”¨ Celery çš„æœ€ä½³å®è·µ</a><br><a href="https://blog.csdn.net/libing_thinking/article/details/78547816">Celery ä¸­æ–‡æ–‡æ¡£</a><br><a href="https://blog.csdn.net/libing_thinking/article/details/78563222">Celery-4.1 ç”¨æˆ·æŒ‡å—: Calling Tasks</a></p><h2 id="ç›¸å…³ä»£ç åº“"><a href="#ç›¸å…³ä»£ç åº“" class="headerlink" title="ç›¸å…³ä»£ç åº“"></a>ç›¸å…³ä»£ç åº“</h2><p><a href="https://github.com/nebularazer/flask-celery-example">1</a><br><a href="https://github.com/chiqj/flask-with-celery-example">2</a> </p>]]></content>
      
      
      <categories>
          
          <category> å·¥ä½œæ—¥å¸¸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flask </tag>
            
            <tag> TODO </tag>
            
            <tag> HOWTO </tag>
            
            <tag> Celery </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æˆ‘çš„å¼€æºåšå®¢ idealyard å¿ƒè·¯å†ç¨‹åŠå…¶ä»–</title>
      <link href="blog/2019-06-17/blog-idealyard-update-history-v1/"/>
      <url>blog/2019-06-17/blog-idealyard-update-history-v1/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><p>ä»Šå¤©ï¼ˆ2019-09-12ï¼‰åŸºæœ¬å®Œæˆäº†åšå®¢ç³»ç»Ÿâ€”â€” <a href="https://github.com/imoyao/idealyard">IdealYard</a> çš„é›å½¢ï¼Œå½“ç„¶ï¼Œè¿™è·ç¦»è‡»äºå®Œç¾è¿˜æœ‰å¾ˆé•¿çš„è·¯è¦èµ°ã€‚ä½†æ­£æ‰€è°“ä¸æ€•èµ°ä¸åˆ°å¤´ï¼Œå°±æ€•ä¸€ç›´ä¸æ•¢å‡ºå‘ã€‚è™½ç„¶æ˜¯ä¸ªä¸èµ·çœ¼çš„é¡¹ç›®ï¼Œä½†æ˜¯ä»æ— åˆ°æœ‰ä¹Ÿæ¶ˆè€—äº†ä¸å°‘ç²¾åŠ›ï¼Œæ‰€ä»¥æœ‰å¿…è¦åšä¸ªç®€å•è®°å½•ã€‚</p><h2 id="ç¼˜èµ·"><a href="#ç¼˜èµ·" class="headerlink" title="ç¼˜èµ·"></a>ç¼˜èµ·</h2><p>ä¸€åˆ‡ç¼˜èµ·ï¼Œéƒ½è¦ä»ä¸˜å¤„æœºè·¯è¿‡ç‰›å®¶æ‘çš„é‚£ä¸ªä¸‹åˆè¯´èµ·â€¦â€¦<br>æ—©å°±æƒ³åŠ¨æ‰‹æ­å»ºä¸€ä¸ªå±äºè‡ªå·±çš„åšå®¢é¡¹ç›®ï¼Œä½†æ˜¯ä½œä¸ºä¸€åå‡ºè‰²çš„å›½å®¶ä¸€çº§é€€å ‚é¼“è¡¨æ¼”å®¶ï¼Œæ€»æ˜¯æ‰¾å„ç§ç†ç”±ï¼Œä¸€ç›´æœªèƒ½è®¡åˆ’æˆå‹è½å®ã€‚æœ€åï¼Œç»ˆäºåœ¨ G å°å§çš„é¼“èˆä¸‹å¼€å§‹ç€æ‰‹ç¼–ç äº†ã€‚<br><img src= "/img/loading.svg" data-lazy-src="/images/wx_img_20190910153859.jpg" alt="ä¸è¯•è¯•ï¼Œæ€ä¹ˆçŸ¥é“è‡ªå·±åšä¸åˆ°å‘¢ï¼Ÿ"></p><h2 id="æŠ€æœ¯é€‰å‹"><a href="#æŠ€æœ¯é€‰å‹" class="headerlink" title="æŠ€æœ¯é€‰å‹"></a>æŠ€æœ¯é€‰å‹</h2><p>å› ä¸ºä¸»è¦å¼€å‘è¯­è¨€æ˜¯ Pythonï¼Œè€Œç›®å‰ Python ç¤¾åŒºå·²ç»å‘å‡ºå…¬å‘Šå°†åœ¨ 2020 å¹´åˆåœæ­¢ Python2 çš„ç»´æŠ¤ã€‚å› æ­¤ï¼Œé€‰æ‹©ä½¿ç”¨ Python3 ä½œä¸ºåŸºæœ¬ç‰ˆæœ¬æ”¯æŒã€‚åœ¨ <a href="/blog/2019-06-05/Flask-vs-webpy/">æ¡†æ¶é€‰æ‹©</a> é—®é¢˜ä¸Šï¼Œè™½ç„¶ä¹‹å‰ä¸»è¦ä½¿ç”¨ Web.py å¼€å‘ï¼Œä½†é‰´äº Web.py ç›®å‰çš„ç»´æŠ¤ç°çŠ¶å’Œç¤¾åŒºæ´»è·ƒåº¦ï¼Œæ‰€ä»¥é€‰æ‹©æ›´å—å¼€å‘è€…é’ççš„ Flask ä½œä¸ºåç«¯ web å¼€å‘æ¡†æ¶ï¼›æ­¤å¤–ï¼Œä½¿ç”¨åˆ° Celery åšä¸€äº›è€—æ—¶è¯·æ±‚å¼‚æ­¥å¤„ç†ï¼Œå¦‚æ³¨å†ŒéªŒè¯é‚®ä»¶å‘é€å’Œåšå®¢æ•°æ®åº“å¤‡ä»½ï¼ˆç”±äºæ—¶é—´å…³ç³»æš‚æ—¶æœªåšï¼‰ã€‚è€Œå‰ç«¯åˆ™ä½¿ç”¨ç›®å‰çƒ­é—¨çš„æ¡†æ¶ Vue å’Œ Element-UI æ¥æ„å»ºã€‚</p><h2 id="å¿ƒè·¯å†ç¨‹"><a href="#å¿ƒè·¯å†ç¨‹" class="headerlink" title="å¿ƒè·¯å†ç¨‹"></a>å¿ƒè·¯å†ç¨‹</h2><p>è™½ç„¶ Python2 ä¸ Python3 ä¹‹é—´æœ‰è¯­æ³•åŒºåˆ«ï¼Œä½†æ˜¯åŸºæœ¬ç”¨æ³•æ–¹é¢ä¹Ÿæ²¡æœ‰åˆ°â€œå­¦ä¹ ä¸€ç§æ–°è¯­è¨€â€çš„åœ°æ­¥ï¼Œæ‰€ä»¥è¿˜ç®—é¡ºåˆ©ã€‚è€Œ Flask ä½œä¸ºâ€œä¸€æ¬¡ä¸€æ»´â€çš„è½»å‹æ¡†æ¶ï¼Œåœ¨åˆšå¼€å§‹çš„æ—¶å€™å­¦ä¹ æ¯ä¸€ä¸ªå­æ¨¡å—çš„ä½¿ç”¨æ„Ÿè§‰æœ‰ç‚¹ç¹çï¼Œç”¨è¿‡å‡ ä¸ªä¹‹åæ„Ÿè§‰ä¹ŸæŒºé¡ºåˆ©å¹¶é€æ¸å–œæ¬¢ä¸Šäº†è¿™ç§ç†å¿µã€‚</p><p>å‰ç«¯æ–¹é¢å‘¢ï¼Œç”±äºä¹‹å‰ä¸€ç›´ä½¿ç”¨ <code>jQuery</code> æ“ä½œ DOMï¼Œæ‰€ä»¥ä¸€å¼€å§‹å¹¶ä¸ä¹ æƒ¯è¿™ç§ <code>MVVM</code> è®¾è®¡æ¨¡å¼ï¼Œå°¤å…¶æ˜¯å¯¹ç”Ÿå‘½å‘¨æœŸçš„ç†è§£ä¸å¤Ÿåˆ°ä½ã€‚è¯è¯´å›æ¥ï¼Œç›®å‰æ¥è¯´ä¹Ÿè¿˜æ˜¯æœ‰å¾ˆå¤šåœ°æ–¹ç†è§£ä¸å¤Ÿé€å½»ï¼Œä½†æ˜¯åŸºæœ¬èƒ½å¤Ÿå®ç°åŠŸèƒ½å¹¶ç®€å•ä¼˜åŒ–ã€‚å½“ç„¶ï¼Œé“è·¯æ˜¯å´å²–çš„ï¼Œæ¯”å¦‚åœ¨ä½¿ç”¨ <code>axios</code> å‘é€è¯·æ±‚è¿æ¥å‰åç«¯çš„æ—¶å€™ï¼Œå°±å‡ºç°äº†ä¸€äº›é—®é¢˜ï¼Œå°¤å…¶æ˜¯åœ¨è®¤è¯ç¯èŠ‚è€—è´¹äº†ä¸å°‘æ—¶é—´ã€‚å…¶å®æ˜¯ä¸€ä¸ªå¾ˆç»†å¾®çš„ç‚¹ï¼Œä½†æ˜¯å› ä¸ºå‘¨å›´çš„åŒäº‹éƒ½æ²¡æœ‰è¿™æ–¹é¢çš„å¼€å‘ç»éªŒï¼Œæ‰€ä»¥ä¸€ä¸ªäººç¢ç£¨è¿˜æ˜¯èŠ±è´¹äº†ä¸å°‘çš„æ—¶é—´ã€‚</p><p>å›é¦–çœ‹æ¥ï¼Œæ²¡æœ‰æ‰“è´¥ä½ çš„æœ€ç»ˆéƒ½ä¼šè®©ä½ æ›´åŠ å¼ºå¤§ï¼Œä¸è¿‡åœ¨ç¬¬ä¸€æ¬¡é¢å¯¹è¿™äº›é—®é¢˜çš„æ—¶å€™è¿˜çœŸæ˜¯æœ‰ç‚¹æ‰¾ä¸åˆ°åŒ—ã€‚</p><h2 id="é¢„è§ˆ"><a href="#é¢„è§ˆ" class="headerlink" title="é¢„è§ˆ"></a>é¢„è§ˆ</h2><iframe class="bilibili" src="https://xbeibeix.com/api/bilibili/biliplayer/?url=BV11v411v76q" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe><p>å¦‚æœä¸Šæ–¹æ— æ³•æ‰“å¼€ï¼Œè¯·è®¿é—®ä¸‹æ–¹é“¾æ¥ã€‚</p><iframe class="bilibili" src="//player.bilibili.com/player.html?aid=244176193&bvid=BV11v411v76q&cid=221300555&page=1&high_quality=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe><h2 id="äº¤æµ"><a href="#äº¤æµ" class="headerlink" title="äº¤æµ"></a>äº¤æµ</h2><ol><li>æŠ€æœ¯é—®é¢˜è¯·å°½é‡ä½¿ç”¨<a href="https://github.com/imoyao/idealyard/issues">Issues Â· imoyao/idealyard</a>æé—®å›é¦ˆç¤¾åŒºï¼Œå‚é˜…ï¼š<a href="https://github.com/imoyao/idealyard/issues/15">Issue #15 Â· imoyao/idealyard</a></li><li>åœ¨ç½‘å‹çš„æè®®ä¸‹å»ºç«‹äº† QQ ç¾¤ï¼Œç¾¤å·ï¼š613922612ã€‚ä½†æ˜¯è¯·æ³¨æ„ï¼šè¯¥é¡¹ç›®ä¸ºå•çº¯å¼€æºï¼Œæœ¬äººå¹¶ä¸é æ­¤ç›ˆåˆ©ï¼ˆæœ‰è‡ªå·±çš„ç –è¦æ¬ï¼‰ï¼Œåœ¨å¯é¢„è§çš„æœªæ¥ä¹Ÿ<strong>æ²¡æœ‰å¯èƒ½</strong>æŠ•å…¥åˆ°ä¸ºå¤§å®¶ç­”ç–‘è§£æƒ‘ä¸­å»ã€‚æ‰€ä»¥è¯¥ç¾¤çš„ç›®çš„æ›´å¤šæ˜¯å»ºç«‹ä¸€ä¸ªå°ç™½ä¹‹é—´äº’ç›¸äº¤æµçš„é€”å¾„ã€‚å¦‚æœå¯èƒ½ï¼Œè¯·åœ¨å…¬å¼€åœºåˆè®¨è®ºä½ çš„é—®é¢˜è€Œä¸æ˜¯ç®€å•åœ°æŠ›å‡ºæˆªå›¾ç­‰å¾…ç­”æ¡ˆã€‚</li></ol><p><img src= "/img/loading.svg" data-lazy-src="https://cdn.jsdelivr.net/gh/imoyao/idealyard@master/document/src/idealyard-qq-group.png" alt="QQ ç¾¤æ‰«ç å…³æ³¨"></p><a target="_blank" href="https://qm.qq.com/cgi-bin/qm/qr?k=Em75uvDaupjSZzL-Y_C9FqzzFUUPiBAA&jump_from=webapi"><img border="0" src= "/img/loading.svg" data-lazy-src="//pub.idqqimg.com/wpa/images/group.png" alt="è„šè¸å®åœ°ï¼Œä»°æœ›æ˜Ÿç©º" title="Flask äº¤æµç¾¤"></a><ol start="3"><li>å‹å–„ã€å‹å–„ã€å‹å–„ã€‚ç½‘ç»œä¸€çº¿ç‰µï¼Œçæƒœè¿™æ®µç¼˜ã€‚è¯·åŠ¡å¿…å’Œå–„ã€è¯šæ³åœ°å¯¹å¾…å…¶ä»–åŒå­¦ã€‚</li></ol><h2 id="å±•æœ›"><a href="#å±•æœ›" class="headerlink" title="å±•æœ›"></a>å±•æœ›</h2><p>ç›®å‰åŸºæœ¬å®Œæˆäº†ä¸€ä¸ªåšå®¢çš„å®Œæ•´åŠŸèƒ½ï¼Œä½†æ˜¯å…¶å®è¿˜æœ‰å¾ˆå¤šçš„å° Bug éœ€è¦è§£å†³ã€‚è€Œä¸”åœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­åˆäº§ç”Ÿäº†ä¸€äº›æ–°æƒ³æ³•ï¼Œè¿˜éœ€è¦è‡ªå·±æŠ½æ—¶é—´è½åœ°ã€‚å…·ä½“è¯·é˜…è¯» <a href="/blog/2019-08-29/blog-idealyard-TODO/">æˆ‘çš„åšå®¢ idealyard å¾…åŠäº‹é¡¹è®°å½•</a>ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>æœ¬åšå®¢åœ¨ç¼–å†™è¿‡ç¨‹ä¸­ä¸»è¦å‚è€ƒé“¾æ¥å’Œä¹¦ç›®æœ‰ï¼š</p><ul><li><a href="https://element.eleme.cn/#/zh-CN/component">Element å®˜æ–¹æ–‡æ¡£</a></li><li><a href="https://cn.vuejs.org/v2/guide/index.html">Vue å®˜æ–¹æ–‡æ¡£</a></li><li><a href="https://book.douban.com/subject/30310340/">ã€ŠFlask Web å¼€å‘å®æˆ˜ã€‹</a></li></ul><blockquote><p>å¤©ä¸‹äº‹æœ‰éš¾æ˜“ä¹ï¼Ÿä¸ºä¹‹ï¼Œåˆ™éš¾è€…äº¦æ˜“çŸ£ï¼›ä¸ä¸ºï¼Œåˆ™æ˜“è€…äº¦éš¾çŸ£ã€‚äººä¹‹ä¸ºå­¦æœ‰éš¾æ˜“ä¹ï¼Ÿå­¦ä¹‹ï¼Œåˆ™éš¾è€…äº¦æ˜“çŸ£ï¼›ä¸å­¦ï¼Œåˆ™æ˜“è€…äº¦éš¾çŸ£ã€‚<br>å¾èµ„ä¹‹æ˜ï¼Œä¸é€®äººä¹Ÿï¼Œå¾æä¹‹åº¸ï¼Œä¸é€®äººä¹Ÿï¼›æ—¦æ—¦è€Œå­¦ä¹‹ï¼Œä¹…è€Œä¸æ€ ç„‰ï¼Œè¿„ä¹æˆï¼Œè€Œäº¦ä¸çŸ¥å…¶æ˜ä¸åº¸ä¹Ÿã€‚å¾èµ„ä¹‹èªï¼Œå€äººä¹Ÿï¼Œå¾æä¹‹æ•ï¼Œå€äººä¹Ÿï¼›å±å¼ƒè€Œä¸ç”¨ï¼Œå…¶ä¸æ˜ä¸åº¸æ— ä»¥å¼‚ä¹Ÿã€‚åœ£äººä¹‹é“ï¼Œå’äºé²ä¹Ÿä¼ ä¹‹ã€‚ç„¶åˆ™æ˜åº¸èªæ•ä¹‹ç”¨ï¼Œå²‚æœ‰å¸¸å“‰ï¼Ÿ<br>èœ€ä¹‹é„™æœ‰äºŒåƒ§ï¼šå…¶ä¸€è´«ï¼Œå…¶ä¸€å¯Œã€‚è´«è€…è¯­äºå¯Œè€…æ›°ï¼šâ€œå¾æ¬²ä¹‹å—æµ·ï¼Œä½•å¦‚ï¼Ÿâ€å¯Œè€…æ›°ï¼šâ€œå­ä½•æƒè€Œå¾€ï¼Ÿâ€æ›°ï¼šâ€œå¾ä¸€ç“¶ä¸€é’µè¶³çŸ£ã€‚â€å¯Œè€…æ›°ï¼šâ€œå¾æ•°å¹´æ¥æ¬²ä¹°èˆŸè€Œä¸‹ï¼ŒçŠ¹æœªèƒ½ä¹Ÿã€‚å­ä½•æƒè€Œå¾€ï¼â€è¶Šæ˜å¹´ï¼Œè´«è€…è‡ªå—æµ·è¿˜ï¼Œä»¥å‘Šå¯Œè€…ï¼Œå¯Œè€…æœ‰æƒ­è‰²ã€‚<br>è¥¿èœ€ä¹‹å»å—æµ·ï¼Œä¸çŸ¥å‡ åƒé‡Œä¹Ÿï¼Œåƒ§å¯Œè€…ä¸èƒ½è‡³è€Œè´«è€…è‡³ç„‰ã€‚äººä¹‹ç«‹å¿—ï¼Œé¡¾ä¸å¦‚èœ€é„™ä¹‹åƒ§å“‰ï¼Ÿæ˜¯æ•…èªä¸æ•ï¼Œå¯æƒè€Œä¸å¯æƒä¹Ÿï¼›è‡ªæƒå…¶èªä¸æ•è€Œä¸å­¦è€…ï¼Œè‡ªè´¥è€…ä¹Ÿã€‚æ˜ä¸åº¸ï¼Œå¯é™è€Œä¸å¯é™ä¹Ÿï¼›ä¸è‡ªé™å…¶æ˜ä¸åº¸ï¼Œè€ŒåŠ›å­¦ä¸å€¦è€…ï¼Œè‡ªåŠ›è€…ä¹Ÿã€‚</p><footer><strong>å½­ç«¯æ·‘</strong><cite>ä¸ºå­¦ä¸€é¦–ç¤ºå­ä¾„</cite></footer></blockquote>]]></content>
      
      
      <categories>
          
          <category> Projects </category>
          
          <category> IdealYard </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flask </tag>
            
            <tag> åšå®¢ </tag>
            
            <tag> å¼€æº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python ä¹‹ Web å¼€å‘æ¡†æ¶å¯¹æ¯”â€”â€”Flask vs Web.py</title>
      <link href="blog/2019-06-05/Flask-vs-webpy/"/>
      <url>blog/2019-06-05/Flask-vs-webpy/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><p><code>Python</code> å¸¸ç”¨çš„<code>web</code>å¼€å‘æ¡†æ¶æœ‰å¾ˆå¤šå¦‚<code>Django</code>ã€<code>Flask</code>ã€<code>Tornado</code>ã€<code>Web.py</code>ç­‰ï¼Œæˆ‘ä»¬ä¹‹å‰é¡¹ç›®ä¸­ä½¿ç”¨çš„æ˜¯ <code>Web.py</code>ï¼Œä½†æ˜¯æ–°é¡¹ç›®ä¸­é€‰æ‹©å“ªä¸ªï¼Ÿæˆ–è®¸æ˜¯ä¸ªå€¼å¾—æ€è€ƒçš„é—®é¢˜ã€‚æœ¬æ–‡ä¸»è¦å¯¹<code>Web.py</code>å’Œ<code>Flask</code>è¿›è¡Œä¸€ä¸ªç®€å•çš„å¯¹æ¯”ã€‚</p><a id="more"></a><h2 id="ä¸ºä»€ä¹ˆè¦ä»Web-pyè¿ç§»åˆ°Flask"><a href="#ä¸ºä»€ä¹ˆè¦ä»Web-pyè¿ç§»åˆ°Flask" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ä»Web.pyè¿ç§»åˆ°Flask"></a>ä¸ºä»€ä¹ˆè¦ä»<code>Web.py</code>è¿ç§»åˆ°<code>Flask</code></h2><p>å¤§åŠ¿æ‰€è¶‹ã€‚æ ¹æ®æœ€æ–°çš„<a href="https://www.jetbrains.com/research/python-developers-survey-2018/">Python å¼€å‘è€…è°ƒç ”-2018</a>ç»“æœæ˜¾ç¤ºï¼Œ<code>Flask</code>å’Œ<code>Django</code>å·²ç»æˆä¸ºæœ€æµè¡Œçš„<code>web</code>å¼€å‘æ¡†æ¶ã€‚å¯¹ä¼ä¸šçš„è‰¯æ€§å‘å±•å’Œå¼€å‘è€…ä¸ªäººæˆé•¿è€Œè¨€ï¼Œä½¿ç”¨çƒ­é—¨æŠ€æœ¯éƒ½æ˜¯å€¼å¾—é¼“åŠ±ä¸”å¿…è¦çš„ã€‚è€Œä¸”ï¼Œä¼—æ‰€å‘¨çŸ¥ï¼Œå®˜æ–¹è®¡åˆ’åœ¨<code>2020</code>å¹´åœæ­¢<code>Python2</code>æ”¯æŒï¼Œè€Œç›¸æ¯”<code>Flask</code>è€Œè¨€ï¼Œ<code>Web.py</code>çš„ç‰ˆæœ¬æ›´æ–°è®¡åˆ’æœ‰ç‚¹è·Ÿä¸ä¸ŠèŠ‚å¥çš„æ„Ÿè§‰ã€‚</p><p><img src= "/img/loading.svg" data-lazy-src="/images/Web-frameworks-python-developers-survey-2018.jpg" alt="Web-frameworks-python-developers-survey-2018"></p><h2 id="TL-DRï¼ŒFlask-å¯¹æ¯”-Web-py-çš„ä¸åŒç‚¹"><a href="#TL-DRï¼ŒFlask-å¯¹æ¯”-Web-py-çš„ä¸åŒç‚¹" class="headerlink" title="TL;DRï¼ŒFlask å¯¹æ¯” Web.py çš„ä¸åŒç‚¹"></a>TL;DRï¼Œ<code>Flask</code> å¯¹æ¯” <code>Web.py</code> çš„ä¸åŒç‚¹</h2><p><code>Flask</code>æ‹¥æœ‰æ´»è·ƒçš„ç¤¾åŒºæ–‡åŒ–å’Œä¸°å¯Œè€Œå¼ºå¤§çš„ç¬¬ä¸‰æ–¹æ‰©å±•ï¼Œè€Œ<code>Web.py</code>åœ¨åŸä½œè€…ï¼ˆAaron Swartzï¼‰è‡ªæ€ä¹‹åè‡ªèº«ç»´æŠ¤å·²ä¸¾æ­¥ç»´è‰°ï¼Œç¬¬ä¸‰æ–¹æ‰©å±•çš„å‘å±•æ›´æ˜¯ä¸è¨€è€Œå–»ã€‚</p><ul><li><strong>ç»´æŠ¤ç§¯ææ€§</strong>  - æœ€æ–°ç‰ˆæœ¬åˆ†åˆ«ä¸º<code>Flask-1.0.2</code>å’Œ <code>webpy-0.39</code>ã€‚</li></ul><div class="justified-gallery"><p><img src= "/img/loading.svg" data-lazy-src="/images/flask-contributors.jpg" alt="flask-contributors"><br><img src= "/img/loading.svg" data-lazy-src="/images/webpy-contributors.jpg" alt="webpy-contributors"></p>          </div><ul><li><strong>å®˜æ–¹æ–‡æ¡£</strong> - <code>Flask</code>å…·æœ‰è‰¯å¥½çš„å®˜æ–¹æ–‡æ¡£ï¼Œå¹¶ä¸”æœ‰å›½å†…ä½¿ç”¨è€…ç¿»è¯‘çš„ä¸­æ–‡æ–‡æ¡£ï¼›<code>Web.py</code>åªæœ‰å‹‰å¼ºå¤Ÿç”¨ã€æ‰è¥Ÿè§è‚˜çš„å…¥é—¨çº§å®˜æ–¹æ–‡æ¡£ï¼Œå‰©ä¸‹çš„éœ€è¦å¼€å‘äººå‘˜è‡ªè¡Œæ‘¸ç´¢ã€‚</li><li><strong>ç¤¾åŒºæ´»è·ƒåº¦</strong> - <code>Flask</code>æ‹¥æœ‰æ´»è·ƒçš„ç¤¾åŒºæ–‡åŒ–å’Œæ•°é‡åºå¤§çš„æ‹¥è¶¸è€…ï¼Œ<code>Web.py</code>å›½å†…åªæœ‰ä¸æ´»è·ƒçš„ä¸“é—¨çš„è±†ç“£å°ç»„æˆ–è€…åœ¨ä¸€äº›çƒ­é—¨<code>Python</code>ç¤¾åŒºå¶æœ‰æåŠã€‚</li><li>ç¬¬ä¸‰æ–¹æ‰©å±•  <ul><li>è¡¨å• - <code>Flask</code> ä½¿ç”¨æ‰©å±•<code>Flask-WTF</code>å’Œ<code>WTForms</code>å¯ä»¥å®ç°å¾ˆå¥½çš„è¡¨å•éªŒè¯å’Œ <code>csrf</code> å®‰å…¨ä¿æŠ¤ï¼›ï¼ˆå‚é˜…<a href="https://www.jianshu.com/p/7e16877757f8">Flask-WTF ä¸ WTForms çš„ç”¨æ³•è¯¦è§£</a>ï¼‰ï¼›è€Œ<code>Web.py</code>è‡ªå¸¦<a href="https://webpy.org/cookbook/forms">Form åº“</a>ï¼Œå¯ä»¥å®ç°è¡¨å•åŠç®€å•æ ¡éªŒã€‚</li><li>æ•°æ®åº“ -  <code>Flask</code> ä½¿ç”¨æ‰©å±•<code>Flask-SQLAlchemy</code>å®ç°å¯¹æ•°æ®åº“çš„<code>ORM</code>æ“ä½œï¼Œå¯ä»¥å¾ˆå¥½åœ°ç®¡ç†å’Œå®ç°æ•°æ®åº“çš„è¿ç§»(å€ŸåŠ©<code>Flask-Migrate</code>)å·¥ä½œï¼›<code>Web.py</code>æˆ‘ä»¬ä½¿ç”¨è‡ªå·±å°è£…çš„<code>database.py</code>ã€‚</li><li>èº«ä»½éªŒè¯å’Œæƒé™ - <code>Flask</code>æä¾›å®‰å…¨<code>cookie</code>ä½œä¸ºæ‚¨è‡ªå·±å®ç°çš„å·¥å…·ï¼Œç¬¬ä¸‰æ–¹æ‰©å±•å¦‚<code>Flask-Login</code>(ç”¨æˆ·ä¼šè¯ç®¡ç†)ï¼Œ<code>Flask-HTTPAuth</code><sup>â‘ </sup>ï¼ˆç®€åŒ–äº†ä½¿ç”¨<code>Flask</code>è·¯ç”±çš„<code>HTTP</code>èº«ä»½éªŒè¯çš„ä½¿ç”¨ï¼‰ï¼Œ<code>Flask-Security</code>ï¼ˆæä¾›ä¸€ç«™å¼ç®¡ç†ï¼‰ï¼Œ <code>Flask-Social</code>ï¼ˆç”¨äºæ·»åŠ â€œç¤¾äº¤â€æˆ–<code>OAuth</code>ç™»å½•å’Œè¿æ¥ç®¡ç†ï¼‰ç­‰ï¼Œè¿™äº›æ‰©å±•è‰¯è ä¸é½ï¼Œä½¿ç”¨æ—¶éœ€è¦å¯¹å…¶æœ‰ä¸ªåˆæ­¥äº†è§£å¹¶è¿›è¡Œé´é€‰ï¼›<code>Web.py</code>è¿˜æ˜¯è¦è‡ªå·±é€ è½®å­ã€‚</li><li><code>RESTful</code> - ä½¿ç”¨<code>Flask-RESTful</code> å¯ä»¥åˆ›å»º<code>REST</code>çš„<code>API</code>ã€‚</li><li>å¼ºå¤§çš„é¡µé¢æ¸²æŸ“ -<code>Flask</code>ä½¿ç”¨<code>jinja2</code>ä½œä¸ºæ¨¡æ¿å¼•æ“ï¼›<code>Web.py</code>ä½¿ç”¨ <a href="https://webpy.org/templetor"><code>Templetor</code>ç±»</a> ï¼Œç±»ä¼¼<code>python</code> è¯­æ³•çš„å†™æ³•ä½¿å…¶å†™èµ·æ¥ä¿¡æ‰‹æ‹ˆæ¥ï¼Œæ— ç—›è¡”æ¥ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨<code>Mako</code>æ¨¡æ¿å¼•æ“ï¼Œä¸¤è€…å¹³åˆ†ç§‹è‰²ï¼Œç”šè‡³ä»è¯­æ³•ä¸Šæ¥è¯´ web.py ç•¥èƒœä¸€ç­¹ã€‚æ€§èƒ½å¯¹æ¯”è§è¿™é‡ŒğŸ‘‰ <a href="http://www.pythontip.com/blog/post/2239/">å‡ ä¸ªæ¨¡æ¿ç³»ç»Ÿçš„æ€§èƒ½å¯¹æ¯”</a></li></ul></li><li>ä¼¸ç¼©æ€§ - <code>Flask</code>æ—¢å¯ä»¥åƒ<code>Web.py</code>é‚£æ ·åšå¾®æ¡†æ¶å¼€å‘ä¸€ä¸ªå¾ˆå°çš„<code>web</code>åº”ç”¨ï¼Œä¹Ÿå¯ä»¥å€ŸåŠ©ä¸Šæ–¹çš„å„ç§æ‰©å±•åšåˆ°<code>Django</code>çº§åˆ«çš„åº”ç”¨ã€‚</li></ul><h2 id="Flask-æ¡†æ¶"><a href="#Flask-æ¡†æ¶" class="headerlink" title="Flask æ¡†æ¶"></a>Flask æ¡†æ¶</h2><blockquote><p>Flask is a microframework for Python based on Werkzeug, Jinja 2 and good intentions.<br>Flask æ˜¯ä¸€ä¸ªåŸºäº <code>Jinja2</code> æ¨¡æ¿å¼•æ“å’Œ <code>Werkzeug WSGI</code> å¥—ä»¶çš„ä¸€ä¸ªå¾®å‹çš„<code>Web</code>å¼€å‘æ¡†æ¶ã€‚ä½“ç°äº†<code>logo</code>ä¸­çš„å£å·<code>web development, one drop at a time.</code>(<code>web</code>å¼€å‘ï¼Œä¸€æ¬¡ä¸€æ»´ã€‚)</p></blockquote><h3 id="ä»€ä¹ˆæ˜¯-â€œå¾®â€"><a href="#ä»€ä¹ˆæ˜¯-â€œå¾®â€" class="headerlink" title="ä»€ä¹ˆæ˜¯ â€œå¾®â€"></a>ä»€ä¹ˆæ˜¯ â€œå¾®â€</h3><blockquote><p>â€œå¾®â€ (â€œMicroâ€) å¹¶ä¸æ˜¯æ„å‘³ç€æŠŠæ•´ä¸ª <code>Web</code> åº”ç”¨æ”¾å…¥åˆ°ä¸€ä¸ª <code>Python</code> æ–‡ä»¶ï¼Œå°½ç®¡ç¡®å®å¯ä»¥è¿™ä¹ˆåšã€‚å½“ç„¶â€œå¾®â€ (â€œMicroâ€) ä¹Ÿä¸æ˜¯æ„å‘³ <code>Flask</code> çš„åŠŸèƒ½ä¸Šæ˜¯ä¸è¶³çš„ã€‚å¾®æ¡†æ¶ä¸­çš„ â€œå¾®â€ (â€œMicroâ€) æ˜¯æŒ‡ <code>Flask</code> æ—¨åœ¨ä¿æŒä»£ç ç®€æ´ä¸”æ˜“äºæ‰©å±•ã€‚<code>Flask</code> ä¸ä¼šæ›¿ä½ åšå‡ºå¤ªå¤šå†³ç­–â€”â€”æ¯”å¦‚ä½¿ç”¨ä½•ç§æ•°æ®åº“ã€‚è€Œé‚£äº› <code>Flask</code> æ‰€é€‰æ‹©çš„â€”â€”æ¯”å¦‚ä½¿ç”¨ä½•ç§æ¨¡æ¿å¼•æ“â€”â€”åˆ™å¾ˆå®¹æ˜“æ›¿æ¢ã€‚é™¤æ­¤ä¹‹å¤–çš„ä¸€åˆ‡éƒ½å¯ç”±ä½ æŒæ¡ã€‚å¦‚æ­¤ï¼Œ<code>Flask</code> å¯ä»¥ä¸æ‚¨ç è”ç’§åˆã€‚<br>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>Flask</code> å¹¶ä¸åŒ…å«æ•°æ®åº“æŠ½è±¡å±‚ï¼Œè¡¨å•éªŒè¯æˆ–è€…ä»»ä½•å…¶ä»–ç°æœ‰çš„åº“( <code>Django</code> )èƒ½å¤Ÿå¤„ç†çš„ã€‚ç›¸åï¼Œ<code>Flask</code> æ”¯æŒæ‰©å±•ï¼Œè¿™äº›æ‰©å±•èƒ½å¤Ÿæ·»åŠ åŠŸèƒ½åˆ°ä½ çš„åº”ç”¨ï¼Œåƒæ˜¯ <code>Flask</code> æœ¬èº«å®ç°çš„ä¸€æ ·ã€‚ä¼—å¤šçš„æ‰©å±•æä¾›äº†æ•°æ®åº“é›†æˆï¼Œè¡¨å•éªŒè¯ï¼Œä¸Šä¼ å¤„ç†ï¼Œå¤šç§å¼€æ”¾çš„è®¤è¯æŠ€æœ¯ç­‰åŠŸèƒ½ã€‚<code>Flask</code> å¯èƒ½æ˜¯â€œå¾®â€å‹çš„ï¼Œä½†å®ƒå¯ä»¥æ¸¸åˆƒæœ‰ä½™åœ°åº”ä»˜éœ€æ±‚ç¹æ‚çš„ç”Ÿäº§ç¯å¢ƒçš„ä½¿ç”¨ã€‚</p></blockquote><p>â‘  åœ¨ <code>Web</code> åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦ä¿æŠ¤æˆ‘ä»¬çš„ <code>api</code>ï¼Œä»¥é¿å…éæ³•è®¿é—®ã€‚æ¯”å¦‚ï¼Œåªå…è®¸ç™»å½•æˆåŠŸçš„ç”¨æˆ·å‘è¡¨è¯„è®ºç­‰ã€‚<code>Flask-HTTPAuth</code> æ‰©å±•å¯ä»¥å¾ˆå¥½åœ°å¯¹ <code>HTTP</code> çš„è¯·æ±‚è¿›è¡Œè®¤è¯ï¼Œä¸ä¾èµ–äº <code>Cookie</code> å’Œ <code>Session</code>ã€‚è€Œæ˜¯åŸºäºå¯†ç å’ŒåŸºäºä»¤ç‰Œ (<code>token</code>)ã€‚</p><h2 id="Web-py-æ¡†æ¶"><a href="#Web-py-æ¡†æ¶" class="headerlink" title="Web.py æ¡†æ¶"></a><code>Web.py</code> æ¡†æ¶</h2><blockquote><p>Web.py is a web framework for Python that is as simple as it is powerful.<br>Web.py æ˜¯ä¸€ä¸ªç®€å•ä¸”åŠŸèƒ½å¼ºå¤§çš„ç”¨äº Python è¯­è¨€çš„ web æ¡†æ¶ã€‚</p></blockquote><h3 id="Web-pyè®¾è®¡å“²å­¦"><a href="#Web-pyè®¾è®¡å“²å­¦" class="headerlink" title="Web.pyè®¾è®¡å“²å­¦"></a><code>Web.py</code>è®¾è®¡å“²å­¦</h3><p><code>Web.py</code>çš„å£å·æ˜¯<code>Think about the ideal way to write a web app. Write the code to make it happen.</code>ï¼ˆæ€è€ƒç¼–å†™<code>web</code>åº”ç”¨ç¨‹åºçš„ç†æƒ³æ–¹å¼ï¼Œç„¶åå»ç¼–å†™ä»£ç å®ç°å®ƒã€‚ï¼‰<br>åœ¨ç”¨<code>Python</code>ç¼–å†™<code>web</code>åº”ç”¨ç¨‹åºçš„æ—¶å€™ï¼Œæˆ‘æƒ³è±¡è‡ªå·±æƒ³è¦<code>API</code>çš„æ–¹å¼ã€‚å®ƒå§‹äºå¯¼å…¥<code>web</code>ï¼Œç„¶åæœ‰ä¸€ä¸ªå®šä¹‰<code>URL</code>çš„åœ°æ–¹ï¼Œå¤„ç†<code>GET</code>å’Œ<code>POST</code>çš„ç®€å•å‡½æ•°å’Œä¸€äº›å¤„ç†è¾“å…¥å˜é‡çš„ä¸œè¥¿ã€‚ä¸€æ—¦ä»£ç å¯¹æˆ‘æ¥è¯´çœ‹èµ·æ¥æ˜¯æ­£ç¡®çš„ï¼Œ æˆ‘å°±ä¼šæƒ³å°½åŠæ³•ä½¿å®ƒåœ¨ä¸æ›´æ”¹åº”ç”¨ç¨‹åºä»£ç çš„æƒ…å†µä¸‹æ‰§è¡Œâ€”â€”ç»“æœå°±æ˜¯ <code>Web.py</code>ã€‚<br>æœ‰äººæŠ±æ€¨è¯´æˆ‘â€œæäº†å¦ä¸€å¥—æ¨¡æ¿è¯­è¨€â€ï¼ˆyet another template languageï¼‰ï¼Œæˆ‘å†™äº†æ›´å¤šæ–‡å­—å…³äºæˆ‘çš„è®¾è®¡ç†å¿µï¼š<a href="http://groups.google.com/group/webpy/msg/f266701d97e7ceb1">å‚é˜…</a></p><p>ä½ ä¸å¿…ä½¿ç”¨å®ƒâ€”â€”<code>Web.py</code>çš„æ¯ä¸ªéƒ¨åˆ†éƒ½ä¸å…¶ä»–éƒ¨åˆ†å®Œå…¨åˆ†ç¦»ã€‚ä½†ä½ æ˜¯å¯¹çš„ï¼Œ å®ƒæ˜¯â€œå¦ä¸€ç§æ¨¡æ¿è¯­è¨€â€ï¼Œè€Œæˆ‘ä¸ä¼šä¸ºæ­¤é“æ­‰ã€‚<br><code>Web.py</code> çš„ç›®æ ‡æ˜¯æ„å»ºåˆ¶ä½œ <code>web</code> åº”ç”¨ç¨‹åºçš„ç†æƒ³æ–¹æ³•ã€‚å¦‚æœä¸ºäº†å®ç°è¿™ä¸ªç›®æ ‡éœ€è¦æœ‰å¾®å°å·®å¼‚åŒ–çš„æ¥é‡å¡‘é™ˆæ—§çš„ä¸œè¥¿ï¼Œ æˆ‘ä¼šæå«è‡ªå·±å¯¹å®ƒä»¬è¿›è¡Œæ”¹é€ çš„æƒåˆ©ã€‚<code>ç†æƒ³çš„æ–¹å¼</code>å’Œ<code>å‡ ä¹ç†æƒ³çš„æ–¹å¼</code>ä¹‹é—´çš„åŒºåˆ«ï¼Œ æ­£å¦‚é©¬å…‹Â·åæ¸©æ‰€è¨€ï¼šæ˜¯é—ªç”µå’Œè¤ç«è™«ä¹‹é—´çš„åŒºåˆ«ã€‚ï¼ˆThe difference between the right word and the almost right word is the difference between lightning and the lightning Bug.ï¼‰<br>ä½†è¿™äº›ä¸ä»…ä»…æ˜¯ç»†å¾®çš„å·®å¼‚ã€‚<code>Web.py</code> å…è®¸æ‚¨æ„å»º <code>http</code> å“åº”ï¼Œ è€Œä¸æš´éœ² <code>Python</code> å¯¹è±¡ã€‚<code>Web.py</code> ä½¿æ•°æ®åº“æ›´æ˜“ä½¿ç”¨ï¼Œè€Œä¸è¯•å›¾ä½¿æ•°æ®åº“çœ‹èµ·æ¥åƒä¸€ä¸ªå¯¹è±¡ã€‚ <code>Web.py</code> æ¨¡æ¿ç³»ç»Ÿè¯•å›¾æŠŠ <code>Python</code> çº³å…¥ <code>HTML</code>è€Œä¸æ˜¯æƒ³å‡ºå¦ä¸€ç§æ–¹æ³•æ¥ç¼–å†™ <code>HTML</code>ã€‚æ²¡å¤šå°‘äººçœŸæ­£å°è¯•è¿‡è¿™ä¹ˆåšçš„å¯èƒ½æ€§ã€‚<br>ä½ å¯ä»¥ä¸åŒæ„è¿™äº›æ–¹æ³•æ›´å¥½å¹¶ç»™å‡ºåŸå› ï¼Œä½†ä»…ä»…æ‰¹è¯„å®ƒä»¬ä¸ä¼—ä¸åŒæ˜¯æµªè´¹æ—¶é—´ã€‚æ˜¯çš„ï¼Œ å®ƒä»¬å¤©ç”Ÿéª„å‚²ã€‚æˆ‘çš„è¯è®²å®Œäº†ã€‚<br>æ–‡å­—æ¥æºï¼š<a href="http://webpy.org/philosophy">The Web.py Philosophy</a></p><h2 id="Show-me-the-code"><a href="#Show-me-the-code" class="headerlink" title="Show me the code"></a>Show me the code</h2><h3 id="Web-py"><a href="#Web-py" class="headerlink" title="Web.py"></a>Web.py</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> web</span><br><span class="line"></span><br><span class="line">urls = (</span><br><span class="line">    <span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;Index&#x27;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Index</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">GET</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Hello, world!&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># def POST(self):</span></span><br><span class="line">    <span class="comment">#     pass    # TODO</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    web.config.debug = <span class="literal">False</span></span><br><span class="line">    app = web.application(urls, <span class="built_in">globals</span>())</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><ol><li>å¯¼å…¥<code>web</code>æ¨¡å—ï¼›</li><li>ç»„è£…<code>url</code>ç»“æ„ï¼›<ul><li>ç¬¬ä¸€éƒ¨åˆ†ä¸ºåŒ¹é…<code>URL</code>çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯æ¥å—è¯·æ±‚çš„ç±»åç§°</li></ul></li><li>å®šä¹‰ç±»<ul><li>å®šä¹‰å¤„ç†<code>GET</code>è¯·æ±‚çš„æ–¹æ³•ï¼›</li><li>å®šä¹‰ï¼ˆå¯é€‰çš„ï¼‰å¤„ç†<code>POST</code>è¯·æ±‚çš„æ–¹æ³•ï¼›</li></ul></li><li><code>debug</code>æ¨¡å¼<br> å½“åº”ç”¨åœ¨å†…å»ºçš„æœåŠ¡å™¨ä¸­è¿è¡Œæ—¶ï¼Œå®ƒä¼šä»¥<code>debug</code>æ¨¡å¼å¯åŠ¨ç¨‹åºã€‚åœ¨<code>debug</code>æ¨¡å¼ä¸‹ï¼Œä»»ä½•ä»£ç ã€æ¨¡æ¿çš„ä¿®æ”¹ï¼Œéƒ½ä¼šè®©æœåŠ¡å™¨é‡æ–°åŠ è½½å®ƒä»¬ï¼Œç„¶åè¿˜ä¼šè¾“å‡ºæœ‰ç”¨çš„é”™è¯¯æ¶ˆæ¯ã€‚<br> åªæœ‰åœ¨ç”Ÿäº§ç¯å¢ƒä¸­<code>debug</code>æ¨¡å¼æ˜¯å…³é—­çš„ï¼Œå¦‚æœä½ æƒ³ç¦ç”¨<code>debug</code>æ¨¡å¼ï¼Œä½ å¯ä»¥åœ¨åˆ›å»ºç¨‹åº/æ¨¡æ¿å‰æ·»åŠ ç½®ä¸º<code>False</code>ã€‚</li><li>åˆ›å»ºåº”ç”¨ï¼Œè¿™ä¸ª<code>application</code>ä¼šåœ¨è¿™ä¸ªæ–‡ä»¶çš„å…¨å±€å‘½åç©ºé—´ä¸­æŸ¥æ‰¾<code>urls</code>ä¸­å®šä¹‰çš„å¯¹åº”ç±»ã€‚</li><li>å¯åŠ¨åº”ç”¨ã€‚</li></ol><h3 id="Flask"><a href="#Flask" class="headerlink" title="Flask"></a>Flask</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># app.py</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,request</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello_world</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello World!&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    æ‰“å¼€è°ƒè¯•æ¨¡å¼çš„å¦ä¸€ç§è®¾ç½®æ–¹å¼</span></span><br><span class="line"><span class="string">    app.debug = True</span></span><br><span class="line"><span class="string">    app.run()</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>,debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p>è¿è¡Œä¹‹åï¼Œæµè§ˆ<code>http://IP_ADDR:5000/</code>å³å¯è®¿é—®ã€‚<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ python app.py</span><br><span class="line"> * Running on http://0.0.0.0:5000/</span><br></pre></td></tr></table></figure><br>ä»£ç è§£é‡Š</p><ol><li>å¯¼å…¥<code>Flask</code>ç±»ï¼›</li><li>å®ä¾‹åŒ–ï¼Œå³ç”Ÿæˆæˆ‘ä»¬çš„ <code>WSGI</code> åº”ç”¨ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯åº”ç”¨æ¨¡å—çš„åç§°ã€‚ å¦‚æœä½ ä½¿ç”¨çš„æ˜¯å•ä¸€çš„æ¨¡å—ï¼ˆå°±å¦‚æœ¬ä¾‹ï¼‰ï¼Œç¬¬ä¸€ä¸ªå‚æ•°åº”è¯¥ä½¿ç”¨ <code>__name__</code>ã€‚æˆ‘ä»¬è¿˜å¯ä»¥ä¼ é€’ç»™å®ƒæ¨¡å—æˆ–åŒ…çš„åç§°ã€‚è¿™æ · <code>Flask</code> æ‰ä¼šçŸ¥é“å»å“ªé‡Œå¯»æ‰¾æ¨¡æ¿ã€é™æ€æ–‡ä»¶ç­‰ç­‰ã€‚</li><li>ä½¿ç”¨è£…é¥°å™¨ <code>route()</code> å‘Šè¯‰ <code>Flask</code> å“ªä¸ª <code>URL</code> æ‰èƒ½è§¦å‘æˆ‘ä»¬çš„å‡½æ•°ã€‚<ul><li>é»˜è®¤æƒ…å†µä¸‹ï¼Œè·¯ç”±åªä¼šå“åº” <code>GET</code> è¯·æ±‚ï¼Œ ä½†æ˜¯èƒ½å¤Ÿé€šè¿‡ç»™ <code>route()</code> è£…é¥°å™¨æä¾› <code>methods</code> å‚æ•°æ”¹å˜ã€‚</li></ul></li><li>å®šä¹‰å‡½æ•°ï¼Œè¯¥å‡½æ•°åä¹Ÿæ˜¯ç”¨æ¥ç»™ç‰¹å®šå‡½æ•°ç”Ÿæˆ <code>URLs</code>ï¼Œå¹¶ä¸”è¿”å›æˆ‘ä»¬æƒ³è¦æ˜¾ç¤ºåœ¨ç”¨æˆ·æµè§ˆå™¨ä¸Šçš„ä¿¡æ¯ã€‚</li><li>æœ€åæˆ‘ä»¬ç”¨å‡½æ•° <code>run()</code> å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨æ¥è¿è¡Œæˆ‘ä»¬çš„åº”ç”¨ã€‚<ul><li><code>host=&#39;0.0.0.0&#39;</code>ä½ å¯ä»¥è®©ä½ çš„æœåŠ¡å™¨å¯¹å¤–å¯è§ã€‚</li><li><code>debug=True</code>å¼€å¯è°ƒå¼æ¨¡å¼ï¼Œä»…é€‚ç”¨äºå¼€å‘é˜¶æ®µï¼Œåœ¨ä»£ç ä¿®æ”¹çš„æ—¶å€™æœåŠ¡å™¨èƒ½å¤Ÿè‡ªåŠ¨åŠ è½½ï¼Œå‘ç”Ÿé”™è¯¯ä¹‹åå¯ä»¥æ›´å¥½è¿½è¸ªè°ƒè¯•ï¼› <strong>ç”Ÿäº§æ¨¡å¼æ—¶ï¼Œä¸€å®šè¦å…³é—­è¯¥é€‰é¡¹ã€‚</strong></li></ul></li></ol><p><strong>æ³¨æ„</strong><br>å¯èƒ½æœ‰äººæƒ³è¦ä½¿ç”¨<code>Flask</code>å®ç°<code>Web.py</code>ç±»ä¼¼çš„<code>RESTful</code>çš„ä»£ç è®¾è®¡é£æ ¼ï¼Œå€ŸåŠ©<code>Flask-RESTful</code>å¯ä»¥å®ç°åƒ<code>Web.py</code>ä¸€æ ·çš„<code>RESTful</code>è®¾è®¡ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask_restful <span class="keyword">import</span> Resource, Api</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">api = Api(app)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloWorld</span>(<span class="params">Resource</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&#x27;hello&#x27;</span>: <span class="string">&#x27;world&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">api.add_resource(HelloWorld, <span class="string">&#x27;/&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure></p><h2 id="å…³äº-Flask-çš„è“æœ¬-è“å›¾ï¼ˆBlueprintï¼‰"><a href="#å…³äº-Flask-çš„è“æœ¬-è“å›¾ï¼ˆBlueprintï¼‰" class="headerlink" title="å…³äº Flask çš„è“æœ¬/è“å›¾ï¼ˆBlueprintï¼‰"></a>å…³äº Flask çš„è“æœ¬/è“å›¾ï¼ˆBlueprintï¼‰</h2><p>åœ¨<code>Flask</code>ä¸­å¯ä»¥ç”¨<code>Blueprint</code> (è“å›¾) å®ç°åº”ç”¨çš„<strong>æ¨¡å—åŒ–</strong>ï¼Œåº”ç”¨å±‚æ¬¡æ¸…æ™°ï¼Œè“å›¾å¯ä»¥æå¤§åœ°<strong>ç®€åŒ–å¤§å‹åº”ç”¨</strong>å¹¶ä¸ºæ‰©å±•æä¾›é›†ä¸­çš„æ³¨å†Œå…¥å£ã€‚<br>è“å›¾é€šå¸¸ä½œç”¨äºç›¸åŒçš„<code>URL</code>å‰ç¼€ï¼Œå¦‚<code>/user/:id</code>ã€<code>/user/profile</code>è¿™æ ·çš„åœ°å€ï¼Œéƒ½ä»¥<code>/user</code>å¼€å¤´ï¼Œå®ƒä»¬æ˜¯ä¸€ç»„ç”¨æˆ·ç›¸å…³çš„æ“ä½œï¼Œé‚£ä¹ˆå°±å¯ä»¥æ”¾åœ¨ä¸€ä¸ªæ¨¡å—ä¸­ã€‚<br>åœ¨å¤§å‹é¡¹ç›®ä¸­ï¼Œä¸€èˆ¬éƒ½æ˜¯ååŒå¼€å‘å„å…±åŒè¿›è¡Œçš„ï¼Œä½¿ç”¨è“å›¾å¯ä»¥é¿å…äº’ç›¸å¹²æ‰°ï¼Œå¼€å‘äººå‘˜ä¸€çœ‹è·¯ç”±å°±èƒ½å¾ˆå¿«çš„æ‰¾åˆ°å¯¹åº”çš„è§†å›¾ï¼Œå¯ä»¥æ›´å®¹æ˜“åœ°<strong>å¼€å‘å’Œç»´æŠ¤</strong>é¡¹ç›®ã€‚</p><p>ä¸€ä¸ªå…¸å‹çš„ä½¿ç”¨è“å›¾ç»„ç»‡åº”ç”¨çš„é¡¹ç›®ç»“æ„ï¼š<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">app/</span><br><span class="line">    __init__.py</span><br><span class="line">    admin/</span><br><span class="line">        __init__.py</span><br><span class="line">        views.py</span><br><span class="line">        static/</span><br><span class="line">        templates/</span><br><span class="line">    home/</span><br><span class="line">        __init__.py</span><br><span class="line">        views.py</span><br><span class="line">        static/</span><br><span class="line">        templates/</span><br><span class="line">    control_panel/</span><br><span class="line">        __init__.py</span><br><span class="line">        views.py</span><br><span class="line">        static/</span><br><span class="line">        templates/</span><br><span class="line">    models.py</span><br><span class="line">    runserver.py</span><br></pre></td></tr></table></figure><br>å‚é˜…ï¼š<a href="https://www.zhihu.com/question/31748237">å¦‚ä½•ç†è§£ Flask ä¸­çš„è“æœ¬ï¼Ÿ</a></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>éœ€æ±‚é©±åŠ¨ï¼Œæ²¡æœ‰æœ€å¥½çš„æ¡†æ¶ï¼Œåªæœ‰é€‚åˆä½ çš„æ¡†æ¶ã€‚<br>ä¸¤è€…éƒ½æ˜¯è½»é‡çº§<code>web</code>å¼€å‘æ¡†æ¶ï¼ˆç›¸è¾ƒäº<code>Django</code>è€Œè¨€ï¼‰ï¼Œéƒ½å…·æœ‰è‰¯å¥½çš„æ‰©å±•æ€§å¹¶éµå¾ª<code>Pythonic</code>è®¾è®¡ï¼Œéå¸¸é€‚åˆåˆå­¦è€…å­¦ä¹ ä¸ä½¿ç”¨ã€‚<br><code>Web.py</code>åšæŒå°è€Œç¾çš„è®¾è®¡ç†å¿µã€‚ç®€å•ç›´æ¥ï¼Œå­¦ä¹ æˆæœ¬æ›´ä½ï¼Œå¯¹äºæ–°æ‰‹ç†è§£ web å¤„ç†æµç¨‹å¾ˆæœ‰å¸®åŠ©ï¼Œæ›´é€‚åˆæ•æ·å¼€å‘å’Œå®šåˆ¶åŒ–ï¼Œå½“ç„¶ä¹Ÿå°±æ„å‘³ç€å¯èƒ½éœ€è¦è‡ªå·±é€ æ›´å¤šçš„è½®å­ã€‚<br>è€Œ<code>Flask</code>æ‹¥æœ‰åºæ‚çš„ç¬¬ä¸‰æ–¹æ‰©å±•å¯ä»¥å‚è€ƒä½¿ç”¨ï¼Œå…·å¤‡è‰¯å¥½çš„æ‰©å±•æ€§ï¼Œé‡åˆ°é—®é¢˜æ›´å¥½å‘ç¤¾åŒºå¯»æ±‚ç­”æ¡ˆã€‚å½“ç„¶ï¼Œéšç€å¼€å‘çš„æ·±å…¥ï¼Œå¯èƒ½ä¼´éšä¸€ç³»åˆ—æ‰©å±•çš„äº†è§£å’Œå­¦ä¹ ï¼Œä¼šæ¶ˆè€—è¾ƒå¤šæ—¶é—´ã€‚ä½†æ˜¯ç›¸æ¯”<code>Django</code>è¿™ç§<code>å®Œç¾ä¸»ä¹‰è€…ç”¨æ¥èµ¶æœŸé™çš„é€‰æ‹©</code>ï¼Œä½ ä¸å¿…ä¸€å¼€å§‹å°±å­¦æ‰€æœ‰çš„ä¸œè¥¿ï¼ˆsessionã€ORMã€CSRFã€Formã€Templateã€Middleware ç­‰ï¼‰ï¼Œå¯ä»¥è‡ªä¸»æ­é…ï¼Œæ¸è¿›å¼€å‘ã€‚<br>æ‰€ä»¥ï¼Œå¯¹äºå…¨æ–°é¡¹ç›®ï¼Œä¸ºäº†åç»­çš„å¯æŒç»­è¿­ä»£å’Œç»´æŠ¤ï¼Œç›¸æ¯”<code>Web.py</code>æ›´å»ºè®®é€‰æ‹©<code>Flask</code>ã€‚</p><h2 id="å‚è€ƒé˜…è¯»"><a href="#å‚è€ƒé˜…è¯»" class="headerlink" title="å‚è€ƒé˜…è¯»"></a>å‚è€ƒé˜…è¯»</h2><h3 id="æ¡†æ¶å¯¹æ¯”"><a href="#æ¡†æ¶å¯¹æ¯”" class="headerlink" title="æ¡†æ¶å¯¹æ¯”"></a>æ¡†æ¶å¯¹æ¯”</h3><ul><li><a href="https://kite.com/blog/python/flask-vs-django-python">Flask vs Django</a></li><li><a href="https://www.douban.com/group/topic/29598761/">Web.py,web2py,django ä¸‰è€…é—´åˆ°åº•æ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿæœ‰ä»€ä¹ˆä¸åŒå‘¢ï¼Ÿ- è±†ç“£</a></li><li><a href="https://www.zhihu.com/question/20708601">Flask æ¡†æ¶æ€ä¹ˆæ ·ï¼Œæ¯”èµ· Web.py æœ‰å“ªäº›ä¸åŒï¼Ÿ- çŸ¥ä¹</a></li><li><a href="https://stackoverflow.com/questions/5695689/web-py-and-flask">Web.py-and-flask- StackOverflow</a></li><li><a href="https://www.quora.com/Which-is-better-Flask-vs-web-py-Why">Which is better: Flask vs Web.py? Why?-Quora</a></li><li><a href="https://www.reddit.com/r/Python/comments/28qr7c/can_anyone_explain_the_differences_between_web2py/">Can anyone explain the differences between web2py, Django, Flask, etc, and when I should use one or the other and what the benefits and drawbacks of each?-Reddit</a></li></ul><h3 id="Flaskå­¦ä¹ èµ„æº"><a href="#Flaskå­¦ä¹ èµ„æº" class="headerlink" title="Flaskå­¦ä¹ èµ„æº"></a><code>Flask</code>å­¦ä¹ èµ„æº</h3><ul><li><a href="http://flask.pocoo.org/">Welcome | Flask (A Python Microframework)</a></li><li><a href="http://docs.jinkan.org/docs/flask/index.html">Flask ä¸­æ–‡æ–‡æ¡£</a></li><li><a href="https://www.ctolib.com/docs/sfile/head-first-flask/">Flask Web å¼€å‘å…¥é—¨</a></li><li><a href="http://www.pythondoc.com/flask-mega-tutorial/index.html">æ¬¢è¿è¿›å…¥ Flask å¤§å‹é¡¹ç›®æ•™ç¨‹</a></li><li><a href="https://book.douban.com/subject/26274202/">Flask Web å¼€å‘ï¼šåŸºäº Python çš„ Web åº”ç”¨å¼€å‘å®æˆ˜ -ï¼ˆç‹—ä¹¦ï¼‰</a></li><li><a href="https://book.douban.com/subject/30310340/">Flask Web å¼€å‘å®æˆ˜ -ï¼ˆç‹¼ä¹¦ï¼‰</a></li></ul><h3 id="Flaskæ‰©å±•"><a href="#Flaskæ‰©å±•" class="headerlink" title="Flaskæ‰©å±•"></a><code>Flask</code>æ‰©å±•</h3><ul><li><a href="https://github.com/humiaozuzu/awesome-flask">Awesome Flask(Flask èµ„æºå’Œæ’ä»¶çš„ç²¾é€‰åˆ—è¡¨)</a></li><li><a href="http://www.pythondoc.com/">Flask æ–‡æ¡£å’Œä¸»æµç¬¬ä¸‰æ–¹æ‰©å±•æ–‡æ¡£</a></li></ul><h3 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h3><ul><li><a href="https://www.zhihu.com/question/20711220">äºšä¼¦Â·æ–¯æ²ƒèŒ¨ (Aaron Swartz) æ˜¯æ€ä¹ˆæ ·ä¸€ä¸ªäººï¼Ÿ</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> å·¥ä½œæ—¥å¸¸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> Flask </tag>
            
            <tag> Web.py </tag>
            
            <tag> Web å¼€å‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL ä¸­å­˜å‚¨ IP åœ°å€åº”è¯¥é€‰ç”¨ä½•ç§æ•°æ®ç±»å‹ï¼Ÿ</title>
      <link href="blog/2019-05-11/which-mysql-datatype-use-for-store-an-ip-address/"/>
      <url>blog/2019-05-11/which-mysql-datatype-use-for-store-an-ip-address/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><p>ä»Šå¤©åœ¨é¡¹ç›®å¼€å‘æ—¶ï¼Œé‡åˆ°éœ€è¦åœ¨æ•°æ®åº“ä¸­å­˜å‚¨ ip åœ°å€ï¼Œé‚£ä¹ˆåº”è¯¥é€‰ç”¨ä½•ç§æ•°æ®ç±»å‹æ›´åŠ é«˜æ•ˆå‘¢ï¼Ÿ<br>å¦‚æœå­˜å‚¨çš„æ˜¯<code>IPV4</code>åœ°å€ï¼Œå¯ä»¥é€‰æ‹©ä½¿ç”¨<code>INT UNSIGNED</code>ï¼Œç„¶åå€ŸåŠ© <code>MySQL</code> è‡ªå¸¦çš„ <code>INET_ATON()</code> å’Œ  <code>INET_NTOA()</code>æ¥å­˜å–æ•°æ®ï¼›<br>å¦‚æœå­˜å‚¨çš„æ˜¯<code>IPV6</code>åœ°å€ï¼Œå¯ä»¥é€‰æ‹©ä½¿ç”¨<code>VARBINARY()</code>ï¼Œç„¶åå€ŸåŠ© <code>INET6_ATON()</code>å’Œ<code>INET6_NTOA()</code> (<code>MySQL5.6+</code>æ”¯æŒ)æ–¹æ³•å­˜å–æ•°æ®ã€‚</p><a id="more"></a><h2 id="é’ˆå¯¹IPv4åœ°å€"><a href="#é’ˆå¯¹IPv4åœ°å€" class="headerlink" title="é’ˆå¯¹IPv4åœ°å€"></a>é’ˆå¯¹<code>IPv4</code>åœ°å€</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> inet_aton(<span class="string">&#x27;127.0.0.1&#x27;</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">------------------------+</span></span><br><span class="line"><span class="operator">|</span> inet_aton(<span class="string">&#x27;127.0.0.1&#x27;</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------------+</span></span><br><span class="line"><span class="operator">|</span>             <span class="number">2130706433</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> inet_ntoa(<span class="number">2130706433</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------------+</span></span><br><span class="line"><span class="operator">|</span> inet_ntoa(<span class="number">2130706433</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>             <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="æ•°æ®å­˜å–"><a href="#æ•°æ®å­˜å–" class="headerlink" title="æ•°æ®å­˜å–"></a>æ•°æ®å­˜å–</h3><ul><li><p>å­˜æ•°æ®</p>  <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `ip_addresses` (`ip_address`)</span><br><span class="line"><span class="keyword">VALUES</span> (INET_ATON(<span class="string">&#x27;127.0.0.1&#x27;</span>));</span><br></pre></td></tr></table></figure></li><li><p>å–æ•°æ®</p>  <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> id, INET_NTOA(`ip_address`) <span class="keyword">AS</span> ip</span><br><span class="line"><span class="keyword">FROM</span> `ip_addresses`;</span><br></pre></td></tr></table></figure><h3 id="Pythonå®ç°"><a href="#Pythonå®ç°" class="headerlink" title="Pythonå®ç°"></a><code>Python</code>å®ç°</h3></li></ul><p>å¯¹äºä¸Šé¢çš„ä»£ç ï¼Œå¦‚æœæˆ‘ä»¬ä¸æƒ³ä½¿ç”¨å†…ç½®çš„<code>MySQL</code>æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥åœ¨åº”ç”¨å±‚ä½¿ç”¨è‡ªå·±å°è£…çš„æ–¹æ³•ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> socket, struct</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ip2long</span>(<span class="params">ip</span>):</span>  </span><br><span class="line">    <span class="keyword">return</span> struct.unpack(<span class="string">&quot;!L&quot;</span>,socket.inet_aton(ip))[<span class="number">0</span>]  </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">long2ip</span>(<span class="params">longip</span>):</span>  </span><br><span class="line">    <span class="keyword">return</span> socket.inet_ntoa(struct.pack(<span class="string">&#x27;!L&#x27;</span>, longip))  </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:  </span><br><span class="line">    print(<span class="string">&#x27;local ip address to long is %s&#x27;</span>%ip2long(<span class="string">&#x27;127.0.0.1&#x27;</span>))  </span><br><span class="line">    print(<span class="string">&#x27;local ip address to long is %s&#x27;</span>%ip2long(<span class="string">&#x27;255.255.255.255&#x27;</span>))  </span><br><span class="line">    print(<span class="string">&#x27;local ip address long to ip is %s&#x27;</span>%long2ip(<span class="number">2130706433</span>))  </span><br><span class="line">    print(<span class="string">&#x27;local ip address long to ip is %s&#x27;</span>%long2ip(<span class="number">4294967295</span>)) </span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h4><p>æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ ipaddress åº“å¯¹ ip åœ°å€è¿›è¡Œ int å’Œ str ä¹‹é—´çš„äº’è½¬ã€‚ä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> ipaddress</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">int</span>(ipaddress.ip_address(<span class="string">&#x27;127.0.0.1&#x27;</span>))</span><br><span class="line"><span class="number">2130706433</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">str</span>(ipaddress.ip_address(<span class="number">2130706433</span>))</span><br><span class="line"><span class="string">&#x27;127.0.0.1&#x27;</span></span><br></pre></td></tr></table></figure></p><h2 id="é’ˆå¯¹IPv6åœ°å€"><a href="#é’ˆå¯¹IPv6åœ°å€" class="headerlink" title="é’ˆå¯¹IPv6åœ°å€"></a>é’ˆå¯¹<code>IPv6</code>åœ°å€</h2><p>MySQL æä¾›å†…ç½®å‡½æ•°<code>inet6_aton()</code>æ¥å­˜å‚¨å’Œæ£€ç´¢<code>IPv6</code>åœ°å€ã€‚æ•²é»‘æ¿ï¼Œä¸è¦æŠŠ<code>IPv6</code>åœ°å€å­˜å‚¨ä¸ºæ•´æ•°ï¼Œå› ä¸ºæ•°å­—æ ¼å¼çš„<code>IPv6</code>åœ°å€éœ€è¦æ¯”<code>UNSIGNED BIGINT</code>æ›´å¤šçš„å­—èŠ‚ã€‚æ‰€ä»¥ä¸‹é¢çš„å‡½æ•°è¿”å›<code>VARBINARY(16)</code>æ•°æ®ç±»å‹ã€‚è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­ã€‚<br><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> hex(inet6_aton(<span class="string">&#x27;127.0.0.1&#x27;</span>));</span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------------------+</span></span><br><span class="line"><span class="operator">|</span> hex(inet6_aton(<span class="string">&#x27;127.0.0.1&#x27;</span>))    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">7</span>F000001                        <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> hex(inet6_aton(<span class="string">&#x27;2001:0db8:85a3:0000:0000:8a2e:0370:7334&#x27;</span>));</span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------------------------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> hex(inet6_aton(<span class="string">&#x27;2001:0db8:85a3:0000:0000:8a2e:0370:7334&#x27;</span>))                <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------------------------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">20010</span>DB885A3000000008A2E03707334                                          <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------------------------------------------------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> inet6_ntoa(unhex(<span class="string">&#x27;20010DB885A3000000008A2E03707334&#x27;</span>));</span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------------------------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> inet6_ntoa(unhex(<span class="string">&#x27;20010DB885A3000000008A2E03707334&#x27;</span>))                      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------------------------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2001</span>:db8:<span class="number">85</span>a3::<span class="number">8</span>a2e:<span class="number">370</span>:<span class="number">7334</span>                                               <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------------------------------------------------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure></p><p><strong>æ³¨æ„</strong></p><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™æŸ¥æ‰¾ä»¥<code>ip</code>åœ°å€ä¸º<code>127.0.0.1</code>è¿æ¥çš„ç”¨æˆ·ï¼Œå¯èƒ½å†™å‡ºå¦‚ä¸‹çš„æŸ¥è¯¢è¯­å¥ï¼š</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">WHERE</span> inet_ntoa(ipaddress)<span class="operator">=</span><span class="string">&#x27;127.0.0.1&#x27;</span>;</span><br></pre></td></tr></table></figure><p>è¯·æ³¨æ„ï¼Œæ­¤æŸ¥è¯¢ä¸ä¼šä½¿ç”¨åœ¨<code>ipaddress</code>åˆ—ä¸Šåˆ›å»ºçš„ç´¢å¼•ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨<code>SQL</code>æ‰§è¡ŒæœŸé—´ä¿®æ”¹äº†ç´¢å¼•åˆ—ï¼Œå®ƒä¹Ÿä¼šé€è¡Œå°†æ•´æ•°è½¬æ¢ä¸ºçœŸå®çš„<code>IP</code>åœ°å€ã€‚æ‰€ä»¥è¦æƒ³è®©ç´¢å¼•ç”Ÿæ•ˆåº”è¯¥ï¼š<br><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SET</span> <span class="variable">@ip</span> <span class="operator">=</span> inet_aton(<span class="string">&#x27;127.0.0.1&#x27;</span>);</span><br><span class="line"><span class="keyword">SELECT</span> name <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">WHERE</span> ipaddress <span class="operator">=</span> <span class="variable">@ip</span>;</span><br></pre></td></tr></table></figure><br>æˆ–è€…<br><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">WHERE</span> ipaddress <span class="operator">=</span> inet_aton(<span class="string">&#x27;127.0.0.1&#x27;</span>);</span><br></pre></td></tr></table></figure></p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><ul><li><a href="https://www.rathishkumar.in/2017/08/how-to-store-ip-address-in-mysql.html">How to store IP (internet protocol) address in MySQL?</a></li><li><a href="https://itsolutionstuff.com/post/which-mysql-datatype-use-for-store-an-ip-address">Which MySQL datatype use for store an IP address?</a></li><li><a href="https://stackoverflow.com/questions/2542011/most-efficient-way-to-store-ip-address-in-mysql">Most efficient way to store IP Address in MySQL</a></li><li><a href="https://dev.mysql.com/doc/refman/5.6/en/miscellaneous-functions.html#function_inet6-aton">MySQL doc-function_inet6-aton</a></li><li><a href="https://www.cnblogs.com/gomysql/p/4595621.html">IP åœ°å€åœ¨æ•°æ®åº“é‡Œé¢çš„å­˜å‚¨æ–¹å¼</a></li><li><a href="https://www.cnblogs.com/skynet/archive/2011/01/09/1931044.html">è®º IP åœ°å€åœ¨æ•°æ®åº“ä¸­åº”è¯¥ç”¨ä½•ç§å½¢å¼å­˜å‚¨ï¼Ÿ</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> å·¥ä½œæ—¥å¸¸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> MySQL </tag>
            
            <tag> æ•°æ®åº“ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•é…ç½® PyCharm ä½¿ç”¨è¿œç¨‹çš„ Flask è™šæ‹Ÿå¼€å‘ç¯å¢ƒï¼Ÿ</title>
      <link href="blog/2019-05-06/pycharm-with-remote-flask-venv/"/>
      <url>blog/2019-05-06/pycharm-with-remote-flask-venv/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><p>å­¦ä¹ <code>Flask</code>å¼€å‘çš„æ—¶å€™ï¼Œå› ä¸ºä¸»æœºæ˜¯<code>Windows</code>ç¯å¢ƒï¼Œè€Œæ—¥å¸¸è·‘æœåŠ¡çš„æ˜¯<code>Linux</code>ç¯å¢ƒï¼Œæ‰€ä»¥éœ€è¦é€šè¿‡é…ç½®<code>pycharm</code>ä½¿ä¹‹ä½¿ç”¨è¿œç«¯çš„è™šæ‹Ÿç¯å¢ƒã€‚</p><a id="more"></a><h2 id="åˆ›å»ºè™šæ‹ŸæœºFlaskç¯å¢ƒ"><a href="#åˆ›å»ºè™šæ‹ŸæœºFlaskç¯å¢ƒ" class="headerlink" title="åˆ›å»ºè™šæ‹ŸæœºFlaskç¯å¢ƒ"></a>åˆ›å»ºè™šæ‹Ÿæœº<code>Flask</code>ç¯å¢ƒ</h2><p>ç•¥</p><p>æ­¤å¤„åœ¨ç½‘ä¸Šå¯ä»¥æ‰¾åˆ°å¾ˆå¤šå†™å¥½çš„æ•™ç¨‹ï¼Œä¸éœ€è¦æˆ‘å†æ¬¡å åºŠæ¶å±‹äº†ã€‚</p><h2 id="é…ç½®Pycharmç¯å¢ƒ"><a href="#é…ç½®Pycharmç¯å¢ƒ" class="headerlink" title="é…ç½®Pycharmç¯å¢ƒ"></a>é…ç½®<code>Pycharm</code>ç¯å¢ƒ</h2><p>æ‰“å¼€ Pycharm çš„ setting å¯¹è¯æ¡†ï¼ŒæŒ‰ç…§å¦‚ä¸‹é…ç½®  </p><p><img src= "/img/loading.svg" data-lazy-src="/images/snipaste_20190506_141224.jpg" alt="setting_start"></p><p>ä¾æ¬¡è¾“å…¥çœŸå®è¿œç«¯ä¿¡æ¯ä¹‹åï¼Œç‚¹å‡»ä¸‹ä¸€æ­¥ï¼Œç›´åˆ°å‡ºç°ä¸‹æ–¹å¯¹è¯æ¡†</p><p><img src= "/img/loading.svg" data-lazy-src="/images/snipaste_20190506_142141.jpg" alt="setting_end"></p><p>ä¾æ¬¡ä¿®æ”¹å°†è¦ä½¿ç”¨çš„è§£é‡Šå™¨å’Œä¸»æœºä¸è¿œç«¯éœ€è¦ä¿æŒåŒæ­¥çš„ç›®å½•ï¼›</p><p><img src= "/img/loading.svg" data-lazy-src="/images/snipaste_20190506_143428.jpg" alt="setting_flask"></p><p>å¦‚å›¾è®¾ç½®ä¹‹åè¿è¡Œï¼Œ<code>Run</code>å‡ºç°å¦‚ä¸‹ç»“æœ<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">FLASK_APP = app</span><br><span class="line">FLASK_ENV = development</span><br><span class="line">FLASK_DEBUG = 1</span><br><span class="line">In folder D:/MYcode/flk</span><br><span class="line">ssh://root@192.168.116.21:22/home/imoyao/envs/flk/bin/python -u -m flask run --host=0.0.0.0</span><br><span class="line"> * Serving Flask app &quot;app&quot; (lazy loading)</span><br><span class="line"> * Environment: development</span><br><span class="line"> * Debug mode: on</span><br><span class="line"> * Running on http://0.0.0.0:5000/ (Press CTRL+C to quit)</span><br><span class="line"> * Restarting with stat</span><br><span class="line"> * Debugger is active!</span><br><span class="line"> * Debugger PIN: 820-491-228</span><br></pre></td></tr></table></figure><br>ä¹‹ååœ¨æœ¬æœºè®¿é—®è™šæ‹Ÿæœº<code>ip</code>ï¼Œæ¯”å¦‚æœ¬ä¾‹ä¸­çš„<code>192.168.116.21:5000</code>ï¼Œå³å¯è¿›å…¥<code>app</code>é¦–é¡µã€‚</p><h2 id="æ³¨æ„é—®é¢˜"><a href="#æ³¨æ„é—®é¢˜" class="headerlink" title="æ³¨æ„é—®é¢˜"></a>æ³¨æ„é—®é¢˜</h2><p>åœ¨é…ç½®å¥½ä¸Šè¿°é€‰é¡¹ä¹‹åï¼Œè¿è¡Œå¯èƒ½ä¼šæç¤º <code>NoAppException: Could not import &quot;app&quot;.</code>ã€‚è¿™ä¸ªé—®é¢˜æš‚æ—¶ä¸çŸ¥é“æ˜¯ä»€ä¹ˆåŸå› å¼•èµ·ï¼Œå¯èƒ½æ˜¯<code>Pycharm</code>è¯†åˆ«è·¯å¾„æœ‰è¯¯å¯¼è‡´ï¼Œæš‚æ—¶æ²¡æœ‰æ‰¾åˆ°å¾ˆå¥½çš„è§£å†³åŠæ³•ã€‚å¤§å®¶å¯ä»¥å‚è€ƒä¸‹å›¾å°è¯•é…ç½®ï¼ˆé€’å½’æ‰‹åŠ¨è®¾ç½®ç›®å½•ï¼Œå¯èƒ½æœ‰ç”¨ï¼‰ã€‚</p><p><img src= "/img/loading.svg" data-lazy-src="/images/snipaste_20190507_133810.jpg" alt="can&#39;t_import_app"></p><h2 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h2><p>ä»Šå¤©çªç„¶å‡ºç°ä¸èƒ½è®¿é—®çš„é—®é¢˜ï¼Œä½¿ç”¨<code>netstat nap|grep 5000(flask è¿è¡Œç«¯å£)</code>æŸ¥çœ‹ç«¯å£çŠ¶æ€ï¼š<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcp        0      0 0.0.0.0:5000            0.0.0.0:*               LISTEN      8195/python</span><br></pre></td></tr></table></figure><br>è¯´æ˜ç«¯å£æ­£å¸¸å¼€æ”¾ï¼Œæ€€ç–‘æ˜¯é˜²ç«å¢™çš„åŸå› <br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">systemctl stop firewalld</span><br></pre></td></tr></table></figure><br>å…³é—­ä¹‹åå¯ä»¥æ­£å¸¸è®¿é—®ï¼Œç¡®è®¤æ˜¯å…¶é—®é¢˜ã€‚<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">firewall-cmd --zone=public --add-port=5000/tcp --permanent</span><br><span class="line">Warning: ALREADY_ENABLED: 5000:tcp</span><br><span class="line">success</span><br></pre></td></tr></table></figure><br>é‡å¯é˜²ç«å¢™ä¹‹åå¯ä»¥æ­£å¸¸è®¿é—®ï¼š<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@172 ~]<span class="comment"># systemctl stop firewalld</span></span><br><span class="line"></span><br><span class="line">[root@172 ~]<span class="comment"># firewall-cmd --reload</span></span><br><span class="line">FirewallD is not running</span><br><span class="line"></span><br><span class="line">[root@172 ~]<span class="comment"># firewall-cmd --state</span></span><br><span class="line">running</span><br></pre></td></tr></table></figure></p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><ul><li><a href="https://www.jetbrains.com/help/pycharm/run-debug-configuration-flask-server.html">é…ç½®<code>flask</code>æœåŠ¡è¿›è¡Œè°ƒè¯•</a></li><li><a href="https://www.jetbrains.com/help/pycharm/configuring-python-interpreter.html">é…ç½®<code>Python</code>è§£é‡Šå™¨</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> å·¥ä½œæ—¥å¸¸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flask </tag>
            
            <tag> PyCharm </tag>
            
            <tag> HOWTO </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python ä¼ å€¼è¿˜æ˜¯ä¼ å¼•ç”¨ï¼Ÿ| é€šè¿‡å¯¹è±¡å¼•ç”¨ä¼ é€’</title>
      <link href="blog/2019-04-13/python-pass-by-object-reference/"/>
      <url>blog/2019-04-13/python-pass-by-object-reference/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><a id="more"></a><p>æœ¬æ–‡è¯‘è‡ª <a href="https://robertheaton.com/2014/02/09/pythons-pass-by-object-reference-as-explained-by-philip-k-dick/">Is Python pass-by-reference or pass-by-value?</a></p><blockquote><p>â€œå‡è®¾æˆ‘å¯¹ Fat è¯´ï¼Œæˆ– Kevin å¯¹ Fat è¯´ï¼Œâ€œä½ æ²¡æœ‰ç»å†è¿‡ä¸Šå¸ã€‚ä½ åªä¸è¿‡ç»å†äº†ä¸€äº›ä¸ä¸Šå¸çš„å“è´¨ã€æ–¹é¢ã€æ€§è´¨ã€åŠ›é‡ã€æ™ºæ…§å’Œå–„è‰¯æœ‰å…³çš„äº‹æƒ…ã€‚â€è¿™å°±åƒæ˜¯å…³äºå¾·å›½äººè®²çš„ä¸€ä¸ªåŒé‡æŠ½è±¡å€¾å‘çš„ç¬‘è¯ï¼›å¾·å›½è‹±å›½æ–‡å­¦æƒå¨å®£ç§°ï¼Œâ€œå“ˆå§†é›·ç‰¹ä¸æ˜¯èå£«æ¯”äºšå†™çš„ï¼›å®ƒåªæ˜¯ç”±ä¸€ä¸ªåå«èå£«æ¯”äºšçš„äººå†™çš„ã€‚â€åœ¨è‹±è¯­è¯­å¢ƒä¸­ï¼Œè¿™å¥è¯çš„åŒºåˆ«åªæ˜¯å£å¤´çš„ï¼Œæ²¡æœ‰å®é™…æ„ä¹‰ï¼Œå°½ç®¡å¾·è¯­ä¸­è¿™ç§è¡¨è¾¾å­˜åœ¨å·®å¼‚ï¼ˆè¿™è§£é‡Šäº†å¾·å›½æ€æƒ³çš„ä¸€äº›å¥‡æ€ªç‰¹å¾ï¼‰ã€‚â€<br>  <p align="right"> â€“Valisï¼Œp71ï¼ˆBook-of-the-Month-Club Editionï¼‰</p></p></blockquote><p>Philip K. Dick å¹¶ä¸ä»¥å…¶è½»æ¾æˆ–æ˜“æ‡‚çš„æ•£æ–‡è€Œé—»åã€‚ç»å¤§å¤šæ•°è§’è‰²éƒ½å¾ˆé«˜ã€‚å°±åƒï¼ŒçœŸçš„ï¼ŒçœŸçš„ï¼ŒçœŸçš„å¾ˆé«˜ã€‚ç„¶è€Œï¼Œåœ¨ Valis çš„ä¸Šè¿°å¼•æ–‡ï¼ˆ1981 å¹´å‡ºç‰ˆï¼‰ä¸­ï¼Œä»–å¯¹è‡­åæ˜­ç€çš„<code>Python</code>å‚æ•°ä¼ é€’èŒƒå¼ç»™å‡ºäº†éå¸¸æœ‰è¿œè§çš„è§£é‡Šã€‚Plus Ã§a change, plus câ€™est omnomnomnom drugs.</p><p>åœ¨ç¼–ç¨‹è¯­è¨€ä¸­å‚æ•°ä¼ é€’çš„ä¸¤ç§æœ€å¹¿ä¸ºäººçŸ¥ä¸”æ˜“äºç†è§£çš„æ–¹æ³•æ˜¯æŒ‰å¼•ç”¨ä¼ é€’( pass-by-reference )å’ŒæŒ‰å€¼ä¼ é€’ ( pass-by-value )ã€‚ä¸å¹¸çš„æ˜¯ï¼Œ<code>Python</code>æ˜¯â€œä¼ é€’å¯¹è±¡å¼•ç”¨â€( pass-by-object-reference )ï¼Œç»å¸¸è¯´ï¼š</p><p>â€œå¯¹è±¡å¼•ç”¨æŒ‰å€¼ä¼ é€’ã€‚â€(Object references are passed by value.)</p><p>å½“æˆ‘ç¬¬ä¸€æ¬¡çœ‹åˆ°è¿™ä¸ªæ²¾æ²¾è‡ªå–œå’Œè¿‡äºç²¾è¾Ÿçš„å®šä¹‰æ—¶ï¼Œæˆ‘æƒ³æ¶äººã€‚åœ¨ä»æ‰‹ä¸Šå–ä¸‹ç»ç’ƒç¢ç‰‡å¹¶è¢«æŠ¤é€å‡ºè„±è¡£èˆä¿±ä¹éƒ¨åï¼Œ<del>æˆ‘æ„è¯†åˆ°æ‰€æœ‰ 3 ç§èŒƒä¾‹éƒ½å¯ä»¥ç†è§£å®ƒä»¬å¦‚ä½•å¯¼è‡´ä»¥ä¸‹ 2 ä¸ªåŠŸèƒ½çš„è¡¨ç°ï¼š</del></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reassign</span>(<span class="params">alist</span>):</span></span><br><span class="line">    alist = [<span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">append</span>(<span class="params">alist</span>):</span></span><br><span class="line">    alist.append(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">alist = [<span class="number">0</span>]</span><br><span class="line">reassign(alist)</span><br><span class="line">append(alist)</span><br></pre></td></tr></table></figure><p>è®©æˆ‘ä»¬æ¥ä¸€æ¢ç©¶ç«Ÿã€‚</p><h2 id="å˜é‡ä¸æ˜¯å¯¹è±¡"><a href="#å˜é‡ä¸æ˜¯å¯¹è±¡" class="headerlink" title="å˜é‡ä¸æ˜¯å¯¹è±¡"></a>å˜é‡ä¸æ˜¯å¯¹è±¡</h2><p>â€œå“ˆå§†é›·ç‰¹ä¸æ˜¯èå£«æ¯”äºšå†™çš„;å®ƒåªæ˜¯ç”±ä¸€ä¸ªåå«èå£«æ¯”äºšçš„äººå†™çš„ã€‚â€ Python å’Œ PKDï¼ˆ Philip K. Dickï¼‰éƒ½åœ¨ä¸€ä¸ªä¸œè¥¿çš„æœ¬è´¨ä¸æˆ‘ä»¬ç”¨æ¥æŒ‡ä»£é‚£ä¸ªä¸œè¥¿çš„æ ‡ç­¾ä¹‹é—´åšå‡ºäº†è‡³å…³é‡è¦çš„åŒºåˆ†ã€‚ â€œè¿™ä¸ªåå«èå£«æ¯”äºšçš„ç”·äººâ€æ˜¯ä¸€ä¸ªå…·ä½“çš„äººã€‚ è€Œâ€œèå£«æ¯”äºšâ€åªæ˜¯ä¸€ä¸ªåå­—ã€‚å¦‚æœæˆ‘ä»¬è¿™æ ·åšï¼š<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = []</span><br></pre></td></tr></table></figure><br><code>[]</code>æ˜¯ä¸€ä¸ªç©ºåˆ—è¡¨ã€‚ a æ˜¯æŒ‡å‘ç©ºåˆ—è¡¨çš„å˜é‡ï¼Œä½†å…¶æœ¬èº«å¹¶ä¸æ˜¯ç©ºåˆ—è¡¨ã€‚æˆ‘ç”»å›¾å¹¶å°†å˜é‡ç§°ä¸ºåŒ…å«å¯¹è±¡çš„â€œç›’å­â€;ä½†æ— è®ºå¦‚ä½•ä½ æ„æƒ³å®ƒï¼Œè¿™ç§å·®å¼‚æ˜¯å…³é”®ã€‚<br><img src= "/img/loading.svg" data-lazy-src="https://robertheaton.com/images/Intro.jpg" alt="Pass-by-reference"></p><h2 id="é€šè¿‡å¼•ç”¨ä¼ é€’"><a href="#é€šè¿‡å¼•ç”¨ä¼ é€’" class="headerlink" title="é€šè¿‡å¼•ç”¨ä¼ é€’"></a>é€šè¿‡å¼•ç”¨ä¼ é€’</h2><p>åœ¨ pass-by-reference ä¸­ï¼Œboxï¼ˆå˜é‡ï¼‰ç›´æ¥ä¼ é€’ç»™å‡½æ•°ï¼Œå…¶å†…å®¹ï¼ˆç”±å˜é‡è¡¨ç¤ºçš„å¯¹è±¡ï¼‰éšæ€§åœ°éšä¹‹è€Œæ¥ã€‚åœ¨å‡½æ•°ä¸Šä¸‹æ–‡ä¸­ï¼Œå‚æ•°æœ¬è´¨ä¸Šæ˜¯è°ƒç”¨è€…ä¼ å…¥çš„å˜é‡çš„å®Œæ•´åˆ«åã€‚å®ƒä»¬éƒ½æ˜¯å®Œå…¨ç›¸åŒçš„ç›’å­ï¼Œå› æ­¤ä¹ŸæŒ‡å‘å†…å­˜ä¸­å®Œå…¨ç›¸åŒçš„å¯¹è±¡ã€‚<br><img src= "/img/loading.svg" data-lazy-src="https://robertheaton.com/images/PBRIntro.jpg" alt=""></p><p>å› æ­¤ï¼Œå‡½æ•°å¯¹å˜é‡æˆ–å®ƒæ‰€ä»£è¡¨çš„å¯¹è±¡æ‰€åšçš„ä»»ä½•æ“ä½œéƒ½å°†å¯¹è°ƒç”¨è€…å¯è§ã€‚ä¾‹å¦‚ï¼Œè¯¥å‡½æ•°å¯ä»¥å®Œå…¨æ›´æ”¹å˜é‡çš„å†…å®¹ï¼Œå¹¶å°†å…¶æŒ‡å‘å®Œå…¨ä¸åŒçš„å¯¹è±¡ï¼š</p><p><img src= "/img/loading.svg" data-lazy-src="https://robertheaton.com/images/PBRReassign.jpg" alt=""></p><p>è¯¥å‡½æ•°è¿˜å¯ä»¥åœ¨ä¸é‡æ–°åˆ†é…å¯¹è±¡çš„æƒ…å†µä¸‹æ“ä½œå¯¹è±¡ï¼Œæ•ˆæœç›¸åŒï¼š<br><img src= "/img/loading.svg" data-lazy-src="https://robertheaton.com/images/PBRAppend.jpg" alt=""></p><p>é‡ç”³ä¸€ä¸‹ï¼Œåœ¨<code>pass-by-reference</code>ä¸­ï¼Œå‡½æ•°å’Œè°ƒç”¨è€…éƒ½ä½¿ç”¨å®Œå…¨ç›¸åŒçš„å˜é‡å’Œå¯¹è±¡ã€‚</p><h2 id="é€šè¿‡å€¼ä¼ é€’"><a href="#é€šè¿‡å€¼ä¼ é€’" class="headerlink" title="é€šè¿‡å€¼ä¼ é€’"></a>é€šè¿‡å€¼ä¼ é€’</h2><p>åœ¨<code>pass-by-value</code>ä¸­ï¼Œå‡½æ•°æ¥æ”¶è°ƒç”¨è€…ä¼ é€’ç»™å®ƒçš„å‚æ•°å¯¹è±¡çš„å‰¯æœ¬ï¼Œå¹¶åœ¨å†…å­˜ä¸­å¼€è¾Ÿæ–°çš„ç©ºé—´ä¿å­˜ã€‚</p><p><img src= "/img/loading.svg" data-lazy-src="https://robertheaton.com/images/PBVIntro.jpg" alt=""></p><p>ç„¶åï¼Œè¯¥å‡½æ•°æœ‰æ•ˆåœ°æä¾›å…¶è‡ªå·±çš„ç›’å­ä»¥å°†å€¼æ”¾å…¥ï¼Œå¹¶ä¸”å‡½æ•°å’Œè°ƒç”¨è€…å¼•ç”¨çš„å˜é‡æˆ–å¯¹è±¡ä¹‹é—´ä¸å†å­˜åœ¨ä»»ä½•å…³ç³»ã€‚è¿™äº›å¯¹è±¡ç¢°å·§å…·æœ‰ç›¸åŒçš„å€¼ï¼Œä½†å®ƒä»¬å®Œå…¨æ˜¯åˆ†å¼€çš„ï¼Œä¸€ä¸ªå¯¹è±¡ä¸ä¼šå½±å“åˆ°å¦ä¸€ä¸ªã€‚å¦‚æœæˆ‘ä»¬å†æ¬¡å°è¯•é‡æ–°åˆ†é…ï¼š</p><p><img src= "/img/loading.svg" data-lazy-src="https://robertheaton.com/images/PBVReassign.jpg" alt=""></p><p>åœ¨å‡½æ•°ä¹‹å¤–ï¼Œæ²¡æœ‰ä»»ä½•ååº”ã€‚åŒç†ï¼š</p><p><img src= "/img/loading.svg" data-lazy-src="https://robertheaton.com/images/PBVAppend.jpg" alt=""></p><p>è°ƒç”¨è€…ä¸Šä¸‹æ–‡ä¸­çš„å˜é‡å’Œå¯¹è±¡çš„å‰¯æœ¬æ˜¯å®Œå…¨éš”ç¦»çš„ã€‚</p><h2 id="é€šè¿‡å¯¹è±¡å¼•ç”¨ä¼ é€’"><a href="#é€šè¿‡å¯¹è±¡å¼•ç”¨ä¼ é€’" class="headerlink" title="é€šè¿‡å¯¹è±¡å¼•ç”¨ä¼ é€’"></a>é€šè¿‡å¯¹è±¡å¼•ç”¨ä¼ é€’</h2><p>åœ¨<code>Python</code>æ˜¯ä¸åŒçš„ã€‚ä¼—æ‰€å‘¨çŸ¥ï¼Œåœ¨<code>Python</code>ä¸­ï¼Œâ€œå¯¹è±¡å¼•ç”¨æŒ‰å€¼ä¼ é€’â€ï¼ˆ<code>Object references are passed by value</code>ï¼‰ã€‚</p><p>å‡½æ•°æ¥æ”¶å¯¹ï¼ˆå¹¶å°†è®¿é—®ï¼‰å†…å­˜ä¸­ä¸è°ƒç”¨è€…ä½¿ç”¨çš„ç›¸åŒå¯¹è±¡çš„å¼•ç”¨ã€‚ä½†æ˜¯ï¼Œå®ƒä¸ä¼šæ”¶åˆ°è°ƒç”¨è€…æ­£åœ¨å­˜å‚¨æ­¤å¯¹è±¡çš„ç›’å­;åœ¨<code>pass-by-value</code>ä¸­ï¼Œå‡½æ•°æä¾›è‡ªå·±çš„ç­å¹¶ä¸ºè‡ªå·±åˆ›å»ºä¸€ä¸ªæ–°å˜é‡ã€‚è®©æˆ‘ä»¬å†æ¬¡æ‰§è¡Œ<code>append</code>ï¼š</p><p><img src= "/img/loading.svg" data-lazy-src="https://robertheaton.com/images/PBORAppend.jpg" alt=""></p><p>å‡½æ•°å’Œè°ƒç”¨è€…éƒ½å¼•ç”¨å†…å­˜ä¸­çš„åŒä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥å½“<code>append</code>å‡½æ•°å‘åˆ—è¡¨ä¸­æ·»åŠ ä¸€ä¸ªé¢å¤–çš„é¡¹æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿä¼šåœ¨è°ƒç”¨è€…ä¸­çœ‹åˆ°è¿™ä¸ªï¼å®ƒä»¬æ˜¯åŒä¸€ä¸ªä¸œè¥¿çš„ä¸åŒåç§°;åŒ…å«ç›¸åŒå¯¹è±¡çš„ä¸åŒç­ã€‚è¿™æ„å‘³ç€æ˜¯é€šè¿‡å€¼ä¼ é€’å¯¹è±¡å¼•ç”¨çš„â€”â€”å‡½æ•°å’Œè°ƒç”¨è€…åœ¨å†…å­˜ä¸­ä½¿ç”¨ç›¸åŒçš„å¯¹è±¡ï¼Œä½†æ˜¯é€šè¿‡ä¸åŒçš„å˜é‡è®¿é—®ã€‚è¿™æ„å‘³ç€åŒä¸€ä¸ªå¯¹è±¡è¢«å­˜å‚¨åœ¨å¤šä¸ªä¸åŒçš„ç­ä¸­ï¼Œè€Œè¿™ç§éšå–»ä¼šè¢«æ‰“ç ´ã€‚<del>å‡å®šå®ƒæ˜¯é‡å­æˆ–å…¶ä»–ä¸œè¥¿ã€‚</del></p><p>ä½†å…³é”®æ˜¯å®ƒä»¬çœŸçš„æ˜¯ä¸åŒçš„åå­—å’Œä¸åŒçš„ç›’å­ã€‚åœ¨<code>pass-by-reference</code>ä¸­ï¼Œå®ƒä»¬æ˜¯ç›¸åŒçš„ç›’å­ã€‚å½“ä½ è¯•å›¾é‡æ–°åˆ†é…ä¸€ä¸ªå˜é‡ï¼Œå¹¶å°†ä¸€äº›ä¸åŒçš„ä¸œè¥¿æ”¾å…¥å‡½æ•°çš„ç›’å­ä¸­æ—¶ï¼Œä½ ä¹Ÿå°†å®ƒæ”¾å…¥è°ƒç”¨è€…çš„ç›’å­ä¸­ï¼Œå› ä¸ºå®ƒä»¬æ˜¯åŒä¸€ä¸ªç›’å­ã€‚ä½†æ˜¯ï¼Œåœ¨<code>pass-by-object-reference</code>ä¸­ï¼š</p><p><img src= "/img/loading.svg" data-lazy-src="https://robertheaton.com/images/PBORReassign.jpg" alt=""></p><p>è°ƒç”¨è€…ä¸åœ¨ä¹ä½ æ˜¯å¦é‡æ–°åˆ†é…æ–¹æ³•çš„ç›’å­ã€‚ä¸åŒçš„ç›’å­ï¼Œç›¸åŒçš„å†…å®¹ã€‚</p><p>ç°åœ¨æˆ‘ä»¬çœ‹çœ‹è²åˆ©æ™®Â·KÂ·è¿ªå…‹è¯•å›¾å‘Šè¯‰æˆ‘ä»¬çš„äº‹æƒ…ã€‚åå­—å’Œäººæ˜¯ä¸åŒçš„ä¸œè¥¿ã€‚å˜é‡å’Œå¯¹è±¡æ˜¯ä¸åŒçš„ä¸œè¥¿ã€‚æœ‰äº†è¿™äº›çŸ¥è¯†ï¼Œä½ æˆ–è®¸å¯ä»¥å¼€å§‹æ¨æ–­å½“ä½ åšè¿™æ ·çš„äº‹æƒ…æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆ</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">listA &#x3D; [0]</span><br><span class="line">listB &#x3D; listA</span><br><span class="line">listB.append(1)</span><br><span class="line">print listA</span><br></pre></td></tr></table></figure><p>ä½ å¯èƒ½è¿˜æƒ³äº†è§£è¿™äº›æ¦‚å¿µä¸å¯å˜å’Œä¸å¯å˜ç±»å‹ä¹‹é—´çš„æœ‰è¶£äº¤äº’ã€‚ä½†è¿™äº›æ˜¯å¦ä¸€å›äº‹äº†ã€‚ç°åœ¨ï¼Œå¦‚æœä½ èƒ½åŸè°…æˆ‘ï¼Œæˆ‘è¦å»è¯»ã€ŠDororoids Dream Of Electric Sheepï¼Ÿã€‹äº†ã€‚ - æˆ‘å¯¹å…ƒç¼–ç¨‹æœ‰ç‚¹ç”Ÿç–ã€‚</p><hr><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><ul><li><a href="https://eev.ee/blog/2012/05/23/python-faq-passing/">Does Python pass by reference or value?</a></li><li><a href="http://foobarnbaz.com/2012/07/08/understanding-python-variables/">http://foobarnbaz.com/2012/07/08/understanding-python-variables/</a> </li><li><a href="http://javadude.com/articles/passbyvalue.htm">http://javadude.com/articles/passbyvalue.htm</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•æŠŠå½“å‰æ”¹åŠ¨è¿½åŠ åˆ°æŸæ¬¡æŒ‡å®š commit ä¸Šï¼ˆéä¸Šæ¬¡ï¼‰</title>
      <link href="blog/2019-03-05/how-to-append-the-current-change-to-specified-commit/"/>
      <url>blog/2019-03-05/how-to-append-the-current-change-to-specified-commit/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><p>æ³¨æ„ï¼šæœ¬ä¾‹ä¸­ä½¿ç”¨<code>Gerrit</code>è¿›è¡Œæ¼”ç¤ºã€‚</p><ol start="0"><li>æš‚å­˜ç›®å‰ä¿®æ”¹çš„ä»£ç  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git stash</span><br><span class="line">git stash list <span class="comment"># å¯ä»¥éªŒè¯æš‚å­˜æ˜¯å¦æˆåŠŸ</span></span><br></pre></td></tr></table></figure></li><li>æŸ¥æ‰¾åˆ°éœ€è¦æŒ‡å®šçš„<code>commit</code>çš„ç¼–å·ï¼› <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">log</span></span><br></pre></td></tr></table></figure> <img src= "/img/loading.svg" data-lazy-src="/images/snipaste_20190305_123504.jpg" alt="rebase"> </li><li>æ‰¾åˆ°<code>git rebase</code>ç¼–å·ï¼Œå³è¦ä¿®æ”¹çš„<code>commit</code>ä¹‹å‰é‚£ä¸ª<code>commit</code>ï¼› <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git rebase --interactive a6f372877d26xxx0690aedf6dc6b6e7c</span><br></pre></td></tr></table></figure> <img src= "/img/loading.svg" data-lazy-src="/images/InsertPic_C032-11-05-09-52-53.jpg" alt="rebase">   </li><li>æ‰¾åˆ°è¦æ›´æ”¹çš„<code>commit</code>, å°†è¡Œé¦–çš„<code>pick</code>æ›´æ”¹ä¸º<code>edit</code>, ä¿å­˜é€€å‡ºï¼›<br> <img src= "/img/loading.svg" data-lazy-src="/images/InsertPic_36EE-11-05-09-52-53.jpg" alt="pick2edit">    </li><li><p>æœ¬åœ°ä¿®æ”¹éœ€è¦ä¿®æ”¹çš„ä»£ç </p></li><li><p>æ¢å¤æš‚å­˜çš„ä¿®æ”¹</p> <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git stash pop </span><br></pre></td></tr></table></figure><p> <strong>æ³¨æ„</strong>ï¼šå¦‚æœæ­¤æ—¶æœ‰å†²çªï¼Œéœ€è¦è‡ªå·±æ‰‹åŠ¨è§£å†³å†²çª</p></li><li>è§£å†³å†²çªåï¼Œæ·»åŠ ä¿®æ”¹æ–‡ä»¶ <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git add xxx    <span class="comment"># æ–‡ä»¶åç§°</span></span><br><span class="line">git commit --amend</span><br></pre></td></tr></table></figure></li><li>å›é€€åˆ°å½“å‰çŠ¶æ€ï¼› <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git rebase --<span class="built_in">continue</span></span><br></pre></td></tr></table></figure> <img src= "/img/loading.svg" data-lazy-src="/images/Catch-11-05-09-52-53.jpg" alt="pick2edit"><br> <strong>æ³¨æ„</strong>ï¼šå¦‚æœ<code>rebase</code>ç‰ˆæœ¬è¾ƒå¤šï¼Œå¯èƒ½éœ€è¦å¤šæ¬¡é‡å¤ä¸Šè¿°æ­¥éª¤ï¼Œä¸”æ¯<code>rebase</code>ä¸€æ­¥ï¼Œå¯èƒ½éƒ½è¦è§£å†³ä¸å…¶ä»–ç»„å‘˜<code>commit</code>çš„å†²çªï¼›</li><li>rebase åˆ° master ä¹‹åï¼Œpush å½“å‰ç‰ˆæœ¬åˆ°è¿œç¨‹ <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git push origin 0d163929c240xxx745b520d07b854c207 â‘  :refs/changes/8xxx4 â‘¡</span><br></pre></td></tr></table></figure> â‘ ï¼šæ­¤å¤„ä¸ºä½ è‡ªå·±éœ€è¦<code>amend</code>çš„<code>commit</code>ç‰ˆæœ¬å·ï¼›<br> â‘¡ï¼šæ­¤å¤„ä¸ºè¿œç«¯ä½ çš„<code>change</code>çš„ç¼–å·ï¼Œå¦‚æœè¿œç«¯ç‰ˆæœ¬å·²ç»<code>closed</code>ï¼Œ<del>åˆ™æ— æ³•è¿›è¡Œ<code>amend</code>ï¼Œåªèƒ½ <code>git reset</code>ï¼›</del><br> å¦‚æœä¸Šæ¸¸æäº¤å·²ç»åˆå¹¶å¹¶å…³é—­ï¼Œåˆ™å‚è€ƒæ­¤å¤„<a href="https://stackoverflow.com/questions/11972384/git-push-remote-rejected-change-closed">gerrit - Git push remote rejected {change ### closed} - Stack Overflow</a><br> éœ€è¦å°†ä¹‹å‰ rebase çš„ commit ä¿¡æ¯ä¸­çš„ change-Id åˆ é™¤ï¼Œè®© Gerrit é‡æ–°ç”Ÿæˆ change-Id ï¼Œä¹‹åå¯ä»¥ç»§ç»­æäº¤ã€‚</li></ol><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p><code>git</code>éå¸¸æ™ºèƒ½åŒ–ï¼Œæ¯ä¸€æ¬¡æ“ä½œåº”è¯¥æ ¹æ®æç¤ºè¿›è¡Œé—®é¢˜åˆ†æã€é€æ­¥æ“ä½œåˆ™å¯é¡ºåˆ©è¾¾åˆ°é¢„æœŸæ•ˆæœã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å·¥ä½œæ—¥å¸¸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
            <tag> ç‰ˆæœ¬æ§åˆ¶ </tag>
            
            <tag> Gerrit </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•è·å– Ztree çš„æ‰€æœ‰å¶å­èŠ‚ç‚¹ï¼Ÿ</title>
      <link href="blog/2019-01-30/how-to-get-leaf-nodes-of-Ztree/"/>
      <url>blog/2019-01-30/how-to-get-leaf-nodes-of-Ztree/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><p>ä½¿ç”¨<code>Ztree</code>æ—¶ï¼Œ<code>treeNode.children</code>åªèƒ½è·å–åˆ°å­èŠ‚ç‚¹ï¼Œè¯¥å¦‚ä½•æ‹¿åˆ°èŠ‚ç‚¹çš„å¶å­èŠ‚ç‚¹å‘¢ï¼Ÿ</p><a id="more"></a><h2 id="åˆ›å»ºåˆå§‹åŒ–è®¾ç½®"><a href="#åˆ›å»ºåˆå§‹åŒ–è®¾ç½®" class="headerlink" title="åˆ›å»ºåˆå§‹åŒ–è®¾ç½®"></a>åˆ›å»ºåˆå§‹åŒ–è®¾ç½®</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> setting = &#123;</span><br><span class="line">    data: &#123;</span><br><span class="line">        simpleData: &#123;</span><br><span class="line">            enable: <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    callback: &#123;</span><br><span class="line">        onCheck:onCheck,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="åˆ›å»ºç‚¹å‡»å“åº”äº‹ä»¶"><a href="#åˆ›å»ºç‚¹å‡»å“åº”äº‹ä»¶" class="headerlink" title="åˆ›å»ºç‚¹å‡»å“åº”äº‹ä»¶"></a>åˆ›å»ºç‚¹å‡»å“åº”äº‹ä»¶</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">onCheck</span>(<span class="params">event, treeId, treeNode, clickFlag</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> treeObj = $(ELT).fn.zTree.getZTreeObj(<span class="string">&quot;datarecdirs&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> str = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        str = getAllChildNodes(treeNode,str);</span><br><span class="line">        <span class="comment">// // åŠ ä¸Šè¢«é€‰æ‹©èŠ‚ç‚¹è‡ªèº«</span></span><br><span class="line">        <span class="comment">// str = str + &#x27;,&#x27; + treeNode.id;</span></span><br><span class="line">        <span class="comment">// å»æ‰æœ€å‰é¢çš„é€—å·</span></span><br><span class="line">        <span class="keyword">var</span> ids = str.substring(<span class="number">1</span>, str.length);</span><br><span class="line">        <span class="comment">// å¾—åˆ°æ‰€æœ‰èŠ‚ç‚¹ID çš„æ•°ç»„</span></span><br><span class="line">        <span class="keyword">var</span> idsArray = ids.split(<span class="string">&#x27;,&#x27;</span>);</span><br><span class="line">        <span class="comment">// è¿‡æ»¤æ‰åºåˆ—ä¸­çš„ç©ºå…ƒç´  [1,2,&#x27;3&#x27;,&quot;&quot;, &#x27;&#x27;] &gt;&gt;&gt; [1,2,&#x27;3&#x27;]   (javascript 1.6 and above)</span></span><br><span class="line">        <span class="keyword">var</span> filterArr = idsArray.filter(<span class="function"><span class="keyword">function</span>(<span class="params">n</span>)</span>&#123;<span class="keyword">return</span> n&#125;);       </span><br><span class="line">        <span class="comment">// å¾—åˆ°èŠ‚ç‚¹æ€»æ•°é‡</span></span><br><span class="line">        <span class="keyword">var</span> leafNodesLen = filterArr.length;</span><br><span class="line">        <span class="keyword">if</span>(filterArr)&#123;</span><br><span class="line">            <span class="keyword">var</span> nodeChecked = treeNode.checked;</span><br><span class="line">            <span class="keyword">if</span>(nodeChecked)&#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i &lt; leafNodesLen; i++) &#123;</span><br><span class="line">                    <span class="keyword">var</span> idVal = filterArr[i];</span><br><span class="line">                    <span class="keyword">var</span> node = treeObj.getNodeByParam(<span class="string">&quot;id&quot;</span>, idVal, <span class="literal">null</span>);</span><br><span class="line">                    treeObj.setChkDisabled(node,<span class="literal">true</span>,<span class="literal">false</span>,<span class="literal">true</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> j=<span class="number">0</span>; j &lt; leafNodesLen; j++) &#123;</span><br><span class="line">                    idVal = filterArr[j];</span><br><span class="line">                    <span class="comment">// æŒ‰ç…§idè·å–èŠ‚ç‚¹ï¼Œsee:https://www.oschina.net/question/222309_131001</span></span><br><span class="line">                    node = treeObj.getNodeByParam(<span class="string">&quot;id&quot;</span>, idVal, <span class="literal">null</span>);       <span class="comment">// æ³¨æ„ï¼šæ­¤å¤„ä¸å¯ä½¿ç”¨getNodeByTId()æ–¹æ³•</span></span><br><span class="line">                    treeObj.setChkDisabled(node,<span class="literal">false</span>,<span class="literal">false</span>,<span class="literal">true</span>);  <span class="comment">//å–æ¶ˆç¦ç”¨æ—¶ï¼Œå½±å“åˆ°å­èŠ‚ç‚¹</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">var</span> nodes = treeObj.getCheckedNodes();</span><br><span class="line">                <span class="built_in">console</span>.log(nodes);</span><br><span class="line">                <span class="keyword">if</span> (nodes.length&gt;<span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>;c&lt;nodes.length;c++)&#123;</span><br><span class="line">                        treeObj.checkNode(nodes[c],<span class="literal">false</span>,<span class="literal">true</span>);     <span class="comment">//æ³¨æ„ï¼Œæ­¤å¤„ä¸å¯ä½¿ç”¨cancelSelectedNode()</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// é€’å½’ï¼Œè·å–æ‰€æœ‰å­èŠ‚ç‚¹</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getAllChildNodes</span>(<span class="params">treeNode,result</span>)</span>&#123;     <span class="comment">// è·å–èŠ‚ç‚¹çš„æ‰€æœ‰å¶å­èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">if</span> (treeNode.isParent) &#123;</span><br><span class="line">        <span class="keyword">var</span> childrenNodes = treeNode.children;</span><br><span class="line">        <span class="keyword">if</span> (childrenNodes) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; childrenNodes.length; i++) &#123;</span><br><span class="line">                result += <span class="string">&#x27;,&#x27;</span> + childrenNodes[i].id;</span><br><span class="line">                result = getAllChildNodes(childrenNodes[i], result);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><span class="label label-danger">æ³¨æ„</span><blockquote><p>zTree é‡Œä¸¥æ ¼åŒºåˆ†äº†é€‰ä¸­å’Œå‹¾é€‰è¿™ä¸¤ä¸ªæ¦‚å¿µï¼Œé€‰ä¸­æ˜¯æŒ‡èŠ‚ç‚¹è¢«é€‰æ‹©èƒŒæ™¯é¢œè‰²æœ‰å˜åŒ–ï¼Œå› æ­¤ cancelSelectedNode()åªæ˜¯æŠŠä½ é€‰æ‹©çš„èŠ‚ç‚¹ï¼Œå˜æˆä¸é€‰æ‹©çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯èŠ‚ç‚¹çš„èƒŒæ™¯è‰²å‘ç”Ÿå˜åŒ–ã€‚<br>è€Œå‹¾é€‰æ˜¯æŒ‡èŠ‚ç‚¹çš„å‹¾é€‰æ¡†è¢«é€‰ä¸­ï¼Œä½ è¦å°†èŠ‚ç‚¹çš„å‹¾é€‰çŠ¶æ€ç”±å‹¾é€‰å˜ä¸ºä¸å‹¾é€‰ï¼Œå°±ä¸èƒ½ä½¿ç”¨ cancelSelectedNode()æ–¹æ³•ï¼Œåªèƒ½ä½¿ç”¨ checknode()æ–¹æ³•ï¼</p></blockquote><h2 id="å‚è€ƒæ¥æº"><a href="#å‚è€ƒæ¥æº" class="headerlink" title="å‚è€ƒæ¥æº"></a>å‚è€ƒæ¥æº</h2><ul><li><a href="https://blog.csdn.net/qq_15071263/article/details/82797734">zTree æ’ä»¶ - è·å–å½“å‰é€‰æ‹©èŠ‚ç‚¹ä¸‹çš„å…¨éƒ¨å­èŠ‚ç‚¹</a> </li><li><a href="https://tieba.baidu.com/p/4157358359?red_tag=3393089686">ä¸ºä»€ä¹ˆ cancelSelectedNode()å–æ¶ˆä¸äº†èŠ‚ç‚¹çš„é€‰ä¸­çŠ¶æ€ï¼Ÿ</a> </li></ul>]]></content>
      
      
      <categories>
          
          <category> å·¥ä½œæ—¥å¸¸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯ </tag>
            
            <tag> zTree </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®°ä¸€æ¬¡ MySQL é”™è¯¯ â€”â€” mysqld-dead-but-subsys-locked</title>
      <link href="blog/2019-01-25/mysqld-dead-but-subsys-locked/"/>
      <url>blog/2019-01-25/mysqld-dead-but-subsys-locked/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><p>è®°ä¸€æ¬¡<code>MySQL</code>æœåŠ¡å‡ºé”™æ’æŸ¥è¿‡ç¨‹ã€‚</p><a id="more"></a><p>ä»Šå¤©ç™»å½•ç®¡ç†ç³»ç»Ÿçš„æ—¶å€™è¾“å…¥è´¦æˆ·ä¿¡æ¯æ²¡æœ‰ååº”ï¼Œåå°æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—å‘ç°æŠ¥é”™ä¿¡æ¯ï¼š<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> <span class="keyword">in</span></span></span><br><span class="line">tailf /var/log/ODSP.log</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> out(éƒ¨åˆ†æœ‰ç”¨ä¿¡æ¯)</span></span><br><span class="line">2019-01-25 11:30:07 database [line:263]: Can&#x27;t connect to local MySQL server through socket &#x27;/var/lib/mysql/mysql.sock&#x27; (2)</span><br></pre></td></tr></table></figure></p><h2 id="æŸ¥çœ‹MySQLæœåŠ¡çŠ¶æ€"><a href="#æŸ¥çœ‹MySQLæœåŠ¡çŠ¶æ€" class="headerlink" title="æŸ¥çœ‹MySQLæœåŠ¡çŠ¶æ€"></a>æŸ¥çœ‹<code>MySQL</code>æœåŠ¡çŠ¶æ€</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> <span class="keyword">in</span></span></span><br><span class="line">/etc/init.d/mysqld status</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> out</span></span><br><span class="line">mysqld dead but subsys locked</span><br></pre></td></tr></table></figure><h2 id="æŸ¥çœ‹MySQLçš„logä¿¡æ¯"><a href="#æŸ¥çœ‹MySQLçš„logä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹MySQLçš„logä¿¡æ¯"></a>æŸ¥çœ‹<code>MySQL</code>çš„<code>log</code>ä¿¡æ¯</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> <span class="keyword">in</span></span></span><br><span class="line">tailf /var/log/mysqld.log</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> outï¼ˆæˆªå–éƒ¨åˆ†æœ‰ç”¨ä¿¡æ¯ï¼‰</span></span><br><span class="line">700101 00:28:38 mysqld_safe mysqld from pid file /var/run/mysqld/mysqld.pid ended</span><br><span class="line">700101 00:28:42 mysqld_safe Starting mysqld daemon with databases from /secbox/var/db</span><br><span class="line">700101  0:28:42 [ERROR] This MySQL server doesn&#x27;t support dates later then 2038</span><br><span class="line">700101  0:28:42 [ERROR] Aborting</span><br></pre></td></tr></table></figure><h2 id="æŸ¥çœ‹ç³»ç»Ÿæ—¶é—´"><a href="#æŸ¥çœ‹ç³»ç»Ÿæ—¶é—´" class="headerlink" title="æŸ¥çœ‹ç³»ç»Ÿæ—¶é—´"></a>æŸ¥çœ‹ç³»ç»Ÿæ—¶é—´</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@master digitools]# date</span><br><span class="line">Wed Jan  1 00:31:52 CST 2070</span><br></pre></td></tr></table></figure><h2 id="é‡æ–°è®¾ç½®ç³»ç»Ÿæ—¶é—´"><a href="#é‡æ–°è®¾ç½®ç³»ç»Ÿæ—¶é—´" class="headerlink" title="é‡æ–°è®¾ç½®ç³»ç»Ÿæ—¶é—´"></a>é‡æ–°è®¾ç½®ç³»ç»Ÿæ—¶é—´</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@master digitools]# date -s &quot;20190125 11:28:50&quot;</span><br><span class="line">Fri Jan 25 11:28:50 CST 2019</span><br></pre></td></tr></table></figure><h2 id="é‡æ–°å¯åŠ¨MySQLæœåŠ¡"><a href="#é‡æ–°å¯åŠ¨MySQLæœåŠ¡" class="headerlink" title="é‡æ–°å¯åŠ¨MySQLæœåŠ¡"></a>é‡æ–°å¯åŠ¨<code>MySQL</code>æœåŠ¡</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@master digitools]# /etc/init.d/mysqld status</span><br><span class="line">mysqld dead but subsys locked</span><br><span class="line"></span><br><span class="line">[root@master digitools]# /etc/init.d/mysqld stop</span><br><span class="line">Stopping mysqld:                                           [  OK  ]</span><br><span class="line">[root@master digitools]# /etc/init.d/mysqld start</span><br><span class="line">Starting mysqld:                                           [  OK  ]</span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¸Šé¢ä¸¤æ­¥å‘½ä»¤ä¹Ÿå¯ä»¥ç›´æ¥åˆå¹¶ä¸ºæ‰§è¡Œ `/etc/init.d/mysqld restart`</span></span><br><span class="line">[root@master digitools]# /etc/init.d/mysqld status</span><br><span class="line">mysqld (pid  19402) is running...</span><br></pre></td></tr></table></figure><h2 id="æ—¥å¿—æ¢å¤æ­£å¸¸"><a href="#æ—¥å¿—æ¢å¤æ­£å¸¸" class="headerlink" title="æ—¥å¿—æ¢å¤æ­£å¸¸"></a>æ—¥å¿—æ¢å¤æ­£å¸¸</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">190125 11:30:10  InnoDB: Initializing buffer pool, size = 8.0M</span><br><span class="line">190125 11:30:10  InnoDB: Completed initialization of buffer pool</span><br><span class="line">190125 11:30:10  InnoDB: Started; log sequence number 0 398010</span><br><span class="line">190125 11:30:10 [Note] Event Scheduler: Loaded 0 events</span><br><span class="line">190125 11:30:10 [Note] /usr/libexec/mysqld: ready for connections.</span><br><span class="line">Version: &#x27;5.1.71&#x27;  socket: &#x27;/var/lib/mysql/mysql.sock&#x27;  port: 3306  Source distribution</span><br></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œæ•°æ®åº“å¼‚å¸¸é—®é¢˜ä¿®å¤ï¼Œå‰å°ç™»å½•ç³»ç»Ÿæ¢å¤æ­£å¸¸ã€‚</p><h2 id="å‚è€ƒé˜…è¯»"><a href="#å‚è€ƒé˜…è¯»" class="headerlink" title="å‚è€ƒé˜…è¯»"></a>å‚è€ƒé˜…è¯»</h2><ul><li><a href="https://en.wikipedia.org/wiki/Year_2038_problem">Year 2038 problem</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> å·¥ä½œæ—¥å¸¸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pip å°è€å¼Ÿï¼Œä½ æ€ä¹ˆè‚¥å››ï¼Ÿ</title>
      <link href="blog/2018-09-21/get-some-trouble-with-pip/"/>
      <url>blog/2018-09-21/get-some-trouble-with-pip/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><p>ä»Šå¤©ç”¨<code>pip</code>çš„æ—¶å€™çªç„¶ä¸èƒ½æ­£å¸¸ä½¿ç”¨ï¼Œåœ¨è¿™é‡Œç®€å•è®°å½•ä¸€ä¸‹ã€‚<br><a id="more"></a></p><h2 id="æç¤ºpipç‰ˆæœ¬ä¸å¯¹"><a href="#æç¤ºpipç‰ˆæœ¬ä¸å¯¹" class="headerlink" title="æç¤ºpipç‰ˆæœ¬ä¸å¯¹"></a>æç¤º<code>pip</code>ç‰ˆæœ¬ä¸å¯¹</h2><h3 id="é”™è¯¯æç¤º"><a href="#é”™è¯¯æç¤º" class="headerlink" title="é”™è¯¯æç¤º"></a>é”™è¯¯æç¤º</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">You are using pip version 9.0.3, however version 18.0.1 is available.</span><br><span class="line">You should consider upgrading via the &#39;python -m pip install --upgrade pip&#39; command. </span><br></pre></td></tr></table></figure><h3 id="å¤„ç†è¿‡ç¨‹"><a href="#å¤„ç†è¿‡ç¨‹" class="headerlink" title="å¤„ç†è¿‡ç¨‹"></a>å¤„ç†è¿‡ç¨‹</h3><p>å»<a href="https://pypi.org/project/pip/">å®˜ç½‘</a>ä¸‹è½½æœ€æ–°ç‰ˆçš„åŒ…ï¼Œç›´æ¥è§£å‹å®‰è£…å³å¯ï¼›</p><h3 id="å‚è€ƒæ¥æº"><a href="#å‚è€ƒæ¥æº" class="headerlink" title="å‚è€ƒæ¥æº"></a>å‚è€ƒæ¥æº</h3><p><a href="https://blog.csdn.net/XavierDarkness/article/details/81234066">Python2.7 è‡ªå¸¦çš„ pip9.0 å‡çº§åˆ° pip18.0</a></p><h2 id="æ˜ç¡®å·²ç»å®‰è£…pipï¼Œä½†æ˜¯ç³»ç»Ÿæç¤ºæ‰¾ä¸åˆ°pip"><a href="#æ˜ç¡®å·²ç»å®‰è£…pipï¼Œä½†æ˜¯ç³»ç»Ÿæç¤ºæ‰¾ä¸åˆ°pip" class="headerlink" title="æ˜ç¡®å·²ç»å®‰è£…pipï¼Œä½†æ˜¯ç³»ç»Ÿæç¤ºæ‰¾ä¸åˆ°pip"></a>æ˜ç¡®å·²ç»å®‰è£…<code>pip</code>ï¼Œä½†æ˜¯ç³»ç»Ÿæç¤ºæ‰¾ä¸åˆ°<code>pip</code></h2><h3 id="é”™è¯¯æç¤º-1"><a href="#é”™è¯¯æç¤º-1" class="headerlink" title="é”™è¯¯æç¤º"></a>é”™è¯¯æç¤º</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-bash: &#x2F;home&#x2F;imoyao&#x2F;.local&#x2F;bin&#x2F;pip: No such file or directory</span><br></pre></td></tr></table></figure><h3 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">1.which pip </span><br><span class="line">/usr/local/bin/pip</span><br><span class="line"></span><br><span class="line">2.pip </span><br><span class="line">-su: /usr/bin/pip: No such file or directory</span><br><span class="line"></span><br><span class="line">3.type pip </span><br><span class="line">pip is hashed (/usr/bin/pip) </span><br><span class="line">So pip is definintely in /usr/local/bin/pip but it is been cached as in /usr/bin/pip, thanks to the Stackoverflow question, the solution is very simple:</span><br><span class="line"></span><br><span class="line">4.hash -r </span><br><span class="line">When the cache is clear, pip is working again.</span><br><span class="line"> </span><br></pre></td></tr></table></figure><h3 id="å‚è€ƒæ¥æº-1"><a href="#å‚è€ƒæ¥æº-1" class="headerlink" title="å‚è€ƒæ¥æº"></a>å‚è€ƒæ¥æº</h3><p><a href="https://blog.csdn.net/qq_32755575/article/details/80443714">/usr/bin/pip: No such file or directory</a></p><h2 id="å®‰è£…æˆ–å‡çº§pipæ—¶æç¤ºSSLError"><a href="#å®‰è£…æˆ–å‡çº§pipæ—¶æç¤ºSSLError" class="headerlink" title="å®‰è£…æˆ–å‡çº§pipæ—¶æç¤ºSSLError"></a>å®‰è£…æˆ–å‡çº§<code>pip</code>æ—¶æç¤º<code>SSLError</code></h2><h3 id="é”™è¯¯æç¤º-2"><a href="#é”™è¯¯æç¤º-2" class="headerlink" title="é”™è¯¯æç¤º"></a>é”™è¯¯æç¤º</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Retrying (Retry(total&#x3D;4, connect&#x3D;None, read&#x3D;None, redirect&#x3D;None, status&#x3D;None)) after connection broken by &#39;SSLError(SSLError(1, &#39;[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed (_ssl.c:833)&#39;),)&#39;: &#x2F;simple&#x2F;pip&#x2F;</span><br><span class="line">Retrying (Retry(total&#x3D;3, connect&#x3D;None, read&#x3D;None, redirect&#x3D;None, status&#x3D;None)) after connection broken by &#39;SSLError(SSLError(1, &#39;[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed (_ssl.c:833)&#39;),)&#39;: &#x2F;simple&#x2F;pip&#x2F;</span><br><span class="line">Retrying (Retry(total&#x3D;2, connect&#x3D;None, read&#x3D;None, redirect&#x3D;None, status&#x3D;None)) after connection broken by &#39;SSLError(SSLError(1, &#39;[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed (_ssl.c:833)&#39;),)&#39;: &#x2F;simple&#x2F;pip&#x2F;</span><br><span class="line">Retrying (Retry(total&#x3D;1, connect&#x3D;None, read&#x3D;None, redirect&#x3D;None, status&#x3D;None)) after connection broken by &#39;SSLError(SSLError(1, &#39;[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed (_ssl.c:833)&#39;),)&#39;: &#x2F;simple&#x2F;pip&#x2F;</span><br><span class="line">Retrying (Retry(total&#x3D;0, connect&#x3D;None, read&#x3D;None, redirect&#x3D;None, status&#x3D;None)) after connection broken by &#39;SSLError(SSLError(1, &#39;[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed (_ssl.c:833)&#39;),)&#39;: &#x2F;simple&#x2F;pip&#x2F;</span><br><span class="line">Could not fetch URL https:&#x2F;&#x2F;pypi.python.org&#x2F;simple&#x2F;pip&#x2F;: There was a problem confirming the ssl certificate: HTTPSConnectionPool(host&#x3D;&#39;pypi.python.org&#39;, port&#x3D;443): Max retries exceeded with url: &#x2F;simple&#x2F;pip&#x2F; (Caused by SSLError(SSLError(1, &#39;[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed (_ssl.c:833)&#39;),)) - skipping</span><br><span class="line">#å…¶å®æœ¬äººé‡åˆ°çš„é”™è¯¯æ˜¯</span><br><span class="line">(Caused by SSLError(SSLError(1, u&#39;[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed (_ssl.c:726)&#39;),))</span><br></pre></td></tr></table></figure><h3 id="è§£å†³æ–¹æ¡ˆ-1"><a href="#è§£å†³æ–¹æ¡ˆ-1" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><ul><li>ä¸´æ—¶æ–¹æ¡ˆ</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å®‰è£…æ—¶æ·»åŠ å‚æ•°ï¼š</span><br><span class="line">--trusted-host pypi.python.org</span><br><span class="line">æ­¤æ–¹å¼è¡¨ç¤ºä¿¡ä»»è¯¥åŸŸåï¼Œä½†æ˜¯æ¯ä¸€æ¬¡å®‰è£…åŒ…çš„æ—¶å€™éƒ½éœ€è¦è¯¥æ“ä½œï¼Œæ¯”è¾ƒéº»çƒ¦ï¼›</span><br></pre></td></tr></table></figure><ul><li>æ°¸ä¹…æ–¹æ¡ˆ</li></ul><p>ä¿®æ”¹<code>pip.conf</code> é…ç½®æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åœ¨<code>Linux</code>ç³»ç»Ÿä¸­çš„å¯èƒ½ä½ç½®ï¼š<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;etc&#x2F;pip.conf</span><br><span class="line"></span><br><span class="line">~&#x2F;.pip&#x2F;pip.conf</span><br><span class="line"></span><br><span class="line">~&#x2F;.config&#x2F;pip&#x2F;pip.conf </span><br></pre></td></tr></table></figure><br>å¦‚æœéƒ½æ²¡æœ‰çš„è¯ï¼Œå¯ä»¥æ‰‹åŠ¨åˆ›å»ºä¹‹åæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[global]</span><br><span class="line">index-url &#x3D; http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;pypi&#x2F;simple&#x2F;      # æœ¬æœºä½¿ç”¨é˜¿é‡Œæºä»£ç†</span><br><span class="line">[install]</span><br><span class="line">trusted-host&#x3D;mirrors.aliyun.com</span><br><span class="line"></span><br><span class="line"># globalå­—æ®µè¿˜çœ‹åˆ°å…¶ä»–å†™æ³•ï¼š</span><br><span class="line">[global]</span><br><span class="line">trusted-host &#x3D; pypi.python.org</span><br><span class="line">               pypi.org</span><br><span class="line">               files.pythonhosted.org</span><br></pre></td></tr></table></figure><h3 id="å‚è€ƒæ¥æº-2"><a href="#å‚è€ƒæ¥æº-2" class="headerlink" title="å‚è€ƒæ¥æº"></a>å‚è€ƒæ¥æº</h3><p><a href="https://stackoverflow.com/questions/16370583/pip-issue-installing-almost-any-library">pip issue installing almost any library</a><br><a href="https://www.cnblogs.com/yudar/p/4657511.html">Linux è®¾ç½® pip é•œåƒ Pip Warningï¼šâ€“trusted-host é—®é¢˜è§£å†³æ–¹æ¡ˆ</a></p><h2 id="å®‰è£…MySQL-pythonæ—¶æç¤º"><a href="#å®‰è£…MySQL-pythonæ—¶æç¤º" class="headerlink" title="å®‰è£…MySQL-pythonæ—¶æç¤º"></a>å®‰è£…<code>MySQL-python</code>æ—¶æç¤º</h2><h3 id="é”™è¯¯æç¤º-3"><a href="#é”™è¯¯æç¤º-3" class="headerlink" title="é”™è¯¯æç¤º"></a>é”™è¯¯æç¤º</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">EnvironmentError: mysql_config not found</span><br></pre></td></tr></table></figure><h3 id="è§£å†³æ–¹æ¡ˆ-2"><a href="#è§£å†³æ–¹æ¡ˆ-2" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><ul><li>CentOS</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">yumÂ installÂ libffi-devel </span><br><span class="line">pip install mysql-connector-python</span><br></pre></td></tr></table></figure><ul><li>Ubuntu</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo apt install default-libmysqlclient-dev</span><br></pre></td></tr></table></figure><h3 id="å‚è€ƒæ¥æº-3"><a href="#å‚è€ƒæ¥æº-3" class="headerlink" title="å‚è€ƒæ¥æº"></a>å‚è€ƒæ¥æº</h3><p><a href="https://stackoverflow.com/questions/5178292/pip-install-mysql-python-fails-with-environmenterror-mysql-config-not-found">pip install mysql-python fails with EnvironmentError: mysql_config not found</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> pip </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DRBD å¤‡å¿˜è®°å½•</title>
      <link href="blog/2018-09-11/record-of-drbd/"/>
      <url>blog/2018-09-11/record-of-drbd/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><p>è¿™æ˜¯ä¸€ä¸ªå…³äº <code>DRBD</code> çš„ä½¿ç”¨å¤‡å¿˜å½•ã€‚<br><a id="more"></a></p><p><img src= "/img/loading.svg" data-lazy-src="/images/DRBD-Diagram.png" alt="DRBDåœ¨Linuxå†…æ ¸I/Oæ ˆçš„ä½ç½®"></p><p>å¼€å§‹é˜…è¯»ä¹‹å‰ï¼Œè¯·å…ˆæ³¨æ„ç¤ºä¾‹ä¸­ä½¿ç”¨çš„ DRBD ç‰ˆæœ¬</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">drbdadm -V</span><br><span class="line"><span class="meta">#</span><span class="bash"> DRBDADM_VERSION=8.4.3</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šå®‰è£…çš„ kernel-devel çš„å†…æ ¸æºç ï¼ˆå†…æ ¸æºç è·¯å¾„/usr/src/kernel/ï¼‰å’Œå½“å‰ç³»ç»Ÿçš„ kernel ç‰ˆæœ¬(uname -r)ä¸ä¸€è‡´çš„è¯éœ€è¦æŠŠå½“å‰å†…æ ¸æ›´æ–°ä¸€ä¸‹ã€‚<br>åœ¨<code>2.6.33</code>åŠä»¥ä¸Šç‰ˆæœ¬çš„å†…æ ¸é»˜è®¤ä¸­æœ‰<code>DRBD</code>,ä¹‹å‰åœ¨ç”¨çš„<code>DRBD</code>ä¸»è¦<code>8.0</code>ã€<code>8.2</code>ã€<code>8.3</code> ä¸‰ä¸ªç‰ˆæœ¬,å¯¹åº”çš„<code>rpm</code>åŒ…æ˜¯<code>drbd</code>,<code>drbd82</code>å’Œ<code>drbd83</code>ï¼Œå› æ­¤éœ€è¦å®‰è£…å¯¹åº”çš„å†…æ ¸æ¨¡å—ï¼Œå¯¹åº”çš„åå­—ä¸º<code>kmod-drbd</code>,<code>kmod-drbd82</code>,<code>kmod-drbd83</code>ã€‚<br>ç”±äº<code>drbd</code>æ˜¯ä½œä¸ºå†…æ ¸æ¨¡å—è¿›è¡Œå·¥ä½œçš„ï¼Œæ•…å»ºè®®ä½¿ç”¨ä¸å†…æ ¸å¯¹åº”çš„ç‰ˆæœ¬ï¼Œå¯¹åº”å…³ç³»å¦‚ä¸‹è¡¨ã€‚</p><table><thead><tr><th style="text-align:left">Linux releases</th><th style="text-align:left">DRBD releases</th></tr></thead><tbody><tr><td style="text-align:left">2.6.33</td><td style="text-align:left">8.3.7</td></tr><tr><td style="text-align:left">2.6.34</td><td style="text-align:left">8.3.7</td></tr><tr><td style="text-align:left">2.6.35</td><td style="text-align:left">8.3.8</td></tr><tr><td style="text-align:left">2.6.36</td><td style="text-align:left">8.3.8.1</td></tr><tr><td style="text-align:left">2.6.37</td><td style="text-align:left">8.3.9</td></tr><tr><td style="text-align:left">2.6.38</td><td style="text-align:left">8.3.9</td></tr><tr><td style="text-align:left">2.6.39</td><td style="text-align:left">8.3.10</td></tr><tr><td style="text-align:left">3.0 - 3.4</td><td style="text-align:left">8.3.11</td></tr><tr><td style="text-align:left">3.5 - 3.7</td><td style="text-align:left">8.3.13</td></tr></tbody></table><p><strong>æ³¨æ„:</strong>ç›®å‰å®˜ç½‘ä¸Šé¢ 8.0 â€“ 8.3.x å·²æ ‡æ³¨ä¸º<code>Deprecated</code>å³ä¸å»ºè®®ä½¿ç”¨çŠ¶æ€ã€‚</p><h2 id="drbd-çŠ¶æ€è®°å½•"><a href="#drbd-çŠ¶æ€è®°å½•" class="headerlink" title="drbd çŠ¶æ€è®°å½•"></a>drbd çŠ¶æ€è®°å½•</h2><p>æœ¬éƒ¨åˆ†å†…å®¹è¯¦è§<a href="/blog/2018-08-29/state-of-drbd/">æ­¤å¤„</a></p><h2 id="æ¸…é™¤å•ä¸ª-DRBD-èµ„æºé…ç½®ï¼š-ä»¥-drbd10-ä¸ºä¾‹"><a href="#æ¸…é™¤å•ä¸ª-DRBD-èµ„æºé…ç½®ï¼š-ä»¥-drbd10-ä¸ºä¾‹" class="headerlink" title="æ¸…é™¤å•ä¸ª DRBD èµ„æºé…ç½®ï¼š(ä»¥ drbd10 ä¸ºä¾‹)"></a>æ¸…é™¤å•ä¸ª <code>DRBD</code> èµ„æºé…ç½®ï¼š(ä»¥ drbd10 ä¸ºä¾‹)</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">drbd-overview       # drbdæ¦‚è§ˆ</span><br><span class="line">drbdadm down drbd10         #down drbd</span><br><span class="line">echo yes|drbdadm wipe-md drbd10     #æ¸…é™¤metadata</span><br><span class="line">cd /etc/drbd.d/         # æ³¨æ„ï¼Œæ­¤å¤„æ ¹æ®drbdç‰ˆæœ¬ä¸åŒä¹Ÿå¯èƒ½åœ¨/usr/local/etc/drbd.d/</span><br><span class="line">rm drbd10.res           #åˆ é™¤resourceæ–‡ä»¶</span><br></pre></td></tr></table></figure><h2 id="é‡å¯-DRBD-æœåŠ¡"><a href="#é‡å¯-DRBD-æœåŠ¡" class="headerlink" title="é‡å¯ DRBD æœåŠ¡"></a>é‡å¯ <code>DRBD</code> æœåŠ¡</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">service drbd stop </span><br><span class="line">service drbd start </span><br></pre></td></tr></table></figure><h2 id="DRBDæ‰©å®¹"><a href="#DRBDæ‰©å®¹" class="headerlink" title="DRBDæ‰©å®¹"></a><code>DRBD</code>æ‰©å®¹</h2><p>å½“é‡åˆ°æˆ‘ä»¬çš„<code>drbd resource</code>è®¾å¤‡å®¹é‡ä¸å¤Ÿçš„æ—¶å€™ï¼Œè€Œä¸”æˆ‘ä»¬çš„åº•å±‚è®¾å¤‡æ”¯æŒåœ¨çº¿å¢å¤§å®¹é‡çš„æ—¶å€™ï¼ˆæ¯”å¦‚ lvmï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå¢å¤§åº•å±‚è®¾å¤‡çš„å¤§å°ï¼Œç„¶åå†é€šè¿‡<code>drbdadm resize resource_name</code>æ¥å®ç°å¯¹<code>resource</code>çš„æ‰©å®¹ã€‚<br>è¿™é‡Œæœ‰éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<br>åªæœ‰åœ¨å•ä¸»æ¨¡å¼ä¸‹å¯ä»¥è¿™æ ·åšï¼Œè€Œä¸”éœ€è¦å…ˆåœ¨ä¸¤èŠ‚ç‚¹ä¸Šéƒ½å¢å¤§åº•å±‚è®¾å¤‡çš„å®¹é‡ï¼Œç„¶åä»…åœ¨ä¸»èŠ‚ç‚¹ä¸Šæ‰§è¡Œ<code>resize</code>å‘½ä»¤ã€‚</p><p>åœ¨æ‰§è¡Œäº†<code>resize</code>å‘½ä»¤åï¼Œå°†è‡ªåŠ¨è§¦å‘ä¸€æ¬¡å½“å‰ä¸»èŠ‚ç‚¹åˆ°å…¶ä»–æ‰€æœ‰ä»èŠ‚ç‚¹çš„ re-synchronizationï¼›</p><p>å¦‚æœæˆ‘ä»¬åœ¨<code>drbd</code>éå·¥ä½œçŠ¶æ€ä¸‹å¯¹åº•å±‚è®¾å¤‡è¿›è¡Œäº†æ‰©å®¹ï¼Œç„¶åå†å¯åŠ¨<code>drbd</code>ï¼Œå°†ä¸éœ€è¦æ‰§è¡Œ<code>resize</code>å‘½ä»¤ï¼ˆå½“ç„¶å‰ææ˜¯åœ¨é…ç½®æ–‡ä»¶ä¸­æ²¡æœ‰å¯¹ disk å‚æ•°é¡¹æŒ‡å®šå¤§å°ï¼‰ï¼Œ<code>drbd</code>è‡ªå·±ä¼šçŸ¥é“å·²ç»å¢å¤§äº†å®¹é‡ï¼›</p><p>åœ¨è¿›è¡Œåº•å±‚è®¾å¤‡çš„å¢å®¹æ“ä½œçš„æ—¶å€™åƒä¸‡ä¸è¦ä¿®æ”¹åˆ°åŸè®¾å¤‡ä¸Šé¢çš„æ•°æ®ï¼Œå°¤å…¶æ˜¯<code>drbd</code>çš„<code>meta</code>ä¿¡æ¯ï¼Œå¦åˆ™æœ‰å¯èƒ½æ¯æ‰æ‰€æœ‰æ•°æ®ã€‚</p><h3 id="æµç¨‹ç®€å•ç¤ºä¾‹"><a href="#æµç¨‹ç®€å•ç¤ºä¾‹" class="headerlink" title="æµç¨‹ç®€å•ç¤ºä¾‹"></a>æµç¨‹ç®€å•ç¤ºä¾‹</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> å…ˆåœ¨ä¸¤ç«¯æ‰©å±•Lunï¼ˆéœ€è¦ç›¸åŒå¤§å°ï¼‰</span>     </span><br><span class="line">lvextend -Ll(50G) lvpath</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> drbdä»ç«¯ï¼šï¼ˆåŒä¸»æ¨¡å¼åˆ‡æ¢ä¸ºä¸»ä»æ¨¡å¼ï¼‰</span></span><br><span class="line">drbdadm secondary drbd[Num]     </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> drbdä¸»ç«¯ï¼š</span></span><br><span class="line">drbdadm resize drbd[Num]</span><br></pre></td></tr></table></figure><h2 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h2><h3 id="global-common-conf-é…ç½®ï¼ˆç¤ºä¾‹ï¼‰"><a href="#global-common-conf-é…ç½®ï¼ˆç¤ºä¾‹ï¼‰" class="headerlink" title="global_common.conf é…ç½®ï¼ˆç¤ºä¾‹ï¼‰"></a>global_common.conf é…ç½®ï¼ˆç¤ºä¾‹ï¼‰</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">global &#123;</span><br><span class="line">    usage-count no;     # æ˜¯å¦å‘å®˜æ–¹å‘é€ç»Ÿè®¡æŠ¥å‘Šï¼ˆå½±å“æ€§èƒ½ï¼‰</span><br><span class="line">&#125;</span><br><span class="line">common &#123;            # å®šä¹‰drbdè®¾å¤‡å…±äº«çš„å±æ€§ä¿¡æ¯</span><br><span class="line">    handlers &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    startup &#123;       # å¯åŠ¨æ—¶å€™çš„ç›¸å…³è®¾ç½®</span><br><span class="line">        wfc-timeout 50;</span><br><span class="line">        become-primary-on both;     # å…è®¸åŒä¸»</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    disk &#123;</span><br><span class="line">        on-io-error detach;     # é…ç½®I/Oé”™è¯¯å¤„ç†ç­–ç•¥ä¸ºåˆ†ç¦»</span><br><span class="line">        no-disk-flushes ;</span><br><span class="line">        no-disk-barrier;</span><br><span class="line">        c-plan-ahead 0;</span><br><span class="line">        c-fill-target 24M;</span><br><span class="line">        c-min-rate 80M;</span><br><span class="line">        c-max-rate 720M;</span><br><span class="line">    &#125; </span><br><span class="line">    net &#123;               # ç½‘ç»œé…ç½®ç›¸å…³</span><br><span class="line">        protocol C;     # åŒæ­¥å¼‚æ­¥æ§åˆ¶ï¼ˆè§ä¸‹æ–¹ä»‹ç»ï¼‰</span><br><span class="line">        after-sb-0pri discard-younger-primary;  # è„‘è£‚ä¿®å¤</span><br><span class="line">        after-sb-1pri discard-secondary;</span><br><span class="line">        after-sb-2pri call-pri-lost-after-sb;</span><br><span class="line">        allow-two-primaries yes;        # å…è®¸åŒä¸»</span><br><span class="line">        max-buffers        36k;</span><br><span class="line">        sndbuf-size         1024k ;</span><br><span class="line">        rcvbuf-size      2048k;</span><br><span class="line">    &#125;</span><br><span class="line">    syncer &#123;    # åŒæ­¥ç›¸å…³çš„è®¾ç½®</span><br><span class="line">            rate                   4194304k;    # bytes/second</span><br><span class="line">            al-extents              6433;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#</span><span class="bash"> Read_More:http://tech.sina.com.cn/smb/2008-12-22/1050926302.shtml</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="æ•°æ®åŒæ­¥åè®®"><a href="#æ•°æ®åŒæ­¥åè®®" class="headerlink" title="æ•°æ®åŒæ­¥åè®®"></a>æ•°æ®åŒæ­¥åè®®</h3><p><code>DRBD</code>æœ‰ä¸‰ç§æ•°æ®åŒæ­¥æ¨¡å¼:åŒæ­¥ï¼Œå¼‚æ­¥ï¼ŒåŠåŒæ­¥</p><ol><li>å¼‚æ­¥ï¼šæŒ‡çš„æ˜¯å½“æ•°æ®å†™åˆ°ç£ç›˜ä¸Šï¼Œå¹¶ä¸”å¤åˆ¶çš„æ•°æ®å·²ç»è¢«æ”¾åˆ°æˆ‘ä»¬çš„<code>tcp</code>ç¼“å†²åŒºå¹¶ç­‰å¾…å‘é€ä»¥åï¼Œå°±è®¤ä¸ºå†™å…¥å®Œæˆï¼›</li><li>åŠåŒæ­¥ï¼šæŒ‡çš„æ˜¯æ•°æ®å·²ç»å†™åˆ°ç£ç›˜ä¸Šï¼Œå¹¶ä¸”è¿™äº›æ•°æ®å·²ç»å‘é€åˆ°å¯¹æ–¹å†…å­˜ç¼“å†²åŒºï¼Œå¯¹æ–¹çš„<code>tcp</code>å·²ç»æ”¶åˆ°æ•°æ®ï¼Œå¹¶å®£å¸ƒå†™å…¥ï¼›</li><li>åŒæ­¥ï¼šæŒ‡çš„æ˜¯ä¸»èŠ‚ç‚¹å·²å†™å…¥ï¼Œä»èŠ‚ç‚¹ç£ç›˜ä¹Ÿå†™å…¥ï¼›</li></ol><p><code>DRBD</code>çš„å¤åˆ¶æ¨¡å‹æ˜¯é <code>protocol</code>å…³é”®å­—æ¥å®šä¹‰çš„ï¼š<code>protocol A</code>è¡¨ç¤ºå¼‚æ­¥ï¼›<code>protocol B</code>è¡¨ç¤ºåŠåŒæ­¥ï¼›<code>protocol C</code>è¡¨ç¤ºåŒæ­¥ï¼Œé»˜è®¤ä¸º<code>protocol C</code>ã€‚</p><p>åœ¨åŒæ­¥æ¨¡å¼ä¸‹åªæœ‰ä¸»ã€ä»èŠ‚ç‚¹ä¸Šä¸¤å—ç£ç›˜åŒæ—¶æŸå®³æ‰ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚åœ¨åŠåŒæ­¥æ¨¡å¼ä¸‹åªæœ‰ä¸»èŠ‚ç‚¹å®•æœºï¼ŒåŒæ—¶ä»èŠ‚ç‚¹å¼‚å¸¸åœç”µæ‰ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚</p><p><strong>æ³¨æ„:</strong></p><ol><li>ä¸»ä»æ‰€åœ¨çš„ç£ç›˜åˆ†åŒºæœ€å¥½å¤§å°ç›¸ç­‰,<code>DRBD</code>ç£ç›˜é•œåƒç›¸å½“äºç½‘ç»œ<code>RAID1</code>ï¼›ï¼ˆæœ¬äººä½¿ç”¨æ—¶å¼ºåˆ¶ç›¸ç­‰ï¼Œä½†ç½‘ä¸Šæ²¡æœ‰å…³äºåˆ†åŒºå¤§å°æ˜¯å¦ä¸€å®šè¦ç›¸åŒçš„ç¡®åˆ‡è¯´æ³•ï¼‰</li><li>ç½‘ç»œåŒæ­¥æ—¶éœ€è¦ä¸€å®šçš„æ—¶é—´ï¼Œåœ¨åŒæ­¥å®Œæˆä¹‹å‰æœ€å¥½ä¸è¦é‡å¯ï¼Œå¦åˆ™ä¼šé‡æ–°åŒæ­¥ï¼›</li><li><code>DRBD</code>çš„ä¸»èŠ‚ç‚¹ä¸ä¼šç›‘æ§ä»èŠ‚ç‚¹çš„çŠ¶æ€ï¼Œæ‰€ä»¥æœ‰å¯èƒ½ä¼šé€ æˆæ•°æ®é‡ä¼ ï¼›</li><li>æ ¼å¼åŒ–åªéœ€è¦åœ¨<code>primary</code>èŠ‚ç‚¹ä¸Šè¿›è¡Œ,ä¸”åªèƒ½åœ¨ä¸»èŠ‚ç‚¹ä¸ŠæŒ‚è½½ï¼›è‹¥ä¸»èŠ‚ç‚¹ä¸‹çº¿,ä»èŠ‚ç‚¹ä¸Šçº¿,åˆ™ä»èŠ‚ç‚¹å¯ä»¥ç›´æ¥æŒ‚è½½,ä¸éœ€è¦å†æ¬¡æ ¼å¼åŒ–ã€‚é›†ç¾¤ä¸­åªæœ‰ primary æœåŠ¡å™¨å¯ä»¥æŒ‚è½½è®¾å¤‡ï¼Œsecondary æŒ‚è½½ä¼šæŠ¥é”™ã€‚åªæœ‰åœ¨è¿›è¡Œæ•…éšœè¿ç§»å‡çº§ä¸ºä¸»æ—¶æ‰éœ€è¦æŒ‚è½½ã€‚</li><li>å¦‚æœ<code>DRBD</code>çŠ¶æ€ä¸‹å…³æœºåŒæ§æ¢å¤ä¸è¿‡æ¥ï¼Œå°è¯•åˆ é™¤<code>DRBD</code>é…ç½®ä¿¡æ¯ï¼Œç„¶ååœæ‰<code>DRBD</code>ç«¯ ODSP å’Œ<code>mysql</code>é‡å¯ä¹‹åå³å¯ï¼›(æ­¤æ¡ä»…é’ˆå¯¹å…¬å¸é¡¹ç›®)</li></ol><h3 id="å•ä¸ªdrbdé…ç½®æ–‡ä»¶ï¼ˆä»¥-drbd10-res-ä¸ºä¾‹ï¼‰"><a href="#å•ä¸ªdrbdé…ç½®æ–‡ä»¶ï¼ˆä»¥-drbd10-res-ä¸ºä¾‹ï¼‰" class="headerlink" title="å•ä¸ªdrbdé…ç½®æ–‡ä»¶ï¼ˆä»¥ drbd10.res ä¸ºä¾‹ï¼‰"></a>å•ä¸ª<code>drbd</code>é…ç½®æ–‡ä»¶ï¼ˆä»¥ drbd10.res ä¸ºä¾‹ï¼‰</h3><ul><li><p>é¡¹ç›®ä¸­çš„é…ç½®æ–¹æ¡ˆ</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">resource drbd11 &#123;</span><br><span class="line">    on controller-1 &#123;</span><br><span class="line">        device /dev/drbd11;</span><br><span class="line">        disk /dev/StorPool11/SANLun11;</span><br><span class="line">        address 192.168.2.10:57811;</span><br><span class="line">        meta-disk internal;</span><br><span class="line">    &#125;</span><br><span class="line">    on controller-2 &#123;</span><br><span class="line">        device /dev/drbd11;</span><br><span class="line">        disk /dev/StorPool11/SANLun11;</span><br><span class="line">        address 192.168.2.18:57811;</span><br><span class="line">        meta-disk internal;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>å¦å¤–ä¸€ç§é…ç½®æ–¹æ¡ˆ<br>æ¥è‡ª<a href="https://documentation.suse.com/zh-cn/sle-ha/15-GA/html/SLE-HA-all/cha-ha-drbd.html#pro-drbd-configure">è¿™é‡Œ</a></p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">resource r0 &#123;   # â‘ </span><br><span class="line">  device /dev/drbd0; # â‘¡</span><br><span class="line">  disk /dev/sda1;   # â‘¢</span><br><span class="line">  meta-disk internal;   # â‘£</span><br><span class="line">  on alice &#123;    # â‘¤</span><br><span class="line">    address  192.168.1.10:7788;     # â‘¥</span><br><span class="line">  &#125;</span><br><span class="line">  on bob &#123; </span><br><span class="line">    address 192.168.1.11:7788; </span><br><span class="line">  &#125;</span><br><span class="line">  syncer &#123;</span><br><span class="line">    rate  7M;   # â‘¦</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¿»è¯‘ä»¥çœ‹æ‡‚ä¸ºç›®çš„ï¼š   </p></li></ul><ol><li>å…è®¸æŸäº›ç³»ç»ŸæœåŠ¡é¡¹å…³è”çš„åç§°ï¼Œå¦‚ï¼šnfs, http, mysql_0, postgres_wal ç­‰ï¼›<br>Name that allows some association to the service that needs them. For example, nfs, http, mysql_0, postgres_wal, etc.</li><li><code>DRBD</code>è®¾å¤‡åç§°åŠç¼–å·ï¼›<br>The device name for DRBD and its minor number.<br>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ<code>drbd</code>çš„ç¼–å·æ˜¯<code>0</code>ã€‚udev é›†æˆè„šæœ¬æä¾›ç¬¦å·é“¾æ¥<code>/dev/drbd/by-res/nfs/0</code>ã€‚æˆ–è€…ï¼Œä¹Ÿå¯ä»¥çœç•¥é…ç½®ä¸­çš„è®¾å¤‡èŠ‚ç‚¹åç§°ï¼Œç„¶åä½¿ç”¨ä¸‹é¢è¿™ç§å½¢å¼ä»£æ›¿ï¼š<br><code>drbd0 minor 0</code>ï¼ˆ/dev/å¯é€‰ï¼‰æˆ–<code>/dev/drbd0</code>ï¼›<br>In the example above, the minor number 0 is used for DRBD. The udev integration scripts will give you a symbolic link /dev/drbd/by-res/nfs/0. Alternatively, omit the device node name in the configuration and use the following line instead:<br>drbd0 minor 0 (/dev/ is optional) or /dev/drbd0</li><li>èŠ‚ç‚¹ä¹‹é—´è¿›è¡Œå¤åˆ¶çš„åŸå§‹è®¾å¤‡ã€‚æ³¨æ„ï¼šåœ¨æœ¬ä¾‹ä¸­ï¼Œä¸¤ä¸ªèŠ‚ç‚¹ä¸Šé¢çš„è®¾å¤‡æ˜¯ç›¸åŒçš„ã€‚è‹¥ä½¿ç”¨ä¸åŒè®¾å¤‡ï¼Œè¯·å°†ç£ç›˜å‚æ•°ç§»åŠ¨åˆ°çŠ¶æ€ä¸º<code>on</code>èŠ‚ç‚¹ä¸Šã€‚ï¼ˆï¼Ÿï¼‰<br>The raw device that is replicated between nodes. Note, in this example the devices are the same on both nodes. If you need different devices, move the disk parameter into the on host.</li><li><code>meta-disk</code>å‚æ•°é€šå¸¸åŒ…å«éšå¼å€¼<code>internal</code>ï¼Œä½†æ˜¯ä½ ä¹Ÿå¯ä»¥æŒ‡å®šä¸€ä¸ªæ˜¾å¼è®¾å¤‡ä¿å­˜å…ƒæ•°æ®ã€‚è¯¦æƒ…å‚è§ï¼š<a href="http://www.drbd.org/users-guide-emb/ch-internals.html#s-metadata">è¿™é‡Œ&gt;&gt;&gt;</a><br>The meta-disk parameter usually contains the value internal, but it is possible to specify an explicit device to hold the meta data. See <a href="http://www.drbd.org/users-guide-emb/ch-internals.html#s-metadata">http://www.drbd.org/users-guide-emb/ch-internals.html#s-metadata</a> for more information.</li><li><code>on</code>èŠ‚é…ç½®æŒ‡æ˜æ”¹é…ç½®åº”ç”¨äºå…·ä½“å“ªä¸ª<code>host</code>ä¸»æœºã€‚<br>The on section states which host this configuration statement applies to.</li><li>å„èŠ‚ç‚¹çš„<code>IP</code>åœ°å€å’Œç«¯å£å·ã€‚æ¯ä¸ªèµ„æºéœ€è¦ä¸€ä¸ªå•ç‹¬çš„ç«¯å£ï¼Œé€šå¸¸ä»<code>7788</code>å¼€å§‹ã€‚DRBD èµ„æºçš„ä¸¤ä¸ªç«¯å£å¿…é¡»ç›¸åŒã€‚<br>The IP address and port number of the respective node. Each resource needs an individual port, usually starting with 7788.</li><li>åŒæ­¥ç‡ã€‚å°†å…¶è®¾ç½®ä¸ºç£ç›˜è¯»å†™å’Œç½‘ç»œå¸¦å®½çš„ä¸‰åˆ†ä¹‹ä¸€ã€‚ä»…é™åˆ¶é‡æ–°åŒæ­¥ï¼Œè€Œä¸æ˜¯å¤åˆ¶ã€‚<br>The synchronization rate. Set it to one third of the lower of the disk- and network bandwidth. It only limits the resynchronization, not the replication.</li></ol><h2 id="ä¸»ä»åˆ‡æ¢"><a href="#ä¸»ä»åˆ‡æ¢" class="headerlink" title="ä¸»ä»åˆ‡æ¢"></a>ä¸»ä»åˆ‡æ¢</h2><p>ä¸»å¤‡èŠ‚ç‚¹åˆ‡æ¢æœ‰ä¸¤ç§æ–¹å¼ï¼Œåˆ†åˆ«æ˜¯åœæ­¢<code>DRBD</code>æœåŠ¡åˆ‡æ¢å’Œæ­£å¸¸åˆ‡æ¢ã€‚</p><h3 id="æ­£å¸¸åˆ‡æ¢"><a href="#æ­£å¸¸åˆ‡æ¢" class="headerlink" title="æ­£å¸¸åˆ‡æ¢"></a>æ­£å¸¸åˆ‡æ¢</h3><p>ä¸»åˆ‡æ¢æˆä»ï¼Œéœ€è¦å…ˆå¸è½½æ–‡ä»¶ç³»ç»Ÿï¼Œå†æ‰§è¡Œé™çº§ä¸ºä»çš„å‘½ä»¤</p><h4 id="ä¸»ç«¯"><a href="#ä¸»ç«¯" class="headerlink" title="ä¸»ç«¯"></a>ä¸»ç«¯</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">umount /data/</span><br><span class="line">drbdadm secondary all</span><br></pre></td></tr></table></figure><h4 id="ä»ç«¯"><a href="#ä»ç«¯" class="headerlink" title="ä»ç«¯"></a>ä»ç«¯</h4><p>ä»åˆ‡æ¢æˆä¸»ï¼Œè¦å…ˆæ‰§è¡Œå‡ä¸»çš„å‘½ä»¤ï¼Œç„¶åæŒ‚è½½æ–‡ä»¶ç³»ç»Ÿ</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">drbdadm  primary all</span><br><span class="line">mount /dev/drbd0 /data/</span><br></pre></td></tr></table></figure><h3 id="åœæ­¢-drbd-æœåŠ¡åˆ‡æ¢"><a href="#åœæ­¢-drbd-æœåŠ¡åˆ‡æ¢" class="headerlink" title="åœæ­¢ drbd æœåŠ¡åˆ‡æ¢"></a>åœæ­¢ drbd æœåŠ¡åˆ‡æ¢</h3><p>åŸºæœ¬æ€è·¯ï¼šå…³é—­ä¸»èŠ‚ç‚¹æœåŠ¡ï¼Œæ­¤æ—¶æŒ‚è½½çš„<code>DRBD</code>åˆ†åŒºå°±è‡ªåŠ¨åœ¨ä¸»èŠ‚ç‚¹å¸è½½äº†ï¼Œç„¶ååœ¨å¤‡ç”¨èŠ‚ç‚¹æ‰§è¡Œåˆ‡æ¢å‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@drbd2 ~]#drbdadm primary all</span><br><span class="line"><span class="meta">#</span><span class="bash"> æ­¤æ—¶æŠ¥é”™ï¼š</span></span><br><span class="line">2: State change failed: (-7) Refusing to be Primary while peer is not outdated</span><br><span class="line">Command &#x27;drbdsetup 2 primary&#x27; terminated with exit code 11</span><br><span class="line"><span class="meta">#</span><span class="bash"> å› æ­¤ï¼Œå¿…é¡»åœ¨å¤‡ç”¨èŠ‚ç‚¹æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</span></span><br><span class="line">[root@drbd2 ~]#drbdsetup /dev/drbd0 primary â€“o</span><br><span class="line"><span class="meta">#</span><span class="bash"> æˆ–è€…</span></span><br><span class="line"><span class="meta">[root@drbd2~]#</span><span class="bash">drbdadm -- --overwrite-data-of-peer primary all</span></span><br></pre></td></tr></table></figure><p>å½“åœ¨å¤‡ç”¨èŠ‚ç‚¹æ‰§è¡Œåˆ‡æ¢åˆ°ä¸»èŠ‚ç‚¹å‘½ä»¤åï¼ŒåŸæ¥çš„ä¸»ç”¨èŠ‚ç‚¹è‡ªåŠ¨å˜ä¸ºå¤‡ç”¨èŠ‚ç‚¹ã€‚æ— éœ€åœ¨ä¸»ç”¨èŠ‚ç‚¹å†æ¬¡æ‰§è¡Œåˆ‡æ¢åˆ°å¤‡ç”¨èŠ‚ç‚¹çš„å‘½ä»¤ã€‚</p><h2 id="è„‘è£‚ä¿®å¤"><a href="#è„‘è£‚ä¿®å¤" class="headerlink" title="è„‘è£‚ä¿®å¤"></a>è„‘è£‚ä¿®å¤</h2><p>å½“<code>DRBD</code>å‡ºç°è„‘è£‚åï¼Œä¼šå¯¼è‡´<code>DRBD</code>ä¸¤è¾¹çš„ç£ç›˜æ•°æ®ä¸ä¸€è‡´ï¼Œåœ¨ç¡®å®šè¦ä½œä¸ºä»çš„èŠ‚ç‚¹ä¸Šåˆ‡æ¢æˆ<code>secondary</code>ï¼Œå¹¶æ”¾å¼ƒè¯¥èµ„æºçš„æ•°æ®:</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">drbdadm secondary r0</span><br><span class="line">drbdadm -- --discard-my-data connect r0</span><br></pre></td></tr></table></figure><p>ç„¶åä½œä¸º<code>primary</code>çš„èŠ‚ç‚¹é‡æ–°è¿æ¥<code>secondary</code>ï¼ˆå¦‚æœè¿™ä¸ªèŠ‚ç‚¹å½“å‰çš„è¿æ¥çŠ¶æ€ä¸º<code>WFConnection</code>çš„è¯ï¼Œå¯ä»¥çœç•¥ï¼‰ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è¿æ¥ï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">drbdadm connect r0</span><br></pre></td></tr></table></figure><h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><h3 id="åŒæ§é…ç½®äº’ä¿¡ï¼ˆå‡å®šåœ¨æ§-1-æ‰§è¡Œï¼‰"><a href="#åŒæ§é…ç½®äº’ä¿¡ï¼ˆå‡å®šåœ¨æ§-1-æ‰§è¡Œï¼‰" class="headerlink" title="åŒæ§é…ç½®äº’ä¿¡ï¼ˆå‡å®šåœ¨æ§ 1 æ‰§è¡Œï¼‰"></a>åŒæ§é…ç½®äº’ä¿¡ï¼ˆå‡å®šåœ¨æ§ 1 æ‰§è¡Œï¼‰</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">echo y|ssh-keygen -t dsa -f ~/.ssh/id_dsa -N &quot;&quot;</span><br><span class="line">cp ~/.ssh/id_dsa.pub ~/.ssh/authorized_keys</span><br><span class="line">scp -r ~/.ssh controller-2:         #åŒæ§å¯¹ç«¯hostname</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒé˜…è¯»"><a href="#å‚è€ƒé˜…è¯»" class="headerlink" title="å‚è€ƒé˜…è¯»"></a>å‚è€ƒé˜…è¯»</h2><ul><li><p><a href="https://docs.linbit.com/docs/users-guide-8.4/">å®˜æ–¹æ‰‹å†Œ</a></p></li><li><p><a href="https://www.suse.com/documentation/sle_ha/book_sleha/data/cha_ha_drbd.html">SUSE é«˜å¯ç”¨é…ç½®</a></p></li><li><p><a href="http://clusterlabs.org/doc/en-US/Pacemaker/1.1/html/Clusters_from_Scratch/ch07.html">ä½¿ç”¨ DRBD å®ç°å¤åˆ¶å­˜å‚¨</a></p></li><li><p><a href="http://www.cnblogs.com/wxl-dede/p/5114696.html">drbd é…ç½® - Rikewang - åšå®¢å›­</a></p></li><li><p><a href="http://www.3mu.me/centos%E4%B8%8B%E5%AE%9E%E7%8E%B0heartbeatdrbdmysql%E5%8F%8C%E6%9C%BA%E7%83%AD%E5%A4%87%E7%A1%AC%E4%BB%B6%E6%95%85%E9%9A%9C%E8%87%AA%E5%8A%A8%E5%88%87%E6%8D%A2%E9%AB%98%E5%8F%AF%E7%94%A8ha/#respond">CentOS ä¸‹å®ç° Heartbeat+DRBD+MySQL åŒæœºçƒ­å¤‡ç¡¬ä»¶æ•…éšœè‡ªåŠ¨åˆ‡æ¢é«˜å¯ç”¨(HA)æ–¹æ¡ˆ | ä¸‰æœ¨çš„äººç”Ÿâ€”â€”3mu.me</a></p></li><li><p><a href="https://www.ibm.com/developerworks/library/l-drbd/index.html">High availability with the Distributed Replicated Block Device</a></p></li><li><p><a href="https://yq.aliyun.com/articles/52043">è®°ä¸€æ¬¡ DRBD Unknown æ•…éšœå¤„ç†è¿‡ç¨‹</a></p></li><li><p><a href="https://www.linuxidc.com/wap.aspx?nid=93422&amp;cid=9&amp;sp=654">DRBD ç®¡ç†ã€æ•…éšœå¤„ç†éƒ¨åˆ†</a>(<a href="https://www.linuxidc.com/Linux/2013-12/93422.htm">https://www.linuxidc.com/Linux/2013-12/93422.htm</a>)</p></li><li><p><a href="http://blog.csdn.net/t1anyuan/article/details/52143789">DRBD ç¼–è¯‘å®‰è£…ä¸­å‡ºç°çš„é—®é¢˜åŠè§£å†³å°ç»“ - CSDN åšå®¢</a></p></li><li><p><a href="https://www.linuxidc.com/Linux/2012-01/51661.htm">DRBD é…ç½®å‚æ•°</a></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹è®°å½• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DRBD </tag>
            
            <tag> å­˜å‚¨ </tag>
            
            <tag> é›†ç¾¤ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DRBD çŠ¶æ€æŒ‡æ ‡è®°å½•</title>
      <link href="blog/2018-08-29/state-of-drbd/"/>
      <url>blog/2018-08-29/state-of-drbd/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><p>åœ¨ç®¡ç†<code>DRBD</code>çš„æ—¶å€™ï¼Œéœ€è¦å…³æ³¨<code>drbd</code>ç›¸å…³çš„å„ç§çŠ¶æ€æŒ‡æ ‡ï¼Œæœ¬æ–‡ä¸»è¦è®°å½•ç›¸å…³çš„æŒ‡ä»¤åŠæ˜¾ç¤ºå«ä¹‰ã€‚<br><a id="more"></a></p><h2 id="DRBDçŠ¶æ€æ¦‚è§ˆ"><a href="#DRBDçŠ¶æ€æ¦‚è§ˆ" class="headerlink" title="DRBDçŠ¶æ€æ¦‚è§ˆ"></a><code>DRBD</code>çŠ¶æ€æ¦‚è§ˆ</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">drbd-overview</span><br><span class="line">drbd status</span><br><span class="line">cat /proc/drbd      # 9.0åºŸæ­¢åœ¨drbd9ä¸­ï¼Œæ›´å¤šçš„æ˜¯ä½¿ç”¨drbdadmæˆ–drbdsetupæ¥è·å–èŠ‚ç‚¹çš„çŠ¶æ€ä¿¡æ¯ã€‚</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šå‘½ä»¤ç•¥æœ‰ä¸åŒï¼Œå¯è‡ªè¡Œå¯¹ç…§</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@Storage drbd]# pwd</span><br><span class="line">/usr/lib/drbd</span><br><span class="line">[root@Storage drbd]# ./drbd status</span><br><span class="line"><span class="meta">#</span><span class="bash"> è¾“å‡ºç¤ºä¾‹</span></span><br><span class="line">drbd driver loaded OK; device status:</span><br><span class="line">version: 8.4.3 (api:1/proto:86-101)</span><br><span class="line">GIT-hash: 89a2942***221f964d3ee515 build by root@third, 2017-07-20 10:58:42</span><br><span class="line">m:res          cs            ro                 ds                 p       mounted       fstype</span><br><span class="line">0:drbd0        Connected     Primary/Secondary  UpToDate/UpToDate  C</span><br><span class="line">1:drbd1^^0     StandAlone    Primary/Unknown    UpToDate/DUnknown  r----s</span><br><span class="line">â€¦â€¦</span><br><span class="line">6:drbd6        Connected     Primary/Secondary  UpToDate/UpToDate  C       /xxx  ext4</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç¼©å†™è§£é‡Š</p><ul><li>resï¼šèµ„æºåç§°</li><li>csï¼šconnect state,èµ„æºè¿æ¥çŠ¶æ€</li><li>roï¼šroleï¼Œè¡¨ç¤ºèŠ‚ç‚¹è§’è‰²ä¿¡æ¯<br>ç¬¬ä¸€æ¬¡å¯åŠ¨ drbd æ—¶ï¼Œä¸¤ä¸ª drbd èŠ‚ç‚¹é»˜è®¤éƒ½å¤„äº Secondary çŠ¶æ€ï¼Œ<br>Primary/Secondaryï¼ˆä»£è¡¨è¿™ä¸ªæ˜¯ä¸»èŠ‚ç‚¹ï¼‰<br>Secondary/Primaryï¼ˆä»£è¡¨è¿™ä¸ªæ˜¯å‰¯èŠ‚ç‚¹ï¼‰</li><li>dsï¼šdisk state,ç£ç›˜çŠ¶æ€ä¿¡æ¯<br>Inconsistent/Inconsistenï¼Œå³ä¸ºâ€œä¸ä¸€è‡´/ä¸ä¸€è‡´â€çŠ¶æ€ï¼Œè¡¨ç¤ºä¸¤ä¸ªèŠ‚ç‚¹çš„ç£ç›˜æ•°æ®å¤„äºä¸ä¸€è‡´çŠ¶æ€ã€‚<br>UpToDate/Inconsistentï¼ˆæ­£åœ¨åŒæ­¥ï¼Œæ•°æ®è¿˜æ²¡æœ‰ä¸€è‡´ï¼‰<br>UpToDate/UpToDate ï¼ˆåŒæ­¥å®Œæˆï¼Œæ•°æ®ä¸€è‡´ï¼‰</li><li>C drbd çš„å¤åˆ¶åè®®ï¼Œå³ Aã€Bã€C åè®®ã€‚</li><li>râ€”â€“æ˜¯ IO æ ‡è®°ï¼Œåæ˜ çš„æ˜¯è¯¥èµ„æºçš„ IO çŠ¶æ€ä¿¡æ¯ã€‚å…±æœ‰ 6 ç§ IO çŠ¶æ€æ ‡è®°ç¬¦å·ã€‚</li></ul><h2 id="è¿æ¥çŠ¶æ€"><a href="#è¿æ¥çŠ¶æ€" class="headerlink" title="è¿æ¥çŠ¶æ€"></a>è¿æ¥çŠ¶æ€</h2><p>èŠ‚ç‚¹é—´é€šè¿‡ TCP è¿æ¥è¿›è¡Œé€šä¿¡ï¼Œåœ¨å»ºç«‹è¿æ¥ã€æ–­å¼€è¿æ¥ã€ç‰¹æ®Šæƒ…å†µä¸‹æœ‰å¾ˆå¤šç§è¿æ¥çŠ¶æ€ã€‚</p><p>DRBD è¿æ¥å»ºç«‹å®Œæˆï¼Œè¡¨ç¤ºå…ƒæ•°æ®åŒºã€æ•°æ®åŒºç­‰ä¸€åˆ‡éƒ½å·²å‡†å¤‡å¥½ï¼Œå¯ä»¥è¿›è¡Œä»»ä½•æ•°æ®åŒæ­¥çš„æ“ä½œã€‚<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@master ~]# drbdadm cstate drbd20</span><br><span class="line">Connected</span><br></pre></td></tr></table></figure><br>ä¸€ä¸ªèµ„æºå¯èƒ½æœ‰ä»¥ä¸‹è¿æ¥çŠ¶æ€ä¸­çš„ä¸€ç§</p><ul><li>Unconfiguredï¼šè®¾å¤‡åœ¨ç­‰å¾…é…ç½®</li><li><strong>WFConnection</strong>ï¼šå½“å‰èŠ‚ç‚¹æ­£åœ¨ç­‰å¾…å¯¹ç«¯èŠ‚ç‚¹å‡ºç°ã€‚ä¾‹å¦‚å¯¹æ–¹èŠ‚ç‚¹<code>drbdadm down</code>åï¼Œæœ¬èŠ‚ç‚¹å°†å¤„äºæœ¬çŠ¶æ€ã€‚</li><li><strong>StandAlone</strong>ï¼šæ— è¿æ¥ã€‚å‡ºç°è¿™ç§çŠ¶æ€å¯èƒ½æ˜¯å› ä¸ºï¼šæœªè¿æ¥è¿‡ã€ä½¿ç”¨<code>drbdadm disconnect</code>æ–­å¼€è¿æ¥ã€èŠ‚ç‚¹ç”±äºèº«ä»½éªŒè¯çš„åŸå› æœªæˆåŠŸåŠ å…¥ drbd é›†ç¾¤ä½¿å¾—è¿æ¥è¢«åˆ é™¤ã€è„‘è£‚åæ–­å¼€è¿æ¥ã€‚</li><li>Disconnectingï¼šæ–­å¼€è¿æ¥çš„ä¸€ä¸ªä¸´æ—¶è¿‡æ¸¡çŠ¶æ€ã€‚å®ƒå¾ˆå¿«å°±ä¼šåˆ‡å…¥ä¸‹ä¸€çŠ¶æ€å°±æ˜¯<code>StandAlone</code>ã€‚</li><li>Unconnectedï¼šå°è¯•å†æ¬¡å‘èµ·<code>TCP</code>è¿æ¥æ—¶çš„ä¸€ä¸ªä¸´æ—¶è¿æ¥çŠ¶æ€(æ˜¯è¿æ¥è¶…æ—¶åå†æ¬¡å‘é€è¿æ¥è¯·æ±‚äº§ç”Ÿçš„çŠ¶æ€)ï¼Œå®ƒçš„ä¸‹ä¸€ä¸ªçŠ¶æ€å¯èƒ½æ˜¯<code>WFConnection</code>ï¼Œä¹Ÿå¯èƒ½æ˜¯<code>WFReportParams</code>ã€‚</li><li>Timeoutï¼šå’Œå¯¹ç«¯é€šä¿¡è¶…æ—¶æ—¶çš„ä¸´æ—¶çŠ¶æ€ã€‚ä¸‹ä¸€ä¸ªçŠ¶æ€å°±æ˜¯<code>Unconnection</code>ã€‚</li><li>BrokenPipeï¼šå’Œå¯¹ç«¯è¿æ¥ä¸¢å¤±æ—¶çš„ä¸´æ—¶çŠ¶æ€ã€‚ä¸‹ä¸€ä¸ªçŠ¶æ€æ˜¯<code>Unconnection</code>ã€‚</li><li>NetworkFailureï¼šå’Œå¯¹ç«¯è¿æ¥ä¸¢å¤±æ—¶çš„ä¸´æ—¶çŠ¶æ€ã€‚ä¸‹ä¸€ä¸ªçŠ¶æ€æ˜¯<code>Unconnection</code>ã€‚(æ²¡é”™ï¼Œå’Œä¸Šé¢çš„ä¸€æ ·)</li><li>ProtocolErrorï¼šå’Œå¯¹ç«¯è¿æ¥ä¸¢å¤±æ—¶çš„ä¸´æ—¶çŠ¶æ€ã€‚ä¸‹ä¸€ä¸ªçŠ¶æ€æ˜¯<code>Unconnection</code>ã€‚(æ²¡é”™ï¼Œè¿˜æ˜¯å’Œä¸Šé¢çš„ä¸€æ ·)</li><li>TearDownï¼šå¯¹ç«¯å…³é—­ TCP è¿æ¥æ—¶çš„ä¸´æ—¶çŠ¶æ€ã€‚ä¸‹ä¸€ä¸ªçŠ¶æ€æ˜¯<code>Unconnection</code>ã€‚</li><li><strong>Connected</strong>ï¼šDRBD è¿æ¥å·²ç»å»ºç«‹å®Œæˆï¼Œæ•°æ®é•œåƒå·²ç»æ¿€æ´»æˆåŠŸã€‚è¿™ä¸ªçŠ¶æ€æ˜¯<code>drbd</code>æ­£å¸¸è¿è¡Œæ—¶çš„çŠ¶æ€ã€‚</li><li>WFReportParamsï¼šTCP è¿æ¥å·²ç»å»ºç«‹å®Œæˆï¼Œè¯¥èŠ‚ç‚¹æ­£åœ¨ç­‰å¾…å¯¹ç«¯çš„ç¬¬ä¸€ä¸ªæ•°æ®åŒ…ã€‚</li><li>StartingSyncSï¼šå…¨ç›˜æ•°æ®åŒæ­¥ä¸­ã€‚åªæœ‰åœ¨åˆå§‹åŒ–æ—¶æ‰åº”è¯¥å…¨ç›˜åŒæ­¥ã€‚ä¸‹ä¸€ä¸ªçŠ¶æ€æ˜¯ï¼š<code>SyncSource</code>æˆ–<code>PauseSyncS</code>ã€‚</li><li>StartingSyncTï¼šå…¨ç›˜æ•°æ®åŒæ­¥ä¸­ã€‚åªæœ‰åœ¨åˆå§‹åŒ–æ—¶æ‰åº”è¯¥å…¨ç›˜åŒæ­¥ã€‚ä¸‹ä¸€ä¸ªçŠ¶æ€æ˜¯ï¼š<code>WFSyncUUID</code>ã€‚</li><li>WFBitMapSï¼šéƒ¨åˆ†æ•°æ®æ­£åœ¨åŒæ­¥ã€‚ä¸‹ä¸€ä¸ªçŠ¶æ€æ˜¯ï¼š<code>SyncSource</code>æˆ–<code>PauseSyncS</code>ã€‚</li><li>WFBitMapTï¼šéƒ¨åˆ†æ•°æ®æ­£åœ¨åŒæ­¥ã€‚ä¸‹ä¸€ä¸ªçŠ¶æ€æ˜¯ï¼š<code>WFSyncUUID</code>ã€‚</li><li>WFSyncUUIDï¼šåŒæ­¥é©¬ä¸Šå°±è¦å¼€å§‹äº†ã€‚ä¸‹ä¸€ä¸ªçŠ¶æ€ï¼š<code>SyncTarget</code>æˆ–<code>PauseSyncT</code>ã€‚</li><li><strong>SyncSource</strong>ï¼šæ­£åœ¨åŒæ­¥ï¼Œä¸”æœ¬èŠ‚ç‚¹æ˜¯æ•°æ®åŒæ­¥çš„æºç«¯ã€‚</li><li><strong>SyncTartget</strong>ï¼šæ­£åœ¨åŒæ­¥ï¼Œä¸”æœ¬èŠ‚ç‚¹æ˜¯æ•°æ®åŒæ­¥çš„ç›®æ ‡ç«¯ã€‚</li><li>PauseSyncSï¼šæœ¬èŠ‚ç‚¹æ˜¯åŒæ­¥çš„æºç«¯èŠ‚ç‚¹ï¼Œä½†åŒæ­¥è¿‡ç¨‹å½“å‰è¢«æš‚åœã€‚å‡ºç°è¿™ç§çŠ¶æ€çš„åŸå› å¯èƒ½æ˜¯å½“å‰åŒæ­¥è¿›ç¨‹ä¾èµ–äºå¦ä¸€ä¸ªåŒæ­¥è¿›ç¨‹å®Œæˆï¼Œæˆ–è€…ä½¿ç”¨<code>drbdadm pause-sync</code>æ‰‹åŠ¨ä¸­æ–­äº†åŒæ­¥æ“ä½œã€‚</li><li>PauseSyncTï¼šæœ¬èŠ‚ç‚¹æ˜¯åŒæ­¥çš„ç›®æ ‡ç«¯ï¼Œä½†åŒæ­¥è¿‡ç¨‹å½“å‰è¢«æš‚åœã€‚å‡ºç°è¿™ç§çŠ¶æ€çš„åŸå› å¯èƒ½æ˜¯å½“å‰åŒæ­¥è¿›ç¨‹ä¾èµ–äºå¦ä¸€ä¸ªåŒæ­¥è¿›ç¨‹å®Œæˆï¼Œæˆ–è€…ä½¿ç”¨<code>drbdadm pause-sync</code>æ‰‹åŠ¨ä¸­æ–­äº†åŒæ­¥æ“ä½œã€‚</li><li>VerifySï¼šæ­£åœ¨è¿›è¡Œåœ¨çº¿è®¾å¤‡éªŒè¯ï¼Œä¸”æœ¬èŠ‚ç‚¹å°†æˆä¸ºéªŒè¯çš„æºç«¯ã€‚</li><li>VerifyTï¼šæ­£åœ¨è¿›è¡Œåœ¨çº¿è®¾å¤‡éªŒè¯ï¼Œä¸”æœ¬èŠ‚ç‚¹å°†æˆä¸ºéªŒè¯çš„ç›®æ ‡ç«¯ã€‚</li></ul><p>åœ¨ drbd9 ä¸­ï¼Œ<code>WFConnection</code>çŠ¶æ€æ”¹ä¸º<code>connecting</code>çŠ¶æ€ã€‚åˆ é™¤äº†<code>WFReportParams</code>çŠ¶æ€ã€‚æ·»åŠ äº†ä»¥ä¸‹å‡ ä¸ªåŒæ­¥ç›¸å…³çš„çŠ¶æ€ï¼š</p><ul><li>Offï¼šè¯¥å·ç»„è¿˜æœªåŒæ­¥ï¼Œå› ä¸ºè¿æ¥æœªå»ºç«‹ã€‚</li><li><strong>Established</strong>ï¼šæ‰€æœ‰å¯¹è¯¥å·ç»„çš„å†™æ“ä½œå·²ç»åœ¨çº¿å®ŒæˆåŒæ­¥ã€‚è¿™æ˜¯<code>drbd</code>æ­£å¸¸è¿è¡Œæ—¶çš„çŠ¶æ€ã€‚</li><li>Aheadï¼šæ•°æ®åŒæ­¥æ“ä½œè¢«æŒ‚èµ·ï¼Œå› ä¸ºç½‘ç»œå¥—æ¥å­—ä¸­è¾¾åˆ°äº†ä¸€å®šçš„å µå¡ç¨‹åº¦ï¼Œæ— æ³•åº”ä»˜æ›´å¤šçš„è´Ÿè½½ã€‚è¯¥çŠ¶æ€éœ€è¦é…ç½®<code>on-congestion</code>é€‰é¡¹æ¥å¯ç”¨ã€‚</li><li>Behindï¼šå¯¹ç«¯å°†æ•°æ®åŒæ­¥æ“ä½œæŒ‚èµ·ï¼Œå› ä¸ºç½‘ç»œå¥—æ¥å­—ä¸­è¾¾åˆ°äº†ä¸€å®šçš„å µå¡ç¨‹åº¦ï¼Œæ— æ³•åº”ä»˜æ›´å¤šçš„è´Ÿè½½ã€‚è¯¥çŠ¶æ€éœ€è¦åœ¨å¯¹ç«¯èŠ‚ç‚¹ä¸Šé…ç½®<code>on-congestion</code>é€‰é¡¹æ¥å¯ç”¨ã€‚</li></ul><h2 id="è§’è‰²çŠ¶æ€"><a href="#è§’è‰²çŠ¶æ€" class="headerlink" title="è§’è‰²çŠ¶æ€"></a>è§’è‰²çŠ¶æ€</h2><p>èµ„æºçš„è§’è‰²çŠ¶æ€æ—¢å¯ä»¥ä»/proc/drbd æ–‡ä»¶ä¸­è·å–ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æ¥è·å–ã€‚<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@drbd1 ~]# drbdadm role data1</span><br><span class="line">Primary/Unknown</span><br></pre></td></tr></table></figure><br>åœ¨è§’è‰²çŠ¶æ€ä¿¡æ¯ä¸­ï¼Œæœ¬åœ°èŠ‚ç‚¹æ€»æ˜¯æ ‡è®°åœ¨ç¬¬ä¸€ä½ï¼Œè¿œç¨‹èŠ‚ç‚¹æ ‡è®°åœ¨ç»“å°¾ã€‚</p><p>å¯èƒ½çš„èŠ‚ç‚¹è§’è‰²çŠ¶æ€æœ‰ï¼š</p><ul><li>Primaryï¼šèµ„æºçš„ primary è§’è‰²ï¼Œè¯¥è§’è‰²çŠ¶æ€ä¸‹çš„ drbd è®¾å¤‡å¯ä»¥è¿›è¡ŒæŒ‚è½½ã€è¯»ã€å†™ç­‰ã€‚åœ¨æ²¡æœ‰å¯ç”¨å¤šä¸»å¤åˆ¶æ¨¡å‹(dual-primary mode)ï¼Œåªèƒ½æœ‰ä¸€ä¸ª primary èŠ‚ç‚¹ã€‚</li><li>Secondaryï¼šèµ„æºçš„ secondary è§’è‰²ã€‚è¯¥è§’è‰²çŠ¶æ€ä¸‹çš„ drbd è®¾å¤‡ä¼šæ¥æ”¶æ¥è‡ª primary ç«¯çš„æ•°æ®æ›´æ–°(é™¤éå’Œå¯¹ç«¯ä¸æ˜¯ primary)ã€‚ä¸”è¯¥è§’è‰²çš„ drbd è®¾å¤‡ä¸å¯æŒ‚è½½ã€ä¸å¯è¯»ã€ä¸å¯å†™ã€‚</li><li>Unknownï¼šèµ„æºçš„è§’è‰²æœªçŸ¥ã€‚æœ¬åœ°èŠ‚ç‚¹çš„è§’è‰²çŠ¶æ€ç»å¯¹ä¸å¯èƒ½ä¼šæ˜¯è¿™ç§çŠ¶æ€ã€‚åªæœ‰å¯¹ç«¯èŠ‚ç‚¹æ–­å¼€è¿æ¥æ—¶å¯¹ç«¯èŠ‚ç‚¹æ‰å¤„äº Unknown çŠ¶æ€ã€‚</li></ul><h2 id="ç¡¬ç›˜çŠ¶æ€"><a href="#ç¡¬ç›˜çŠ¶æ€" class="headerlink" title="ç¡¬ç›˜çŠ¶æ€"></a>ç¡¬ç›˜çŠ¶æ€</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@master ~]# drbdadm dstate drbd20</span><br><span class="line">UpToDate/UpToDate</span><br></pre></td></tr></table></figure><p>åœ¨ç£ç›˜çŠ¶æ€ä¿¡æ¯ä¸­ï¼Œæœ¬åœ°èŠ‚ç‚¹çš„ç£ç›˜çŠ¶æ€æ€»æ˜¯æ ‡è®°åœ¨ç¬¬ä¸€ä½ï¼Œè¿œç¨‹èŠ‚ç‚¹æ ‡è®°åœ¨ç»“å°¾ã€‚æœ¬åœ°å’Œå¯¹ç­‰èŠ‚ç‚¹çš„ç¡¬ç›˜æœ‰å¯èƒ½ä¸ºä¸‹åˆ—çŠ¶æ€ä¹‹ä¸€ï¼š</p><ul><li>Diskless æ— ç›˜ï¼šæœ¬åœ°æ²¡æœ‰å—è®¾å¤‡åˆ†é…ç»™<code>DRBD</code>ä½¿ç”¨ï¼Œè¿™æ„å‘³ç€èµ„æºå¯èƒ½ä»æ²¡æœ‰å’Œå®ƒçš„åº•å±‚å—è®¾å¤‡è¿›è¡Œå…³è”ç»‘å®š(attach)ï¼Œä¹Ÿå¯èƒ½æ˜¯æ‰‹åŠ¨ detach è§£é™¤äº†å…³è”ï¼Œè¿˜å¯èƒ½æ˜¯å‡ºç°äº†åº•å±‚ I/O é”™è¯¯æ—¶è‡ªåŠ¨åˆ†ç¦»ï¼ˆdetachï¼‰ã€‚</li><li>Attachingï¼šè¯»å–æ— æ•°æ®æ—¶å€™çš„ç¬é—´çŠ¶æ€</li><li>Failedï¼šå¤±è´¥ï¼Œæœ¬åœ°å—è®¾å¤‡æŠ¥å‘Š<code>I/O</code>é”™è¯¯çš„ä¸‹ä¸€ä¸ªçŠ¶æ€ï¼Œå…¶ä¸‹ä¸€ä¸ªçŠ¶æ€ä¸º<code>Diskless</code>æ— ç›˜</li><li>Negotiatingï¼šåœ¨å·²ç»è¿æ¥çš„ DRBD è®¾ç½®è¿›è¡Œ<code>Attach</code>è¯»å–æ— æ•°æ®å‰çš„ç¬é—´çŠ¶æ€</li><li>Inconsistentï¼šæ•°æ®ä¸ä¸€è‡´ï¼Œåœ¨ä¸¤ä¸ªèŠ‚ç‚¹ä¸Šï¼ˆåˆå§‹çš„å®Œå…¨åŒæ­¥å‰ï¼‰è¿™ç§çŠ¶æ€å‡ºç°åç«‹å³åˆ›å»ºä¸€ä¸ªæ–°çš„èµ„æºã€‚æ­¤å¤–ï¼Œåœ¨åŒæ­¥æœŸé—´ï¼ˆåŒæ­¥ç›®æ ‡ç«¯ï¼‰æ­£æ¥æ”¶åŒæ­¥æ•°æ®æ—¶ï¼Œä¹Ÿä¼šè¿›å…¥ä¸ä¸€è‡´çŠ¶æ€ã€‚</li><li>Outdatedï¼šæ•°æ®èµ„æºæ˜¯ä¸€è‡´çš„ï¼Œä½†æ˜¯å·²ç»è¿‡æ—¶ã€‚(ä¾‹å¦‚ï¼Œå·²ç»åŒæ­¥å secondary ä¸‹çº¿äº†ï¼Œä¹‹ååˆä¸Šçº¿äº†ï¼Œåœ¨è¿˜æ²¡å¼€å§‹é‡æ–°åŒæ­¥çš„æ—¶å€™å°±æ˜¯ Outdated çŠ¶æ€)</li><li>DUnknownï¼šå½“å¯¹ç­‰èŠ‚ç‚¹ç½‘ç»œè¿æ¥ä¸å¯ç”¨æ—¶å‡ºç°è¿™ç§çŠ¶æ€</li><li>Consistentï¼šè¿æ¥æ–­å¼€æ—¶çš„æ•°æ®å¤„äºä¸€è‡´æ€§çŠ¶æ€ï¼Œå½“è¿æ¥å»ºç«‹åï¼Œå°†å†³å®šæ•°æ®æ˜¯<code>UpToDate</code>è¿˜æ˜¯<code>Outdated</code>çŠ¶æ€</li><li>UpToDateï¼šä¸€è‡´çš„ã€æœ€æ–°çš„æ•°æ®çŠ¶æ€ï¼Œè¿™ä¸ªçŠ¶æ€ä¸ºæ­£å¸¸çŠ¶æ€</li></ul><h2 id="IO-çŠ¶æ€æ ‡è®°"><a href="#IO-çŠ¶æ€æ ‡è®°" class="headerlink" title="IO çŠ¶æ€æ ‡è®°"></a>IO çŠ¶æ€æ ‡è®°</h2><p>IO çŠ¶æ€æ ‡è®°è¡¨ç¤ºçš„æ˜¯å½“å‰èµ„æºçš„ IO æ“ä½œçŠ¶æ€ã€‚å…±æœ‰ 6 ç§çŠ¶æ€ï¼š</p><ul><li>IO æŒ‚èµ·ï¼šr æˆ– s éƒ½å¯èƒ½è¡¨ç¤º IO æŒ‚èµ·ï¼Œä¸€èˆ¬æ˜¯ rã€‚r=runningï¼Œs=suspendedã€‚</li><li>ä¸²è¡Œé‡æ–°åŒæ­¥ï¼šèµ„æºæ­£åœ¨ç­‰å¾…è¿›è¡Œé‡æ–°åŒæ­¥ï¼Œä½†è¢« resync-after é€‰é¡¹å»¶è¿Ÿäº†åŒæ­¥è¿›åº¦ã€‚è¯¥çŠ¶æ€æ ‡è®°ä¸ºâ€aâ€ï¼Œé€šå¸¸è¯¥çŠ¶æ€æ åº”è¯¥å¤„äºâ€-â€œã€‚</li><li>å¯¹ç«¯åˆå§‹åŒ–åŒæ­¥æŒ‚èµ·ï¼šèµ„æºæ­£åœ¨ç­‰å¾…è¿›è¡Œé‡æ–°åŒæ­¥ï¼Œä½†å¯¹ç«¯èŠ‚ç‚¹å› ä¸ºæŸäº›åŸå› è€Œ IO æŒ‚èµ·ã€‚è¯¥çŠ¶æ€æ ‡è®°ä¸ºâ€pâ€ï¼Œé€šå¸¸è¯¥çŠ¶æ€æ åº”è¯¥å¤„äºâ€-â€œã€‚</li><li>æœ¬åœ°åˆå§‹åŒ–åŒæ­¥æŒ‚èµ·ï¼šèµ„æºæ­£åœ¨ç­‰å¾…è¿›è¡Œé‡æ–°åŒæ­¥ï¼Œä½†æœ¬èŠ‚ç‚¹å› ä¸ºæŸäº›åŸå› è€Œ IO æŒ‚èµ·ã€‚è¯¥çŠ¶æ€æ ‡è®°ä¸ºâ€uâ€ï¼Œé€šå¸¸è¯¥çŠ¶æ€æ åº”è¯¥å¤„äºâ€-â€œã€‚</li><li>æœ¬åœ° IO é˜»å¡ï¼šé€šå¸¸è¯¥çŠ¶æ€æ åº”è¯¥å¤„äºâ€-â€œã€‚å¯èƒ½æœ‰ä»¥ä¸‹å‡ ç§æ ‡è®°ï¼š<ul><li>dï¼šå› ä¸º DRBD å†…éƒ¨åŸå› å¯¼è‡´çš„ IO é˜»å¡ã€‚</li><li>bï¼šåç«¯è®¾å¤‡æ­£å¤„äº IO é˜»å¡ã€‚</li><li>nï¼šç½‘ç»œå¥—æ¥å­—é˜»å¡ã€‚</li><li>aï¼šç½‘ç»œå¥—æ¥å­—å’Œåç«¯å—è®¾å¤‡åŒæ—¶å¤„äºé˜»å¡çŠ¶æ€ã€‚</li></ul></li><li>Activity Log æ›´æ–°æŒ‚èµ·ï¼šå½“ al æ›´æ–°è¢«æŒ‚èµ·æ—¶ï¼Œå¤„äºè¯¥çŠ¶æ€ï¼Œæ ‡è®°ä¸ºâ€sâ€ï¼Œé€šå¸¸è¯¥çŠ¶æ€æ åº”è¯¥å¤„äºâ€-â€œã€‚(å¦‚æœä¸çŸ¥é“ä»€ä¹ˆæ˜¯ Active Logï¼Œè¯·æ— è§†æœ¬æ ‡è®°)</li></ul><h2 id="æ€§èƒ½æŒ‡æ ‡"><a href="#æ€§èƒ½æŒ‡æ ‡" class="headerlink" title="æ€§èƒ½æŒ‡æ ‡"></a>æ€§èƒ½æŒ‡æ ‡</h2><p>ä¹ æƒ¯ä¸Šï¼Œæˆ‘ä»¬ä½¿ç”¨<code>cat /proc/drbd</code>è·å–<code>drbd</code>çŠ¶æ€ä¿¡æ¯ã€‚ä¸»è¦æ˜¯ä¸€äº›è®¡æ•°å™¨å’Œè®¡é‡å™¨çš„å€¼ã€‚<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@Storage ~]# cat /proc/drbd </span><br><span class="line">version: 8.4.3 (api:1/proto:86-101)</span><br><span class="line">srcversion: 9D811F04CD6DC2C9A9A608F </span><br><span class="line"></span><br><span class="line"> 3: cs:Connected ro:Secondary/Secondary ds:UpToDate/UpToDate C r-----</span><br><span class="line">    ns:0 nr:0 dw:0 dr:0 al:0 bm:0 lo:0 pe:0 ua:0 ap:0 ep:1 wo:f oos:0</span><br><span class="line"></span><br><span class="line">301: cs:Connected ro:Secondary/Secondary ds:UpToDate/UpToDate C r-----</span><br><span class="line">    ns:0 nr:0 dw:0 dr:0 al:0 bm:0 lo:0 pe:0 ua:0 ap:0 ep:1 wo:f oos:0</span><br></pre></td></tr></table></figure><br>drbd84 ä¸­ä½¿ç”¨ç¼©å†™ç¬¦å·æ¥æ ‡è®°æ€§èƒ½æŒ‡æ ‡ï¼Œè€Œ drbd9 ä¸­ä½¿ç”¨å…¨ç§°æ¥è¡¨ç¤ºã€‚ä¾‹å¦‚ drbd84 ä¸­çš„ ns å’Œ drbd9 ä¸­çš„ send æ˜¯åŒä¸€ä¸ªæ„æ€ã€‚</p><ul><li>ns/send (network send)ï¼šé€šè¿‡ç½‘ç»œè¿æ¥å‘é€ç»™å¯¹ç«¯çš„æ•°æ®é‡ï¼Œå•ä½ä¸º Kbã€‚</li><li>nr/receive (network receive)ï¼šé€šè¿‡ç½‘ç»œè¿æ¥æ¥æ”¶åˆ°å¯¹ç«¯å‘é€æ¥çš„æ•°æ®é‡ï¼Œå•ä½ä¸º Kbã€‚</li><li>dw/written (disk write)ï¼šè¯¥å·(volume)å†™å…¥æœ¬åœ°ç£ç›˜çš„æ•°æ®é‡ï¼Œå•ä½ä¸º Kbã€‚</li><li>dr/read (disk read)ï¼šè¯¥å·(volume)ä»æœ¬åœ°ç£ç›˜è¯»å–çš„æ•°æ®é‡ï¼Œå•ä½ä¸º Kbã€‚</li><li>al/al-writes (activity log)ï¼šå…ƒæ•°æ®åŒºä¸­ al æ›´æ–°çš„æ¬¡æ•°ã€‚</li><li>bm/bm-writes (bit map)ï¼šå…ƒæ•°æ®åŒºä¸­ bitmap æ›´æ–°çš„æ¬¡æ•°ã€‚</li><li>lo/lower-pending (local count)ï¼šDRBD å‘èµ·çš„æ‰“å¼€æœ¬åœ° IO å­ç³»ç»Ÿçš„è¯·æ±‚æ¬¡æ•°ã€‚</li><li>pe/pending (pending)ï¼šæœ¬åœ°å‘é€ç»™å¯¹ç«¯ä½†å´æ²¡æœ‰å›å¤çš„æ¬¡æ•°ã€‚</li><li>ua/unacked (unacknowledged)ï¼šæ¥æ”¶åˆ°å¯¹ç«¯å‘é€çš„è¯·æ±‚ä½†å´æ²¡æœ‰ç»™äºˆå›å¤çš„è¯·æ±‚æ•°é‡ã€‚</li><li>ap/upper-pending (application pending)ï¼šè½¬å‘ç»™ DRBD çš„ IO å—çš„è¯·æ±‚ï¼Œä½† DRBD è¿˜æ²¡ç»™äºˆå›å¤çš„è¯·æ±‚æ•°é‡ã€‚</li><li>ep (epochs):epoch å¯¹è±¡çš„æ•°é‡ã€‚é€šå¸¸ä¸º 1ã€‚drbd9 ä¸­æ²¡æœ‰è¯¥æŒ‡æ ‡ã€‚</li><li>wo/write-ordering (write order):å½“å‰æ­£åœ¨ä½¿ç”¨çš„ write order æ–¹æ³•ï¼šb(barrier), f(flush), d(drain)æˆ– n(none)ã€‚</li><li>oos/out-of-sync (out of sync):å½“å‰ä¸åŒæ­¥çš„æ•°æ®é‡ï¼Œå•ä½ä¸º Kbã€‚</li></ul><p>ä¸Šé¢æ‰€æœ‰â€æœªç»™äºˆå›å¤â€çš„æŒ‡æ ‡æ•°é‡éƒ½è¡¨ç¤ºåŠ¨ä½œè¿˜æœªå®Œæˆï¼Œéœ€è¦å›å¤åæ‰è¡¨ç¤ºæ“ä½œå®Œæˆã€‚è¿™äº›æœªå›å¤æ•°å€¼ä¸èƒ½å¤ªå¤§ã€‚</p><p>æ­¤å¤–ï¼Œdrbd9 ä¸­æ·»åŠ äº†ä»¥ä¸‹å‡ ä¸ªæŒ‡æ ‡ï¼š</p><ul><li>resync-suspendedï¼šé‡æ–°åŒæ­¥æ“ä½œå½“å‰æ˜¯å¦è¢«æŒ‚èµ·ã€‚å¯èƒ½çš„å€¼ä¸º no/user/peer/dependencyã€‚</li><li>blockedï¼šæœ¬åœ° IO çš„æ‹¥æŒ¤æƒ…å†µã€‚<ul><li>noï¼šæœ¬åœ° IO ä¸æ‹¥æŒ¤ã€‚</li><li>upperï¼šDRBD å±‚ä¹‹ä¸Šçš„ IO è¢«é˜»å¡ã€‚ä¾‹å¦‚åˆ°æ–‡ä»¶ç³»ç»Ÿä¸Šçš„ IO é˜»å¡ã€‚å¯èƒ½æœ‰ä»¥ä¸‹å‡ ç§åŸå› ï¼š<ul><li>ç®¡ç†å‘˜ä½¿ç”¨ drbdadm suspend-io å‘½ä»¤æŒ‚èµ·äº† I/O æ“ä½œã€‚</li><li>çŸ­æš‚çš„ IO é˜»å¡ï¼Œä¾‹å¦‚ attach/detach å¯¼è‡´çš„ã€‚</li><li>åˆ é™¤äº†ç¼“å†²åŒºã€‚</li><li>bitmap çš„ IO ç­‰å¾…ã€‚</li></ul></li><li>lowerï¼šåº•å±‚è®¾å¤‡å¤„äºæ‹¥æŒ¤çŠ¶æ€ã€‚</li></ul></li></ul><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><ul><li><a href="https://www.linbit.com/drbd-user-guide/users-guide-drbd-8-4/#s-check-status">DRBD 8.4 en Â» LINBIT</a></li><li><a href="http://www.cnblogs.com/f-ck-need-u/p/8684648.html">drbd(ä¸‰)ï¼šdrbd çš„çŠ¶æ€è¯´æ˜ - éªé©¬é‡‘é¾™ - åšå®¢å›­</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹è®°å½• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DRBD </tag>
            
            <tag> Linux </tag>
            
            <tag> é«˜å¯ç”¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DRBD ä½¿ç”¨å¤–éƒ¨å…ƒæ•°æ®</title>
      <link href="blog/2018-08-28/drbd-with-external-disk/"/>
      <url>blog/2018-08-28/drbd-with-external-disk/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><p>è£‚è„‘ä¸€æ—¦å‘ç”Ÿï¼Œéœ€è¦åŠæ—¶æ’æŸ¥é—®é¢˜æ‰€åœ¨ï¼Œæœ€å¤§é™åº¦ä¿æŠ¤æ•°æ®å®Œæ•´æ€§ã€‚<br><a id="more"></a></p><h2 id="meta-dataå­˜æ”¾ä½ç½®ä¼˜ç¼ºç‚¹æ¯”è¾ƒ"><a href="#meta-dataå­˜æ”¾ä½ç½®ä¼˜ç¼ºç‚¹æ¯”è¾ƒ" class="headerlink" title="meta dataå­˜æ”¾ä½ç½®ä¼˜ç¼ºç‚¹æ¯”è¾ƒ"></a><code>meta data</code>å­˜æ”¾ä½ç½®ä¼˜ç¼ºç‚¹æ¯”è¾ƒ</h2><h3 id="internal-meta-data"><a href="#internal-meta-data" class="headerlink" title="internal meta-data"></a>internal meta-data</h3><p>meta-data å’Œæ•°æ®å­˜æ”¾åœ¨åŒä¸€ä¸ªåº•å±‚è®¾å¤‡ä¹‹ä¸Šï¼Œå®ƒé€šè¿‡åœ¨è®¾å¤‡æœ«ç«¯é¢„ç•™ä¸€ä¸ªåŒºåŸŸä»¥å­˜å‚¨å…ƒæ•°æ®åšåˆ°è¿™ä¸€ç‚¹ã€‚</p><ul><li>ä¼˜ç‚¹ï¼š</li></ul><p>ä¸€æ—¦ meta-data åˆ›å»ºä¹‹åï¼Œå°±å’Œå®é™…æ•°æ®ç»‘åœ¨äº†ä¸€èµ·ï¼Œåœ¨ç»´æŠ¤ä¸Šä¼šæ›´ç®€å•æ–¹ä¾¿ï¼Œä¸ç”¨æ‹…å¿ƒ meta-data ä¼šå› ä¸ºæŸäº›æ“ä½œè€Œä¸¢å¤±ã€‚å¦å¤–åœ¨ç¡¬ç›˜æŸåä¸¢å¤±æ•°æ®çš„åŒæ—¶ï¼Œmeta-data ä¹Ÿè·Ÿç€ä¸€èµ·ä¸¢å¤±ï¼Œå½“æ›´æ¢ç¡¬ç›˜ä¹‹åï¼Œåªéœ€è¦æ‰§è¡Œé‡å»º meta-data çš„å‘½ä»¤å³å¯ï¼Œä¸¢å¤±çš„æ•°æ®ä¼šå¾ˆå®¹æ˜“çš„ä»å…¶ä»–èŠ‚ç‚¹åŒæ­¥è¿‡æ¥ã€‚</p><ul><li>ç¼ºç‚¹ï¼š</li></ul><p>å¦‚æœåº•å±‚è®¾å¤‡æ˜¯å•ä¸€çš„ç£ç›˜ï¼Œæ²¡æœ‰åš raidï¼Œä¹Ÿä¸æ˜¯ lvm ç­‰ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šå¯¹å†™å…¥ååé‡äº§ç”Ÿè´Ÿé¢å½±å“ã€‚å› ä¸ºæ¯ä¸€æ¬¡å†™ io éƒ½éœ€è¦æ›´æ–° meta-data é‡Œé¢çš„ä¿¡æ¯ï¼Œé‚£ä¹ˆæ¯æ¬¡å†™ io éƒ½ä¼šæœ‰ä¸¤æ¬¡ï¼Œè€Œä¸”è‚¯å®šä¼šæœ‰ç£å¤´çš„è¾ƒå¤§å¯»é“ç§»åŠ¨ï¼Œå› ä¸º meta-data éƒ½æ˜¯è®°å½•åœ¨è®¾å¤‡çš„æœ€æœ«ç«¯çš„ï¼Œè¿™æ ·å°±ä¼šé€ æˆå†™ io çš„æ€§èƒ½é™ä½ã€‚</p><h3 id="external-meta-data"><a href="#external-meta-data" class="headerlink" title="external meta data"></a>external meta data</h3><p><code>meta-data</code>å­˜æ”¾åœ¨ç‹¬ç«‹çš„ï¼Œä¸å­˜æ”¾æ•°æ®çš„è®¾å¤‡åˆ†å¼€çš„è®¾å¤‡ä¹‹ä¸Šã€‚</p><ul><li>ä¼˜ç‚¹ï¼š</li></ul><p>ä¸ internal meta-data çš„ç¼ºç‚¹å®Œå…¨ç›¸å¯¹ã€‚å¯¹äºæŸäº›å†™æ“ä½œ, ä½¿ç”¨å¤–éƒ¨å…ƒæ•°æ®ä¼šç¨å¾®æ”¹è¿›å»¶è¿Ÿè¡Œä¸ºã€‚</p><ul><li>ç¼ºç‚¹ï¼š</li></ul><p>ç”±äº meta-data å­˜æ”¾åœ¨ä¸æ•°æ®è®¾å¤‡åˆ†å¼€çš„åœ°æ–¹ï¼Œå°±æ„å‘³ç€å¦‚æœç£ç›˜æ•…éšœä¸”ä»…ç ´åç”Ÿäº§æ•°æ® (è€Œä¸æ˜¯ DRBD å…ƒæ•°æ®), åˆ™å¯ä»¥é€šè¿‡æ‰‹åŠ¨å¹²é¢„, ä»¥ä½¿å‘èµ·ä»å¹¸å­˜çš„èŠ‚ç‚¹åˆ°åç»­æ›´æ¢çš„ç£ç›˜ä¸Šçš„å®Œæ•´æ•°æ®åŒæ­¥ã€‚ä¹Ÿå°±æ˜¯ç®¡ç†ç»´æŠ¤ä¼šç¨å¾®éº»çƒ¦ä¸€ç‚¹ï¼Œå¾ˆå°çš„ä¸€ç‚¹ç‚¹ã€‚</p><p><strong>æ³¨æ„ï¼š</strong> å¦‚æœæˆ‘ä»¬å¸Œæœ›åœ¨å·²ç»å­˜åœ¨æ•°æ®çš„è®¾å¤‡ä¸Šé¢å»ºç«‹ drbd çš„èµ„æºï¼Œå¹¶ä¸”ä¸å¸Œæœ›ä¸¢å¤±è¯¥è®¾å¤‡ä¸Šé¢çš„æ•°æ®ï¼Œåˆæ²¡åŠæ³•å¢å¤§åº•å±‚è®¾å¤‡çš„å®¹é‡ï¼Œè€Œä¸”ä¸Šå±‚æ–‡ä»¶ç³»ç»Ÿä¸æ”¯æŒæ”¶ç¼©ï¼Œæˆ‘ä»¬å°±åªèƒ½å°† meta data åˆ›å»ºæˆ external æ–¹å¼ã€‚</p><h2 id="ä¼°ç®—å…ƒæ•°æ®å¤§å°"><a href="#ä¼°ç®—å…ƒæ•°æ®å¤§å°" class="headerlink" title="ä¼°ç®—å…ƒæ•°æ®å¤§å°"></a>ä¼°ç®—å…ƒæ•°æ®å¤§å°</h2><p>æ³¨æ„ï¼šå¦‚æœå…¬å¼æ¸²æŸ“å‡ºé”™ï¼Œå¯ä»¥å»<a href="https://zohooo.github.io/jaxedit/">è¿™é‡Œ</a>é¢„è§ˆ</p><p>ä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å…¬å¼è®¡ç®— DRBD å…ƒæ•°æ®çš„ç²¾ç¡®ç©ºé—´è¦æ±‚:</p><p><img src= "/img/loading.svg" data-lazy-src="https://docs.linbit.com/ug-src/users-guide-8.4/images/metadata-size-exact.png" alt="ç²¾ç¡®è®¡ç®—å…ƒæ•°æ®å¤§å°"></p><p>$$M_{S}= \lceil\frac{C_{s}}{2^{18}} \rceil \ast 8 \ast N + 72$$</p><p>Cs æ˜¯å­˜å‚¨è®¾å¤‡æ‰‡åŒºå¤§å°ã€‚N æ˜¯å¯¹ç«¯çš„æ•°é‡ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ drbd å®ç°çš„æ˜¯åŒèŠ‚ç‚¹ï¼Œå› æ­¤ N=1ï¼Œå¯ä»¥ä¸ç”¨è€ƒè™‘ã€‚</p><p>æ‚¨å¯ä»¥é€šè¿‡å‘å‡º blockdev â€“getsz <device>æ¥æ£€ç´¢è®¾å¤‡å¤§å°ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@Storage ~]# blockdev --getsz /dev/StorPool1/SANLun2</span><br><span class="line">2097152</span><br></pre></td></tr></table></figure><p>ç»“æœä¸­çš„ Ms çš„å¤§å°ä¹Ÿæ˜¯ç”¨æ‰‡åŒºè¡¨ç¤ºçš„,è¦è½¬æ¢ä¸º MB, è¯·é™¤ä»¥ 2048ã€‚(å¯¹äº 512 å­—èŠ‚çš„æ‰‡åŒºå¤§å°, è¿™æ˜¯é™¤ s390 ä¹‹å¤–çš„æ‰€æœ‰ Linux å¹³å°ä¸Šçš„é»˜è®¤å€¼)ã€‚<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">In [<span class="number">23</span>]: (math.ceil(<span class="number">2097152</span>/<span class="number">2</span>**<span class="number">18</span>)*<span class="number">8</span>+<span class="number">72</span>)/<span class="built_in">float</span>(<span class="number">2048</span>)</span><br><span class="line">Out[<span class="number">23</span>]: <span class="number">0.06640625</span></span><br></pre></td></tr></table></figure><br>åœ¨å®è·µä¸­, ä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªåˆç†çš„å¥½çš„è¿‘ä¼¼, ä¸‹é¢ç»™å‡ºã€‚è¯·æ³¨æ„, åœ¨æ­¤å…¬å¼ä¸­, å•ä½ä¸ºå…†å­—èŠ‚(megabytes), è€Œéæ‰‡åŒº:</p><p><img src= "/img/loading.svg" data-lazy-src="https://docs.linbit.com/ug-src/users-guide-8.4/images/metadata-size-approx.png" alt="é¢„ä¼°è®¡ç®—å…ƒæ•°æ®å¤§å°"></p><p>$$M_{MB} \lt \frac{C_{MB}}{32768} \ast N + 1$$</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> è·å–å—è®¾å¤‡å¤§å°</span></span><br><span class="line">[root@Storage ~]# lsblk /dev/StorPool1/SANLun2</span><br><span class="line">NAME              MAJ:MIN RM SIZE RO TYPE MOUNTPOINT</span><br><span class="line">StorPool1-SANLun2 253:3    0   1G  0 lvm  </span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># é¢„ä¼°å…ƒæ•°æ®è®¾å¤‡å¤§å°</span></span><br><span class="line">In [<span class="number">30</span>]: <span class="number">1024</span>/<span class="built_in">float</span>(<span class="number">32768</span>)+<span class="number">1</span></span><br><span class="line">Out[<span class="number">30</span>]: <span class="number">1.03125</span></span><br></pre></td></tr></table></figure><p>æ­¤å¤„æ’æ’­ä¸€ä¸ªå°çš„çŸ¥è¯†ç‚¹,æ¥æºå‚è€ƒ<a href="https://blog.csdn.net/starshine/article/details/8226320">è¿™é‡Œ</a>ï¼ˆè§£é‡Šï¼‰å’Œ<a href="http://www.maixj.net/ict/kbkib-mbmib-gbgib-15095">è¿™é‡Œ</a>ï¼ˆåŒºåˆ«ï¼‰ã€‚</p><table><thead><tr><th style="text-align:left">åå­—</th><th style="text-align:left">ç¼©å†™</th><th style="text-align:left">æ¬¡æ–¹</th><th style="text-align:left">åå­—</th><th style="text-align:left">ç¼©å†™</th><th style="text-align:left">æ¬¡æ–¹</th></tr></thead><tbody><tr><td style="text-align:left">kilobyte</td><td style="text-align:left">KB</td><td style="text-align:left">10^3</td><td style="text-align:left">kibibyte</td><td style="text-align:left">KiB</td><td style="text-align:left">2^10</td></tr><tr><td style="text-align:left">megabyte</td><td style="text-align:left">MB</td><td style="text-align:left">10^6</td><td style="text-align:left">mebibyte</td><td style="text-align:left">MiB</td><td style="text-align:left">2^20</td></tr><tr><td style="text-align:left">gigabyte</td><td style="text-align:left">GB</td><td style="text-align:left">10^9</td><td style="text-align:left">gibibyte</td><td style="text-align:left">GiB</td><td style="text-align:left">2^30</td></tr><tr><td style="text-align:left">terabyte</td><td style="text-align:left">TB</td><td style="text-align:left">10^12</td><td style="text-align:left">tebibyte</td><td style="text-align:left">TiB</td><td style="text-align:left">2^40</td></tr><tr><td style="text-align:left">petabyte</td><td style="text-align:left">PB</td><td style="text-align:left">10^15</td><td style="text-align:left">pebibyte</td><td style="text-align:left">PiB</td><td style="text-align:left">2^50</td></tr><tr><td style="text-align:left">exabyte</td><td style="text-align:left">EB</td><td style="text-align:left">10^18</td><td style="text-align:left">exbibyte</td><td style="text-align:left">EiB</td><td style="text-align:left">2^60</td></tr><tr><td style="text-align:left">zettabyte</td><td style="text-align:left">ZB</td><td style="text-align:left">10^21</td><td style="text-align:left">zebibyte</td><td style="text-align:left">ZiB</td><td style="text-align:left">2^70</td></tr><tr><td style="text-align:left">yottabyte</td><td style="text-align:left">YB</td><td style="text-align:left">10^24</td><td style="text-align:left">yobibyte</td><td style="text-align:left">YiB</td><td style="text-align:left">2^80</td></tr></tbody></table><h2 id="é‡ç½®èµ„æºçš„å¤§å°"><a href="#é‡ç½®èµ„æºçš„å¤§å°" class="headerlink" title="é‡ç½®èµ„æºçš„å¤§å°"></a>é‡ç½®èµ„æºçš„å¤§å°</h2><h3 id="åœ¨çº¿å¢åŠ "><a href="#åœ¨çº¿å¢åŠ " class="headerlink" title="åœ¨çº¿å¢åŠ "></a>åœ¨çº¿å¢åŠ </h3><p>éœ€è¦æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼š</p><ol><li><p>æ”¯æŒè®¾å¤‡å¿…é¡»æ˜¯é€»è¾‘å·</p></li><li><p>å½“å‰çš„èµ„æºå¿…é¡»å¤„äº<code>connected</code>çš„è¿æ¥çŠ¶æ€ã€‚</p></li></ol><p>åœ¨ä¸¤ä¸ªèŠ‚ç‚¹ç»™è®¾å¤‡å¢åŠ å¤§å°åï¼Œå†ç¡®è®¤åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹å¤„äº<code>primary</code>çŠ¶æ€ã€‚ç„¶åè¾“å…¥ï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">drbdadm resize &lt;resource&gt;</span><br></pre></td></tr></table></figure><p>æ­¤å‘½ä»¤ä¼šè§¦å‘æ–°æ‰‡åŒºçš„åŒæ­¥ï¼Œå®Œæˆä¸»èŠ‚ç‚¹åˆ°å¤‡ç”¨èŠ‚ç‚¹é—´çš„åŒæ­¥ã€‚</p><p>å¦‚æœä½ æ·»åŠ çš„ç©ºé—´æ˜¯å¹²å‡€æ²¡æœ‰æ•°æ®çš„ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>--assume-clean</code>é€‰é¡¹ï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">drbdadm -- --assume-clean resize &lt;resource&gt;</span><br></pre></td></tr></table></figure><p>æ¥è·³è¿‡é¢å¤–çš„ç©ºé—´åŒæ­¥ã€‚</p><h3 id="ç¦»çº¿å¢åŠ "><a href="#ç¦»çº¿å¢åŠ " class="headerlink" title="ç¦»çº¿å¢åŠ "></a>ç¦»çº¿å¢åŠ </h3><p>ï¼ˆæ­¤ä¸ºé«˜çº§åŠŸèƒ½ï¼Œè¯·è‡ªå®¡ä¹‹åä½¿ç”¨ã€‚ï¼‰</p><ol><li>èµ„æºè¢«é…ç½®ä¸º external meta data æ—¶</li></ol><p>å½“ DRBD åœ¨å¤„äºéæ´»åŠ¨æƒ…å†µä¸‹ï¼Œåœ¨ä¸¤ä¸ªèŠ‚ç‚¹çš„æ”¯æŒè®¾å¤‡è¢«æ‰©å±•æ—¶ï¼Œä¸” DRBD èµ„æºä½¿ç”¨çš„æ˜¯ external meta dataï¼Œé‚£ä¹ˆæ–°çš„å¤§å°ä¼šè‡ªåŠ¨è¢«è¯†åˆ«ï¼Œä¸éœ€è¦ç®¡ç†å‘˜å¹²é¢„ã€‚DRBD è®¾å¤‡å°†åœ¨ä¸‹æ¬¡ä¸¤ä¸ªèŠ‚ç‚¹æ´»åŠ¨å¹¶ä¸”æˆåŠŸå»ºç«‹ç½‘ç»œè¿æ¥ä¹‹åï¼Œæ˜¾ç¤ºå¢åŠ åçš„æ–°å®¹é‡ã€‚</p><ol start="2"><li>èµ„æºè¢«é…ç½®ä¸º internal meta data æ—¶</li></ol><p>å½“ DRBD èµ„æºè¢«é…ç½®ä¸ºä½¿ç”¨ internal meta data æ—¶ï¼Œåœ¨æ–°å¤§å°å˜ä¸ºå¯ç”¨ä¹‹å‰, åˆ™å¿…é¡»å°†æ­¤å…ƒæ•°æ®ç§»åŠ¨åˆ°å·²æ‰©å®¹è®¾å¤‡çš„æœ«å°¾ã€‚ä¸ºæ­¤, è¯·å®Œæˆä»¥ä¸‹æ­¥éª¤:</p><ul><li>down æ‰ DRBD èµ„æº:</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">drbdadm down &lt;resource&gt;</span><br></pre></td></tr></table></figure><ul><li>åœ¨æ”¶ç¼©ä¹‹å‰å°†å…ƒæ•°æ®ä¿å­˜åœ¨æ–‡æœ¬æ–‡ä»¶ä¸­</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">drbdadm dump-md &lt;resource&gt; &gt; /tmp/metadata</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼š</strong> ä»¥ä¸Šæ­¥éª¤å¿…é¡»åœ¨ä¸¤ä¸ªèŠ‚ç‚¹ä¸Šåˆ†åˆ«è¿è¡Œã€‚ä¸èƒ½åœ¨ä¸€ä¸ªèŠ‚ç‚¹ä¸Šä¿å­˜äº†å…ƒæ•°æ®ç„¶ååœ¨æ‹·è´åˆ°å¦å¤–ä¸€ä¸ªèŠ‚ç‚¹ä¸Šã€‚å¦åˆ™å°±æ— æ³•æ­£å¸¸å·¥ä½œã€‚</p><ul><li><p>åœ¨ä¸¤ä¸ªèŠ‚ç‚¹ä¸Šç»™æ”¯æŒçš„å—è®¾å¤‡å¢åŠ å®¹é‡</p></li><li><p>åˆ†åˆ«åœ¨ä¸¤ä¸ªèŠ‚ç‚¹ä¸Šè°ƒæ•´/tmp/metadata æ–‡ä»¶ä¸­<code>la-size-sect</code>çš„å¤§å°ä¿¡æ¯ã€‚æ³¨ï¼šè¿™é‡Œ la-size-sect æŒ‡å®šçš„æ˜¯æ‰‡åŒºæ•°é‡</p></li><li><p>é‡æ–°åˆå§‹åŒ–å…ƒæ•°æ®åŒºåŸŸ</p></li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">drbdadm create-md &lt;resource&gt;</span><br></pre></td></tr></table></figure><ul><li>åˆ†åˆ«åœ¨ä¸¤ä¸ªèŠ‚ç‚¹ä¸Šé‡æ–°å¯¼å…¥ä¿®æ­£çš„å…ƒæ•°æ®</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># æ­¤å¤„ä½¿ç”¨bashè„šæœ¬ï¼Œéœ€è¦ç¡®è®¤å¯ç”¨æ€§</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> drbdmeta_cmd=$(drbdadm -d dump-md &lt;resource&gt;)</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="variable">$&#123;drbdmeta_cmd/dump-md/restore-md&#125;</span> /tmp/metadata</span></span><br><span class="line">Valid meta-data in place, overwrite? [need to type &#x27;yes&#x27; to confirm]</span><br><span class="line">yes</span><br><span class="line">Successfully restored meta data</span><br></pre></td></tr></table></figure><ul><li>é‡æ–°å¯ç”¨ DRBD èµ„æº</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">drbdadm up &lt;resource&gt;</span><br></pre></td></tr></table></figure><ul><li>åœ¨ä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼Œè®¾ç½® DRBD ä¸º primary</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">drbdadm primary &lt;resource&gt;</span><br></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œå·²å®Œæˆ DRBD è®¾å¤‡å¤§å°çš„æ‰©å®¹ã€‚</p><h3 id="åœ¨çº¿ç¼©å°å®¹é‡"><a href="#åœ¨çº¿ç¼©å°å®¹é‡" class="headerlink" title="åœ¨çº¿ç¼©å°å®¹é‡"></a>åœ¨çº¿ç¼©å°å®¹é‡</h3><p>æ³¨ï¼šåœ¨çº¿ç¼©å°å®¹é‡ï¼Œä»…æ”¯æŒ<code>external metadata</code></p><p>åœ¨ç¼©å° DRBD è®¾å¤‡æ—¶å¿…é¡»é¦–å…ˆç¼©å° DRBD çš„ä¸Šå±‚å—è®¾å¤‡ã€‚ä¾‹å¦‚æ–‡ä»¶ç³»ç»Ÿã€‚ç”±äº DRBD æ— æ³•è·çŸ¥æ–‡ä»¶ç³»ç»Ÿåˆ°åº•ä½¿ç”¨äº†å¤šå°‘ç©ºé—´ï¼Œæ‰€ä»¥åœ¨ç¼©å°æ–‡ä»¶ç³»ç»Ÿæ—¶éœ€è¦æ ¼å¤–å°å¿ƒé˜²æ­¢æ•°æ®ä¸¢å¤±ï¼æ–‡ä»¶ç³»ç»Ÿæ˜¯å¦å¯ä»¥è¢«ç¼©å°å–å†³äºæ‰€ä½¿ç”¨çš„æ–‡ä»¶ç³»ç»Ÿã€‚å¤§å¤šæ•°æ–‡ä»¶ç³»ç»Ÿä¸æ”¯æŒåœ¨çº¿ç¼©å‡ã€‚XFS ä¹Ÿä¸æ”¯æŒåœ¨çº¿ç¼©å‡ã€‚</p><p>å› æ­¤ï¼Œåœ¨ç¼©å°æ–‡ä»¶ç³»ç»Ÿåï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åœ¨çº¿ç¼©å° DRBD è®¾å¤‡å®¹é‡ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">drbdadm resize --size=&lt;new-size&gt;  &lt;resource&gt;</span><br></pre></td></tr></table></figure><h3 id="ç¦»çº¿æ”¶ç¼©å®¹é‡"><a href="#ç¦»çº¿æ”¶ç¼©å®¹é‡" class="headerlink" title="ç¦»çº¿æ”¶ç¼©å®¹é‡"></a>ç¦»çº¿æ”¶ç¼©å®¹é‡</h3><p>ï¼ˆæ­¤ä¸ºé«˜çº§åŠŸèƒ½ï¼Œè¯·è‡ªå®¡ä¹‹åä½¿ç”¨ã€‚ï¼‰</p><p>å¦‚æœåœ¨ DRBD å¤„äºéæ´»åŠ¨çŠ¶æ€æ—¶æ”¶ç¼©åå¤‡å—è®¾å¤‡, DRBD å°†æ‹’ç»åœ¨ä¸‹æ¬¡å°è¯•<code>attach</code>æœŸé—´<code>attach</code>åˆ°æ­¤å—è®¾å¤‡, å› ä¸ºå®ƒç°åœ¨å¤ªå° (external meta-data), æˆ–è€…å®ƒå°†æ— æ³•æ‰¾åˆ°å…¶å…ƒæ•°æ® (internal meta-data)ã€‚è¦å˜é€šè§£å†³è¿™äº›é—®é¢˜, è¯·ä½¿ç”¨æ­¤è¿‡ç¨‹ (å¦‚æœä¸èƒ½ä½¿ç”¨ä¸Šé¢çš„åœ¨çº¿æ”¶ç¼©):</p><ul><li><p>åœ¨ DRBD è¿˜å¤„äºé…ç½®è¿è¡ŒçŠ¶æ€æ—¶ï¼Œåœ¨ä¸€ä¸ªèŠ‚ç‚¹ä¸Šç¼©å°æ–‡ä»¶ç³»ç»Ÿ</p></li><li><p>down æ‰ DRBD èµ„æº</p></li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">drbdadm down &lt;resource&gt;</span><br></pre></td></tr></table></figure><ul><li>åœ¨ç¼©å°å‰ä¿å­˜å…ƒæ•°æ®åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼š</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">drbdadm dump-md &lt;resource&gt; &gt; /tmp/metadata</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼š</strong> ä»¥ä¸Šæ­¥éª¤å¿…é¡»åœ¨ä¸¤ä¸ªèŠ‚ç‚¹ä¸Šåˆ†åˆ«è¿è¡Œã€‚ä¸èƒ½åœ¨ä¸€ä¸ªèŠ‚ç‚¹ä¸Šä¿å­˜äº†å…ƒæ•°æ®ç„¶ååœ¨æ‹·è´åˆ°å¦å¤–ä¸€ä¸ªèŠ‚ç‚¹ä¸Šã€‚å¦åˆ™å°±æ— æ³•æ­£å¸¸å·¥ä½œã€‚</p><ul><li><p>åœ¨ä¸¤ä¸ªèŠ‚ç‚¹ä¸Šç»™æ”¯æŒçš„å—è®¾å¤‡ç¼©å°å®¹é‡</p></li><li><p>åˆ†åˆ«åœ¨ä¸¤ä¸ªèŠ‚ç‚¹ä¸Šè°ƒæ•´/tmp/metadata æ–‡ä»¶ä¸­<code>la-size-sect</code>çš„å¤§å°ä¿¡æ¯ã€‚æ³¨ï¼šè¿™é‡Œ la-size-sect æŒ‡å®šçš„æ˜¯æ‰‡åŒºæ•°é‡</p></li><li><p>é‡æ–°åˆå§‹åŒ–å…ƒæ•°æ®åŒºåŸŸ</p></li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">drbdadm create-md &lt;resource&gt;</span><br></pre></td></tr></table></figure><ul><li>åˆ†åˆ«åœ¨ä¸¤ä¸ªèŠ‚ç‚¹ä¸Šé‡æ–°å¯¼å…¥ä¿®æ­£çš„å…ƒæ•°æ®</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># æ­¤å¤„ä½¿ç”¨bashè„šæœ¬ï¼Œéœ€è¦ç¡®è®¤å¯ç”¨æ€§</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> drbdmeta_cmd=$(drbdadm -d dump-md &lt;resource&gt;)</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="variable">$&#123;drbdmeta_cmd/dump-md/restore-md&#125;</span> /tmp/metadata</span></span><br><span class="line">Valid meta-data in place, overwrite? [need to type &#x27;yes&#x27; to confirm]</span><br><span class="line">yes</span><br><span class="line">Successfully restored meta data</span><br></pre></td></tr></table></figure><ul><li>é‡æ–°å¯ç”¨ DRBD èµ„æº</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">drbdadm up &lt;resource&gt;</span><br></pre></td></tr></table></figure><h2 id="å…¶ä»–è¯´æ˜"><a href="#å…¶ä»–è¯´æ˜" class="headerlink" title="å…¶ä»–è¯´æ˜"></a>å…¶ä»–è¯´æ˜</h2><h3 id="æŸ¥çœ‹å…ƒæ•°æ®"><a href="#æŸ¥çœ‹å…ƒæ•°æ®" class="headerlink" title="æŸ¥çœ‹å…ƒæ•°æ®"></a>æŸ¥çœ‹å…ƒæ•°æ®</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> down æ‰drbd</span></span><br><span class="line">[root@Storage ~]# drbdadm down drbds2</span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹å…ƒæ•°æ®å‡ºé”™</span></span><br><span class="line">[root@Storage ~]# drbdadm dump-md drbds2</span><br><span class="line">Found meta data is &quot;unclean&quot;, please apply-al first</span><br><span class="line">Command &#x27;drbdmeta 2 v08 /dev/StorPool1/SANLun2 internal dump-md&#x27; terminated with exit code 255</span><br><span class="line"><span class="meta">#</span><span class="bash"> æš‚æ—¶ä¸æ˜ç™½è¿™å¥æ“ä½œçš„å«ä¹‰ï¼Œå¾…æŸ¥</span></span><br><span class="line">[root@Storage ~]# drbdadm apply-al drbds2</span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹meata-data</span></span><br><span class="line">[root@Storage ~]# drbdadm dump-md drbds2</span><br><span class="line"><span class="meta">#</span><span class="bash"> DRBD meta data dump</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 2018-08-29 01:48:20 +0800 [1535478500]</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Storage&gt; drbdmeta 2 v08 /dev/StorPool1/SANLun2 internal dump-md</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"></span><br><span class="line"><span class="bash">version <span class="string">&quot;v08&quot;</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> md_size_sect 136</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> md_offset 1073737728</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> al_offset 1073704960</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> bm_offset 1073672192</span></span><br><span class="line"></span><br><span class="line">uuid &#123;</span><br><span class="line">    0xDDB03F0DAF07DEDC; 0x0000000000000000; 0xE4689A94FBB0E78B; 0xE4679A94FBB0E78B;</span><br><span class="line">    flags 0x00000000;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#</span><span class="bash"> al-extents 1237;</span></span><br><span class="line">la-size-sect 2097016;</span><br><span class="line">bm-byte-per-bit 4096;</span><br><span class="line">device-uuid 0x625F486D2CB120D1;</span><br><span class="line">la-peer-max-bio-size 1048576;</span><br><span class="line">al-stripes 1;</span><br><span class="line">al-stripe-size-4k 8;</span><br><span class="line"><span class="meta">#</span><span class="bash"> bm-bytes 32768;</span></span><br><span class="line">bm &#123;</span><br><span class="line"><span class="meta">   #</span><span class="bash"> at 0kB</span></span><br><span class="line">    4096 times 0x0000000000000000;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#</span><span class="bash"> bits-set 0;</span></span><br></pre></td></tr></table></figure><p>ä»æ­¤å‘½ä»¤ä¸­å¯ä»¥è·çŸ¥ä¸åŒæ ‡è®°ä»£æ•°çš„ uuid å€¼ï¼Œä»¥åŠ metadata çš„å…ƒæ•°æ®ä¿¡æ¯ï¼Œä¾‹å¦‚ md_size_sect=1951744 è¡¨ç¤ºå…ƒæ•°æ®æ‰€åœ¨åˆ†åŒºå ç”¨äº† 1951744 ä¸ªæ‰‡åŒºã€‚æ³¨æ„ï¼Œè¯¥å‘½ä»¤ä¸è¦åœ¨ drbd è®¾å¤‡å·²å¯åŠ¨çš„æƒ…å†µä¸‹æ‰§è¡Œã€‚</p><p>çŸ¥é“è¿™ä¸¤ä¸ªå‘½ä»¤å¯ä»¥è·å–ä¸€äº›ä¿¡æ¯åï¼Œç°åœ¨æˆ‘ä»¬è¦åšçš„æ˜¯è®¡ç®— metadata éƒ¨åˆ†çš„æ•°æ®å¤§å°ã€‚è¿™ä¸ªå¤§å°åœ¨â€ä¿®æ”¹ drbd è®¾å¤‡ç©ºé—´å¤§å°â€æ—¶æœ‰ç”¨ã€‚</p><p>é¦–å…ˆè·å–å…ƒæ•°æ®æ‰€åœ¨åˆ†åŒºçš„æ‰‡åŒºæ•°ã€‚å³ä¸Šé¢ç»“æœä¸­çš„â€md_size_sectâ€ã€‚ä¸è¿‡ä¹Ÿå¯ä»¥ä½¿ç”¨å—è®¾å¤‡å·¥å…· blockdev æ¥è·å–ã€‚</p><h2 id="å‚è€ƒæ¥æº"><a href="#å‚è€ƒæ¥æº" class="headerlink" title="å‚è€ƒæ¥æº"></a>å‚è€ƒæ¥æº</h2><ul><li><a href="https://docs.linbit.com/docs/users-guide-8.4/#s-metadata">16.1. DRBD meta data</a></li><li><a href="https://www.wenzizone.cn/2009/10/29/drbd%E4%B8%ADmetadata%E7%9A%84%E7%90%86%E8%A7%A3%E5%8E%9F%E5%88%9B.html">åŸåˆ› | drbd ä¸­ metadata çš„ç†è§£</a></li><li><a href="https://blog.csdn.net/yuanhangq220/article/details/46634249">drbd é…ç½®ç®€è¿°</a></li><li><a href="http://www.cnblogs.com/f-ck-need-u/p/8678883.html">drbd(äºŒ)ï¼šé…ç½®å’Œä½¿ç”¨ - éªé©¬é‡‘é¾™ - åšå®¢å›­</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> DRBD </tag>
            
            <tag> meta-data </tag>
            
            <tag> å…ƒæ•°æ® </tag>
            
            <tag> å­˜å‚¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³äº DRBD è„‘è£‚é—®é¢˜çš„æ€»ç»“</title>
      <link href="blog/2018-05-27/split-brain-of-drbd/"/>
      <url>blog/2018-05-27/split-brain-of-drbd/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><div class="note info modern"><p>æœ¬æ–‡åœ¨ç¼–å†™æ—¶åŸºäº<a href="https://www.linbit.com/drbd-user-guide/users-guide-drbd-8-4/">å®˜ç½‘ 8.4 è‹±æ–‡ç‰ˆæœ¬</a>ã€‚ç”±äºè‹±è¯­æ°´å¹³å’Œå½“æ—¶è®¤çŸ¥æ‰€é™ï¼Œç¿»è¯‘ä¸­éš¾å…æœ‰è±ç‰™è¯˜å±ˆç”šè‡³è¯¯å¯¼åˆ«äººä¹‹å¤„ã€‚ä»Šå¤©ç¿»é˜…å®˜ç½‘å‘ç°å·²ç»å‡ºç°äº†åŸºäº 9.0 ç‰ˆæœ¬çš„ä¸­æ–‡æ–‡æ¡£ï¼Œæ‰€ä»¥å¤§å®¶å¯ä»¥ç›´æ¥å»æµè§ˆ<a href="https://www.linbit.com/drbd-user-guide/drbd-guide-9_0-cn/#about">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p></div><h2 id="ä»€ä¹ˆæ˜¯DRBDè„‘è£‚"><a href="#ä»€ä¹ˆæ˜¯DRBDè„‘è£‚" class="headerlink" title="ä»€ä¹ˆæ˜¯DRBDè„‘è£‚"></a>ä»€ä¹ˆæ˜¯<code>DRBD</code>è„‘è£‚</h2><p>è„‘è£‚(<code>split brain</code>)æ˜¯æŒ‡ç”±äºé›†ç¾¤èŠ‚ç‚¹ä¹‹é—´çš„æ‰€æœ‰ç½‘ç»œé“¾è·¯çš„ä¸´æ—¶æ•…éšœï¼Œä»¥åŠå¯èƒ½ç”±äºé›†ç¾¤ç®¡ç†è½¯ä»¶çš„å¹²é¢„æˆ–äººä¸ºé”™è¯¯ï¼Œå¯¼è‡´ä¸¤ä¸ªèŠ‚ç‚¹åœ¨æ–­å¼€è¿æ¥æ—¶éƒ½åˆ‡æ¢åˆ°ä¸»èŠ‚ç‚¹ï¼ˆ<code>primary</code>ï¼‰è§’è‰²çš„æƒ…å†µã€‚è¿™æ˜¯ä¸€ç§æ½œåœ¨çš„æœ‰å®³çŠ¶æ€ï¼Œå› ä¸ºå®ƒæ„å‘³ç€å¯¹æ•°æ®çš„ä¿®æ”¹å¯èƒ½æ˜¯åœ¨ä»»ä¸€èŠ‚ç‚¹ä¸Šè¿›è¡Œçš„ï¼Œè€Œæ²¡æœ‰å¤åˆ¶åˆ°å¯¹ç­‰èŠ‚ç‚¹ã€‚å› æ­¤ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¾ˆå¯èƒ½å·²ç»åˆ›å»ºäº†ä¸¤ä¸ªä¸åŒçš„æ•°æ®é›†ï¼Œè¿™äº›æ•°æ®é›†ä¸èƒ½ç®€å•åœ°åˆå¹¶ã€‚</p><h2 id="æ€ä¹ˆåˆ¤å®šè„‘è£‚"><a href="#æ€ä¹ˆåˆ¤å®šè„‘è£‚" class="headerlink" title="æ€ä¹ˆåˆ¤å®šè„‘è£‚"></a>æ€ä¹ˆåˆ¤å®šè„‘è£‚</h2><h3 id="æŸ¥çœ‹æ—¥å¿—ä¿¡æ¯"><a href="#æŸ¥çœ‹æ—¥å¿—ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹æ—¥å¿—ä¿¡æ¯"></a>æŸ¥çœ‹æ—¥å¿—ä¿¡æ¯</h3><p>å¦‚æœ<code>DRBD</code>å‡ºç°è„‘è£‚ï¼Œä¼šåœ¨ <code>/var/log/message</code> å‡ºç°ä¸€æ¡æ—¥å¿—ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Split-Brain detected but unresolved, dropping connection!</span><br></pre></td></tr></table></figure><p>å½“å‘ç”Ÿ<code>split brain</code>ä¹‹åï¼Œå¦‚æœæŸ¥çœ‹è¿æ¥çŠ¶æ€ï¼Œå…¶ä¸­è‡³å°‘ä¼šæœ‰ä¸€ä¸ªæ˜¯<code>StandAlone</code>çŠ¶æ€ï¼Œå¦å¤–ä¸€ä¸ªå¯èƒ½ä¹Ÿæ˜¯<code>StandAlone</code>ï¼ˆå¦‚æœæ˜¯åŒæ—¶å‘ç°<code>split brain</code>çŠ¶æ€ï¼‰ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ <code>WFConnection</code> çŠ¶æ€ã€‚</p><h3 id="è„‘è£‚è‡ªåŠ¨é€šçŸ¥"><a href="#è„‘è£‚è‡ªåŠ¨é€šçŸ¥" class="headerlink" title="è„‘è£‚è‡ªåŠ¨é€šçŸ¥"></a>è„‘è£‚è‡ªåŠ¨é€šçŸ¥</h3><p>å¦‚æœè¿›è¡Œé…ç½®ï¼ŒDRBD ä¼šè°ƒç”¨è„‘è£‚å¤„ç†ç¨‹åºï¼Œå½“è„‘è£‚å‘ç”Ÿæ—¶å°±ä¼šè¢«æ¢æµ‹åˆ°ã€‚è¦é…ç½®è¿™ä¸ªç¨‹åºï¼Œéœ€è¦å¯¹èµ„æº<code>/etc/drbd.d/global_common.conf</code>æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">resource &lt;resource&gt;</span><br><span class="line"></span><br><span class="line">  handlers &#123;</span><br><span class="line"></span><br><span class="line">    split-brain &lt;handler&gt;;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><code>&lt;handler&gt;</code>å¯èƒ½æ˜¯ç›®å‰ç³»ç»Ÿä¸­ä¸€ä¸ªå¯æ‰§è¡Œçš„æ–‡ä»¶ã€‚</p><p><code>Drbd</code>è‡ªå¸¦ä¸€ä¸ªè„‘è£‚å¤„ç†ç¨‹åºè„šæœ¬<code>/usr/lib/drbd/notify-split-brain.sh</code>ã€‚å®ƒå¯ä»¥é€šè¿‡ç”µå­é‚®ä»¶çš„æ–¹å¼å‘é€åˆ°æŒ‡å®šçš„åœ°å€ã€‚è¦é…åˆç¨‹åºå‘é€ä¿¡æ¯åˆ° root@localhostï¼ˆè¿™å‡è®¾æ˜¯è®¾ç½®çš„ç³»ç»Ÿç®¡ç†å‘˜çš„é‚®ä»¶åœ°å€ï¼‰ï¼Œé…ç½®å¦‚ä¸‹ï¼š<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">resource &lt;resource&gt;</span><br><span class="line"></span><br><span class="line">  handlers &#123;</span><br><span class="line"></span><br><span class="line">    split-brain &quot;/usr/lib/drbd/notify-split-brain.sh root&quot;;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>å½“é…ç½®å·²ç»åœ¨èµ„æºä¸Šè¿›è¡Œä¿®æ”¹ï¼ˆåŒæ­¥åˆ°ä¸¤ä¸ªèŠ‚ç‚¹ä¸Šï¼‰ï¼Œå°±ä¸éœ€è¦æ·»åŠ å…¶ä»–çš„å¤„ç†å°±å¯ä»¥å¯åŠ¨å¤„ç†ç¨‹åºã€‚<code>DRBD</code>ä¼šåœ¨ä¸‹ä¸€æ¬¡æ£€æµ‹åˆ°è„‘è£‚æ—¶ç›´æ¥è°ƒç”¨è¯¥å¤„ç†ç¨‹åºã€‚</p><p>å¦‚æœè¦é…ç½®çœŸå®å¯ç”¨çš„æŠ¥è­¦é‚®ç®±åœ°å€ï¼Œåˆ™é™¤äº†å°†ä¸Šé¢çš„é€šçŸ¥åœ°å€æ”¹ä¸ºçœŸå®é‚®ä»¶åœ°å€:<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">split-brain &quot;/usr/lib/drbd/notify-split-brain.sh foo@bar.com</span><br></pre></td></tr></table></figure><br>è¿˜éœ€è¦ä¿®æ”¹ä¸€ä¸‹<code>ssmtp</code>é…ç½®æ–‡ä»¶ï¼š<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">vim /etc/ssmtp/ssmtp.conf</span><br><span class="line"><span class="meta">#</span><span class="bash"> å¡«å†™çœŸå®æ”¶ä»¶æœåŠ¡å™¨ä¿¡æ¯</span></span><br><span class="line">mailhub=mail.masantu.com:25</span><br></pre></td></tr></table></figure><br>æ›´å¤šé…ç½®å‚è§ <a href="https://wiki.archlinux.org/index.php/SSMTP">è¿™é‡Œ SSMTP - ArchWiki</a></p><h3 id="ä¸–ä»£æ ‡è¯†ç¬¦å…ƒç»„ï¼ˆGIï¼‰"><a href="#ä¸–ä»£æ ‡è¯†ç¬¦å…ƒç»„ï¼ˆGIï¼‰" class="headerlink" title="ä¸–ä»£æ ‡è¯†ç¬¦å…ƒç»„ï¼ˆGIï¼‰"></a>ä¸–ä»£æ ‡è¯†ç¬¦å…ƒç»„ï¼ˆGIï¼‰</h3><p>å‚è§<a href="https://docs.linbit.com/docs/users-guide-8.4/#s-gi">16.2. Generation Identifiers</a></p><p>DRBD å°†å…¶å¤‡ä»½çš„æ•°æ®çš„æ›´æ–°å˜åŒ–è¿‡ç¨‹æ¯”æ‹Ÿæˆäººç±»ä¸–ä»£ç¹è¡çš„è¿‡ç¨‹ã€‚æ¯ä¸ªæ—¶ç‚¹åŒä¸€ä¸ªåŒæœºçš„ DRBD çš„ä¸¤ä¸ªèŠ‚ç‚¹ä¸Šçš„æ•°æ®éƒ½æ¥è‡ªäºåŒä¸€ä»½åŸå§‹æ•°æ®ï¼Œæˆ‘ä»¬å¯è®¤ä¸ºè¿™ä¸ªæ—¶ç‚¹ä¸Šä¸¤ä»½æ•°æ®æºäºåŒä¸€ç¥–å…ˆã€‚ä¸»å¤‡èŠ‚ç‚¹çš„ DRBD éƒ½ä¼šç”¨ä¸€ä¸ªå«ä½œ GI(Generation ID)çš„æ ‡è¯†ç¬¦æ¥æ ‡è¯†å½“å‰çš„æ•°æ®æ˜¯å“ªä¸ªä¸–ä»£çš„ï¼ŒåŒæ ·ä¹Ÿä¼šè®°å½•æœ€è¿‘ä¸¤ä¸ªæ•°æ®ç¥–å…ˆçš„ GI ç”¨äºè¿½æœ”å½“å‰æ•°æ®çš„å†å²æ¥æºã€‚DRBD å¯ä»¥æ®æ­¤æ¥åˆ¤æ–­ä¸¤ä¸ªèŠ‚ç‚¹æ˜¯å¦æ˜¯å±äºåŒä¸€ä¸ªåŒæœº,å› ä¸ºåŒä¸€ä¸ªåŒæœºçš„ä¸¤ä»½æ•°æ®åº”è¯¥æ˜¯ä»åŒä¸€ä¸ªç¥–å…ˆè€Œæ¥ã€‚<br>GI ä½œä¸º DRBD çš„å†…éƒ¨æœºåˆ¶ä¸»è¦è¢«ç”¨æ¥ï¼š</p><ol><li>ç¡®å®šè¿™ä¸¤ä¸ªèŠ‚ç‚¹æ˜¯å¦æ˜¯äº‹å®ä¸Šçš„åŒä¸€ä¸ªé›†ç¾¤çš„æˆå‘˜ï¼ˆè€Œä¸æ˜¯æ„å¤–è¿æ¥çš„ä¸¤ä¸ªèŠ‚ç‚¹ï¼‰ï¼›</li><li>ç¡®å®šè§¦å‘å…¨ç›˜åŒæ­¥ï¼ˆ<code>full re-synchronization</code>ï¼‰è¿˜æ˜¯åªè§¦å‘éƒ¨åˆ†åŒæ­¥ï¼ˆ<code>partial re-synchronization</code>ï¼‰ã€‚</li><li>ç¡®å®šåå°é‡æ–°åŒæ­¥çš„æ–¹å‘ï¼ˆå¦‚æœéœ€è¦å…¨ç›˜åŒæ­¥ï¼‰ï¼›</li><li>ç¡®å®šè„‘è£‚ã€‚</li></ol><h4 id="æ•°æ®è¿­ä»£"><a href="#æ•°æ®è¿­ä»£" class="headerlink" title="æ•°æ®è¿­ä»£"></a>æ•°æ®è¿­ä»£</h4><p>å½“å‡ºç°ä¸‹åˆ—æƒ…å½¢é‡Œ<code>DRBD</code>ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„<code>GI</code>ï¼Œç”¨æ¥æ ‡è¯†æ–°ä¸€ä»£çš„æ•°æ®ï¼š</p><ol><li>ç¬¬ä¸€æ¬¡å…¨ç›˜åŒæ­¥æ—¶ï¼›</li><li>ä¸€ä¸ª<code>Disconnected</code>çš„èµ„æºè½¬æ¢ä¸º<code>Primary</code>æ—¶ï¼›</li><li>ä¸€ä¸ª<code>Primary</code>çš„èµ„æºè½¬æ¢ä¸º<code>Disconnected</code>æ—¶ã€‚</li></ol><p>å› æ­¤,æˆ‘ä»¬å¯ä»¥æ€»ç»“å‡ºï¼šåªè¦ä¸€ä¸ª<code>DRBD</code>èµ„æºå¤„äº<code>Connected</code>çš„çŠ¶æ€ï¼Œå¹¶ä¸”ä¸¤è¾¹ç£ç›˜çš„çŠ¶æ€ä¸º<code>UpToDate</code>ï¼Œé‚£ä¹ˆæ­¤<code>DRBD</code>èµ„æºåœ¨ä¸¤ä¸ªèŠ‚ç‚¹ä¸Šçš„<code>GI</code>ä¸€å®šæ˜¯ä¸€æ ·çš„ã€‚æ­¤ç»“è®ºåè¿‡æ¥ä¹ŸåŒæ ·æˆç«‹ã€‚è¯·æ³¨æ„ï¼Œ<strong>å½“å‰å®ç°ä½¿ç”¨æœ€ä½ä½æ¥ç¼–ç èŠ‚ç‚¹çš„è§’è‰²(<code>Primary/Secondary</code>)ã€‚ å› æ­¤ï¼Œå³ä½¿å®ƒä»¬è¢«è®¤ä¸ºå…·æœ‰ç›¸åŒçš„æ•°æ®ç”Ÿæˆï¼Œæœ€ä½ä½åœ¨ä¸åŒèŠ‚ç‚¹ä¸Šä¹Ÿå¯èƒ½ä¸åŒã€‚</strong></p><p>æ¯ä¸ªæ–°çš„æ•°æ®ç”Ÿæˆéƒ½ç”±ä¸€ä¸ª<code>8</code>å­—èŠ‚çš„é€šç”¨å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆ<code>UUID</code>ï¼‰æ¥æ ‡è¯†ã€‚</p><h4 id="GIå…ƒç¥–"><a href="#GIå…ƒç¥–" class="headerlink" title="GIå…ƒç¥–"></a><code>GI</code>å…ƒç¥–</h4><p><code>DRBD</code>åœ¨æœ¬åœ°èµ„æºå…ƒæ•°æ®ä¸­ä¿å­˜æœ‰å…³å½“å‰å’Œå†å²æ•°æ®ç”Ÿæˆçš„å››æ¡ä¿¡æ¯ï¼š</p><ul><li><p>å½“å‰<code>UUID(C-UUID)</code><br>ä»æœ¬åœ°èŠ‚ç‚¹çš„è§’åº¦æ¥çœ‹ï¼Œè¿™æ˜¯å½“å‰æ•°æ®ç”Ÿæˆçš„ç”Ÿæˆæ ‡è¯†ç¬¦ã€‚ å½“èµ„æºè¢«è¿æ¥å¹¶å®Œå…¨åŒæ­¥æ—¶ï¼Œå½“å‰<code>UUID</code>åœ¨èŠ‚ç‚¹ä¹‹é—´æ˜¯ç›¸åŒçš„ã€‚</p></li><li><p>ä½å›¾<code>UUID(B-UUID)</code><br>è¿™æ˜¯ç£ç›˜ä¸ŠåŒæ­¥ä½å›¾è·Ÿè¸ªçš„ç”Ÿæˆçš„<code>UUID</code>æ›´æ”¹ã€‚ ä½œä¸ºç£ç›˜ä¸Šçš„åŒæ­¥ä½å›¾æœ¬èº«ï¼Œæ­¤æ ‡è¯†ç¬¦ä»…åœ¨æ–­å¼€æ¨¡å¼ä¸‹æ‰æœ‰ç”¨ã€‚ å¦‚æœèµ„æºå·²è¿æ¥ï¼Œåˆ™æ­¤<code>UUID</code>å§‹ç»ˆä¸ºç©ºï¼ˆé›¶ï¼‰ã€‚</p></li><li><p>ä¸¤ä¸ª<code>å†å²UUID</code></p></li></ul><p>è¿™äº›æ˜¯å½“å‰ä¹‹å‰ä¸¤ä¸ªæ•°æ®ä¸–ä»£çš„æ ‡è¯†ç¬¦ã€‚</p><ol><li>ä¸Šä¸€ä»£æ•°æ®çš„<code>UUID(H1-UUID)</code>ï¼›</li><li>æœ€è¿‘ç¬¬äºŒä»£æ•°æ®çš„<code>UUID(H2-UUID)</code>ï¼Œå³ä¸Šä¸€ä»£æ•°æ®çš„ä¸Šä¸€ä»£æ•°æ®çš„<code>UUID</code>ã€‚</li></ol><p>æ€»çš„æ¥è¯´ï¼Œè¿™å››ä¸ªé¡¹ç›®è¢«ç§°ä¸ºä»£ç æ ‡è¯†ç¬¦å…ƒç»„ï¼Œæˆ–ç®€ç§°ä¸º<code>GIå…ƒç»„</code>ã€‚</p><h4 id="GIå¦‚ä½•å˜åŒ–"><a href="#GIå¦‚ä½•å˜åŒ–" class="headerlink" title="GIå¦‚ä½•å˜åŒ–"></a><code>GI</code>å¦‚ä½•å˜åŒ–</h4><ul><li>å¼€å§‹æ–°çš„æ•°æ®ç”Ÿæˆä»£</li></ul><p>å½“èŠ‚ç‚¹ä¸å…¶å¯¹ç­‰æ–¹å¤±å»è¿æ¥æ—¶ï¼ˆç½‘ç»œæ•…éšœæˆ–äººå·¥å¹²é¢„éƒ½æœ‰å¯èƒ½ï¼‰ï¼ŒDRBD å°†æŒ‰ç…§ä»¥ä¸‹æ–¹å¼ä¿®æ”¹å…¶æœ¬åœ°ç”Ÿæˆæ ‡è¯†ç¬¦ï¼š</p><p><img src= "/img/loading.svg" data-lazy-src="/images/gi-changes-newgen.png" alt="å›¾1 GIå…ƒç¥–åœ¨ç”Ÿæˆæ–°çš„æ•°æ®ä»£æ—¶æ”¹å˜"></p><ol><li>ä¸ºæ–°çš„æ•°æ®ä»£ç”Ÿæˆæ–°çš„<code>UUID</code>ï¼Œå˜ä¸ºä¸»èŠ‚ç‚¹çš„<code>C-UUID</code>ï¼›</li><li>ä¹‹å‰çš„ UUID ç°åœ¨æŒ‡å‘ä½å›¾ï¼ˆ<code>B-UUID</code>ï¼‰ä»¥è·Ÿè¸ªæ•°æ®å˜åŒ–ï¼Œå› æ­¤å®ƒæˆä¸ºä¸»èŠ‚ç‚¹çš„æ–°ä½å›¾<code>UUID</code>ï¼›</li><li>å¤‡èŠ‚ç‚¹ GI å…ƒç¥–ä¿æŒä¸å˜ã€‚</li></ol><ul><li>å¼€å§‹é‡æ–°åŒæ­¥</li></ul><p>åœ¨å¼€å§‹é‡æ–°åŒæ­¥æ—¶ï¼Œ<code>DRBD</code>åœ¨æœ¬åœ°ä»£æ ‡è¯†ç¬¦ä¸Šæ‰§è¡Œå¦‚ä¸‹ä¿®æ”¹ï¼š</p><p><img src= "/img/loading.svg" data-lazy-src="/images/gi-changes-syncstart.png" alt="å›¾2 GIå…ƒç¥–åœ¨é‡æ–°å¼€å§‹åŒæ­¥æ—¶æ”¹å˜"></p><ol><li>åœ¨åŒæ­¥æºç«¯çš„<code>å½“å‰UUID</code>ï¼ˆC-UUIDï¼‰ä¿æŒä¸å˜ï¼›</li><li>åŒæ­¥æºç«¯çš„<code>ä½å›¾UUID</code>è½®è½¬ä¸º<code>ç¬¬ä¸€å†å²UUID</code>ï¼ˆH1-UUIDï¼‰ï¼›</li><li>åŒæ­¥æºç«¯ç”Ÿæˆæ–°çš„<code>ä½å›¾UUID</code>ï¼ˆB-UUIDï¼‰;</li><li>è¯¥ UUIDï¼ˆ<em>åº”æŒ‡åŒæ­¥æºç«¯ç”Ÿæˆçš„<code>B-UUID</code></em>ï¼‰å˜ä¸ºåŒæ­¥ç›®æ ‡ç«¯çš„æ–°çš„<code>å½“å‰UUID</code>ï¼ˆC-UUIDï¼‰ï¼›</li><li>åŒæ­¥ç›®æ ‡ç«¯çš„<code>ä½å›¾UUID</code>ï¼ˆB-UUIDï¼‰å’Œ<code>å†å²UUID</code>ï¼ˆH1-UUID,H2-UUIDï¼‰ä¿æŒä¸å˜ã€‚</li></ol><ul><li>é‡æ–°åŒæ­¥ç»“æŸ</li></ul><p>å½“é‡æ–°åŒæ­¥ç»“æŸåï¼Œå°†æ‰§è¡Œä»¥ä¸‹æ›´æ”¹ï¼š</p><p><img src= "/img/loading.svg" data-lazy-src="/images/gi-changes-synccomplete.png" alt="å›¾3 å½“é‡æ–°åŒæ­¥ç»“æŸåï¼ŒGIå…ƒç¥–å‘ç”Ÿæ”¹å˜"></p><ol><li>åŒæ­¥æºç«¯<code>å½“å‰UUID</code>(C-UUID)ä¿æŒä¸å˜ï¼›</li><li>åŒæ­¥æºç«¯çš„<code>ä½å›¾UUID</code>(B-UUID)è½®è½¬ä¸º<code>ç¬¬ä¸€å†å²UUID</code>ï¼ˆH1-UUIDï¼‰ï¼ŒåŒæ—¶è¯¥ UUID(æŒ‡<code>H1-UUID</code>)è½®è½¬ä¸º<code>ç¬¬äºŒå†å²UUID</code>(ç°æœ‰çš„ç¬¬äºŒå†å² uuid è¢«ä¸¢å¼ƒ)ï¼›</li><li>åŒæ­¥æºç«¯çš„<code>ä½å›¾UUID</code>(B-UUID)æ¸…ç©ºï¼ˆç½®é›¶ï¼‰ï¼›</li><li>åŒæ­¥ç›®æ ‡ç«¯é‡‡ç”¨åŒæ­¥æºç«¯æ•´ä¸ª<code>GIå…ƒç¥–</code>ã€‚</li></ol><p>å½“èŠ‚ç‚¹ä¹‹é—´å»ºç«‹è¿æ¥ä¹‹åï¼Œä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´ä¼šäº¤æ¢å½“å‰å¯ç”¨çš„ä»£æ ‡è¯†ç¬¦,ç„¶åæ ¹æ®æ¯”å¯¹çš„ç»“æœé‡‡å–ç›¸åº”çš„æ“ä½œã€‚ä»¥ä¸‹æ˜¯å¯èƒ½çš„å‡ ç§ç»“æœï¼š</p><ul><li>ä¸¤ä¸ªèŠ‚ç‚¹ä¸Šçš„å½“å‰<code>UUID(C-UUID)</code>éƒ½ä¸ºç©º<br>æœ¬åœ°èŠ‚ç‚¹æ£€æµ‹åˆ°å®ƒçš„å½“å‰<code>UUID</code>å’Œå¯¹æ–¹çš„å½“å‰<code>UUID</code>éƒ½æ˜¯ç©ºçš„ã€‚è¿™é€šå¸¸æ˜¯å‘ç”Ÿäºå°šæœªå¯åŠ¨åˆå§‹å®Œå…¨åŒæ­¥çš„æ–°é…ç½®èµ„æºçš„æ­£å¸¸æƒ…å†µã€‚æ­¤æ—¶æ²¡æœ‰åŒæ­¥å‘ç”Ÿ;é¡»æ‰‹åŠ¨äººä¸ºè§¦å‘å¯åŠ¨ã€‚</li><li>å•ä¸€èŠ‚ç‚¹ä¸Šçš„å½“å‰<code>UUID(C-UUID)</code>ä¸ºç©º<br>æœ¬åœ°èŠ‚ç‚¹æ£€æµ‹åˆ°å¯¹æ–¹çš„å½“å‰<code>UUID</code>ä¸ºç©ºï¼Œè€Œå…¶æœ¬èº«éç©ºã€‚è¿™æ˜¯æ–°é…ç½®èµ„æºçš„æ­£å¸¸æƒ…å†µï¼Œæ­¤æ—¶åˆå§‹å…¨ç›˜åŒæ­¥åˆšåˆšè§¦å‘ï¼Œæœ¬åœ°èŠ‚ç‚¹è¢«é€‰ä¸ºåˆå§‹åŒæ­¥æºï¼ˆ<code>sync source</code>ï¼‰ã€‚ <code>DRBD</code>å°†ç£ç›˜ä¸Šçš„åŒæ­¥ä½å›¾(<code>sync bitmap</code>)ä¸­çš„æ‰€æœ‰ä½å…¨éƒ¨ç½®ä½ï¼ˆæ„å‘³ç€å®ƒè®¤ä¸ºæ•´ä¸ªè®¾å¤‡ä¸åŒæ­¥ï¼‰ï¼Œå¹¶å¼€å§‹å°†å…¶ä½œä¸ºåŒæ­¥æºåŒæ­¥ã€‚ç›¸åï¼Œï¼ˆå³æœ¬åœ°å½“å‰<code>UUID</code>ä¸ºç©ºï¼Œå¯¹ç­‰èŠ‚ç‚¹éç©ºï¼‰ï¼Œé™¤äº†æœ¬åœ°èŠ‚ç‚¹æˆä¸ºåŒæ­¥ç›®æ ‡ï¼ˆ<code>sync target</code>ï¼‰ä¹‹å¤–ï¼Œ<code>DRBD</code>æ‰§è¡Œç›¸åŒçš„æ­¥éª¤ã€‚</li><li>å½“å‰<code>UUID(C-UUID)</code>ç›¸ç­‰<br>æœ¬åœ°èŠ‚ç‚¹æ£€æµ‹åˆ°å®ƒçš„å½“å‰<code>UUID</code>å’Œå¯¹ç­‰èŠ‚ç‚¹çš„å½“å‰<code>UUID</code>éç©ºä¸”ç›¸ç­‰æ—¶ã€‚è¿™æ˜¯èµ„æºåœ¨<code>secondary</code>çŠ¶æ€è¿›å…¥æ–­å¼€è¿æ¥ï¼ˆ<code>disconnected</code>ï¼‰æ¨¡å¼æ—¶çš„æ­£å¸¸æƒ…å†µï¼Œå¹¶ä¸”åœ¨æ–­å¼€è¿æ¥æ—¶å¹¶æœªåœ¨ä»»ä¸€èŠ‚ç‚¹ä¸Šå‡ä¸º <code>primary</code> çŠ¶æ€ã€‚æ­¤æ—¶ä¸ä¼šè§¦å‘åŒæ­¥ï¼Œå› ä¸ºä¸¤è¾¹çš„æ•°æ®ä¸€è‡´ï¼Œæ²¡æœ‰å¿…è¦ã€‚</li><li>ä½å›¾<code>UUIDï¼ˆB-UUIDï¼‰</code>åŒ¹é…å¯¹ç­‰èŠ‚ç‚¹çš„å½“å‰<code>UUIDï¼ˆ`C-UUID`ï¼‰</code><br>æœ¬åœ°èŠ‚ç‚¹æ£€æµ‹åˆ°å…¶ä½å›¾<code>UUID</code>åŒ¹é…å¯¹ç­‰èŠ‚ç‚¹çš„å½“å‰<code>UUID</code>ï¼Œä¸”å¯¹ç­‰èŠ‚ç‚¹çš„ä½å›¾<code>UUID</code>ä¸ºç©ºã€‚è¿™æ˜¯æœ¬åœ°èŠ‚ç‚¹å¤„äº <code>primary</code> çŠ¶æ€ï¼Œæ¬¡è¦èŠ‚ç‚¹æ•…éšœåæ­£å¸¸ä¸”é¢„æœŸçš„æƒ…å†µã€‚è¿™æ„å‘³ç€å¯¹ç«¯åœ¨æ­¤æœŸé—´æ°¸è¿œä¸ä¼šå˜ä¸º<code>primary</code>çŠ¶æ€ï¼Œå¹¶å§‹ç»ˆä»¥ç›¸åŒçš„æ•°æ®ç”Ÿæˆä¸ºå‰æè¿è¡Œã€‚ <code>DRBD</code>æ­¤æ—¶ä»¥æœ¬åœ°èŠ‚ç‚¹ä½œä¸ºåŒæ­¥æºï¼ˆ<code>sync source</code>ï¼‰å¯åŠ¨æ­£å¸¸çš„åå°é‡æ–°åŒæ­¥ï¼ˆ<code>re-sync</code>ï¼‰ã€‚ç›¸åï¼Œå¦‚æœæœ¬åœ°èŠ‚ç‚¹æ£€æµ‹åˆ°å…¶ä½å›¾<code>UUID</code>ä¸ºç©ºï¼Œä¸”å¯¹ç­‰èŠ‚ç‚¹çš„ä½å›¾ä¸æœ¬åœ°èŠ‚ç‚¹çš„å½“å‰<code>UUID</code>åŒ¹é…ï¼Œé‚£ä¹ˆè¿™æ˜¯æœ¬åœ°èŠ‚ç‚¹å¤±è´¥åçš„æ­£å¸¸å’Œé¢„æœŸæƒ…å†µã€‚åŒæ ·åœ°ï¼Œ<code>DRBD</code>æ­¤æ—¶å¯åŠ¨æ­£å¸¸çš„åå°é‡æ–°åŒæ­¥ï¼Œåªä¸è¿‡æœ¬åœ°èŠ‚ç‚¹æˆä¸ºåŒæ­¥ç›®æ ‡ï¼ˆ<code>sync target</code>ï¼‰ã€‚</li><li>å½“å‰<code>UUID(C-UUID)</code>åŒ¹é…å¯¹ç­‰èŠ‚ç‚¹çš„å†å²<code>UUIDï¼ˆh-UUIDï¼‰</code><br>æœ¬åœ°èŠ‚ç‚¹æ£€æµ‹åˆ°å…¶å½“å‰<code>UUID</code>ä¸å¯¹ç­‰èŠ‚ç‚¹çš„å†å²<code>UUID</code>ä¹‹ä¸€(<code>h1/h2</code>)åŒ¹é…ã€‚è¿™æ„å‘³ç€å°½ç®¡ä¸¤ä¸ªæ•°æ®é›†å…±äº«ä¸€ä¸ªå…±åŒçš„ç¥–å…ˆä¸”å¯¹ç­‰èŠ‚ç‚¹å…·æœ‰æœ€æ–°çš„æ•°æ®ï¼Œä½†ä¿å­˜åœ¨å¯¹ç­‰èŠ‚ç‚¹çš„ä½å›¾ä¸­çš„ä¿¡æ¯å·²è¿‡æ—¶å¹¶ä¸”ä¸å¯ç”¨ã€‚å› æ­¤ï¼Œç®€å•çš„æ­£å¸¸åŒæ­¥ä¸å¤Ÿçš„ã€‚ <code>DRBD</code>æ­¤æ—¶å°†æ•´ä¸ªè®¾å¤‡æ ‡è®°ä¸ºæœªåŒæ­¥ï¼ˆ<code>out-of-sync</code>ï¼‰å¹¶å¯åŠ¨ä»¥æœ¬åœ°èŠ‚ç‚¹ä½œä¸ºåŒæ­¥ç›®æ ‡ï¼ˆ<code>sync target</code>ï¼‰çš„å…¨ç›˜åå°é‡æ–°åŒæ­¥ã€‚åœ¨ç›¸åçš„æƒ…å†µä¸‹ï¼ˆæœ¬åœ°èŠ‚ç‚¹çš„æŸä¸ªå†å²<code>UUID</code>ä¸å¯¹ç­‰èŠ‚ç‚¹çš„å½“å‰<code>UUID</code>ç›¸åŒ¹é…ï¼‰ï¼Œé™¤äº†æœ¬åœ°èŠ‚ç‚¹æˆä¸ºåŒæ­¥æºï¼ˆ<code>sync source</code>ï¼‰ä¹‹å¤–ï¼Œ<code>DRBD</code>æ‰§è¡Œç›¸åŒçš„æ­¥éª¤ã€‚</li><li>ä½å›¾<code>UUIDï¼ˆB-UUIDï¼‰</code>åŒ¹é…ï¼Œå½“å‰ <code>UUID(C-UUID)</code>ä¸åŒ¹é…<br>æœ¬åœ°èŠ‚ç‚¹æ£€æµ‹åˆ°å…¶å½“å‰<code>UUID</code>ä¸å¯¹ç­‰èŠ‚ç‚¹çš„å½“å‰<code>UUID</code>ä¸åŒä¸”ä½å›¾<code>UUID</code>åŒ¹é…ã€‚è¿™æ˜¯è„‘è£‚ï¼ˆ<code>split brain</code>ï¼‰çš„ä¸€ç§æƒ…å†µï¼Œä¸¤ä»½æ•°æ®æœ‰ç›¸åŒçš„çˆ¶ä»£ã€‚è¿™æ„å‘³ç€<code>DRBD</code>å¯ä»¥è°ƒç”¨è„‘è£‚è‡ªåŠ¨æ¢å¤ç­–ç•¥è¿›è¡Œæ•°æ®æ¢å¤ï¼ˆå¦‚æœå·²é…ç½®ï¼‰ã€‚å¦åˆ™ï¼Œ<code>DRBD</code>æ–­å¼€è¿æ¥å¹¶ç­‰å¾…æ‰‹åŠ¨æ¢å¤ã€‚</li><li>å½“å‰<code>UUIDï¼ˆC-UUIDï¼‰</code>å’Œä½å›¾<code>UUID(B-UUID)</code>éƒ½ä¸åŒ¹é…<br>æœ¬åœ°èŠ‚ç‚¹æ£€æµ‹åˆ°å®ƒçš„å½“å‰<code>UUID</code>ä¸å¯¹ç­‰èŠ‚ç‚¹çš„å½“å‰<code>UUID</code>ä¸åŒï¼Œå¹¶ä¸”ä½å›¾<code>UUID</code>ä¸åŒ¹é…ã€‚è¿™æ˜¯ä¸¤ä»½æ•°æ®ä¸æ— å…³çˆ¶ä»£äº§ç”Ÿçš„ä¸€ç§è„‘è£‚ï¼Œå› æ­¤å³ä½¿é…ç½®äº†è‡ªåŠ¨æ¢å¤ç­–ç•¥ä¹Ÿæ²¡æœ‰æ„ä¹‰ã€‚ <code>DRBD</code>å¤„äºæ–­å¼€è¿æ¥å¹¶ç­‰å¾…æ‰‹åŠ¨æ¢å¤çŠ¶æ€ã€‚</li><li>æ²¡æœ‰<code>UUID</code>åŒ¹é…<br>æœ€åï¼Œå¦‚æœ<code>DRBD</code>æœªèƒ½æ£€æµ‹åˆ°ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„<code>GI</code>å…ƒç»„ä¸­çš„å•ä¸ªå…ƒç´ åŒ¹é…ï¼Œåˆ™ä¼šè®°å½•å…³äºæ— å…³æ•°æ®ï¼ˆ<code>unrelated data</code>ï¼‰çš„è­¦å‘Šå¹¶æ–­å¼€è¿æ¥ã€‚è¿™æ˜¯<code>DRBD</code>çš„é˜²èŒƒæªæ–½ï¼Œå¯é˜²æ­¢ä¹‹å‰æ— å…³è”çš„ä¸¤ä¸ªé›†ç¾¤èŠ‚ç‚¹çš„æ„å¤–è¿æ¥å¯¼è‡´æ•°æ®ç ´åã€‚</li></ul><p>ä»¥ä¸Šé€»è¾‘ä½¿ç”¨ä»£ç è¡¨ç¤ºå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">empty_uuid = <span class="string">&#x27;0000000000000000&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">slice_seq</span>(<span class="params">seq</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    å¯¹GIå…ƒç¥–å†…å…ƒç´ è¿›è¡Œåˆ‡ç‰‡æ“ä½œ</span></span><br><span class="line"><span class="string">    :param seq: GIå…ƒç¥–</span></span><br><span class="line"><span class="string">    :return:type:list</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">global</span> empty_uuid</span><br><span class="line">    sliced_seq = [item[:-<span class="number">1</span>] <span class="keyword">if</span> item != empty_uuid <span class="keyword">else</span> item <span class="keyword">for</span> item <span class="keyword">in</span> seq]</span><br><span class="line">    <span class="keyword">return</span> sliced_seq</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cmp_both</span>(<span class="params">seqa,seqb</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> seqa:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">not</span> <span class="keyword">in</span> seqb:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_gi_action</span>(<span class="params">drbdname</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    è°ƒç”¨&#x27;drbdadm get-gi DRBDNAME&#x27;å‘½ä»¤è·å–drbdçš„ GI(Generation ID) ä¿¡æ¯</span></span><br><span class="line"><span class="string">    :param drbdname:type:str,drbdåç§° like:&#x27;drbds1/drbdn301&#x27;</span></span><br><span class="line"><span class="string">    :return:è·å–æ­£å¸¸è¿”å›å…ƒç¥–(c_uuid, b_uuid, h1_uuid, h2_uuid)ï¼Œè·å–å¤±è´¥è¿”å›None</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    get_gi_cmd = <span class="string">&quot;drbdadm get-gi %s |awk -F: &#x27;&#123;print $1,$2,$3,$4&#125;&#x27;&quot;</span>%(drbdname)</span><br><span class="line">    retcode,proc = utils.cust_popen(get_gi_cmd)</span><br><span class="line">    message = proc.stderr.read(), proc.stdout.read()</span><br><span class="line">    retstr = message[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> retstr:</span><br><span class="line">        c_uuid,b_uuid,h1_uuid,h2_uuid = <span class="built_in">tuple</span>(retstr.split())</span><br><span class="line">        <span class="keyword">return</span> c_uuid,b_uuid,h1_uuid,h2_uuid</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        debug.write_debug(debug.LINE(), <span class="string">&quot;peradrbd&quot;</span>, message)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">  </span><br><span class="line">        </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_remote_gi</span>(<span class="params">params</span>):</span></span><br><span class="line">    rtndata = &#123;&#125;</span><br><span class="line">    result = &#123;&#125;</span><br><span class="line">    drbdname = <span class="string">&#x27;drbdname&#x27;</span> <span class="keyword">in</span> params <span class="keyword">and</span> params[<span class="string">&#x27;drbdname&#x27;</span>] <span class="keyword">or</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> drbdname:</span><br><span class="line">        <span class="keyword">if</span> hasthedrbd(drbdname):</span><br><span class="line">            gi_uuids = get_gi_action(drbdname)</span><br><span class="line">            <span class="keyword">if</span> gi_uuids <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                rtndata[<span class="string">&#x27;state&#x27;</span>] = <span class="string">&#x27;0&#x27;</span></span><br><span class="line">                result[<span class="string">&#x27;message&#x27;</span>] = <span class="string">&#x27;&#x27;</span></span><br><span class="line">                result[<span class="string">&#x27;gi_id&#x27;</span>] = gi_uuids</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                rtndata[<span class="string">&#x27;state&#x27;</span>] = <span class="string">&#x27;1&#x27;</span></span><br><span class="line">                result[<span class="string">&#x27;message&#x27;</span>] = <span class="string">&#x27;11069&#x27;</span>     <span class="comment"># è·å– gi_id å‡ºé”™</span></span><br><span class="line">                result[<span class="string">&#x27;gi_id&#x27;</span>] = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            rtndata[<span class="string">&#x27;state&#x27;</span>] = <span class="string">&#x27;1&#x27;</span></span><br><span class="line">            result[<span class="string">&#x27;message&#x27;</span>] = <span class="string">&#x27;11060&#x27;</span>  <span class="comment"># the drbd not found</span></span><br><span class="line"></span><br><span class="line">        rtndata[<span class="string">&#x27;result&#x27;</span>] = result</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        rtndata = &#123;<span class="string">&#x27;state&#x27;</span>: <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;result&#x27;</span>: &#123;<span class="string">&#x27;message&#x27;</span>: <span class="string">&#x27;11059&#x27;</span>&#125;&#125;  <span class="comment"># drbdname error</span></span><br><span class="line">    <span class="keyword">return</span> rtndata</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exchange_gi_process</span>(<span class="params">drbdname</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    see:https://docs.linbit.com/docs/users-guide-8.4/#s-gi (16.2.4. How DRBD uses generation identifiers)</span></span><br><span class="line"><span class="string">    :param drbdname:</span></span><br><span class="line"><span class="string">    :return:type:str</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    local_gis = get_gi_action(drbdname)</span><br><span class="line">    remote_gis = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">global</span> remoteip</span><br><span class="line">    retresult = hautils.socketclient(ip=remoteip,</span><br><span class="line">                                     **&#123;<span class="string">&#x27;target&#x27;</span>: <span class="string">&#x27;drbd&#x27;</span>, <span class="string">&#x27;op&#x27;</span>: <span class="string">&#x27;getremotegi&#x27;</span>, <span class="string">&#x27;params&#x27;</span>: &#123;<span class="string">&#x27;drbdname&#x27;</span>:drbdname&#125;&#125;)</span><br><span class="line">    <span class="keyword">if</span> retresult:</span><br><span class="line">        <span class="keyword">if</span> retresult[<span class="string">&#x27;state&#x27;</span>] == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">            remote_gis = retresult[<span class="string">&#x27;result&#x27;</span>][<span class="string">&#x27;gi_id&#x27;</span>]</span><br><span class="line">        drbd_next = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> local_gis <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> remote_gis <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            local_gis_sliced = slice_seq(local_gis)</span><br><span class="line">            remote_gis_sliced = slice_seq(remote_gis)</span><br><span class="line">            <span class="keyword">global</span> empty_uuid</span><br><span class="line">            print(<span class="string">&#x27;sliced&#x27;</span>, local_gis_sliced, remote_gis_sliced)</span><br><span class="line">            <span class="keyword">if</span> local_gis_sliced[<span class="number">0</span>] == empty_uuid <span class="keyword">and</span> remote_gis_sliced[<span class="number">0</span>] == empty_uuid:</span><br><span class="line">                drbd_next = <span class="string">&#x27;no_sync:(manual_sync)&#x27;</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> local_gis_sliced[<span class="number">0</span>] == empty_uuid <span class="keyword">or</span> remote_gis_sliced[<span class="number">0</span>] == empty_uuid:</span><br><span class="line">                <span class="keyword">if</span> remote_gis_sliced[<span class="number">0</span>] == empty_uuid <span class="keyword">and</span> local_gis_sliced[<span class="number">0</span>] != empty_uuid:</span><br><span class="line">                    drbd_next = <span class="string">&#x27;full_re_sync:(local_source)&#x27;</span></span><br><span class="line">                <span class="keyword">elif</span> local_gis_sliced[<span class="number">0</span>] == empty_uuid <span class="keyword">and</span> remote_gis_sliced[<span class="number">0</span>] != empty_uuid:</span><br><span class="line">                    drbd_next = <span class="string">&#x27;full_re_sync:(local_target)&#x27;</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> local_gis_sliced[<span class="number">0</span>] != empty_uuid <span class="keyword">and</span> remote_gis_sliced[<span class="number">0</span>] != empty_uuid <span class="keyword">and</span> local_gis_sliced[<span class="number">0</span>] == remote_gis_sliced[<span class="number">0</span>]:</span><br><span class="line">                drbd_next = <span class="string">&#x27;consistent:(both_secondary)&#x27;</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> local_gis_sliced[<span class="number">1</span>] == remote_gis_sliced[<span class="number">0</span>] <span class="keyword">and</span> remote_gis_sliced[<span class="number">1</span>] == empty_uuid:</span><br><span class="line">                drbd_next = <span class="string">&#x27;partial_re_sync:(local_source)&#x27;</span></span><br><span class="line">            <span class="keyword">elif</span> local_gis_sliced[<span class="number">1</span>] == empty_uuid <span class="keyword">and</span> remote_gis_sliced[<span class="number">1</span>] == local_gis_sliced[<span class="number">0</span>]:</span><br><span class="line">                drbd_next = <span class="string">&#x27;partial_re_sync:(local_target)&#x27;</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> local_gis_sliced[<span class="number">0</span>] <span class="keyword">in</span> [remote_gis_sliced[<span class="number">2</span>], remote_gis_sliced[<span class="number">3</span>]]:</span><br><span class="line">                drbd_next = <span class="string">&#x27;full_re_sync:(local_target)&#x27;</span></span><br><span class="line">            <span class="keyword">elif</span> remote_gis_sliced[<span class="number">0</span>] <span class="keyword">in</span> [local_gis_sliced[<span class="number">2</span>], local_gis_sliced[<span class="number">3</span>]]:</span><br><span class="line">                drbd_next = <span class="string">&#x27;full_re_sync:(local_source)&#x27;</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> local_gis_sliced[<span class="number">0</span>] != remote_gis_sliced[<span class="number">0</span>]:</span><br><span class="line">                <span class="keyword">if</span> local_gis_sliced[<span class="number">1</span>] == remote_gis_sliced[<span class="number">1</span>]:</span><br><span class="line">                    drbd_next = <span class="string">&#x27;split_brain:(auto_recover_able)&#x27;</span></span><br><span class="line">                <span class="keyword">elif</span> local_gis_sliced[<span class="number">1</span>] != remote_gis_sliced[<span class="number">1</span>]:</span><br><span class="line">                    drbd_next = <span class="string">&#x27;split_brain:(wait_for_manual_recover)&#x27;</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> cmp_both(local_gis_sliced,remote_gis_sliced):</span><br><span class="line">                drbd_next = <span class="string">&#x27;unrelated_data:(wait_for_manual_recover)&#x27;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                debug.write_debug(debug.LINE(), <span class="string">&quot;peradrbd&quot;</span>, (local_gis_sliced, remote_gis_sliced))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            debug.write_debug(debug.LINE(), <span class="string">&quot;peradrbd&quot;</span>, (local_gis,remote_gis))</span><br><span class="line">        <span class="keyword">return</span> drbd_next</span><br><span class="line"></span><br></pre></td></tr></table></figure><div class="note info modern"><p><strong>æ³¨æ„</strong><br>ç»åˆ†æå®˜æ–¹æ–‡æ¡£ä¸­çš„<code>matches</code>å¹¶ä¸æ˜¯å®Œå…¨ç›¸ç­‰ï¼Œè€Œ <code>UUID is always empty (zero)</code> æ˜¯æŒ‡ â€œâ€˜0â€™*16â€ çš„å­—ç¬¦ä¸²ï¼</p></div><h2 id="å¦‚ä½•æ¨¡æ‹Ÿä¸€ä¸ª-Split-BrainçŠ¶æ€"><a href="#å¦‚ä½•æ¨¡æ‹Ÿä¸€ä¸ª-Split-BrainçŠ¶æ€" class="headerlink" title="å¦‚ä½•æ¨¡æ‹Ÿä¸€ä¸ª Split-BrainçŠ¶æ€"></a>å¦‚ä½•æ¨¡æ‹Ÿä¸€ä¸ª <code>Split-Brain</code>çŠ¶æ€</h2><ol><li>å¾€ä¸»èŠ‚ç‚¹å†™å…¥å¤§æ–‡ä»¶ï¼Œåœ¨æœªå†™å…¥å®Œå‰åœæ­¢å¤‡èŠ‚ç‚¹çš„<code>DRBD</code>ï¼›<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># on secondary</span><br><span class="line">drbdadm down drbdxx</span><br></pre></td></tr></table></figure></li><li>åœæ­¢ä¸»èŠ‚ç‚¹çš„<code>DRBD</code>ï¼›<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># on primary</span><br><span class="line">drbdadm down drbdxx</span><br></pre></td></tr></table></figure></li><li>å¯åŠ¨å¤‡èŠ‚ç‚¹çš„<code>DRBD</code>ï¼Œè®¾ç½®ä¸ºä¸»èŠ‚ç‚¹ï¼›<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># on secondary</span><br><span class="line">drbdadm up drbdxx</span><br><span class="line">drbdadm primary drbdxx</span><br></pre></td></tr></table></figure></li><li>å¯åŠ¨åŸä¸»èŠ‚ç‚¹çš„<code>DRBD</code>ï¼Œè¿™æ—¶å‘ç°å®ƒçš„çŠ¶æ€å°±æ˜¯<code>StandAlone Secondary/Unknown UpToDate/DUnknown</code>ï¼Œ<code>Split-Brain</code> æƒ…å†µå‡ºç°ã€‚<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># on primary</span><br><span class="line">drbdadm up drbdxx</span><br></pre></td></tr></table></figure><h2 id="è§£å†³-DRBD-è„‘è£‚çŠ¶æ€"><a href="#è§£å†³-DRBD-è„‘è£‚çŠ¶æ€" class="headerlink" title="è§£å†³ DRBD è„‘è£‚çŠ¶æ€"></a>è§£å†³ DRBD è„‘è£‚çŠ¶æ€</h2></li></ol><h3 id="è®¾ç½®è‡ªåŠ¨ä¿®å¤"><a href="#è®¾ç½®è‡ªåŠ¨ä¿®å¤" class="headerlink" title="è®¾ç½®è‡ªåŠ¨ä¿®å¤"></a>è®¾ç½®è‡ªåŠ¨ä¿®å¤</h3><p>å‚è§<a href="https://docs.linbit.com/docs/users-guide-8.4/#s-configure-split-brain-behavior">5.17.2. Automatic split brain recovery policies</a></p><div class="note warning modern"><p><strong>è­¦å‘Š</strong><br>é…ç½®<code>DRBD</code>è‡ªåŠ¨ä¿®å¤è„‘è£‚ï¼ˆæˆ–å…¶ä»–çŠ¶å†µï¼‰å¯¼è‡´çš„æ•°æ®åˆ†æ­§æƒ…å†µå¯èƒ½ä½¿æ­£åœ¨é…ç½®çš„æ•°æ®ä¸¢å¤±ï¼Œå¦‚æœä½ ä¸çŸ¥é“ä½ åœ¨å¹²ä»€ä¹ˆï¼Œé‚£æœ€å¥½åˆ«å¹²ã€‚ï¼ˆNO ZUO NO DIEï¼‰</p></div><div class="note info modern"><p><strong>æç¤º</strong><br>æ‚¨æ›´åº”è¯¥æŸ¥çœ‹ç³»ç»Ÿé˜²æŠ¤ç­–ç•¥ï¼Œé›†ç¾¤ç®¡ç†é›†æˆå’Œå†—ä½™é›†ç¾¤ç®¡ç†å™¨é€šä¿¡è¿æ¥çŠ¶æ€ï¼Œä»¥é¿å…å‡ºç°æ•°æ®åˆ†æ­§ã€‚ï¼ˆé˜²æ‚£äºæœªç„¶è€Œä¸æ˜¯äº¡ç¾Šè¡¥ç‰¢ï¼‰</p></div><p>åœ¨å¯ç”¨å’Œé…ç½®<code>DRBD</code>çš„è‡ªåŠ¨è„‘è£‚æ¢å¤ç­–ç•¥ä¹‹å‰ï¼Œæ‚¨å¿…é¡»äº†è§£<code>DRBD</code>ä¸ºæ­¤æä¾›äº†å¤šç§é…ç½®é€‰é¡¹ã€‚ <code>DRBD</code> æ ¹æ®æ£€æµ‹åˆ°è„‘è£‚æ—¶ä¸»èŠ‚ç‚¹ï¼ˆ<code>Primary role</code>ï¼‰çš„æ•°é‡åº”ç”¨å…¶è„‘è£‚æ¢å¤ç¨‹åºã€‚ä¸ºæ­¤ï¼Œ<code>DRBD</code> æ£€æŸ¥ä»¥ä¸‹å…³é”®å­—ï¼Œè¿™äº›å…³é”®å­—å‡å¯åœ¨èµ„æºçš„ç½‘ç»œé…ç½®éƒ¨åˆ†ä¸­æ‰¾åˆ°ï¼š</p><h4 id="after-sb-0pri"><a href="#after-sb-0pri" class="headerlink" title="after-sb-0pri"></a>after-sb-0pri</h4><p>è„‘è£‚è¢«æ£€æµ‹åˆ°çš„åŒæ—¶è¯¥èµ„æºåœ¨ä»»ä¸€èŠ‚ç‚¹ä¸æ˜¯ä¸»èŠ‚ç‚¹ã€‚å¯¹äºè¿™ç§çŠ¶å†µï¼Œ<code>DRBD</code>å¯ä»¥ç†è§£ä»¥ä¸‹å…³é”®å­—ï¼š</p><ul><li>disconnect: ä¸è‡ªåŠ¨æ¢å¤ï¼Œåªè°ƒç”¨è„‘è£‚é€šçŸ¥ç¨‹åºï¼ˆå¦‚æœå·²é…ç½®ï¼‰ï¼Œæ–­å¼€è¿æ¥å¹¶ä¿æŒæ–­å¼€ï¼›</li><li>discard-younger-primary: ä¸¢å¼ƒå¹¶å›æ»šæœ€åå‡ä¸»èŠ‚ç‚¹çš„æ”¹åŠ¨ï¼›</li><li>discard-least-changes: ä¸¢å¼ƒå¹¶å›æ»šä¿®æ”¹æ›´å°‘èŠ‚ç‚¹çš„ä¿®æ”¹ï¼›</li><li>discard-zero-changes: å¦‚æœæœ‰æŸä¸€èŠ‚ç‚¹ä¸€ç‚¹æœªæ”¹åŠ¨ï¼Œåªéœ€åº”ç”¨å¯¹å¦ä¸€ä¸»æœºæ‰€åšçš„ä¿®æ”¹å¹¶ç»§ç»­ï¼›</li></ul><h4 id="after-sb-1pri"><a href="#after-sb-1pri" class="headerlink" title="after-sb-1pri"></a>after-sb-1pri</h4><p>è„‘è£‚åˆšè¢«æ£€æµ‹åˆ°çš„åŒæ—¶è¯¥èµ„æºåœ¨ä¸€ä¸ªèŠ‚ç‚¹ä¸Šæ˜¯ä¸»èŠ‚ç‚¹ã€‚å¯¹äºè¿™ç§çŠ¶å†µï¼Œ<code>DRBD</code>ç†è§£ä»¥ä¸‹å…³é”®å­—ï¼š</p><ul><li>disconnect:åŒä¸Š</li><li>consensusï¼šåº”ç”¨ä¸Šä¸€æ­¥çš„ç­–ç•¥ä¹‹åï¼Œå¦‚æœè„‘è£‚å—å®³è€…å¯ä»¥é€‰æ‹©æ‹†åˆ†åˆ™ä¼šè‡ªåŠ¨è§£å†³ã€‚å¦åˆ™ï¼Œä¸<code>disconnect</code>æŒ‡ä»¤ç›¸åŒã€‚</li><li>call-pri-lost-after-sbï¼šåº”ç”¨ä¸Šä¸€æ­¥çš„ç­–ç•¥ä¹‹åï¼Œå¦‚æœè„‘è£‚å—å®³è€…èŠ‚ç‚¹å¯ä»¥é€‰æ‹©æ‹†åˆ†åˆ™è°ƒç”¨<code>pri-lost-after-sb</code>å¤„ç†ç¨‹åºï¼Œè¯¥å¤„ç†ç¨‹åºå¿…é¡»åœ¨å¤„ç†ç¨‹åºä¸­è¿›è¡Œé…ç½®ï¼Œå¹¶ä¸”éœ€è¦å¼ºåˆ¶ä»é›†ç¾¤ä¸­åˆ é™¤è¯¥èŠ‚ç‚¹ã€‚</li><li>discard-secondaryï¼šå°†ä»ç«¯ï¼ˆ<code>Secondary role</code>ï¼‰èŠ‚ç‚¹è§†ä¸ºè„‘è£‚å—å®³è€…ã€‚</li></ul><h4 id="after-sb-2pri"><a href="#after-sb-2pri" class="headerlink" title="after-sb-2pri"></a>after-sb-2pri</h4><p>è„‘è£‚åˆšè¢«æ£€æµ‹åˆ°æ—¶è¯¥èµ„æºåœ¨ä¸¤ä¸ªèŠ‚ç‚¹éƒ½å¤„äºä¸»ç«¯ã€‚è¯¥é€‰é¡¹æ¥å—ä¸é™¤<code>discard-secondary</code> å’Œ <code>consensus</code> ä¹‹å¤–ä¸ <code>after-sb-1pri</code> ç›¸åŒçš„å…³é”®å­—ã€‚<br><div class="note info modern"><p><strong>æç¤º</strong><br><code>DRBD</code>è¿˜å¯ä»¥ç†è§£è¿™ä¸‰ä¸ªé€‰é¡¹ä¸‹é¢å¤–çš„å…³é”®å­—ï¼Œè¿™äº›å…³é”®å­—åœ¨è¿™é‡Œè¢«çœç•¥ï¼Œå› ä¸ºå®ƒä»¬å¾ˆå°‘è¢«ä½¿ç”¨ã€‚è¯·å‚é˜…<code>drbd.conf</code>çš„æ‰‹å†Œé¡µä»¥è·å–æœ‰å…³è„‘è£‚æ¢å¤å…³é”®å­—çš„è¯¦ç»†ä¿¡æ¯ï¼Œæ­¤å¤„ä¸å†è®¨è®ºã€‚</p></div><br>ä¾‹å¦‚ï¼Œç”¨ä½œåŒä¸»æ¨¡å¼ä¸‹<code>GFS</code>æˆ–<code>OCFS2</code>æ–‡ä»¶ç³»ç»Ÿçš„å—è®¾å¤‡çš„èµ„æºå¯èƒ½ä¼šå°†å…¶æ¢å¤ç­–ç•¥å®šä¹‰å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">resource &lt;resource&gt; &#123;</span><br><span class="line">  handlers &#123;</span><br><span class="line">    split-brain &quot;/usr/lib/drbd/notify-split-brain.sh root&quot;      # è„šæœ¬é€šçŸ¥rootç”¨æˆ·ï¼Œæ­¤å¤„å¯ä»¥ä½¿ç”¨é‚®ä»¶æé†’</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">  net &#123;</span><br><span class="line">    after-sb-0pri discard-zero-changes;</span><br><span class="line">    after-sb-1pri discard-secondary;</span><br><span class="line">    after-sb-2pri disconnect;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ‰‹åŠ¨æ¢å¤"><a href="#æ‰‹åŠ¨æ¢å¤" class="headerlink" title="æ‰‹åŠ¨æ¢å¤"></a>æ‰‹åŠ¨æ¢å¤</h3><p><a href="https://docs.linbit.com/docs/users-guide-8.4/#s-resolve-split-brain">6.3. Manual split brain recovery</a></p><p>åœ¨æ£€æµ‹åˆ°è„‘è£‚åï¼Œä¸€ä¸ªèŠ‚ç‚¹å°†å§‹ç»ˆä½¿èµ„æºå¤„äº<code>StandAlone</code>è¿æ¥çŠ¶æ€ã€‚å¦ä¸€ä¸ªå¯èƒ½ä¹Ÿå¤„äº<code>StandAlone</code>çŠ¶æ€ï¼ˆå¦‚æœä¸¤ä¸ªèŠ‚ç‚¹åŒæ—¶æ£€æµ‹åˆ°è„‘è£‚ï¼‰æˆ–<code>WFConnection</code>ï¼ˆå¦‚æœæŸæ–¹èŠ‚ç‚¹åœ¨å¦ä¸€èŠ‚ç‚¹æ£€æµ‹åˆ°è„‘è£‚ä¹‹å‰æ–­å¼€è¿æ¥ï¼‰ã€‚</p><p>æ­¤æ—¶ï¼Œé™¤éå·²å°†<code>DRBD</code>é…ç½®ä¸ºè‡ªåŠ¨ä»è„‘è£‚çŠ¶æ€ä¸­æ¢å¤ï¼Œå¦åˆ™å¿…é¡»é€šè¿‡é€‰æ‹©ä¸€ä¸ªèŠ‚ç‚¹è¿›è¡Œæ‰‹åŠ¨å¹²é¢„ï¼Œè¯¥èŠ‚ç‚¹çš„ä¿®æ”¹å°†è¢«ä¸¢å¼ƒï¼ˆæ­¤èŠ‚ç‚¹ç§°ä¸ºè„‘è£‚å—å®³è€…ï¼‰ã€‚è¿™ä¸ªå¹²é¢„ä½¿ç”¨ä¸‹é¢æ­¥éª¤å®Œæˆï¼š</p><p>è„‘è£‚å—å®³è€…éœ€è¦å¤„äº<code>StandAlone</code>çš„è¿æ¥çŠ¶æ€ï¼Œå¦åˆ™ä»¥ä¸‹å‘½ä»¤å°†è¿”å›é”™è¯¯ã€‚æ‚¨å¯ä»¥é€šè¿‡å‘å‡ºä»¥ä¸‹å†…å®¹ç¡®ä¿å®ƒæ˜¯<code>StandAlone</code>çš„ï¼š<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">drbdadm disconnect &lt;resource&gt;</span><br><span class="line">drbdadm secondary &lt;resource&gt;</span><br><span class="line">drbdadm connect --discard-my-data &lt;resource&gt;    # 8.4+  if 8.3,use &#x27;drbdadm -- --discard-my-data connect &lt;resource&gt;&#x27; instead</span><br></pre></td></tr></table></figure><br>åœ¨å¦ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆè„‘è£‚å¹¸å­˜è€…ï¼‰ä¸Šï¼Œå¦‚æœå®ƒçš„è¿æ¥çŠ¶æ€ä¹Ÿæ˜¯<code>StandAlone</code>ï¼Œä½ å¯ä»¥è¾“å…¥ï¼š<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">drbdadm connect &lt;resource&gt;</span><br></pre></td></tr></table></figure><br>å¦‚æœèŠ‚ç‚¹å·²å¤„äº<code>WFConnection</code>çŠ¶æ€ï¼Œåˆ™å¯ä»¥çœç•¥æ­¤æ­¥éª¤;å®ƒä¼šè‡ªåŠ¨é‡æ–°è¿æ¥ã€‚</p><p>å¦‚æœå—è„‘è£‚å½±å“çš„èµ„æºæ˜¯<strong>å †å </strong>èµ„æºï¼Œè¯·ä½¿ç”¨<code>drbdadm --stacked</code>è€Œä¸æ˜¯<code>drbdadm</code>ã€‚</p><p>è¿æ¥åï¼Œè„‘è£‚å—å®³è€…ç«‹å³å°†å…¶è¿æ¥çŠ¶æ€æ›´æ”¹ä¸º<code>SyncTarget</code>ï¼Œå¹¶å°†å…¶å¯¼è‡´è„‘è£‚çš„ä¿®æ”¹ç”±å…¶ä½™ä¸»èŠ‚ç‚¹çš„æ•°æ®è¦†ç›–ã€‚</p><p>è„‘è£‚å—å®³è€…ä¸ä¼šå¼•å‘å…¨ç›˜åŒæ­¥ã€‚ç›¸åï¼Œå®ƒçš„å±€éƒ¨ä¿®æ”¹å·²ç»è¢«å›æ»šï¼Œå¯¹è„‘è£‚å¹¸å­˜è€…çš„ä»»ä½•ä¿®æ”¹éƒ½ä¼šä¼ é€’ç»™å—å®³è€…ã€‚<br>é‡æ–°åŒæ­¥å®Œæˆåï¼Œè„‘è£‚è¢«è§†ä¸ºå·²è§£å†³ï¼ˆ<code>resolved</code>ï¼‰ï¼Œä¸¤ä¸ªèŠ‚ç‚¹å†æ¬¡å½¢æˆå®Œå…¨ä¸€è‡´çš„å†—ä½™å¤åˆ¶å­˜å‚¨ç³»ç»Ÿï¼ˆ<code>DRBD</code>ï¼‰ã€‚</p><h3 id="ä»²è£æœåŠ¡"><a href="#ä»²è£æœåŠ¡" class="headerlink" title="ä»²è£æœåŠ¡"></a>ä»²è£æœåŠ¡</h3><p>å‚è§æˆ‘çš„å¦ä¸€ç¯‡åšæ–‡ï¼š<a href="/blog/2020-07-22/dual-active-with-drbd/">ä¸€ç§åŸºäº DRBD çš„åŒæ´»è§£å†³æ–¹æ¡ˆ | åˆ«é™¢ç‰§å¿—</a></p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><ul><li><a href="https://docs.linbit.com/docs/users-guide-8.4/">Userâ€™s Guide 8.4.x</a></li><li><a href="http://blog.sina.com.cn/s/blog_a30f2be401016d04.html">å…³äº DRBD v8.3 çš„åŒæ­¥æœºåˆ¶</a></li><li><a href="http://myhat.blog.51cto.com/391263/606318/">ä¸€æ¬¡ DRBD è„‘è£‚è¡Œä¸ºçš„æ¨¡æ‹Ÿ</a></li><li><a href="http://itindex.net/detail/50197-drbd">drbd è„‘è£‚å¤„ç† | IT ç˜¾</a></li><li><a href="http://www.3mu.me/%E4%BB%80%E4%B9%88%E6%98%AFdrbd%E8%84%91%E8%A3%82%E5%8F%8A%E5%A6%82%E4%BD%95%E6%A8%A1%E6%8B%9Fdrbd%E8%84%91%E8%A3%82/">ä»€ä¹ˆæ˜¯ DRBD è„‘è£‚åŠå¦‚ä½•æ¨¡æ‹Ÿ DRBD è„‘è£‚</a></li><li><a href="http://www.wenzizone.cn/2009/10/29/drbd%e4%b8%admetadata%e7%9a%84%e7%90%86%e8%a7%a3%e5%8e%9f%e5%88%9b.html">drbd ä¸­ metadata çš„ç†è§£(åŸåˆ›) â€“ èšŠå­ä¸–ç•Œ</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> DRBD </tag>
            
            <tag> å­˜å‚¨ </tag>
            
            <tag> è„‘è£‚ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³äºåœ¨ Python ä¸­ MySQL çš„ WHERE å­å¥ä¸­æ‰§è¡Œ IN æ“ä½œï¼ˆlistï¼Œtupleï¼‰çš„é—®é¢˜</title>
      <link href="blog/2018-05-10/executing-select-where-in-using-mysqldb/"/>
      <url>blog/2018-05-10/executing-select-where-in-using-mysqldb/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><p>ä»Šå¤©åœ¨å†™ä»£ç çš„æ—¶å€™ï¼Œæœ‰ä¸€å¤„æŸ¥è¯¢è¯­å¥éœ€è¦æ‰§è¡Œ <code>IN</code> æ“ä½œï¼Œç»“æœç›´æ¥<code>join</code>æ“ä½œä¼šå‡ºé”™ã€‚<br><a id="more"></a></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">list_of_datas = [<span class="string">u&#x27;sde&#x27;</span>, <span class="string">u&#x27;sdf&#x27;</span>, <span class="string">u&#x27;sdb&#x27;</span>, <span class="string">u&#x27;sdc&#x27;</span>]</span><br><span class="line">sql = <span class="string">&quot;SELECT DiskId,Name,Sg,PhyId,ExpanderId,EProduct FROM Disk WHERE Used=&#x27;2&#x27; AND Name IN (%s)&quot;</span> % <span class="string">&#x27;,&#x27;</span>.join(list_of_datas)</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœï¼š</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> DiskId, Name, Sg, PhyId, ExpanderId</span><br><span class="line">, EProduct</span><br><span class="line"><span class="keyword">FROM</span> Disk</span><br><span class="line"><span class="keyword">WHERE</span> Used <span class="operator">=</span> <span class="string">&#x27;2&#x27;</span></span><br><span class="line"><span class="keyword">AND</span> Name <span class="keyword">IN</span> (sde, sdf, sdb, sdc)</span><br></pre></td></tr></table></figure><p>å¾ˆæ˜æ˜¾ä¸é¢„æœŸçš„ç»“æœæ˜¯ä¸ä¸€æ ·çš„ã€‚å› ä¸º <code>IN</code> æ“ä½œä¸­çš„é€‰å–å­—æ®µåº”è¯¥æ˜¯å¸¦å¼•å·çš„å­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯ç›´æ¥æ˜¾ç¤ºçš„å­—ç¬¦ä¸²ã€‚ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬æœŸæœ›çš„<code>WHERE</code>å­å¥ä¸­æ˜¯<code>WHERE Used = &#39;2&#39; AND Name IN (&#39;sde&#39;, &#39;sdf&#39;, &#39;sdb&#39;, &#39;sdc&#39;)</code>å½¢å¼ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sql1 = <span class="string">&quot;SELECT DiskId,Name,Sg,PhyId,ExpanderId,EProduct FROM Disk WHERE Used=&#x27;2&#x27; AND Name IN (%s)&quot;</span> % <span class="string">&#x27;,&#x27;</span>.join([<span class="string">&quot;&#x27;%s&#x27;&quot;</span> % item <span class="keyword">for</span> item <span class="keyword">in</span> list_of_datas])</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœï¼š</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> DiskId, Name, Sg, PhyId, ExpanderId</span><br><span class="line">, EProduct</span><br><span class="line"><span class="keyword">FROM</span> Disk</span><br><span class="line"><span class="keyword">WHERE</span> Used <span class="operator">=</span> <span class="string">&#x27;2&#x27;</span></span><br><span class="line"><span class="keyword">AND</span> Name <span class="keyword">IN</span> (<span class="string">&#x27;sde&#x27;</span>, <span class="string">&#x27;sdf&#x27;</span>, <span class="string">&#x27;sdb&#x27;</span>, <span class="string">&#x27;sdc&#x27;</span>)</span><br></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œå¯ä»¥æ»¡è¶³æˆ‘ä»¬çš„è¦æ±‚ã€‚ä¸è¿‡ï¼Œç”±äºä¸Šé¢å­—ç¬¦åŒ–æ“ä½œæ„Ÿè§‰æœ‰ç‚¹æš´åŠ›ï¼Œæˆ‘ä»¬å¯ä»¥ç¨å¾®æ”¹è¿›ä¸€ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">format_strings= <span class="string">&#x27;,&#x27;</span>.join([<span class="built_in">repr</span>(item) <span class="keyword">for</span> item <span class="keyword">in</span> list_of_datas])</span><br><span class="line">print(format_strings)</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">u&#x27;sde&#x27;</span>,<span class="string">u&#x27;sdf&#x27;</span>,<span class="string">u&#x27;sdb&#x27;</span>,<span class="string">u&#x27;sdc&#x27;</span></span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ <code>SQL</code> è¯­å¥å˜æˆ:</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> DiskId,Name,Sg,PhyId,ExpanderId,EProduct <span class="keyword">FROM</span> Disk <span class="keyword">WHERE</span> Used<span class="operator">=</span><span class="string">&#x27;2&#x27;</span> <span class="keyword">AND</span> Name <span class="keyword">IN</span> (u<span class="string">&#x27;sde&#x27;</span>,u<span class="string">&#x27;sdf&#x27;</span>,u<span class="string">&#x27;sdb&#x27;</span>,u<span class="string">&#x27;sdc&#x27;</span>)</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ˜¯æ²¡åŠæ³•æ­£å¸¸æŸ¥è¯¢å‡ºç»“æœçš„ï¼Œå› ä¸ºæŸ¥è¯¢å­—æ®µæ˜¯ <code>unicode</code> ç¼–ç ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">format_unicode_strings = <span class="string">&#x27;,&#x27;</span>.join([<span class="built_in">repr</span>(item.encode(<span class="string">&#x27;utf-8&#x27;</span>)) <span class="keyword">if</span> <span class="built_in">isinstance</span>(item,unicode) <span class="keyword">else</span> <span class="built_in">repr</span>(item) <span class="keyword">for</span> item <span class="keyword">in</span> list_of_datas])</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ç»“æœæ»¡è¶³æˆ‘ä»¬çš„è¦æ±‚ï¼š</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> DiskId, Name, Sg, PhyId, ExpanderId</span><br><span class="line">, EProduct</span><br><span class="line"><span class="keyword">FROM</span> Disk</span><br><span class="line"><span class="keyword">WHERE</span> Used <span class="operator">=</span> <span class="string">&#x27;2&#x27;</span></span><br><span class="line"><span class="keyword">AND</span> Name <span class="keyword">IN</span> (<span class="string">&#x27;sde&#x27;</span>, <span class="string">&#x27;sdf&#x27;</span>, <span class="string">&#x27;sdb&#x27;</span>, <span class="string">&#x27;sdc&#x27;</span>)</span><br></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œæ”¶å·¥ã€‚</p><p>å› ä¸ºå…¬å¸çš„ä»£ç å°è£…å‡½æ•°æ˜¯åªèƒ½æ‰§è¡ŒçœŸæ­£çš„ <code>SQL</code> è¯­å¥çš„ï¼Œæ‰€ä»¥åªèƒ½ç”¨ä¸Šé¢çš„æ–¹æ³•ï¼ŒæŸ¥è¯¢ç½‘ç»œä¸Šåˆ«äººçš„è§£å†³æ–¹æ¡ˆå‘ç°ä¸‹é¢çš„å†™æ³•ï¼Œä»¥å¤‡å‚è€ƒã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>alist = [<span class="string">&#x27;1.1.1.1&#x27;</span>,<span class="string">&#x27;2.2.2.2&#x27;</span>,<span class="string">&#x27;3.3.3.3&#x27;</span>]                                                    </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>select_str = <span class="string">&#x27;select * from server where ip in (%s)&#x27;</span> % <span class="string">&#x27;,&#x27;</span>.join([<span class="string">&#x27;%s&#x27;</span>] * <span class="built_in">len</span>(alist))       </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>select_str  </span><br><span class="line"><span class="string">&#x27;select * from server where ip in (%s,%s,%s)&#x27;</span> </span><br><span class="line"> <span class="comment"># æ‰§è¡ŒsqlæŸ¥è¯¢</span></span><br><span class="line">cursor.execute(select_str,a)  </span><br></pre></td></tr></table></figure><p>åé¢çš„å†™æ³•æœ‰å¾ˆå¤šç§ï¼Œæ¯”å¦‚ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">args = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">in_p = <span class="string">&#x27;, &#x27;</span>.join((<span class="built_in">map</span>(<span class="keyword">lambda</span> x: <span class="string">&#x27;%s&#x27;</span>, args)))</span><br><span class="line">realsql = sql % in_p</span><br><span class="line">cursor.execute(realsql, args)</span><br></pre></td></tr></table></figure><p>å†æ¯”å¦‚ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">args = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">in_p = <span class="string">&#x27;, &#x27;</span>.join(itertools.repeat(<span class="string">&#x27;%s&#x27;</span>, <span class="built_in">len</span>(args)))</span><br><span class="line">cursor.execute(sql % in_p, args)</span><br></pre></td></tr></table></figure><p>å®Œæ•´ç¤ºä¾‹ä»£ç :</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># Created by imoyao at 2018/5/18 17:17</span></span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> MySQLdb</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">excute_sql</span>(<span class="params">sql</span>):</span></span><br><span class="line">    db = MySQLdb.connect(host=<span class="string">&quot;localhost&quot;</span>, user=<span class="string">&quot;imoyao&quot;</span>, passwd=<span class="string">&quot;111111&quot;</span>, db=<span class="string">&quot;ODSP&quot;</span>, charset=<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    cr = db.cursor()</span><br><span class="line">    cr.execute(sql)</span><br><span class="line">    data = cr.fetchall()</span><br><span class="line">    cr.close()</span><br><span class="line">    db.close()</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">excute_sql_datas</span>(<span class="params">sqlstr, tupledata</span>):</span></span><br><span class="line">    db = MySQLdb.connect(host=<span class="string">&quot;localhost&quot;</span>, user=<span class="string">&quot;imoyao&quot;</span>, passwd=<span class="string">&quot;111111&quot;</span>, db=<span class="string">&quot;ODSP&quot;</span>, charset=<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    cr = db.cursor()</span><br><span class="line">    cr.execute(sqlstr,tupledata)</span><br><span class="line">    data = cr.fetchall()</span><br><span class="line">    cr.close()</span><br><span class="line">    db.close()</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    list_of_datas = [<span class="string">u&#x27;sde&#x27;</span>, <span class="string">u&#x27;sdf&#x27;</span>, <span class="string">u&#x27;sdb&#x27;</span>, <span class="string">u&#x27;sdc&#x27;</span>]</span><br><span class="line">    format_strings = <span class="string">&#x27;,&#x27;</span>.join(</span><br><span class="line">        [<span class="built_in">repr</span>(item.encode(<span class="string">&#x27;utf-8&#x27;</span>)) <span class="keyword">if</span> <span class="built_in">isinstance</span>(item, unicode) <span class="keyword">else</span> <span class="built_in">repr</span>(item) <span class="keyword">for</span> item <span class="keyword">in</span> list_of_datas])</span><br><span class="line">    sql = <span class="string">&quot;SELECT DiskId,Name,Sg,PhyId,ExpanderId,EProduct FROM Disk WHERE Used=&#x27;2&#x27; AND Name IN (%s)&quot;</span> % format_strings</span><br><span class="line">    print(excute_sql(sql))</span><br><span class="line"></span><br><span class="line">    print(<span class="string">&#x27;*&#x27;</span>*<span class="number">40</span>)</span><br><span class="line"></span><br><span class="line">    sql2 = <span class="string">&quot;SELECT DiskId,Name,Sg,PhyId,ExpanderId,EProduct FROM Disk WHERE Used=&#x27;2&#x27; AND Name IN (%s)&quot;</span></span><br><span class="line">    <span class="comment"># format_strings2 = &#x27;, &#x27;.join(map(lambda x: &#x27;%s&#x27;, list_of_datas))</span></span><br><span class="line">    <span class="comment"># format_strings2 = &#x27;, &#x27;.join([&#x27;%s&#x27;] * len(list_of_datas))</span></span><br><span class="line">    format_strings2 = <span class="string">&#x27;, &#x27;</span>.join(itertools.repeat(<span class="string">&#x27;%s&#x27;</span>, <span class="built_in">len</span>(list_of_datas)))</span><br><span class="line">    sqlstr = sql2 % format_strings2</span><br><span class="line">    print(excute_sql_datas(sqlstr, list_of_datas))</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å‚è€ƒé“¾æ¥ï¼š</p><ol><li><p><a href="https://blog.csdn.net/u011085172/article/details/79044490">python mysql where in å¯¹åˆ—è¡¨ï¼ˆlist,,arrayï¼‰é—®é¢˜ - CSDN åšå®¢</a></p></li><li><p><a href="https://stackoverflow.com/questions/4574609/executing-select-where-in-using-mysqldb">python - Executing â€œSELECT â€¦ WHERE â€¦ IN â€¦â€ using MySQLdb - Stack Overflow</a></p></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> MySQL </tag>
            
            <tag> SQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³äº Python ä¸­çš„ä¸‹åˆ’çº¿ç”¨æ³•çš„è®°å½•</title>
      <link href="blog/2018-04-28/the-underline-of-Python/"/>
      <url>blog/2018-04-28/the-underline-of-Python/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h2 id="Py-ä¹™å·±"><a href="#Py-ä¹™å·±" class="headerlink" title="Py ä¹™å·±"></a>Py ä¹™å·±</h2><p>å­”ä¹™å·±è‡ªå·±çŸ¥é“ä¸èƒ½å’Œæ¶æ„å¸ˆè°ˆå¤©ï¼Œä¾¿åªå¥½å‘å®ä¹ ç”Ÿè¯´è¯ã€‚</p><p>æœ‰ä¸€å›å¯¹æˆ‘è¯´é“ï¼Œâ€œä½ å†™è¿‡<code>Python</code>ä¹ˆï¼Ÿâ€æˆ‘ç•¥ç•¥ç‚¹ä¸€ç‚¹å¤´ã€‚</p><p>ä»–è¯´ï¼Œâ€œå†™è¿‡ä»£ç ï¼Œâ€¦â€¦æˆ‘ä¾¿è€ƒä½ ä¸€è€ƒã€‚<code>Python</code>ä¸­çš„ä¸‹åˆ’çº¿ï¼Œæ€æ ·ç”¨çš„ï¼Ÿâ€</p><p>æˆ‘æƒ³ï¼Œæ¬ç –ä¸€æ ·çš„äººï¼Œä¹Ÿé…è€ƒæˆ‘ä¹ˆï¼Ÿä¾¿å›è¿‡è„¸å»ï¼Œä¸å†ç†ä¼šã€‚</p><p>å­”ä¹™å·±ç­‰äº†è®¸ä¹…ï¼Œå¾ˆæ³åˆ‡çš„è¯´é“ï¼Œâ€œä¸èƒ½å†™ç½¢ï¼Ÿâ€¦â€¦æˆ‘æ•™ç»™ä½ ï¼Œè®°ç€ï¼è¿™äº›ç”¨æ³•åº”è¯¥è®°ç€ã€‚å°†æ¥åšé¢è¯•å®˜çš„æ—¶å€™è¦ç”¨ã€‚â€</p><p>æˆ‘æš—æƒ³æˆ‘å’Œé¢è¯•å®˜çš„ç­‰çº§è¿˜å¾ˆè¿œå‘¢ï¼Œè€Œä¸”æˆ‘ä»¬é¢è¯•å®˜ä¹Ÿä»ä¸å°†è¿™äº›é—®é¢˜æ‹¿æ¥è€ƒåº”è˜è€…ï¼›åˆå¥½ç¬‘ï¼Œåˆä¸è€çƒ¦ï¼Œæ‡’æ‡’çš„ç­”ä»–é“ï¼Œâ€œè°è¦ä½ æ•™ï¼Œä¸å°±æ˜¯å‘½åå˜é‡ï¼Œå¢åŠ ä»£ç çš„å¯è¯»æ€§å—ï¼Ÿâ€</p><p>å­”ä¹™å·±æ˜¾å‡ºæé«˜å…´çš„æ ·å­ï¼Œå°†ä¸¤ä¸ªæŒ‡å¤´çš„é•¿æŒ‡ç”²æ•²ç€é”®ç›˜ï¼Œç‚¹å¤´è¯´ï¼Œâ€œå¯¹å‘€å¯¹å‘€ï¼â€¦â€¦ä¸‹åˆ’çº¿æœ‰ x ç§å†™æ³•ï¼Œä½ çŸ¥é“ä¹ˆï¼Ÿâ€</p><p>æˆ‘æ„ˆä¸è€çƒ¦äº†ï¼ŒåŠªç€å˜´èµ°è¿œã€‚å­”ä¹™å·±åˆšç”¨çº¸å·¾æ“¦äº†æ“¦é”®ç›˜ä¸Šçš„å’–å•¡æ¸ï¼Œæƒ³åœ¨<code>IDE</code>é‡Œå†™ä»£ç ï¼Œè§æˆ‘æ¯«ä¸çƒ­å¿ƒï¼Œä¾¿åˆå¹ä¸€å£æ°”ï¼Œæ˜¾å‡ºææƒ‹æƒœçš„æ ·å­ã€‚<br><a id="more"></a></p><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><ul><li>åœ¨<code>äº¤äº’å¼è§£é‡Šå™¨</code>ä¸­è·å–ä¸Šä¸€ä¸ªè¯­å¥æ‰§è¡Œçš„ç»“æœï¼›</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">1</span>+<span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>_</span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>_ * <span class="number">5</span></span><br><span class="line"><span class="number">10</span></span><br></pre></td></tr></table></figure><ul><li>ç”¨æ¥åœ¨å‡½æ•°ã€æ¨¡å—ã€åŒ…ã€å˜é‡åä¸­åˆ†éš”å•è¯ï¼Œå¢åŠ å¯è¯»æ€§ï¼›</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">var_foo_bar = <span class="string">&#x27;hello,world!&#x27;</span></span><br></pre></td></tr></table></figure><ul><li>å†…éƒ¨ä½¿ç”¨çš„å˜é‡ã€å±æ€§ã€æ–¹æ³•ã€å‡½æ•°ã€ç±»æˆ–æ¨¡å—ï¼Œï¼ˆçº¦å®šï¼‰åˆç§°ä¸ºå†…éƒ¨å®ç°ï¼›</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å‡å®šå­˜åœ¨foo.pyä¸­å®šä¹‰å˜é‡ï¼š</span></span><br><span class="line">_var = <span class="number">9527</span></span><br><span class="line"><span class="comment"># åœ¨bar.pyä¸­å¯¼å…¥</span></span><br><span class="line"><span class="keyword">from</span> foo <span class="keyword">import</span> *   <span class="comment"># ä¸ä¼šå¯¼å…¥ä»¥ä¸‹åˆ’çº¿å¼€å¤´çš„å¯¹è±¡</span></span><br><span class="line">print(_var)</span><br><span class="line"><span class="comment"># è¿”å›ï¼š</span></span><br><span class="line">NameError: name <span class="string">&#x27;_var&#x27;</span> <span class="keyword">is</span> <span class="keyword">not</span> defined</span><br><span class="line"><span class="comment"># å½“ç„¶ä¹Ÿå¯ä»¥å¼ºåˆ¶å¯¼å…¥ï¼ˆä¸æ¨èï¼‰</span></span><br><span class="line"><span class="keyword">from</span> foo <span class="keyword">import</span> _var        <span class="comment"># Access to a protected member _var of a module</span></span><br><span class="line">print(_var)</span><br><span class="line"><span class="comment"># è¿”å›ï¼š</span></span><br><span class="line"><span class="number">9527</span></span><br></pre></td></tr></table></figure><ul><li>é¿å…ä¸ <code>Python</code> ä¿ç•™çš„å…³é”®å­—å†²çªï¼ˆçº¦å®šï¼‰ï¼›</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">Tkinter.Toplevel(master, class_=<span class="string">&#x27;ClassName&#x27;</span>)        <span class="comment"># æ³¨æ„classä¸ºPythonå…§å»ºåç§°</span></span><br></pre></td></tr></table></figure><ul><li>åœ¨ç±»å†…çš„ç§æœ‰å˜é‡ï¼ˆ<code>private</code>ï¼‰ï¼Œç±»å¤–éƒ¨æ— æ³•ç›´æ¥ä½¿ç”¨åŸåç§°è®¿é—®ï¼Œéœ€è¦é€šè¿‡<code>instance._ClassName__var</code>çš„å½¢å¼è®¿é—®ï¼ˆ<code>name mangling</code>ï¼‰ï¼›</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line"></span><br><span class="line">    __say_hello = <span class="string">&#x27;Hello,world&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, age</span>):</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.age = age</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_name</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.name</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_age</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.age</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    pi = Person(<span class="string">&#x27;Peter&#x27;</span>, <span class="number">26</span>)</span><br><span class="line">    <span class="comment"># print(pi.__say_hello)       # AttributeError: &#x27;Person&#x27; object has no attribute &#x27;__say_hello&#x27;</span></span><br><span class="line">    print(pi._Person__say_hello)</span><br><span class="line">    print(pi.get_age())</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>dir(pi)</code>çœ‹ä¸€ä¸‹å¯¹è±¡ä¸­çš„ä¸­çš„å±æ€§å’Œæ–¹æ³•ï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[&#x27;_Person__say_hello&#x27;, &#x27;__class__&#x27;, &#x27;__delattr__&#x27;, &#x27;__dict__&#x27;, &#x27;__doc__&#x27;, &#x27;__format__&#x27;, &#x27;__getattribute__&#x27;, &#x27;__hash__&#x27;, &#x27;__init__&#x27;, &#x27;__module__&#x27;, &#x27;__new__&#x27;, &#x27;__reduce__&#x27;, &#x27;__reduce_ex__&#x27;, &#x27;__repr__&#x27;, &#x27;__setattr__&#x27;, &#x27;__sizeof__&#x27;, &#x27;__str__&#x27;, &#x27;__subclasshook__&#x27;, &#x27;__weakref__&#x27;, &#x27;age&#x27;, &#x27;get_age&#x27;, &#x27;get_name&#x27;, &#x27;name&#x27;]</span><br></pre></td></tr></table></figure><p>è¿™é‡Œ <code>Python</code> è§£é‡Šå™¨è§¦å‘åç§°ä¿®é¥°ï¼Œå®ƒè¿™æ ·åšæ˜¯ä¸ºäº†é˜²æ­¢å˜é‡åœ¨å­ç±»ä¸­è¢«é‡å†™ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ–°å»ºä¸€ä¸ªé›†æˆPersonçš„AIç±»</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AI</span>(<span class="params">Person</span>):</span></span><br><span class="line"></span><br><span class="line">    __say_hello = <span class="string">&#x27;ALL in AI&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"></span><br><span class="line">    ai_attr = [<span class="string">&#x27;ALL in AI&#x27;</span>]*<span class="number">3</span></span><br><span class="line">    ai = AI(*ai_attr)</span><br><span class="line">    print(<span class="built_in">dir</span>(ai))</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç»§æ‰¿å…³ç³»ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¿”å›</span></span><br><span class="line">[<span class="string">&#x27;_AI__say_hello&#x27;</span>, <span class="string">&#x27;_Person__gender&#x27;</span>, <span class="string">&#x27;_Person__say_hello&#x27;</span>, <span class="string">&#x27;__class__&#x27;</span>, <span class="string">&#x27;__delattr__&#x27;</span>, <span class="string">&#x27;__dict__&#x27;</span>, <span class="string">&#x27;__doc__&#x27;</span>, <span class="string">&#x27;__format__&#x27;</span>, <span class="string">&#x27;__getattribute__&#x27;</span>, <span class="string">&#x27;__hash__&#x27;</span>, <span class="string">&#x27;__init__&#x27;</span>, <span class="string">&#x27;__module__&#x27;</span>, <span class="string">&#x27;__new__&#x27;</span>, <span class="string">&#x27;__reduce__&#x27;</span>, <span class="string">&#x27;__reduce_ex__&#x27;</span>, <span class="string">&#x27;__repr__&#x27;</span>, <span class="string">&#x27;__setattr__&#x27;</span>, <span class="string">&#x27;__sizeof__&#x27;</span>, <span class="string">&#x27;__str__&#x27;</span>, <span class="string">&#x27;__subclasshook__&#x27;</span>, <span class="string">&#x27;__weakref__&#x27;</span>, <span class="string">&#x27;_age&#x27;</span>, <span class="string">&#x27;name&#x27;</span>]</span><br></pre></td></tr></table></figure><p>è¿™ç‚¹åœ¨ <code>ã€ŠPython Cookbookã€‹- 8.5 åœ¨ç±»ä¸­å°è£…å±æ€§å</code> ä¸­å¯¹äºå•ä¸‹åˆ’çº¿å’ŒåŒä¸‹åˆ’çº¿çš„ä½¿ç”¨åœºæ™¯ä¹Ÿæœ‰æåŠå’Œè§£é‡Šï¼š</p><blockquote><p>é€šå¸¸è€Œè¨€ï¼Œä½ åº”è¯¥è®©ä½ çš„éå…¬å…±åç§°ä»¥å•ä¸‹åˆ’çº¿å¼€å¤´ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ æ¸…æ¥šä½ çš„ä»£ç ä¼šæ¶‰åŠåˆ°å­ç±»ï¼Œå¹¶ä¸”æœ‰äº›å†…éƒ¨å±æ€§åº”è¯¥åœ¨å­ç±»ä¸­éšè—èµ·æ¥ï¼Œé‚£ä¹ˆæ‰è€ƒè™‘ä½¿ç”¨åŒä¸‹åˆ’çº¿æ–¹æ¡ˆã€‚</p></blockquote><ul><li><p>ç±»é‡Œé¢çš„ä¿æŠ¤å˜é‡ï¼›</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">_var_</span><br></pre></td></tr></table></figure><div class="note info modern"><p>ä¸ªäººè®¤ä¸ºè¿™ä¸ªè¿˜æ˜¯ç±»å†…éƒ¨ä½¿ç”¨å˜é‡çš„ä¸€ç§å»¶ä¼¸ç”¨æ³•ï¼Œåªä¸è¿‡åœ¨åé¢åŠ ä¸‹åˆ’çº¿ä»¥åšåŒºåˆ†ã€‚ä½†æ˜¯ï¼Œè¿™ä¸ªå’ŒåŒä¸‹åˆ’çº¿ä¼šåœ¨ä¸€å®šç¨‹åº¦ä¸Šå¼•èµ·é˜…è¯»æ··æ·†ï¼ˆå¦‚æœçœ¼ç¥ä¸å¥½ï¼‰ã€‚å¦‚æœåªæ˜¯å‘½åä¸ªåˆ«å˜é‡è¿˜æ˜¯å¯ä»¥æ¥å—çš„ã€‚</p></div></li><li><p><code>Python</code> å†…ç½®çš„â€œé­”æ³•â€æ–¹æ³•æˆ–å±æ€§ï¼Œä½ ä¹Ÿå¯ä»¥è‡ªå·±å®šä¹‰ï¼Œä½† <strong>å¼ºçƒˆä¸æ¨è</strong>ã€‚æ¯”å¦‚ï¼š</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">__init__, __file__, __main__</span><br></pre></td></tr></table></figure><ul><li>ä½œä¸ºå†…éƒ¨ä½¿ç”¨çš„ä¸€æ¬¡æ€§å˜é‡ï¼›</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># é€šå¸¸åœ¨å¾ªç¯é‡Œä½¿ç”¨,æ¯”å¦‚ï¼š</span></span><br><span class="line">foo_list = [_ <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)]</span><br><span class="line"><span class="comment"># æˆ–æ˜¯ç”¨ä½œå ä½ï¼Œä¸å®é™…ä½¿ç”¨çš„å˜é‡,æ¯”å¦‚ï¼š</span></span><br><span class="line"><span class="keyword">for</span> _, a <span class="keyword">in</span> [(<span class="number">1</span>,<span class="number">2</span>),(<span class="number">3</span>,<span class="number">4</span>)]:</span><br><span class="line">    <span class="built_in">print</span> a</span><br></pre></td></tr></table></figure><ul><li><code>i18n</code> é‡Œä½œä¸º <code>gettext()</code> çš„ç¼©å†™ï¼›</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">_()</span><br></pre></td></tr></table></figure><ul><li>ç”¨æ¥åˆ†éš”æ•°å€¼ä»¥å¢åŠ å¯è¯»æ€§ï¼ˆ<code>Python 3.6</code> æ–°å¢ï¼‰ï¼›</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; num &#x3D; 1_000_000 </span><br><span class="line">&gt;&gt;&gt; num</span><br><span class="line">1000000</span><br><span class="line">1_000_000</span><br></pre></td></tr></table></figure><h3 id="å‚è€ƒæ¥æº"><a href="#å‚è€ƒæ¥æº" class="headerlink" title="å‚è€ƒæ¥æº"></a>å‚è€ƒæ¥æº</h3><ol><li><a href="https://pep8.org/#descriptive-naming-styles">PEP 8 â€“ Descriptive: Naming Styles</a></li><li><a href="https://www.pythonsheets.com/notes/python-basic.html#python-naming-rule">Python basic cheatsheet</a></li><li><a href="https://dbader.org/blog/meaning-of-underscores-in-python">The Meaning of Underscores in Python â€“ dbader.org</a></li><li><a href="https://www.zhihu.com/question/268940585/answer/344852737">Python ä¸­çš„ä¸‹åˆ’çº¿_æœ‰å¤šå°‘ä¸ªæ„æ€ï¼Ÿ- çŸ¥ä¹</a></li><li><a href="https://www.zhihu.com/question/19754941">Python çš„ç±»çš„ä¸‹åˆ’çº¿å‘½åæœ‰ä»€ä¹ˆä¸åŒï¼Ÿ - çŸ¥ä¹</a></li></ol><h2 id="æ´¾æ£®å¤šä¸€ç‚¹"><a href="#æ´¾æ£®å¤šä¸€ç‚¹" class="headerlink" title="æ´¾æ£®å¤šä¸€ç‚¹"></a>æ´¾æ£®å¤šä¸€ç‚¹</h2><p><code>Python</code>ä¸­çš„<code>dunder</code></p><p>å‚è§<a href="https://nedbatchelder.com/blog/200605/dunder.html">è¿™é‡Œ</a></p><blockquote><p>å…³äº<code>Python</code> ç¼–ç¨‹çš„ä¸€ä¸ªå°´å°¬çš„äº‹æƒ…æ˜¯ï¼šæœ‰å¾ˆå¤šç§åŒä¸‹åˆ’çº¿ã€‚ ä¾‹å¦‚ï¼Œè¯­æ³•ç³–ä¸‹é¢çš„æ ‡å‡†æ–¹æ³•åç§°å…·æœ‰ <code>__getattr__</code> è¿™æ ·çš„åç§°ï¼Œæ„é€ å‡½æ•°æ˜¯ <code>__init__</code> ï¼Œå†…ç½®è¿ç®—ç¬¦å¯ä»¥ç”¨ <code>__add__</code> é‡è½½ï¼Œç­‰ç­‰ã€‚ åœ¨ <code>Django</code> æ¡†æ¶ä¸­ï¼ˆè‡³å°‘åœ¨ä»–ä»¬æ•´åˆäº† <code>magic-removal</code> åˆ†æ”¯ä¹‹å‰ï¼‰ï¼Œå¯¹è±¡å…³ç³»æ˜ å°„å™¨ä½¿ç”¨äº†åä¸º <code>user__id__exact</code> çš„å…³é”®å­—å‚æ•°ã€‚<br>åŒä¸‹åˆ’çº¿çš„é—®é¢˜æ˜¯å¾ˆéš¾å‘åˆ«äººæè¿°ã€‚ ä½ æ€ä¹ˆè¯» <code>__init__</code> ï¼Ÿ â€œä¸‹åˆ’çº¿ä¸‹åˆ’çº¿ <code>init</code> ä¸‹åˆ’çº¿ä¸‹åˆ’çº¿â€ï¼Ÿ â€œåŒä¸‹åˆ’çº¿ <code>init</code> åŒä¸‹åˆ’çº¿â€ï¼Ÿ ç®€å•çš„ â€œ<code>init</code>â€ ä¼¼ä¹æ¼æ‰äº†ä¸€äº›é‡è¦çš„ä¸œè¥¿ã€‚<br>æˆ‘æœ‰ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼šåŒä¸‹åˆ’çº¿åº”è¯¥å‘éŸ³ä¸º â€œ<code>dunder</code>â€ ã€‚ æ‰€ä»¥ <code>__init__</code> å¿µæˆâ€œ<code>dunder init dunder</code>â€ï¼Œæˆ–è€…ä¹Ÿå¯ä»¥ç®€è¯»ä¸º â€œ<code>dunder init</code>â€ ã€‚<br>ç°åœ¨æˆ‘æœŸå¾…æŸä¸ªäººå®šä¹‰ä¸€ä¸‹ â€œ<code>dunderhead</code>â€ æ˜¯ä»€ä¹ˆæ„æ€ï¼Œhahaâ€¦â€¦</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æµ…æ Python ä¸­çš„å»¶è¿Ÿç»‘å®šé—®é¢˜</title>
      <link href="blog/2018-04-10/late-binding-of-Python/"/>
      <url>blog/2018-04-10/late-binding-of-Python/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><p><code>Python</code> ä½¿ç”¨ä¸­ä¸€ä¸ªå¸¸è§çš„å›°æƒ‘æ˜¯ <code>Python</code> åœ¨é—­åŒ…(æˆ–åœ¨å‘¨å›´å…¨å±€ä½œç”¨åŸŸï¼ˆ<code>surrounding global scope</code>ï¼‰)ä¸­ç»‘å®šå˜é‡çš„æ–¹å¼ã€‚<br><a id="more"></a><br>ä½ æ‰€å†™çš„å‡½æ•°ï¼š<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">multi_expression</span>():</span></span><br><span class="line">    <span class="keyword">return</span> [<span class="keyword">lambda</span> n: n*i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)]</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    print([multi(<span class="number">10</span>) <span class="keyword">for</span> multi <span class="keyword">in</span> multi_expression()])</span><br></pre></td></tr></table></figure><br>ä½ æ‰€æœŸæœ›çš„æ˜¯ï¼š<br>ä¸€ä¸ªåŒ…å« 5 ä¸ªå‡½æ•°è¿”å›å€¼çš„åˆ—è¡¨ï¼Œæ¯ä¸ªå‡½æ•°æœ‰å®ƒä»¬è‡ªå·±çš„å°é—­å˜é‡ <code>i</code> ä¹˜ä»¥å®ƒä»¬çš„å‚æ•°ï¼Œå¾—åˆ°:<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">[<span class="number">0</span>, <span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>]</span><br></pre></td></tr></table></figure><br>è€Œå®é™…è¿”å›ç»“æœæ˜¯ï¼š<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">[<span class="number">40</span>, <span class="number">40</span>, <span class="number">40</span>, <span class="number">40</span>, <span class="number">40</span>]</span><br></pre></td></tr></table></figure><br>åˆ›å»ºäº† 5 ä¸ªå‡½æ•°ï¼Œå®ƒä»¬å…¨éƒ½æ˜¯ <code>4</code> ä¹˜ä»¥ <code>n</code> ã€‚<br><code>Python</code> çš„é—­åŒ…æ˜¯<em>è¿Ÿç»‘å®š</em> ã€‚è¿™æ„å‘³ç€é—­åŒ…ä¸­ç”¨åˆ°çš„å˜é‡çš„å€¼æ˜¯åœ¨å†…éƒ¨å‡½æ•°è¢«è°ƒç”¨æ—¶æŸ¥è¯¢å¾—åˆ°çš„ã€‚<br>åœ¨è¿™é‡Œ, æ¯å½“è°ƒç”¨<em>ä»»ä½•</em>å‡½æ•°è¿”å›æ—¶, <code>i</code> çš„å€¼æ˜¯è°ƒç”¨æ—¶åœ¨å‘¨å›´ä½œç”¨åŸŸï¼ˆ <code>surrounding scope</code>ï¼‰ä¸­æŸ¥è¯¢åˆ°çš„ã€‚è€Œåˆ°é‚£ä¸ªæ—¶å€™ï¼Œå¾ªç¯å·²ç»å®Œæˆï¼Œ <code>i</code> çš„å€¼æœ€ç»ˆå˜æˆ <code>4</code> ã€‚</p><p>å…³äºè¿™ä¸ªé™·é˜±æœ‰ä¸€ä¸ªæ™®éä¸¥é‡çš„è¯¯è§£ï¼Œå®ƒå¾ˆå®¹æ˜“è¢«ç”©é”…ç»™ <code>Python</code> çš„ <a href="http://docs.python.org/reference/expressions.html#lambda">lambda</a>è¡¨è¾¾å¼ã€‚å®é™…ä¸Šï¼Œ <code>lambda</code> è¡¨è¾¾å¼æ˜¯è¢«å†¤æ‰æ»´ã€‚æˆ‘ä»¬å°è¯•æŠŠå®ƒæ”¹å†™æˆæ™®é€šå‡½æ•°ï¼š<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">multi_func</span>():</span></span><br><span class="line">    foo = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">func</span>(<span class="params">n</span>):</span></span><br><span class="line">            <span class="keyword">return</span> n * i</span><br><span class="line">        foo.append(func)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> foo</span><br></pre></td></tr></table></figure></p><h2 id="ä¸ºäº†å®ç°ç›®æ ‡ï¼Œä½ åº”è¯¥è¿™æ ·"><a href="#ä¸ºäº†å®ç°ç›®æ ‡ï¼Œä½ åº”è¯¥è¿™æ ·" class="headerlink" title="ä¸ºäº†å®ç°ç›®æ ‡ï¼Œä½ åº”è¯¥è¿™æ ·"></a>ä¸ºäº†å®ç°ç›®æ ‡ï¼Œä½ åº”è¯¥è¿™æ ·</h2><ol><li><p>æœ€ä¸€èˆ¬çš„è§£å†³æ–¹æ¡ˆå¯ä»¥è¯´æ˜¯æœ‰ç‚¹å–å·§ï¼ˆ <code>hack</code> ï¼‰ã€‚ç”±äº <code>Python</code> æ‹¥æœ‰åœ¨å‰æ–‡æåˆ°çš„ä¸ºå‡½æ•°çš„é»˜è®¤å‚æ•°èµ‹å€¼çš„è¡Œä¸ºï¼ˆå‚è§ <a href="http://docs.python-guide.org/en/latest/writing/gotchas/#default-args">å¯å˜é»˜è®¤å‚æ•°</a> ï¼‰,ä½ å¯ä»¥åƒä¸‹é¢è¿™æ ·åˆ›å»ºä¸€ä¸ªç«‹å³ç»‘å®šå‚æ•°çš„é—­åŒ…ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">multi_expression_hack</span>():</span></span><br><span class="line">    <span class="keyword">return</span> [<span class="keyword">lambda</span> n, i=i: n * i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)]     <span class="comment"># æ­¤å¤„ç”¨æ³•å‚è§ã€ŠPython Cookbookã€‹7.7 åŒ¿åå‡½æ•°æ•è·å˜é‡å€¼</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    print([func(<span class="number">10</span>) <span class="keyword">for</span> func <span class="keyword">in</span> multi_expression_hack()])</span><br><span class="line"> ```plain</span><br><span class="line"> æ­¤å¤„ä¼šåœ¨å‡½æ•°å†…éƒ¨å†æ¬¡å®šä¹‰ä¸€ä¸ªå±€éƒ¨å˜é‡ã€‚</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span> æˆ–è€…ï¼Œä½ å¯ä»¥ä½¿ç”¨ `functools.partial` å‡½æ•°ï¼ˆåå‡½æ•°ï¼‰ï¼š</span><br><span class="line"></span><br><span class="line"> ```python</span><br><span class="line">    <span class="keyword">from</span> functools <span class="keyword">import</span> partial</span><br><span class="line">    <span class="keyword">from</span> operator <span class="keyword">import</span> mul</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">partial_func</span>():</span></span><br><span class="line">        <span class="keyword">return</span> [partial(mul, i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">        print([func(<span class="number">10</span>) <span class="keyword">for</span> func <span class="keyword">in</span> partial_func()])</span><br></pre></td></tr></table></figure></li><li><p>ä¼˜é›…çš„å†™æ³•ï¼Œç›´æ¥ç”¨ç”Ÿæˆå™¨è¡¨è¾¾å¼ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_expression</span>():</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">lambda</span> n: n * i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    print([gen(<span class="number">10</span>) <span class="keyword">for</span> gen <span class="keyword">in</span> gen_expression()])</span><br><span class="line"> ```plain</span><br><span class="line"></span><br><span class="line"><span class="number">4.</span> åˆ©ç”¨ `<span class="keyword">yield</span>` çš„æƒ°æ€§æ±‚å€¼æ€æƒ³ç¼–å†™ç”Ÿæˆå™¨å‡½æ•°ï¼š</span><br><span class="line"></span><br><span class="line"> ```python</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_func</span>():</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        <span class="keyword">yield</span> <span class="keyword">lambda</span> n: i * n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    print([gen(<span class="number">10</span>) <span class="keyword">for</span> gen <span class="keyword">in</span> gen_func()])</span><br></pre></td></tr></table></figure><h2 id="å½“é™·é˜±ä¸æ˜¯ä¸€ä¸ªé™·é˜±"><a href="#å½“é™·é˜±ä¸æ˜¯ä¸€ä¸ªé™·é˜±" class="headerlink" title="å½“é™·é˜±ä¸æ˜¯ä¸€ä¸ªé™·é˜±"></a>å½“é™·é˜±ä¸æ˜¯ä¸€ä¸ªé™·é˜±</h2></li></ol><p>æœ‰æ—¶, ä½ é¢„æœŸé—­åŒ…æ˜¯è¿™æ ·çš„ï¼ˆè¿Ÿç»‘å®šçš„è¡¨ç°å½¢å¼ï¼‰ã€‚å»¶è¿Ÿç»‘å®šåœ¨å¤šæ•°æƒ…å†µä¸‹æ˜¯æ­£å¸¸çš„ã€‚ä¸å¹¸çš„æ˜¯, å¾ªç¯åˆ›å»ºç‹¬ç‰¹çš„å‡½æ•°å¯èƒ½ä¼šå¯¼è‡´æœªçŸ¥çš„å°é—®é¢˜ã€‚</p><h2 id="æ´¾æ£®å¤šä¸€ç‚¹"><a href="#æ´¾æ£®å¤šä¸€ç‚¹" class="headerlink" title="æ´¾æ£®å¤šä¸€ç‚¹"></a>æ´¾æ£®å¤šä¸€ç‚¹</h2><p>å…³äºç”Ÿæˆå™¨çš„æƒ°æ€§æ±‚å€¼ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸ªä¾‹å­ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">a, b</span>):</span>      <span class="comment"># â‘ </span></span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen</span>(<span class="params">n</span>):</span>     <span class="comment"># â‘¡</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        <span class="keyword">yield</span> i</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>(<span class="params">m_num, m_gen_num</span>):</span></span><br><span class="line">    base = gen(m_gen_num)</span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(m_num):              <span class="comment"># â‘¢</span></span><br><span class="line">        base = (add(i, n) <span class="keyword">for</span> i <span class="keyword">in</span> base)</span><br><span class="line">    <span class="keyword">return</span> base</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    num = <span class="number">10</span></span><br><span class="line">    gen_num = <span class="number">3</span></span><br><span class="line">    print(<span class="built_in">list</span>(main(num, gen_num)))</span><br></pre></td></tr></table></figure><p>è¿”å›ç»“æœï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">[<span class="number">90</span>, <span class="number">91</span>, <span class="number">92</span>]</span><br></pre></td></tr></table></figure><h3 id="è§£é‡Š"><a href="#è§£é‡Š" class="headerlink" title="è§£é‡Š"></a>è§£é‡Š</h3><p>çœ‹æ‡‚è¿™ä¸ªå‡½æ•°çš„å…³é”®æ˜¯çœ‹æ‡‚ for å¾ªç¯ä¸­çš„<code>base = (add(i, n) for i in base)</code>è¡¨è¾¾å¼ï¼Œå…¶ä¸­ add çš„æ±‚å’Œè¿ç®—æ˜¯å’Œ<code>for i in base</code>ç”Ÿæˆå™¨ä¸­çš„å…ƒç´ ï¼ˆ0,1,2ï¼‰è¿›è¡Œçš„ï¼Œ<strong>è€Œ n åœ¨æœ€ç»ˆè¿ç®—æ—¶å®é™…ä¸Šæ¯æ¬¡éƒ½æ˜¯ 9</strong>ã€‚æ‰€ä»¥æœ€ç»ˆæ±‚å€¼æ—¶ç›¸å½“äº 9 å’Œ <code>gen()</code> æ±‚å’Œä¹‹åå†è‡ªå·±è¿ç»­ç´¯åŠ  10 æ¬¡ï¼Œæœ€ç»ˆå¾—åˆ°å€¼ä¸ºï¼ˆ90,91,92ï¼‰çš„ç”Ÿæˆå™¨ï¼Œè€Œ list å°±å¾ˆç®€å•äº†ï¼Œåªæ˜¯ä¸€ä¸ªç®€å•çš„å°†ç”Ÿæˆå™¨è½¬æ¢ä¸ºåˆ—è¡¨çš„æ“ä½œã€‚</p><p>æ³¨æ„ï¼šæ­¤å¤„ä»£ç ä¸è®°å¾—åœ¨å“ªé‡Œçœ‹çš„åŸæ–‡äº†ï¼Œæ—¶éš”ä¸¤å¹´å†å»çœ‹å±…ç„¶çœ‹ä¸æ‡‚äº†ã€‚ğŸ¤•å¦‚æœè¯»äº†ä¸Šé¢çœ‹ä¸æ‡‚çš„è¯å¯ä»¥å‚è€ƒæ­¤å¤„ ğŸ‘‰ <a href="https://segmentfault.com/a/1190000004554823">python è¿­ä»£å™¨ä¸ç”Ÿæˆå™¨å°ç»“ - shomy - SegmentFault æ€å¦</a></p><p>å¦‚æœæˆ‘ä»¬å¯¹ä¹‹å‰æ”¹å†™çš„<code>multi_func()</code>å‡½æ•°å†ç¨å¾®æ”¹å†™ä¸€ä¸‹ï¼Œè®©å†…éƒ¨å‡½æ•°ä¼ å€¼<code>*args</code>ä¼šæ€ä¹ˆæ ·ï¼Ÿ</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">multi_func_starred</span>():</span></span><br><span class="line">    foo = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">func</span>(<span class="params">*n</span>):</span></span><br><span class="line">            <span class="keyword">return</span> n * i</span><br><span class="line">        foo.append(func)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> foo</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    print([func(<span class="number">10</span>) <span class="keyword">for</span> func <span class="keyword">in</span> multi_func_starred()])</span><br></pre></td></tr></table></figure><p>è¿”å›ç»“æœï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[(10, 10, 10, 10), (10, 10, 10, 10), (10, 10, 10, 10), (10, 10, 10, 10), (10, 10, 10, 10)]</span><br></pre></td></tr></table></figure><p>å®é™…ä¸Šï¼Œ<code>*args</code>ç›¸å½“äºä¸€ä¸ªç”Ÿæˆå™¨è¡¨è¾¾å¼ï¼Œè¿™ç‚¹å¾ˆå®¹æ˜“éªŒè¯ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">multi_expression_starred</span>():</span></span><br><span class="line">    <span class="comment"># print(type(lambda *n: n*i for i in range(5)))     # æ³¨é‡Šè¡Œæ‰“å° &gt;&gt;&gt;: &lt;class &#x27;generator&#x27;&gt;</span></span><br><span class="line">    <span class="keyword">return</span> [<span class="keyword">lambda</span> *n: n * i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    print([func(<span class="number">10</span>) <span class="keyword">for</span> func <span class="keyword">in</span> multi_expression_starred()])</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> å»¶è¿Ÿç»‘å®š </tag>
            
            <tag> ç”Ÿæˆå™¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python ç¯å¢ƒç®¡ç†ä»‹ç»</title>
      <link href="blog/2018-01-18/python-env-introduce/"/>
      <url>blog/2018-01-18/python-env-introduce/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><p>é¡¹ç›®å¼€å‘ä¸­å¯èƒ½éœ€è¦ç”¨åˆ°ä¸åŒç‰ˆæœ¬çš„<code>Python</code>åŠç›¸å…³çš„å¼€å‘ç¯å¢ƒã€‚æ¯”å¦‚<code>Python2</code>åŠ<code>Python3</code>ï¼Œæˆ–è€…æœ‰çš„é¡¹ç›®éœ€è¦ <code>Django1.5</code> ï¼Œæœ‰çš„éœ€è¦<code>2.0</code>ï¼Œè¿™ä¸ªæ—¶å€™å€ŸåŠ©ä¸€äº›å·¥å…·ï¼Œå¾€å¾€å¯ä»¥è¾¾åˆ°äº‹åŠåŠŸå€çš„æ•ˆæœã€‚</p><p><img src= "/img/loading.svg" data-lazy-src="https://farm5.staticflickr.com/4290/35294660055_42c02b2316_k_d.jpg" alt="Python"></p><h2 id="ä¸ªäººæ­é…"><a href="#ä¸ªäººæ­é…" class="headerlink" title="ä¸ªäººæ­é…"></a>ä¸ªäººæ­é…</h2><p>æ—¢ç„¶åˆ«äººéƒ½è¯´ä¸å¤Ÿç†æƒ³ï¼Œé‚£å°±æš‚æ—¶å¤„äºè§‚æœ›é˜¶æ®µå§ã€‚ç›®å‰ä¸ªäººåœ¨ç”¨çš„ Python è™šæ‹Ÿç¯å¢ƒå’ŒåŒ…ç®¡ç†ç»„åˆï¼š<br>è™šæ‹Ÿç¯å¢ƒç®¡ç†ï¼švenv<br>åŒ…ç®¡ç†ï¼špip</p><h3 id="å·¥ä½œæµ"><a href="#å·¥ä½œæµ" class="headerlink" title="å·¥ä½œæµ"></a>å·¥ä½œæµ</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">python3 -m venv venvX    # ä½¿ç”¨ venv åˆ›å»ºåä¸º venvXï¼ˆå¯è‡ªå®šä¹‰ï¼‰ çš„è™šæ‹Ÿç¯å¢ƒ</span><br><span class="line">source venvX/bin/activate    # æ¿€æ´»è™šæ‹Ÿç¯å¢ƒvenvXï¼ˆä¸Šä¸€æ­¥è‡ªå®šä¹‰è™šæ‹Ÿç¯å¢ƒåç§°ï¼‰</span><br><span class="line">pip install -r requirements.txt # ä½¿ç”¨pipå®‰è£…ä¾èµ–</span><br></pre></td></tr></table></figure><h3 id="å€¼å¾—å…³æ³¨çš„"><a href="#å€¼å¾—å…³æ³¨çš„" class="headerlink" title="å€¼å¾—å…³æ³¨çš„"></a>å€¼å¾—å…³æ³¨çš„</h3><ul><li><a href="https://www.python.org/dev/peps/pep-0582/">PEP 582 â€“ Python local packages directory | Python.org</a></li><li><a href="https://asciinema.org/a/303535">pdm 0.2.4 live demo - asciinema</a></li></ul><div class="note info no-icon modern"><h2 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="@æ›´æ–°"></a>@æ›´æ–°</h2><ul><li>2020-1-8<br>ä»Šå¤©çœ‹åˆ°ä¸€ç¯‡æ–‡ç«  <a href="https://frostming.com/2019/09-01/pipenv-problems">Pipenv æœ‰ä»€ä¹ˆé—®é¢˜</a>ï¼Œä½œè€…æ˜¯<code>Pipenv</code>çš„æ ¸å¿ƒå¼€å‘è€…ï¼Œä¹Ÿå¯¹<code>Poetry</code>åšäº†ä¸€ç‚¹ä»‹ç»ï¼ŒåŒæ—¶åœ¨ <a href="https://github.com/pypa/pipenv/issues/4058">è¿™é‡Œ</a> çœ‹åˆ°å¯¹<code>pipenv</code>é¡¹ç›®è¿›åº¦çš„è¯¢é—®ä¸å¼€å‘è€…çš„å›åº”ï¼Œæœ‰å…´è¶£çš„å¯ä»¥ä¸€è¯»ã€‚</li></ul></div><hr><h2 id="ç¬¬ä¸‰æ–¹åº“"><a href="#ç¬¬ä¸‰æ–¹åº“" class="headerlink" title="ç¬¬ä¸‰æ–¹åº“"></a>ç¬¬ä¸‰æ–¹åº“</h2><h3 id="virtualenv"><a href="#virtualenv" class="headerlink" title="virtualenv"></a>virtualenv</h3><p><code>virtualenv</code>æ˜¯ä¸€ä¸ªéå¸¸æµè¡Œçš„å·¥å…·ï¼Œä¸º<code>Python</code>åº“åˆ›å»ºç‹¬ç«‹çš„<code>Python</code>ç¯å¢ƒã€‚å¦‚æœä½ ä¸ç†Ÿæ‚‰è¿™ä¸ªå·¥å…·ï¼Œæˆ‘å¼ºçƒˆå»ºè®®ä½ å­¦ä¹ å®ƒï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å·¥å…·ï¼Œæˆ‘å°†åœ¨è¿™ä¸ªç­”æ¡ˆçš„å…¶ä½™éƒ¨åˆ†å¯¹æ­¤è¿›è¡Œæ¯”è¾ƒã€‚</p><p>å®ƒé€šè¿‡åœ¨ä¸€ä¸ªç›®å½•ï¼ˆä¾‹å¦‚ï¼š<code>env/</code>ï¼‰ä¸­å®‰è£…ä¸€å †æ–‡ä»¶ï¼Œç„¶åä¿®æ”¹<code>PATH</code>ç¯å¢ƒå˜é‡æ¥ä¸ºè‡ªå®šä¹‰<code>bin</code>ç›®å½•ï¼ˆä¾‹å¦‚ï¼š<code>env/bin/</code>ï¼‰æ·»åŠ å‰ç¼€ã€‚ <code>python</code>æˆ–<code>python3</code>äºŒè¿›åˆ¶æ–‡ä»¶çš„ç²¾ç¡®æ‹·è´ä¼šè¢«æ”¾ç½®åœ¨è¿™ä¸ªç›®å½•ä¸­ï¼Œä½†<code>Python</code>è¢«ç¼–ç¨‹ä¸ºé¦–å…ˆåœ¨ç¯å¢ƒç›®å½•ä¸­æŸ¥æ‰¾ç›¸å¯¹äºå…¶è·¯å¾„çš„åº“ã€‚å®ƒä¸æ˜¯<code>Python</code>æ ‡å‡†åº“çš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯è·å¾—<code>PyPA</code>ï¼ˆPython Packaging Authorityï¼‰æ­£å¼ç§°èµã€‚æ¿€æ´»ä¹‹åï¼Œä½ å°±å¯ä»¥ä½¿ç”¨<code>pip</code>åœ¨è™šæ‹Ÿç¯å¢ƒä¸­å®‰è£…è½¯ä»¶åŒ…ã€‚</p><h4 id="virtualenvwrapper"><a href="#virtualenvwrapper" class="headerlink" title="virtualenvwrapper"></a>virtualenvwrapper</h4><p><code>virtualenvwrapper</code>æ˜¯<code>virtualenv</code>çš„ä¸€ç»„æ‰©å±•ï¼ˆå‚è§<a href="http://virtualenvwrapper.readthedocs.io/en/latest/">æ–‡æ¡£</a>ï¼‰ã€‚å®ƒæä¾›ä¾‹å¦‚<code>mkvirtualenv</code>ã€<code>lssitepackages</code>è¿™æ ·çš„å‘½ä»¤ï¼Œç‰¹åˆ«æ˜¯<code>workon</code>å‘½ä»¤ï¼Œå®ƒå¯ä»¥åœ¨ä¸åŒçš„<code>virtualenv</code>ç›®å½•ä¹‹é—´åˆ‡æ¢ã€‚å¦‚æœä½ æƒ³è¦å¤šä¸ª<code>virtualenv</code>ç›®å½•ï¼Œè¿™ä¸ªå·¥å…·ç‰¹åˆ«æœ‰ç”¨ã€‚</p><h3 id="pyenv"><a href="#pyenv" class="headerlink" title="pyenv"></a>pyenv</h3><p><code>pyenv</code>æ˜¯<code>Python</code>çš„<strong>ç‰ˆæœ¬</strong>ç®¡ç†å™¨,ç”¨äºéš”ç¦»<code>Python</code>ç‰ˆæœ¬ã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½æƒ³è¦é’ˆå¯¹<code>Python 2.6</code>,<code>2.7</code>,<code>3.3</code>,<code>3.4</code>å’Œ<code>3.5</code>æµ‹è¯•ä½ çš„ä»£ç ï¼Œå› æ­¤ä½ éœ€è¦åœ¨ä¸åŒ<code>Python</code>ç‰ˆæœ¬ä¹‹é—´è¿›è¡Œåˆ‡æ¢ã€‚ä¸€æ—¦æ¿€æ´»ï¼Œå®ƒå°±ä¼šåœ¨<code>PATH</code>ç¯å¢ƒå˜é‡å‰åŠ ä¸Š<code>~/.pyenv/shims</code>ï¼Œå…¶ä¸­æœ‰ä¸€äº›ä¸<code>Python</code>å‘½ä»¤ï¼ˆ<code>python</code>ï¼Œ<code>pip</code>ï¼‰åŒ¹é…çš„ç‰¹æ®Šæ–‡ä»¶ã€‚è¿™äº›ä¸æ˜¯<code>Python</code>æä¾›çš„å‘½ä»¤çš„å‰¯æœ¬;å®ƒä»¬æ˜¯æ ¹æ®<code>PYENV_VERSION</code>ç¯å¢ƒå˜é‡æˆ–<code>.python-version</code>æ–‡ä»¶æˆ–<code>~/.pyenv/version</code>æ–‡ä»¶å†³å®šè¿è¡Œå“ªä¸ªç‰ˆæœ¬çš„<code>Python</code>çš„ç‰¹æ®Šè„šæœ¬ã€‚ <code>pyenv</code>ä¹Ÿä½¿ä¸‹è½½å’Œå®‰è£…å¤šä¸ª<code>Python</code>ç‰ˆæœ¬çš„è¿‡ç¨‹å˜å¾—æ›´ç®€å•ï¼Œä½¿ç”¨å‘½ä»¤<code>pyenv install</code>å³å¯ã€‚</p><h4 id="pyenv-virtualenv"><a href="#pyenv-virtualenv" class="headerlink" title="pyenv-virtualenv"></a>pyenv-virtualenv</h4><p><code>pyenv-virtualenv</code>æ˜¯<code>pyenv</code>çš„ä¸€ä¸ªæ’ä»¶ï¼Œå’Œ<code>pyenv</code>ä¸€æ ·ï¼Œå…è®¸ä½ åœ¨åŒä¸€æ—¶é—´æ–¹ä¾¿åœ°ä½¿ç”¨<code>pyenv</code>å’Œ<code>virtualenv</code>ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ ä½¿ç”¨<code>Python 3.3</code>æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œåˆ™<code>pyenv-virtualenv</code>ä¼šå°è¯•è¿è¡Œ<code>python -m venv</code>ï¼ˆå¦‚æœå¯ç”¨ï¼‰ï¼Œè€Œä¸æ˜¯<code>virtualenv</code>ã€‚å¦‚æœä½ ä¸æƒ³ä½¿ç”¨ä¾¿åˆ©åŠŸèƒ½ï¼Œåˆ™å¯ä»¥æ­é…ä½¿ç”¨<code>virtualenv</code>å’Œ<code>pyenv</code>è€Œä¸ä½¿ç”¨<code>pyenv-virtualenv</code>ã€‚</p><h4 id="pyenv-virtualenvwrapper"><a href="#pyenv-virtualenvwrapper" class="headerlink" title="pyenv-virtualenvwrapper"></a>pyenv-virtualenvwrapper</h4><p><code>pyenv-virtualenvwrapper</code>æ˜¯<code>pyenv</code>çš„ä¸€ä¸ªæ’ä»¶ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿åœ°å°†<code>virtualenvwrapper</code>é›†æˆåˆ°<code>pyenv</code>ä¸­ã€‚</p><h3 id="pipenv"><a href="#pipenv" class="headerlink" title="pipenv"></a>pipenv</h3><p><code>pipenv</code>æ˜¯<code>Python</code>çš„<strong>åŒ…</strong>ç®¡ç†å™¨ã€‚ç”±<code>Kennetth Reitz</code>ï¼ˆ<code>requests</code>çš„ä½œè€…ï¼‰ç¼–å†™ç»´æŠ¤ï¼Œæ˜¯æˆ‘ä»¬ä¸Šé¢æåˆ°çš„è¿™äº›é¡¹ç›®é‡Œé¢æœ€æ–°çš„ã€‚å®ƒçš„ç›®æ ‡æ˜¯åœ¨å‘½ä»¤è¡Œä¸­å°†<code>Pipfile</code>ã€<code>pip</code>å’Œ<code>virtualenv</code>åˆå¹¶ä¸ºä¸€ä¸ªå‘½ä»¤ã€‚</p><h2 id="æ ‡å‡†åº“"><a href="#æ ‡å‡†åº“" class="headerlink" title="æ ‡å‡†åº“"></a>æ ‡å‡†åº“</h2><h3 id="pyvenv"><a href="#pyvenv" class="headerlink" title="pyvenv"></a>pyvenv</h3><p><code>pyvenv</code>æ˜¯ä¸€ä¸ª<code>Python 3</code>é™„å¸¦çš„è„šæœ¬ï¼Œä½†åœ¨<strong>Python 3.6 ä¸­è¢«å¼ƒç”¨</strong>ï¼Œï¼ˆå‚è§<a href="https://docs.python.org/dev/whatsnew/3.6.html#id8">è¿™é‡Œ</a>ï¼‰å› ä¸ºå®ƒæœ‰é—®é¢˜ï¼ˆæš‚ä¸”ä¸è¯´åå­—è¿˜å®¹æ˜“é€ æˆæ··æ·†ï¼‰ã€‚åœ¨<code>Python 3.6+</code>ä¸­ï¼Œå®é™…ä¸Šç­‰ä»·äºå‘½ä»¤<code>python3 -m venv</code>ã€‚</p><h3 id="venv"><a href="#venv" class="headerlink" title="venv"></a>venv</h3><p><code>venv</code>æ˜¯<code>Python 3</code>é™„å¸¦çš„ä¸€ä¸ªåŒ…ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>python3 -m venv</code>è¿è¡Œï¼ˆè™½ç„¶ç”±äºæŸäº›åŸå› ï¼Œä¸€äº›å‘è¡Œç‰ˆæŠŠå®ƒåˆ†ç¦»æˆä¸€ä¸ªå•ç‹¬çš„å‘è¡ŒåŒ…ï¼Œæ¯”å¦‚<code>Ubuntu / Debian</code>ä¸Šçš„<code>python3-venv</code>ï¼‰ã€‚å®ƒçš„ä½œç”¨ä¸<code>virtualenv</code> ç›¸ä¼¼ï¼Œå·¥ä½œæ–¹å¼ä¹Ÿéå¸¸ç›¸ä¼¼ï¼Œä½†ä¸éœ€è¦å¤åˆ¶<code>Python</code>äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆ<code>Windows</code>ä¸‹é™¤å¤–ï¼‰ã€‚å¦‚æœä½ çš„ä»£ç ä¸éœ€è¦æ”¯æŒ<code>Python 2</code>ï¼Œå¯ä»¥ä½¿ç”¨å®ƒã€‚åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼Œ<code>Python</code>ç¤¾åŒºä¼¼ä¹å¯¹<code>virtualenv</code>æ„Ÿåˆ°æ»¡æ„ï¼Œ<code>venv</code>ç›¸å¯¹æ¥è¯´æ¯”è¾ƒå°ä¼—ã€‚</p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><ol><li><a href="https://stackoverflow.com/questions/41573587/what-is-the-difference-between-venv-pyvenv-pyenv-virtualenv-virtualenvwrappe">Python - What is the difference between venv, pyvenv, pyenv, virtualenv, virtualenvwrapper, pipenv, etc? - Stack Overflow</a></li><li><a href="http://docs.python-guide.org/en/latest/dev/virtualenvs/">Pipenv &amp; Virtual Environments â€” The Hitchhikerâ€™s Guide to Python</a></li><li><a href="https://frostming.com/2019/11-18/python-setup">æˆ‘çš„ Python ç¯å¢ƒè®¾ç½®</a></li><li><a href="http://greyli.com/slides/pyconchina2019-venv/#/">Python è™šæ‹Ÿç¯å¢ƒå’Œä¾èµ–ç®¡ç†å·¥å…·å¤§ä¹±æ–—</a></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> pyenv </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CentOS7 ç¯å¢ƒä¸‹é…ç½® DRBD</title>
      <link href="blog/2018-01-11/how-to-configure-drbd-on-CentOS7/"/>
      <url>blog/2018-01-11/how-to-configure-drbd-on-CentOS7/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><p>æœ¬æ–‡ä¸»è¦è®°å½•<code>DRBD</code>çš„é…ç½®è¿‡ç¨‹å’ŒåŠŸèƒ½éªŒè¯ã€‚<br><a id="more"></a></p><p>æœ¬æ–‡ä½¿ç”¨<code>64</code>ä½<code>CentOS</code>ï¼ŒåŸºæœ¬ç¯å¢ƒï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">+-----------------------+              |               +----------------------+</span><br><span class="line">| [ DRBD_A (Server#1) ] | 10.10.17.18  |  10.10.17.19  | [DRBD_B (Server#2) ] |</span><br><span class="line">|       node01          +--------------+---------------+         node02       |</span><br><span class="line">|                       |                              |                      |</span><br><span class="line">+-----------------------+                              +----------------------+</span><br><span class="line"></span><br><span class="line">DRBD æœåŠ¡å™¨A ï¼šip:10.10.17.18ï¼Œhostnameï¼šDRBD_A</span><br><span class="line">DRBD æœåŠ¡å™¨B ï¼šip:10.10.17.19ï¼Œhostnameï¼šDRBD_B</span><br></pre></td></tr></table></figure><h2 id="å»ºç«‹ç£ç›˜åˆ†åŒº"><a href="#å»ºç«‹ç£ç›˜åˆ†åŒº" class="headerlink" title="å»ºç«‹ç£ç›˜åˆ†åŒº"></a>å»ºç«‹ç£ç›˜åˆ†åŒº</h2><ul><li>åˆ†åŒºä¹‹å‰</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@DRBD_A ~]# lsblk      # æŸ¥è¯¢å—è®¾å¤‡ä¿¡æ¯</span><br><span class="line">NAME                  MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT</span><br><span class="line">fd0                     2:0    1    4K  0 disk</span><br><span class="line">sda                     8:0    0   16G  0 disk</span><br><span class="line">â”œâ”€sda1                  8:1    0  500M  0 part /boot</span><br><span class="line">â””â”€sda2                  8:2    0 15.5G  0 part</span><br><span class="line">  â”œâ”€centos_bogon-root 253:0    0 13.9G  0 lvm  /</span><br><span class="line">  â””â”€centos_bogon-swap 253:1    0  1.6G  0 lvm  [SWAP]</span><br><span class="line">sdb                     8:16   0    5G  0 disk</span><br><span class="line">â””â”€StorPool-SANLun10   253:2    0    2G  0 lvm</span><br><span class="line">sr0                    11:0    1 1024M  0 rom</span><br><span class="line">drbd0                 147:0    0    2G  1 disk</span><br></pre></td></tr></table></figure><ul><li>è¿›è¡Œåˆ†åŒº</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@DRBD_A ~]# fdisk /dev/sdb     # åœ¨sdbä¸Šæ–°å»ºåˆ†åŒº</span><br><span class="line">Welcome to fdisk (util-linux 2.23.2).</span><br><span class="line"></span><br><span class="line">Changes will remain in memory only, until you decide to write them.</span><br><span class="line">Be careful before using the write command.</span><br><span class="line"></span><br><span class="line">Device does not contain a recognized partition table</span><br><span class="line">Building a new DOS disklabel with disk identifier 0xb25d5d26.</span><br><span class="line"></span><br><span class="line">Command (m for help): n         #  æ–°å»º</span><br><span class="line">Partition type:</span><br><span class="line">   p   primary (0 primary, 0 extended, 4 free)</span><br><span class="line">   e   extended</span><br><span class="line">Select (default p):</span><br><span class="line">Using default response p</span><br><span class="line">Partition number (1-4, default 1):</span><br><span class="line">First sector (2048-10485759, default 2048):</span><br><span class="line">Using default value 2048</span><br><span class="line">Last sector, +sectors or +size&#123;K,M,G&#125; (2048-10485759, default 10485759): +1G</span><br><span class="line">Partition 1 of type Linux and of size 1 GiB is set</span><br><span class="line"></span><br><span class="line">Command (m for help): w         #  å†™å…¥</span><br><span class="line">The partition table has been altered!</span><br><span class="line"></span><br><span class="line">Calling ioctl() to re-read partition table.</span><br><span class="line">Syncing disks.</span><br></pre></td></tr></table></figure><ul><li>åˆ†åŒºä¹‹å</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@DRBD_A ~]# lsblk</span><br><span class="line">NAME                  MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT</span><br><span class="line">fd0                     2:0    1    4K  0 disk</span><br><span class="line">sda                     8:0    0   16G  0 disk</span><br><span class="line">â”œâ”€sda1                  8:1    0  500M  0 part /boot</span><br><span class="line">â””â”€sda2                  8:2    0 15.5G  0 part</span><br><span class="line">  â”œâ”€centos_bogon-root 253:0    0 13.9G  0 lvm  /</span><br><span class="line">  â””â”€centos_bogon-swap 253:1    0  1.6G  0 lvm  [SWAP]</span><br><span class="line">sdb                     8:16   0    5G  0 disk</span><br><span class="line">â”œâ”€sdb1                  8:17   0    1G  0 part      # æ–°åˆ†åŒº</span><br><span class="line">â””â”€StorPool-SANLun10   253:2    0    2G  0 lvm</span><br><span class="line">sr0                    11:0    1 1024M  0 rom</span><br><span class="line">drbd0                 147:0    0    2G  0 disk /media</span><br></pre></td></tr></table></figure><h2 id="ä¿®æ”¹é…ç½®æ–‡ä»¶"><a href="#ä¿®æ”¹é…ç½®æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹é…ç½®æ–‡ä»¶"></a>ä¿®æ”¹é…ç½®æ–‡ä»¶</h2><h3 id="æ›´æ”¹-DRBD-å…¨å±€é…ç½®"><a href="#æ›´æ”¹-DRBD-å…¨å±€é…ç½®" class="headerlink" title="æ›´æ”¹ DRBD å…¨å±€é…ç½®"></a>æ›´æ”¹ DRBD å…¨å±€é…ç½®</h3><p>é¦–å…ˆæ ¹æ®éœ€æ±‚æ›´æ”¹<code>DRBD</code>å…¨å±€é…ç½®<code>/etc/drbd.d/global_common.conf</code>:</p><p>æ­¤å¤„å¯å‚é˜…å¦ä¸€ç¯‡æ–‡ç« ï¼š<a href="/blog/2017-09-11/Record_of_drbd/#global-common-confé…ç½®ï¼ˆç¤ºä¾‹ï¼‰">DRBD å…¨å±€é…ç½®</a></p><h3 id="åˆ›å»ºDRBDé…ç½®æ–‡ä»¶"><a href="#åˆ›å»ºDRBDé…ç½®æ–‡ä»¶" class="headerlink" title="åˆ›å»ºDRBDé…ç½®æ–‡ä»¶"></a>åˆ›å»º<code>DRBD</code>é…ç½®æ–‡ä»¶</h3><p>ç”±äº<code>DRBD</code>æ˜¯åŸºäºå—è®¾å¤‡çš„å­˜å‚¨å¤åˆ¶è§£å†³æ–¹æ¡ˆï¼Œæ‰€ä»¥æ­¤å¤„ä½¿ç”¨<code>Lun</code>ä½œä¸ºæ¼”ç¤ºã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">vi r0.res</span><br><span class="line">resource r0 &#123;</span><br><span class="line">    # DRBD device</span><br><span class="line">    device /dev/drbd0;</span><br><span class="line">    # block device</span><br><span class="line">    disk /dev/StorPool/SANLun10;    # ç£ç›˜è·¯å¾„ï¼Œè‹¥ä¸ºdiskåˆ™ä¿®æ”¹ä¸º/dev/sdb1</span><br><span class="line">    meta-disk internal;</span><br><span class="line">    on DRBD_A &#123;</span><br><span class="line">        # IP address:port</span><br><span class="line">        address 10.10.17.18:7788;</span><br><span class="line">    &#125;</span><br><span class="line">    on DRBD_B &#123;</span><br><span class="line">        address 10.10.17.19:7788;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>æ³¨æ„ï¼š</code>æœ¬æœºä¸»æœºå(<code>hostname</code>)å’Œåœ°å€(<code>ip</code>)å¿…é¡»ä¸¥æ ¼æŒ‰ç…§çœŸå®æƒ…å†µé…ç½®ï¼Œä¸¤è¾¹<code>.res</code>æ–‡ä»¶å†…å®¹å°½é‡ä¿æŒä¸€è‡´ã€‚</p><p>é…ç½®æ–‡ä»¶åˆ›å»ºå®Œæˆä¹‹åï¼Œåœ¨ä¸¤ä¸ªæœåŠ¡å™¨ä¸Šåˆ†åˆ«æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œåˆ›å»º<code>DRBD</code>èµ„æºï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥é€šè¿‡<code>scp</code>æŠŠé…ç½®æ–‡ä»¶æ‹·è¿‡å»ï¼Œç„¶åæ‰§è¡Œç›¸å…³å‘½ä»¤ã€‚</p><p>å…¶ä¸­ä¸Šè¿°é…ç½®æ–‡ä»¶çš„ meta-disk æœ‰ä¸‰ç§è®°å½•æ–¹å¼ï¼šinternal/device/device[index_num]ã€‚å…¶ä¸­ä¸ç®¡æ˜¯å“ªç§æ–¹å¼ï¼Œmetadata å­˜æ”¾çš„åˆ†åŒºä¸èƒ½æ ¼å¼åŒ–ï¼Œå“ªæ€•ä½¿ç”¨ internal æ—¶ metadata å’Œä¸€èˆ¬ data åœ¨åŒä¸€ä¸ªåˆ†åŒºä¹Ÿä¸èƒ½æ ¼å¼åŒ–è¯¥åˆ†åŒºã€‚</p><p>internal æ˜¯å°†å…ƒæ•°æ®ä¹Ÿå†™å…¥åˆ°æ•°æ®åˆ†åŒºçš„å°¾éƒ¨ï¼Œå³æ•°æ®å’Œå…ƒæ•°æ®åŒåˆ†åŒºã€‚å¦‚æœæŒ‡å®šçš„ device æ²¡æœ‰ç»™å®š index æ—¶ï¼Œåˆ™è¡¨ç¤ºå…ƒæ•°æ®å­˜å‚¨åˆ°è¯¥è®¾å¤‡ä¸­ã€‚å¦‚æœæŸèŠ‚ç‚¹æŒ‡å®š device[index_num]ï¼Œé‚£ä¹ˆæŒ‡å®šå‡ æ¬¡å…ƒæ•°æ®åˆ†åŒºç´¢å¼•å°±å¿…é¡»å¤§äº 128M çš„å‡ å€ï¼Œä¾‹å¦‚ä¸Šè¿°æ–‡ä»¶ä¸­ drbd1.longshuai.com èŠ‚ç‚¹æŒ‡å®šäº†/dev/sdb1[0]ï¼Œé‚£ä¹ˆ sdb1 å°±å¿…é¡»å¤§äº 128Mï¼Œå¦‚æœæ­¤æ—¶å…¶ä»–èµ„æºçš„èŠ‚ç‚¹ä¹ŸæŒ‡å®šäº†åŒä¸€å°æœåŠ¡å™¨çš„/dev/sdb1[1]ï¼Œåˆ™æŒ‡å®šäº†ä¸¤æ¬¡å°±å¿…é¡»å¤§äº 256Mã€‚æŒ‡å®šä¸º internal å’Œ device æ—¶ï¼Œå…ƒæ•°æ®åŒºçš„å¤§å°æ˜¯ drbd è‡ªè¡Œè®¡ç®—çš„ã€‚<br>ä¸Šé¢ index çš„è¯´æ³•æ¥è‡ª<a href="http://www.cnblogs.com/f-ck-need-u/p/8678883.html#1-drbd-">è¿™é‡Œ</a>ï¼Œå…·ä½“æ²¡æœ‰å®é™…éªŒè¯ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">drbdadm create-md r0</span><br></pre></td></tr></table></figure><p>ç„¶åå¯åŠ¨ DRBDï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">drbdadm up r0</span><br></pre></td></tr></table></figure><p>æˆ‘åœ¨æµ‹è¯•æ—¶æ²¡æœ‰æ“ä½œä¸‹ä¸€æ­¥æ“ä½œï¼Œä½†æ˜¯æ•°æ®ä¹Ÿå¯ä»¥å®ŒæˆåŒæ­¥ã€‚æŸ¥è¯¢äº†ä¸€ä¸‹ï¼Œç½‘ä¸Šè¯´<code>drbdadm up</code>è¿™ä¸ªå‘½ä»¤ç›¸å½“äº<code>attach</code>ã€<code>syncer</code>ã€<code>connect</code>çš„æ€»é›†åˆã€‚ä½†æ˜¯åå°ä½¿ç”¨<code>systemctl status drbd</code>è·å–åˆ°çš„çŠ¶æ€è¿˜æ˜¯<code>inactive (dead)</code>ï¼Œæ¬¢è¿å¤§å®¶æå‡ºè‡ªå·±çš„çœ‹æ³•ã€‚</p><hr><p>åœ¨ä¸¤ä¸ªæœåŠ¡å™¨ä¸Šåˆ†åˆ«å¯åŠ¨<code>DRBD</code>æœåŠ¡ï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">/etc/init.d/drbd start</span><br></pre></td></tr></table></figure><hr><p>æŠŠ<code>DRBD_A</code>åšä¸ºä¸»æœåŠ¡å™¨ï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æ— æ•°æ®æ—¶</span></span><br><span class="line">drbdadm primary r0</span><br><span class="line"><span class="meta">#</span><span class="bash"> æœ‰æ•°æ®æ—¶ï¼ŒæŠŠæœ¬ç«¯ä½œä¸ºprimaryç«¯ï¼Œæœ¬åœ°æ•°æ®åˆ†å‘åˆ°å…¶ä»–èŠ‚ç‚¹ã€‚</span></span><br><span class="line">drbdadm -- --overwrite-data-of-peer primary r0</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹<code>DRBD</code>æœåŠ¡çš„çŠ¶æ€ä¿¡æ¯ï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">/etc/init.d/drbd status</span><br><span class="line"><span class="meta">#</span><span class="bash">æˆ–è€…</span></span><br><span class="line">drbd-overview</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ï¼Œå†™å…¥<code>DRBD_A</code>ç«¯(<code>/dev/drbd1</code>)çš„æ•°æ®éƒ½ä¼šåŒæ­¥åˆ°<code>DRBD_B</code>ç«¯ã€‚</p><h2 id="æµ‹è¯•æ•°æ®åŒæ­¥"><a href="#æµ‹è¯•æ•°æ®åŒæ­¥" class="headerlink" title="æµ‹è¯•æ•°æ®åŒæ­¥"></a>æµ‹è¯•æ•°æ®åŒæ­¥</h2><h3 id="Primaryç«¯"><a href="#Primaryç«¯" class="headerlink" title="Primaryç«¯"></a><code>Primary</code>ç«¯</h3><ul><li>æ ¼å¼åŒ–<code>drbd</code></li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mkfs.xfs /dev/drbd0</span><br></pre></td></tr></table></figure><ul><li>æŒ‚è½½è®¾å¤‡</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mount /dev/drbd0 /media</span><br></pre></td></tr></table></figure><ul><li>å†™å…¥æ•°æ®</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd /media/</span><br><span class="line">mkdir drbd_test</span><br><span class="line">cd drbd_test/</span><br><span class="line">echo &quot;hello World&quot; &gt; hello.txt</span><br></pre></td></tr></table></figure><ul><li>å¸è½½è®¾å¤‡</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd ~</span><br><span class="line">umount /media</span><br></pre></td></tr></table></figure><ul><li>æœ¬ç«¯é™çº§</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">drbdadm secondary r0</span><br></pre></td></tr></table></figure><h3 id="Secondaryç«¯"><a href="#Secondaryç«¯" class="headerlink" title="Secondaryç«¯"></a><code>Secondary</code>ç«¯</h3><ul><li>ä»ç«¯å‡ä¸»</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">drbdadm primary r0</span><br></pre></td></tr></table></figure><ul><li>æŒ‚è½½è®¾å¤‡</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mount /dev/drbd0 /media</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼š</strong> æ­¤æ—¶ä»ç«¯ä¸éœ€è¦å†æ¬¡æ ¼å¼åŒ–ï¼Œå¦åˆ™æ•°æ®ä¸¢å¤±ã€‚</p><ul><li>éªŒè¯æ•°æ®</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd /media</span><br><span class="line">ls</span><br><span class="line">cat ./drbd_test/hello.txt</span><br><span class="line"><span class="meta">#</span><span class="bash"> è¿”å›</span></span><br><span class="line">hello World</span><br></pre></td></tr></table></figure><p>å‚è€ƒæ¥æº</p><ul><li><a href="https://www.server-world.info/en/note?os=CentOS_7&amp;p=drbd&amp;f=2">CentOS 7 : DRBD : Configure : Server World</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> å·¥ä½œæ—¥å¸¸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DRBD </tag>
            
            <tag> Linux </tag>
            
            <tag> CentOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CentOS7 ä¸‹æºç å®‰è£… DRBD</title>
      <link href="blog/2018-01-11/how-to-install-drbd-on-CentOS7/"/>
      <url>blog/2018-01-11/how-to-install-drbd-on-CentOS7/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><p>æœ€è¿‘å¼€å‘ä¸­åˆè¦ç”¨åˆ°<code>DRBD</code>åšè¿œç¨‹å¤åˆ¶çš„åŠŸèƒ½ï¼Œç½‘ä¸Šæœåˆ°å¾ˆå¤šéƒ½æ˜¯<code>yum</code>å®‰è£…çš„åŠæ³•ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹æºç å®‰è£…çš„åŠæ³•ã€‚<br><a id="more"></a></p><h2 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h2><h3 id="å…³é—­é˜²ç«å¢™"><a href="#å…³é—­é˜²ç«å¢™" class="headerlink" title="å…³é—­é˜²ç«å¢™"></a>å…³é—­é˜²ç«å¢™</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">systemctl disable firewalld</span><br><span class="line">systemctl stop firewalld</span><br></pre></td></tr></table></figure><h3 id="å…³é—­-SELinux"><a href="#å…³é—­-SELinux" class="headerlink" title="å…³é—­ SELinux"></a>å…³é—­ SELinux</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sed -i -e &quot;s/=enforcing/=disabled/g&quot; /etc/selinux/config</span><br><span class="line">setenforce 0 </span><br></pre></td></tr></table></figure><h3 id="å®‰è£…ä¾èµ–"><a href="#å®‰è£…ä¾èµ–" class="headerlink" title="å®‰è£…ä¾èµ–"></a>å®‰è£…ä¾èµ–</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">yum -y update </span><br><span class="line">yum -y install gcc make automake autoconf libxslt libxslt-devel flex rpm-build wget</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼š</strong> å®‰è£…<code>kernel-devel</code>ä¸€å®šè¦å’Œ<code>uname -r</code>è·å–ç»“æœä¸€è‡´ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">rpm -q kernel-devel</span><br><span class="line">uname -r</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 3.10.0-327.el7.x86_64</span></span><br></pre></td></tr></table></figure><p>è¿”å›çš„å†…æ ¸ç‰ˆæœ¬åº”å½“ä¸€è‡´ï¼Œå¦åˆ™å»ºè®®ç”¨æœ¬åœ°æºå®‰è£…<code>kernel-devel</code>ã€‚</p><h2 id="ä¸‹è½½-è§£å‹æºç "><a href="#ä¸‹è½½-è§£å‹æºç " class="headerlink" title="ä¸‹è½½/è§£å‹æºç "></a>ä¸‹è½½/è§£å‹æºç </h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">å®˜æ–¹åœ°å€ï¼šhttps://www.linbit.com/en/drbd-community/drbd-download/</span><br><span class="line">æ—§ç‰ˆæœ¬ï¼šhttp://www.linbit.com/en/drbd-community/old-releases/</span><br><span class="line">MOREï¼šhttp://www.linbit.com/www.linbit.com/downloads/drbd/</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼š</strong> åœ¨<code>DRBD 8.4.3</code>(?)ä»¥ä¸Šç‰ˆæœ¬ï¼Œå¯¹<code>drbd</code>å’Œ<code>utils</code>åšäº†æ‹†åˆ†ï¼Œéœ€è¦åˆ†åˆ«è¿›è¡Œä¸‹è½½ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">wget https://xxx.tar.gz</span><br></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œå¦‚æœéœ€è¦ä½ ä¹Ÿå¯ä»¥é€šè¿‡æˆ‘çš„åˆ†äº«ä¸‹è½½ç¼–è¯‘å¥½çš„<code>rpm</code>åŒ…ï¼ˆç¤ºä¾‹ç‰ˆæœ¬ï¼‰ï¼š</p><blockquote><p>é“¾æ¥:  <a href="https://pan.baidu.com/s/1huncgDI">https://pan.baidu.com/s/1huncgDI</a>       å¯†ç :  b41i</p></blockquote><h3 id="è§£å‹ä¸‹è½½çš„ä¸¤ä¸ªtaråŒ…"><a href="#è§£å‹ä¸‹è½½çš„ä¸¤ä¸ªtaråŒ…" class="headerlink" title="è§£å‹ä¸‹è½½çš„ä¸¤ä¸ªtaråŒ…"></a>è§£å‹ä¸‹è½½çš„ä¸¤ä¸ª<code>tar</code>åŒ…</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">tar -zxvf drbd-8.*.tar.gz</span><br><span class="line">tar -zxvf drbd-utils-*.tar.gz</span><br></pre></td></tr></table></figure><h2 id="ç¼–è¯‘rpm"><a href="#ç¼–è¯‘rpm" class="headerlink" title="ç¼–è¯‘rpm"></a>ç¼–è¯‘<code>rpm</code></h2><h3 id="åˆ›å»ºæ„å»ºDRBDéœ€è¦çš„ç›®å½•"><a href="#åˆ›å»ºæ„å»ºDRBDéœ€è¦çš„ç›®å½•" class="headerlink" title="åˆ›å»ºæ„å»ºDRBDéœ€è¦çš„ç›®å½•"></a>åˆ›å»ºæ„å»º<code>DRBD</code>éœ€è¦çš„ç›®å½•</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mkdir -p rpmbuild/&#123;BUILD,BUILDROOT,RPMS,SOURCES,SPECS,SRPMS&#125;</span><br></pre></td></tr></table></figure><h3 id="ç¼–è¯‘DRBD"><a href="#ç¼–è¯‘DRBD" class="headerlink" title="ç¼–è¯‘DRBD"></a>ç¼–è¯‘<code>DRBD</code></h3><h4 id="åˆ¶ä½œ-rpm-åŒ…"><a href="#åˆ¶ä½œ-rpm-åŒ…" class="headerlink" title="åˆ¶ä½œ rpm åŒ…"></a>åˆ¶ä½œ <code>rpm</code> åŒ…</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd drbd-8.4.5/</span><br><span class="line">make clean</span><br><span class="line">make km-rpm KDIR=/usr/src/kernels/`uname -r`/       # å¯ç”¨å†…æ ¸æ¨¡å— è‡ªåŠ¨è¯†åˆ«å†…æ ¸ç‰ˆæœ¬    </span><br><span class="line"><span class="meta">#</span><span class="bash"> è¿”å›ï¼š</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> You have now:</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> /root/rpmbuild/RPMS/x86_64/drbd-km-3.10.0_693.11.6.el7.x86_64-8.4.5-1.x86_64.rpm</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> /root/rpmbuild/RPMS/x86_64/drbd-km-debuginfo-8.4.5-1.x86_64.rpmmakeinsta</span></span><br></pre></td></tr></table></figure><hr><h4 id="ç›´æ¥ç¼–è¯‘å®‰è£…"><a href="#ç›´æ¥ç¼–è¯‘å®‰è£…" class="headerlink" title="ç›´æ¥ç¼–è¯‘å®‰è£…"></a>ç›´æ¥ç¼–è¯‘å®‰è£…</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># drbdæ¨¡å—</span></span></span><br><span class="line"></span><br><span class="line">cd drbd</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">lsmod|grep drbd</span><br><span class="line">cp drbd.ko /lib/modules/`uname -r`/kernel/lib/</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># å®‰è£…æ¨¡å—</span></span></span><br><span class="line">modprobe drbd</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># éªŒè¯drbdæ¨¡å—æ˜¯å¦åŠ è½½ï¼ˆéƒ¨åˆ†ç³»ç»Ÿé»˜è®¤æœ‰è¯¥æ¨¡å—ï¼‰</span></span></span><br><span class="line">lsmod|grep drbd</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> drbd                  364858  0</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> libcrc32c              12644  4 xfs,drbd,nf_nat,nf_conntrack</span></span><br></pre></td></tr></table></figure><hr><h3 id="ç¼–è¯‘-drbd-utils-ç»„ä»¶"><a href="#ç¼–è¯‘-drbd-utils-ç»„ä»¶" class="headerlink" title="ç¼–è¯‘ drbd-utils ç»„ä»¶"></a>ç¼–è¯‘ drbd-utils ç»„ä»¶</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd ../../drbd-utils-8.9.0/   </span><br><span class="line">./configure</span><br><span class="line">make rpm</span><br><span class="line"><span class="meta">#</span><span class="bash"> è¿”å›ï¼š</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">##</span></span></span><br><span class="line">+ exit 0</span><br><span class="line">You have now:</span><br><span class="line">/root/rpmbuild/RPMS/x86_64/drbd-km-3.10.0_693.11.6.el7.x86_64-8.4.5-1.x86_64.rpm</span><br><span class="line">/root/rpmbuild/RPMS/x86_64/drbd-km-debuginfo-8.4.5-1.x86_64.rpm</span><br><span class="line">/root/rpmbuild/RPMS/x86_64/drbd-8.9.0-1.el7.centos.x86_64.rpm</span><br><span class="line">/root/rpmbuild/RPMS/x86_64/drbd-utils-8.9.0-1.el7.centos.x86_64.rpm</span><br><span class="line">/root/rpmbuild/RPMS/x86_64/drbd-xen-8.9.0-1.el7.centos.x86_64.rpm</span><br><span class="line">/root/rpmbuild/RPMS/x86_64/drbd-udev-8.9.0-1.el7.centos.x86_64.rpm</span><br><span class="line">/root/rpmbuild/RPMS/x86_64/drbd-pacemaker-8.9.0-1.el7.centos.x86_64.rpm</span><br><span class="line">/root/rpmbuild/RPMS/x86_64/drbd-bash-completion-8.9.0-1.el7.centos.x86_64.rpm</span><br><span class="line">/root/rpmbuild/RPMS/x86_64/drbd-debuginfo-8.9.0-1.el7.centos.x86_64.rpm</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">##</span></span></span><br></pre></td></tr></table></figure><p>æ­¤æ—¶æœ‰å¯èƒ½æç¤ºé”™è¯¯å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">/usr/bin/xsltproc \</span><br><span class="line">        --xinclude \</span><br><span class="line">        http://docbook.sourceforge.net/release/xsl/current/manpages/docbook.xsl drbdsetup.xml</span><br><span class="line">error : Operation in progress</span><br><span class="line">warning: failed to load external entity &quot;http://docbook.sourceforge.net/release/xsl/current/manpages/docbook.xsl&quot;</span><br><span class="line">cannot parse http://docbook.sourceforge.net/release/xsl/current/manpages/docbook.xsl</span><br><span class="line">make[1]: *** [drbdsetup.8] Error 4</span><br></pre></td></tr></table></figure><p>æç¤ºæœ‰ä¸€ä¸ªåœ°å€æ–‡ä»¶æ²¡èƒ½æ‰¾åˆ°ï¼Œè§£å†³æ–¹æ³•ï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">yum -y install docbook-style-xsl</span><br></pre></td></tr></table></figure><p>TODO: æ­¤å¤„æš‚æœªæ‰¾åˆ°åˆ«çš„è§£å†³æ–¹æ³•ï¼Œæ¬¢è¿è¯»è€…ç•™è¨€ã€‚</p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><h3 id="å®‰è£…ç¼–è¯‘ç”Ÿæˆçš„æ–‡ä»¶"><a href="#å®‰è£…ç¼–è¯‘ç”Ÿæˆçš„æ–‡ä»¶" class="headerlink" title="å®‰è£…ç¼–è¯‘ç”Ÿæˆçš„æ–‡ä»¶"></a>å®‰è£…ç¼–è¯‘ç”Ÿæˆçš„æ–‡ä»¶</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd /root/rpmbuild/RPMS/x86_64/</span><br><span class="line">rpm -ivh drbd-* --force</span><br></pre></td></tr></table></figure><h3 id="åŠ è½½æ¨¡å—ï¼ˆå‚è§åˆ†å‰²çº¿éƒ¨åˆ†ï¼‰"><a href="#åŠ è½½æ¨¡å—ï¼ˆå‚è§åˆ†å‰²çº¿éƒ¨åˆ†ï¼‰" class="headerlink" title="åŠ è½½æ¨¡å—ï¼ˆå‚è§åˆ†å‰²çº¿éƒ¨åˆ†ï¼‰"></a>åŠ è½½æ¨¡å—ï¼ˆå‚è§åˆ†å‰²çº¿éƒ¨åˆ†ï¼‰</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">modprobe drbd</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="éªŒè¯å®‰è£…ç»“æœ"><a href="#éªŒè¯å®‰è£…ç»“æœ" class="headerlink" title="éªŒè¯å®‰è£…ç»“æœ"></a>éªŒè¯å®‰è£…ç»“æœ</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">lsmod|grep drbd</span><br><span class="line"><span class="meta">#</span><span class="bash"> è¿”å›ï¼ˆ`depends` å¯èƒ½ç•¥æœ‰ä¸åŒï¼‰ï¼š</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> drbd                  373375  4</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> libcrc32c              12644  2 xfs,drbd</span></span><br><span class="line"></span><br><span class="line">drbd-overview  </span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> ä»¥ä¸‹ä¸¤è€…è¿”å›ç¨æœ‰ä¸åŒ</span>    </span><br><span class="line">cat /proc/drbd</span><br><span class="line">drbdadm -V</span><br><span class="line"><span class="meta">#</span><span class="bash"> è¿”å›</span></span><br><span class="line"></span><br><span class="line">DRBDADM_BUILDTAG=GIT-hash:\ 79677f4***7ca6b99929\ build\ by\ root@imoyao\,\ 2018-01-06\ 14:25:03</span><br><span class="line">DRBDADM_API_VERSION=1</span><br><span class="line">DRBD_KERNEL_VERSION_CODE=0x080405</span><br><span class="line">DRBDADM_VERSION_CODE=0x080900</span><br><span class="line">DRBDADM_VERSION=8.9.0</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒæ¥æº"><a href="#å‚è€ƒæ¥æº" class="headerlink" title="å‚è€ƒæ¥æº"></a>å‚è€ƒæ¥æº</h2><ul><li><p><a href="https://www.server-world.info/en/note?os=CentOS_7&amp;p=drbd&amp;f=1">CentOS 7 : DRBD : Install : Server World</a></p></li><li><p><a href="http://blog.topspeedsnail.com/archives/8381">CentOS å®‰è£…é…ç½® DRBD â€“ WTF Daily Blog</a></p></li><li><p><a href="http://www.3mu.me/centos%E4%B8%8B%E5%AE%9E%E7%8E%B0heartbeatdrbdmysql%E5%8F%8C%E6%9C%BA%E7%83%AD%E5%A4%87%E7%A1%AC%E4%BB%B6%E6%95%85%E9%9A%9C%E8%87%AA%E5%8A%A8%E5%88%87%E6%8D%A2%E9%AB%98%E5%8F%AF%E7%94%A8ha/#respond">CentOS ä¸‹å®ç° Heartbeat+DRBD+MySQL åŒæœºçƒ­å¤‡ç¡¬ä»¶æ•…éšœè‡ªåŠ¨åˆ‡æ¢é«˜å¯ç”¨(HA)æ–¹æ¡ˆ | ä¸‰æœ¨çš„äººç”Ÿâ€”â€”3mu.me</a></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹è®°å½• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DRBD </tag>
            
            <tag> Linux </tag>
            
            <tag> CentOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ğŸPyTricks | Python å­—å…¸æ’åº</title>
      <link href="blog/2018-01-02/how-to-sort-dict-use-python/"/>
      <url>blog/2018-01-02/how-to-sort-dict-use-python/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><p>å†™å‡º<code>Pythonic</code>çš„ä»£ç åº”è¯¥æ˜¯æ¯ä¸ª Pythonista çš„æ¯•ç”Ÿè¿½æ±‚ï¼Œæœ¬æ–‡ä¸»è¦è®°å½•åœ¨å¼€å‘ä¸­é‡åˆ°çš„ä¸€äº›æœ‰å…³<code>Python</code>æŠ€å·§ã€‚</p><a id="more"></a><h2 id="æ’åº"><a href="#æ’åº" class="headerlink" title="æ’åº"></a>æ’åº</h2><ul><li><code>JSON</code>å­—å…¸å†…æŒ‰ç…§æŸä¸ªé”®å€¼æ’åº</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">In [<span class="number">15</span>]: alist = [&#123;<span class="string">&#x27;create&#x27;</span>: <span class="string">&#x27;2017-12-28 11:05:48&#x27;</span>, <span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;0_1&#x27;</span>, <span class="string">&#x27;path&#x27;</span>: <span class="string">&#x27;foo.py&#x27;</span>, <span class="string">&#x27;size&#x27;</span>: <span class="number">0</span>&#125;,</span><br><span class="line">&#123;<span class="string">&#x27;create&#x27;</span>: <span class="string">&#x27;2017-12-28 11:00:29&#x27;</span>, <span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;0_2&#x27;</span>, <span class="string">&#x27;path&#x27;</span>: <span class="string">&#x27;bar.py&#x27;</span>, <span class="string">&#x27;size&#x27;</span>: <span class="number">0</span>&#125;, &#123;<span class="string">&#x27;create&#x27;</span>: <span class="string">&#x27;2017-12-28 11:05:55&#x27;</span>, <span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;0_3&#x27;</span>, <span class="string">&#x27;path&#x27;</span>: <span class="string">&#x27;baz.py&#x27;</span>, <span class="string">&#x27;size&#x27;</span>: <span class="number">0</span>&#125;]</span><br><span class="line"></span><br><span class="line">In [<span class="number">16</span>]: alist.sort(key=<span class="keyword">lambda</span> x:x[<span class="string">&#x27;create&#x27;</span>])    <span class="comment"># æŒ‰ç…§åˆ›å»ºæ—¶é—´æ’åº </span></span><br><span class="line"></span><br><span class="line">In [<span class="number">17</span>]: alist</span><br><span class="line">Out[<span class="number">17</span>]:</span><br><span class="line">[&#123;<span class="string">&#x27;create&#x27;</span>: <span class="string">&#x27;2017-12-28 11:00:29&#x27;</span>, <span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;0_2&#x27;</span>, <span class="string">&#x27;path&#x27;</span>: <span class="string">&#x27;bar.py&#x27;</span>, <span class="string">&#x27;size&#x27;</span>: <span class="number">0</span>&#125;,</span><br><span class="line"> &#123;<span class="string">&#x27;create&#x27;</span>: <span class="string">&#x27;2017-12-28 11:05:48&#x27;</span>, <span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;0_1&#x27;</span>, <span class="string">&#x27;path&#x27;</span>: <span class="string">&#x27;foo.py&#x27;</span>, <span class="string">&#x27;size&#x27;</span>: <span class="number">0</span>&#125;,</span><br><span class="line"> &#123;<span class="string">&#x27;create&#x27;</span>: <span class="string">&#x27;2017-12-28 11:05:55&#x27;</span>, <span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;0_3&#x27;</span>, <span class="string">&#x27;path&#x27;</span>: <span class="string">&#x27;baz.py&#x27;</span>, <span class="string">&#x27;size&#x27;</span>: <span class="number">0</span>&#125;]</span><br><span class="line"> </span><br></pre></td></tr></table></figure><ul><li>å­—å…¸æ’åº</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">In [<span class="number">35</span>]: languages = &#123;<span class="string">&#x27;JAVA&#x27;</span>:<span class="number">15</span>,<span class="string">&#x27;Python&#x27;</span>:<span class="number">12</span>,<span class="string">&#x27;Go&#x27;</span>:<span class="number">13</span>,<span class="string">&#x27;PHP&#x27;</span>:<span class="number">14</span>&#125;</span><br><span class="line"></span><br><span class="line">In [<span class="number">35</span>]: <span class="built_in">sorted</span>(languages.items(),key=<span class="keyword">lambda</span> x:x[<span class="number">0</span>])        <span class="comment"># ä»¥keyæ’åº</span></span><br><span class="line">Out[<span class="number">35</span>]: [(<span class="string">&#x27;Go&#x27;</span>, <span class="number">13</span>), (<span class="string">&#x27;JAVA&#x27;</span>, <span class="number">15</span>), (<span class="string">&#x27;PHP&#x27;</span>, <span class="number">12</span>), (<span class="string">&#x27;Python&#x27;</span>, <span class="number">12</span>)]</span><br><span class="line"></span><br><span class="line">In [<span class="number">36</span>]: <span class="built_in">sorted</span>(languages.items(),key=<span class="keyword">lambda</span> x:x[<span class="number">1</span>])        <span class="comment"># ä»¥valueæ’åº</span></span><br><span class="line">Out[<span class="number">36</span>]: [(<span class="string">&#x27;Python&#x27;</span>, <span class="number">12</span>), (<span class="string">&#x27;PHP&#x27;</span>, <span class="number">12</span>), (<span class="string">&#x27;Go&#x27;</span>, <span class="number">13</span>), (<span class="string">&#x27;JAVA&#x27;</span>, <span class="number">15</span>)]</span><br><span class="line"></span><br><span class="line">In [<span class="number">37</span>]: <span class="built_in">sorted</span>(languages.items(),key=<span class="keyword">lambda</span> x:-x[<span class="number">1</span>])       <span class="comment"># ä»¥valueå€’åº</span></span><br><span class="line">Out[<span class="number">37</span>]: [(<span class="string">&#x27;JAVA&#x27;</span>, <span class="number">15</span>), (<span class="string">&#x27;Go&#x27;</span>, <span class="number">13</span>), (<span class="string">&#x27;Python&#x27;</span>, <span class="number">12</span>), (<span class="string">&#x27;PHP&#x27;</span>, <span class="number">12</span>)]</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼š<code>sort()</code>ä¸<code>sorted()</code>çš„åŒºåˆ«ï¼Œå‰è€…ç›´æ¥ä¿®æ”¹åˆ—è¡¨ï¼Œè¿”å›å€¼ä¸º<code>None</code>ï¼›åè€…ä¸ºå†…ç½®å‡½æ•°ï¼Œå®ƒä¼šä»ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡æ„å»ºä¸€ä¸ªæ–°çš„æ’åºåˆ—è¡¨ã€‚</p><h2 id="å‚è€ƒé˜…è¯»"><a href="#å‚è€ƒé˜…è¯»" class="headerlink" title="å‚è€ƒé˜…è¯»"></a>å‚è€ƒé˜…è¯»</h2><ul><li><a href="https://docs.python.org/zh-cn/3.6/howto/sorting.html">æ’åºæŒ‡å— â€” Python 3.6.10 æ–‡æ¡£</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> ğŸPyTricks </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> sort </tag>
            
            <tag> dict </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Storcli å¸¸ç”¨ç®¡ç†å‘½ä»¤æ±‡æ€»</title>
      <link href="blog/2017-12-27/storcli-command-share/"/>
      <url>blog/2017-12-27/storcli-command-share/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><p>ç›®å‰<code>LSI RAID</code>å¡ä½¿ç”¨çš„é…ç½®å·¥å…·ä¸»è¦æœ‰ï¼š<code>Megaraid Storage Manager</code>ï¼ˆMSMï¼Œå›¾å½¢ç¯å¢ƒï¼‰ã€<code>MegaCLI</code>ï¼ˆå­—ç¬¦ç•Œé¢ï¼‰ã€<code>StorCLI</code>ï¼ˆå­—ç¬¦ç•Œé¢ï¼‰ã€‚å…¶ä¸­<code>StorCLI</code>ä½œä¸º<code>MegaCLI</code>åç»§è€…æ•´åˆäº†<code>LSI</code>å’ŒåŸæ¥<code>3ware</code>çš„äº§å“æ”¯æŒï¼Œå…¼å®¹<code>MegaCLI</code>å‘½ä»¤çš„åŒæ—¶æ›´åŠ ç®€æ´ã€‚<a href="/blog/2017-11-20/megacli-command-share/">å‰é¢çš„æ–‡ç« </a>è®°å½•äº†<code>MegaCli</code>å¸¸ç”¨ç®¡ç†å‘½ä»¤ï¼Œæœ¬ç¯‡ä¸»è¦è®°å½•<code>StorCLI</code>çš„ä½¿ç”¨ã€‚</p><a id="more"></a><h2 id="å®‰è£…Storcli"><a href="#å®‰è£…Storcli" class="headerlink" title="å®‰è£…Storcli"></a>å®‰è£…<code>Storcli</code></h2><h3 id="Ubuntu"><a href="#Ubuntu" class="headerlink" title="Ubuntu"></a>Ubuntu</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">unzip ul_avago_storcli_1.18.11_anyos.zip</span><br><span class="line">dpkg -i storcli_all_os/Ubuntu/storcli_1.18.11_all.deb</span><br><span class="line">dpkg -l | grep -i storcli</span><br></pre></td></tr></table></figure><h3 id="Centos"><a href="#Centos" class="headerlink" title="Centos"></a>Centos</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">unzip ul_avago_storcli_1.18.11_anyos.zip</span><br><span class="line">rpm -ivh storcli_all_os/Linux/storcli-1.18.11-1.noarch.rpm</span><br><span class="line">rpm -qi storcli</span><br><span class="line">ln -s /opt/MegaRAID/storcli/storcli64 /usr/local/bin/storcli</span><br></pre></td></tr></table></figure><h3 id="ESXi-5-5-amp-ESXi-6-0"><a href="#ESXi-5-5-amp-ESXi-6-0" class="headerlink" title="ESXi 5.5 &amp; ESXi 6.0"></a>ESXi 5.5 &amp; ESXi 6.0</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">unzip ul_avago_storcli_1.18.11_anyos.zip</span><br><span class="line">esxcli software vib install -v=vmware-esx-storcli-1.21.06.vib --no-sig-check</span><br><span class="line">ln -s /opt/lsi/storcli/storcli /sbin/storcli</span><br><span class="line">storcli -V</span><br></pre></td></tr></table></figure><h2 id="storcliä½¿ç”¨"><a href="#storcliä½¿ç”¨" class="headerlink" title="storcliä½¿ç”¨"></a><code>storcli</code>ä½¿ç”¨</h2><p>ä¸“æœ‰åè¯è§£é‡Šï¼š</p><p><code>/cx, /vx</code> è¡¨ç¤º <code>Controller/Virtual Drive Number</code>.</p><p><code>/ex, /sx</code>è¡¨ç¤º <code>Enclosure/Slot ID</code>.</p><p><code>VD</code>è¡¨ç¤º <code>Virtual Drive</code>.</p><p>è¦è¾“å‡º<code>json</code>æ ¼å¼çš„è¿”å›,åœ¨å‘½ä»¤è¡Œæœ€åæ·»åŠ <code>J</code>.</p><ul><li>å›ºä»¶å‡çº§</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">storcli /cx download file=/path/to/firmware.rom</span><br></pre></td></tr></table></figure><ul><li>æŸ¥çœ‹æ§åˆ¶å™¨å’Œé…ç½®ä¿¡æ¯</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">storcli /cx show all</span><br></pre></td></tr></table></figure><ul><li>ä½¿ç”¨æ¿€æ´»ç æ¿€æ´»ç‰¹æ€§(å¦‚ CacheCade, FastPath,â€¦)</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">storcli /cx set aso key=AAAAAAAABBBBBBBBCCCCCCCC</span><br></pre></td></tr></table></figure><ul><li>æŸ¥çœ‹ç°æœ‰ç¡¬ç›˜åŠå…¶çŠ¶æ€çš„ä¿¡æ¯ (IDs,â€¦)</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">storcli /cx /eall /sall show (all)</span><br></pre></td></tr></table></figure><p>è¿”å›ç»“æœ</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Controller &#x3D; 0</span><br><span class="line">Status &#x3D; Success</span><br><span class="line">Description &#x3D; Show Drive Information Succeeded.</span><br><span class="line"></span><br><span class="line">Drive Information :</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">-----------------------------------------------------------------------------</span><br><span class="line">EID:Slt DID State DG     Size Intf Med SED PI SeSz Model                  Sp</span><br><span class="line">-----------------------------------------------------------------------------</span><br><span class="line">252:0     1 Onln   1 3.637 TB SATA HDD N   N  512B WDC WD4000FYYZ-03UL1B3 U</span><br><span class="line">252:1     3 Onln   1 3.637 TB SATA HDD N   N  512B WDC WD4000FYYZ-03UL1B3 U</span><br><span class="line">......</span><br><span class="line">252:6    85 Onln   0 3.637 TB SATA HDD N   N  512B WDC WD4000FYYZ-03UL1B3 U</span><br><span class="line">252:7     2 UGood  - 3.637 TB SATA HDD N   N  512B WDC WD4000FYYZ-03UL1B3 D</span><br><span class="line">-----------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">EID-Enclosure Device ID|Slt-Slot No.|DID-Device ID|DG-DriveGroup</span><br><span class="line">DHS-Dedicated Hot Spare|UGood-Unconfigured Good|GHS-Global Hotspare</span><br><span class="line">UBad-Unconfigured Bad|Onln-Online|Offln-Offline|Intf-Interface</span><br><span class="line">Med-Media Type|SED-Self Encryptive Drive|PI-Protection Info</span><br><span class="line">SeSz-Sector Size|Sp-Spun|U-Up|D-Down|T-Transition|F-Foreign</span><br><span class="line">UGUnsp-Unsupported|UGShld-UnConfigured shielded|HSPShld-Hotspare shielded</span><br><span class="line">CFShld-Configured shielded|Cpybck-CopyBack|CBShld-Copyback Shielded</span><br></pre></td></tr></table></figure><ul><li>ç°æœ‰è™šæ‹Ÿç¡¬ç›˜åŠå…¶çŠ¶æ€çš„ä¿¡æ¯</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">storcli /cx /vall show (all)</span><br></pre></td></tr></table></figure><ul><li>æŸ¥çœ‹å½“å‰æ‰€æœ‰é‡å»ºçš„çŠ¶æ€</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">storcli /cx /eall /sall show rebuild</span><br></pre></td></tr></table></figure><h2 id="åˆ›å»º-åˆå§‹åŒ–-raid"><a href="#åˆ›å»º-åˆå§‹åŒ–-raid" class="headerlink" title="åˆ›å»º/åˆå§‹åŒ– raid"></a>åˆ›å»º/åˆå§‹åŒ– <code>raid</code></h2><ul><li><code>shell</code>åˆ›å»º<code>VD</code></li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">storcli /cx add vd type=[RAID0(r0)|RAID1(r1)|...] drives=[EnclosureID:SlotID|:SlotID-SlotID|:SlotID,SlotID]</span><br><span class="line"><span class="meta">#</span><span class="bash">more</span></span><br><span class="line">storcli /cx add vd type=raid[0|1|5|6|00|10|50|60(r0|r1|...)] [Size=&lt;VD1_Sz&gt;,&lt;VD2_Sz&gt;,..|all] [name=&lt;VDNAME1&gt;,..] drives=e:s|e:s-x,y;e:s-x,y,z [PDperArray=x] [SED] [pdcache=on|off|default] [pi] [DimmerSwitch(ds)=default|automatic(auto)|none|maximum(max)|MaximumWithoutCaching(maxnocache)] [wt|wb] [nora|ra] [direct|cached] [CachedBadBBU|NoCachedBadBBU][cachevd] [Strip=&lt;8|16|32|64|128|256|1024&gt;] [AfterVd=X] [Spares = [e:]s|[e:]s-x|[e:]s-x,y] [force][ExclusiveAccess]</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹:</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> ä½¿ç”¨ç¡¬ç›˜0-2åˆ›å»ºraid1</span></span><br><span class="line">storcli /cx add vd type=r1 drives=252:0-2</span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ›å»º raid5,write-bakc,read-ahead</span></span><br><span class="line">storcli /cx add vd type=raid5  size=all names=VD1 drives=32:2-7 wb ra</span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ›å»º raid10/50/60,å¿…é¡»è®¾å®šPDperArrayå‚æ•°,write-bakc,read-ahead</span></span><br><span class="line">storcli /cx add vd type=raid10 size=all names=VD1 drives=32:2-7 PDperArray=2 wb ra</span><br></pre></td></tr></table></figure><ul><li><code>shell</code>ä¹‹åˆå§‹åŒ–<code>VD</code></li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">storcli &#x2F;cx&#x2F;vx start init (force)</span><br></pre></td></tr></table></figure><ul><li>ç›‘è§†åˆå§‹åŒ–è¿›åº¦</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">storcli /cx/vx show init</span><br></pre></td></tr></table></figure><ul><li><code>shell</code>ä¹‹ç§»é™¤<code>VD</code></li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">storcli /cx/vx del (force)</span><br></pre></td></tr></table></figure><h2 id="ç¼“å­˜åŠ é€Ÿ"><a href="#ç¼“å­˜åŠ é€Ÿ" class="headerlink" title="ç¼“å­˜åŠ é€Ÿ"></a>ç¼“å­˜åŠ é€Ÿ</h2><ul><li><code>shell</code>ä¹‹åˆ›å»º<code>CacheCade</code>è®¾å¤‡ï¼ˆSSD ç¼“å­˜åŠ é€Ÿï¼‰</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">storcli /cx add vd cc type=r[0,1,10] drives=[EnclosureID:SlotID|:SlotID-SlotID|:SlotID,SlotID]  WT|WB (assignvds=0,1,2)</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹:</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">storcli /c0 add vd cc type=r1 drives=252:2-3 WB</span><br></pre></td></tr></table></figure><ul><li><code>shell</code>ä¹‹<code>CacheCade</code>æ¿€æ´»/åœç”¨</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">storcli /cx/[vx|vall] set ssdCaching=[on|off]</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹:</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">storcli /c0/v1 set ssdCaching=on</span><br></pre></td></tr></table></figure><ul><li><code>shell</code>ä¹‹ç§»é™¤<code>CacheCade</code></li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">storcli /cx/vx del cc</span><br></pre></td></tr></table></figure><h2 id="è¯¯æ’æ‹”è®¾å¤‡åˆå¹¶"><a href="#è¯¯æ’æ‹”è®¾å¤‡åˆå¹¶" class="headerlink" title="è¯¯æ’æ‹”è®¾å¤‡åˆå¹¶"></a>è¯¯æ’æ‹”è®¾å¤‡åˆå¹¶</h2><p>å¦‚æœä¸æ­£ç¡®åœ°ç§»é™¤è®¾å¤‡å¹¶é‡æ–°è¿æ¥åˆ° RAID æ§åˆ¶å™¨ï¼Œå®ƒå°†è¢«è¯†åˆ«ä¸º UBAD(Unconfigured Bad)ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">storcli /c0 /eall /sall show</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶çš„è¿”å›ç»“æœï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Controller &#x3D; 0</span><br><span class="line">Status &#x3D; Success</span><br><span class="line">Description &#x3D; Show Drive Information Succeeded.</span><br><span class="line"></span><br><span class="line">Drive Information :</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">EID:Slt DID State DG       Size Intf Med SED PI SeSz Model                  Sp </span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">252:0     7 Onln   0  465.25 GB SATA HDD N   N  512B WDC WD5003ABYX-01WERA1 U  </span><br><span class="line">252:1     6 Onln   1  465.25 GB SATA HDD N   N  512B WDC WD5003ABYX-01WERA1 U  </span><br><span class="line">252:2     5 UGood  -  465.25 GB SATA HDD N   N  512B WDC WD5003ABYX-01WERA1 U  </span><br><span class="line">252:3     4 UBad   - 223.062 GB SATA SSD N   N  512B INTEL SSDSC2CW240A3    U  </span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">......</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶<code>252:3</code>å¿…éœ€ç½®ä¸º<code>UGOOD</code></p><ul><li><code>UBad</code>ç½®ä¸º<code>UGOOD</code></li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">storcli /cx /ex /sx set good</span><br></pre></td></tr></table></figure><p>è¿”å›ç»“æœ</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Controller = 0</span><br><span class="line">Status = Success</span><br><span class="line">Description = Show Drive Information Succeeded.</span><br><span class="line"></span><br><span class="line">Drive Information :</span><br><span class="line">=================</span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">EID:Slt DID State DG       Size Intf Med SED PI SeSz Model                  Sp </span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">252:0     7 Onln   0  465.25 GB SATA HDD N   N  512B WDC WD5003ABYX-01WERA1 U  </span><br><span class="line">252:1     6 Onln   1  465.25 GB SATA HDD N   N  512B WDC WD5003ABYX-01WERA1 U  </span><br><span class="line">252:2     5 UGood  -  465.25 GB SATA HDD N   N  512B WDC WD5003ABYX-01WERA1 U  </span><br><span class="line">252:3     4 UGood  F 223.062 GB SATA SSD N   N  512B INTEL SSDSC2CW240A3    U  </span><br><span class="line">-------------------------------------------------------------------------------</span><br></pre></td></tr></table></figure><ul><li><code>foreign</code>ç®¡ç†</li></ul><p>æ­¤æ—¶ç¡¬ç›˜ä¸º<code>foreign</code>çŠ¶æ€</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">storcli /cx /fall show</span><br></pre></td></tr></table></figure><p>è¿”å›ç»“æœ</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Controller = 0</span><br><span class="line">Status = Success</span><br><span class="line">Description = Operation on foreign configuration Succeeded</span><br><span class="line"></span><br><span class="line">FOREIGN CONFIGURATION :</span><br><span class="line">=====================</span><br><span class="line">----------------------------------------</span><br><span class="line">DG EID:Slot Type State       Size NoVDs </span><br><span class="line">----------------------------------------</span><br><span class="line"> 0 -        Cac0 Frgn  223.062 GB     1 </span><br><span class="line">----------------------------------------</span><br><span class="line"></span><br><span class="line">NoVDs - Number of VDs in disk group|DG - Diskgroup</span><br><span class="line">Total foreign drive groups = 1</span><br></pre></td></tr></table></figure><p>ç°åœ¨å®ƒå¯ä»¥é‡æ–°åŒ…å«åœ¨é…ç½®ä¸­</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">storcli /cx /fall import</span><br></pre></td></tr></table></figure><p>å¦‚æœè®¾å¤‡æ˜¯ RAID çš„ä¸€éƒ¨åˆ†ï¼Œåˆ™ä¼šè‡ªåŠ¨æ‰§è¡Œé‡å»ºï¼ˆè¯·å‚é˜…æ¦‚è¿°ä¸­çš„çŠ¶æ€ï¼šRbldï¼‰ã€‚ å¯ç”¨ä»¥ä¸‹å‘½ä»¤ç›‘è§†è¿›åº¦ï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">storcli /cx /ex /sx show rebuild</span><br></pre></td></tr></table></figure><h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹VDå¥åº·çŠ¶æ€ç­‰,è·å–åˆ°åç›˜çš„E:Sç¼–å·,ç„¶åæŸ¥çœ‹å¯¹åº”ç›˜çš„SN</span></span><br><span class="line">storcli /c0 /vall show [all]</span><br><span class="line">storcli /c0 /eX /sY show all |grep SN</span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹é˜µåˆ—å¡</span></span><br><span class="line">storcli show ctrlcount</span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ virtual disk 0 @controlor 0</span></span><br><span class="line">storcli /cx /v0 show</span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ Controlor-0, Enclosure-7, Slot-7çš„ç£ç›˜ä¿¡æ¯</span></span><br><span class="line">storcli /cx/e252/s7 show all</span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹æŠ¥è­¦ä¿¡æ¯</span></span><br><span class="line">storcli /cx show alarm</span><br><span class="line"><span class="meta">#</span><span class="bash"> å…³é—­beepèœ‚é¸£å™¨æŠ¥è­¦</span></span><br><span class="line">storcli /cx set alarm=&lt;on|off|silence&gt;</span><br><span class="line"><span class="meta">#</span><span class="bash"> å®šä½ç£ç›˜ä»“ä½</span></span><br><span class="line">storcli /c0/e8/s2 start/stop locate</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒæ¥æº"><a href="#å‚è€ƒæ¥æº" class="headerlink" title="å‚è€ƒæ¥æº"></a>å‚è€ƒæ¥æº</h2><ul><li><a href="https://www.broadcom.com/site-search?q=storcli">å®˜æ–¹ç›¸å…³èµ„æºä¸‹è½½-broadcom</a></li><li><a href="https://docs.broadcom.com/docs-and-downloads/raid-controllers/raid-controllers-common-files/StorCLI_RefMan_revf.pdf">StorCLI å®˜æ–¹æ‰‹å†Œä¸‹è½½</a></li><li><a href="https://www.thomas-krenn.com/en/wiki/StorCLI">StorCLI _Thomas-Krenn</a></li><li><a href="https://www.xargs.cn/doku.php/lsi:storcli%E6%89%8B%E5%86%8C">STORCLI-wikiï¼ˆä¸ªäººåšä¸»ç»´æŠ¤ï¼‰</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹è®°å½• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å­˜å‚¨ </tag>
            
            <tag> Linux </tag>
            
            <tag> RAID </tag>
            
            <tag> Storcli </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¹¦ç±ç¯‡ | Python èµ„æºæ•´ç†æ¨è</title>
      <link href="blog/2017-12-03/recommend-books-for-Python-learner/"/>
      <url>blog/2017-12-03/recommend-books-for-Python-learner/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><p>å› ä¸ºæˆ‘ç›®å‰åš<code>Python</code>ç›¸å…³å¼€å‘ï¼Œå¾ˆå¤šæƒ³å…¥é—¨<code>Python</code>çš„æœ‹å‹æˆ–è€…ä»äº‹å…¶ä»–è¯­è¨€å¼€å‘çš„åŒå­¦ç§èŠè®¨è®ºä¹¦ç±èµ„æ–™æ¨èçš„è¯é¢˜ï¼Œå…¶å®ç½‘ä¸Šæœ‰å¾ˆå¤šå…³äºè¿™ä¸ªé—®é¢˜çš„è¯é¢˜æ€»ç»“ï¼Œæˆ‘ä¸ªäººçš„æ¨èå¹¶ä¸è§å¾—æ¯”å¤§ç¥æ›´å¥½ï¼Œå¸Œæœ›çœŸæ­£æƒ³æ²‰ä¸‹å¿ƒæ¥å­¦ä¹ çš„äººèƒ½å¤Ÿæ—©ç‚¹æ˜ç™½â€œè‡ªå·±åŠ¨æ‰‹ï¼Œä¸°è¡£è¶³é£Ÿâ€çš„é“ç†ã€‚åœ¨è¿™é‡Œåšä¸ªç®€å•æ•´ç†ä¹Ÿç®—æ˜¯ç»™å¤§å®¶ä¸€ä¸ªäº¤ä»£ï¼Œä»¥ä¸ç•™ä¸‹ç››æ°”å‡Œäººçš„å‚²æ…¢å°è±¡ä¸ºç›¼ã€‚</p><a id="more"></a><h2 id="çº¢è¯ä¸¸è¿˜æ˜¯è“è¯ä¸¸"><a href="#çº¢è¯ä¸¸è¿˜æ˜¯è“è¯ä¸¸" class="headerlink" title="çº¢è¯ä¸¸è¿˜æ˜¯è“è¯ä¸¸"></a>çº¢è¯ä¸¸è¿˜æ˜¯è“è¯ä¸¸</h2><p><img src= "/img/loading.svg" data-lazy-src="/images/python-or-python3.png" alt="è¯·é€‰Python3"></p><p>åˆšå¼€å§‹å­¦ä¹ ç¼–ç¨‹çš„æ—¶å€™ï¼Œå¾ˆå¤šäººä¼šæœ‰å„ç§å›°æƒ‘ï¼šé€‰æ‹©å“ªé—¨è¯­è¨€ï¼Ÿé€‰æ‹©è¯­è¨€çš„å“ªä¸ªç‰ˆæœ¬ï¼Ÿç”¨ä»€ä¹ˆç¼–è¾‘å™¨/å¼€å‘å¹³å°â€¦â€¦</p><p>ç›¸ä¿¡çœ‹è¿™ç¯‡æ–‡ç« çš„å¯¹ç¬¬ä¸€ä¸ªé—®é¢˜å·²ç„¶æœ‰äº†è‡ªå·±çš„é€‰æ‹©ï¼Œåœ¨æ­¤ä¸å¤šèµ˜è¿°ã€‚å…³äº Python ç‰ˆæœ¬çš„é—®é¢˜ï¼Œæ—¶è‡³ä»Šæ—¥ï¼ˆ2017 å¹´ï¼‰ï¼Œé™¤éå…¬å¸é¡¹ç›®éœ€è¦ï¼Œä¸ç„¶è¯·æœæ–­é€‰æ‹© Python3ï¼Œæ¯•ç«Ÿå¤§å¤šæ•°ç¬¬ä¸‰æ–¹åº“å·²ç»åšå‡ºæ”¾å¼ƒ Python2 ç»´æŠ¤çš„ç›¸å…³è¯´æ˜ã€‚ç¬¬ä¸‰ä¸ªé—®é¢˜å€’æ˜¯ä¸ç”¨è¿‡åˆ†çº ç»“ï¼Œæ¯•ç«Ÿåªè¦èƒ½å¤Ÿ runï¼Œå“ªæ€•æ˜¯ç”¨è®°äº‹æœ¬å†™çš„ä¹Ÿæ²¡äººä¼šåœ¨æ„ã€‚ä¸ªäººç›®å‰ä½¿ç”¨ Sublime Text 3 æ­é… PyCharm ä½œä¸º IDEã€‚</p><h2 id="å…¥é—¨ç¯‡"><a href="#å…¥é—¨ç¯‡" class="headerlink" title="å…¥é—¨ç¯‡"></a>å…¥é—¨ç¯‡</h2><ul><li>ã€Šâ€ç¬¨åŠæ³•â€å­¦ Pythonã€‹    ï¼ˆã€ŠLearn Python the Hard Wayã€‹ï¼‰</li></ul><p><a href="https://www.gitbook.com/book/flyouting/learn-python-the-hard-way-cn/details">ç¬¨åŠæ³•å­¦ Python -Gitbook</a></p><p>å­¦ä¹ ä¸€é—¨è¯­è¨€çš„æœ€å¥½åŠæ³•å°±æ˜¯å¤šæ•²å¤šç”¨ï¼Œå¦„å›¾é çœ¼ç›<strong>çœ‹</strong>ä¼šä¸€é—¨æŠ€æœ¯çš„äººï¼Œå¸Œæœ›èƒ½å¤Ÿæ—©ç‚¹ä¸¢æ‰å¹»æƒ³ï¼Œå‡†å¤‡æˆ˜æ–—ï¼</p><blockquote><p>è¿™æœ¬ç®€å•ä¹¦çš„ç›®çš„æ˜¯è®©ä½ èµ·æ­¥ç¼–ç¨‹ã€‚ è™½ç„¶ä¹¦åè¯´æ˜¯â€œç¬¨åŠæ³•â€,ä½†å…¶å®å¹¶éå¦‚æ­¤. æ‰€è°“çš„â€œç¬¨åŠæ³•â€æ˜¯æŒ‡æœ¬ä¹¦æ•™æˆçš„æ–¹å¼ã€‚è¿™æœ¬ä¹¦çš„<br>æ•™å­¦æ–¹å¼å°±æ˜¯æŒ‰ç…§æˆ‘å‘Šè¯‰ä½ çš„æ–¹å¼å»åšä¸€ç³»åˆ—çš„ç»ƒä¹ ï¼Œç›®çš„æ˜¯é€šè¿‡é‡å¤ç»ƒä¹ æŒæ¡ä¸€ç§æŠ€èƒ½ã€‚è¿™å¯¹äºä¸€äº›ä»€ä¹ˆéƒ½ä¸çŸ¥é“çš„åˆå­¦è€…ï¼Œåœ¨ç†è§£æ›´å¤æ‚çš„ç§‘ç›®ä¹‹å‰è·å–åŸºæœ¬èƒ½åŠ›æ˜¯å¾ˆæœ‰æ•ˆçš„æ–¹æ³•ã€‚è¿™ç§æ–¹æ³•é€‚ç”¨äºä¸€åˆ‡é¢†åŸŸï¼Œä»æ­¦æœ¯åˆ°éŸ³ä¹ç”šè‡³åŸºæœ¬çš„æ•°å­¦å’Œé˜…è¯»æŠ€å·§ã€‚<br>è¿™æœ¬ä¹¦ä»¥ä¹ é¢˜çš„æ–¹å¼å¼•å¯¼è¯»è€…ä¸€æ­¥ä¸€æ­¥å­¦ä¹ ç¼–ç¨‹ï¼Œä»ç®€å•çš„æ‰“å°ä¸€ç›´è®²åˆ°å®Œæ•´é¡¹ç›®çš„å®ç°ã€‚ä¹Ÿè®¸è¯»å®Œè¿™æœ¬ä¹¦å¹¶ä¸<br>æ„å‘³ç€ä½ å·²ç»å­¦ä¼šäº†ç¼–ç¨‹ï¼Œä½†è‡³å°‘ä½ ä¼šå¯¹ç¼–ç¨‹è¯­è¨€ä»¥åŠç¼–ç¨‹è¿™ä¸ªè¡Œä¸šæœ‰ä¸€ä¸ªåˆæ­¥çš„äº†è§£ã€‚</p></blockquote><ul><li>ã€Šç®€æ˜ Python æ•™ç¨‹ã€‹    ï¼ˆã€ŠA Byte of Pythonã€‹ï¼‰</li></ul><p><a href="https://www.gitbook.com/book/lenkimo/byte-of-python-chinese-edition/details">ç®€æ˜ Python æ•™ç¨‹-Gitbook</a></p><p>çœ‹ä¸€ä¸‹æ¿€åŠ¨äººå¿ƒçš„å‰è¨€ä»‹ç»ï¼š</p><blockquote><p>æœ¬ä¹¦å°†ä»¥æŒ‡å—æˆ–æ•™ç¨‹çš„å½¢å¼å‘ä½ ä»‹ç»<code>Python</code>è¿™é—¨ç¼–ç¨‹è¯­è¨€ã€‚å®ƒä»¥æ–°æ‰‹ä¸ºä¸»è¦ç›®æ ‡ã€‚åŒæ—¶æœ¬ä¹¦ä¹Ÿå¯¹æœ‰ç»éªŒçš„ç¨‹åºå‘˜æœ‰æ‰€å¸®åŠ©ã€‚<br>å¦‚æœä½ å¯¹ç”µè„‘çš„æ‰€æœ‰äº†è§£ä»…æ­¢æ­¥äºå¦‚ä½•ä¿å­˜æ–‡æœ¬æ–‡ä»¶çš„è¯ï¼Œé‚£æœ¬ä¹¦çš„ç›®æ ‡ä¾¿æ˜¯ååŠ©ä½ é€šè¿‡æœ¬ä¹¦å­¦ä¹ <code>Python</code>ã€‚å¦‚æœåœ¨æ­¤ä¹‹å‰ä½ å·²ç»æœ‰äº†ç¼–ç¨‹ç»éªŒï¼Œä½ åŒæ ·å¯ä»¥é€šè¿‡æœ¬ä¹¦æ¥å­¦ä¹ <code>Python</code>ã€‚<br>å¦‚æœä½ å·²ç»æœ‰è¿‡ç¼–ç¨‹ç»éªŒï¼Œä½ æˆ–è®¸ä¼šå¯¹<code>Python</code>ä¸å…¶å®ƒä½ æ‰€å–œçˆ±çš„ç¼–ç¨‹è¯­è¨€é—´æœ‰ä½•åŒºåˆ«æŠ±æœ‰å…´è¶£â€”â€”è€Œæˆ‘å°†ä¼šä½ å±•ç°è®¸å¤šè¿™ç§åŒºåˆ«ã€‚é¡ºä¾¿æé†’ä½ ä¸€ä¸‹ï¼Œ<code>Python</code>å°†ä¼šå¾ˆå¿«æˆä¸ºä½ æœ€å–œæ¬¢çš„ç¼–ç¨‹è¯­è¨€ï¼</p></blockquote><ul><li>ã€Š Python 3 å®˜æ–¹æ•™ç¨‹ã€‹</li></ul><p><a href="http://www.pythondoc.com/pythontutorial3/index.html">Python å…¥é—¨æŒ‡å—ä¸­æ–‡ç‰ˆ</a><br><a href="https://docs.python.org/3/">Python å®˜æ–¹æ•™ç¨‹ï¼ˆè‹±æ–‡åŸç‰ˆï¼‰</a></p><p>æ›´æ–°ã€æƒå¨ã€æ¡ç†åŒ–çš„å®˜æ–¹<code>tutorial</code> ï¼Œæœ€åŸæ±åŸå‘³çš„<code>Python</code>æŒ‡å—ã€‚</p><ul><li>ã€Šé›¶åŸºç¡€å­¦ Pythonã€‹/ã€Šè·Ÿè€é½å­¦ Pythonã€‹</li></ul><p><a href="https://www.gitbook.com/book/looly/python-basic/details">é›¶åŸºç¡€å­¦ Python</a></p><p>è¿™æœ¬æ•™ç¨‹æ˜¯æˆ‘å½“åˆå¼€å§‹è‡ªå­¦çš„æ—¶å€™çœ‹è¿‡çš„ï¼Œç”±äºæ˜¯å›½å†…ä½œè€…ï¼Œè¯­è¨€ä¹ æƒ¯æ›´é€‚åˆæˆ‘ä»¬ï¼Œé¡ºä¾¿ä¹Ÿæ¨èç»™å¤§å®¶ã€‚</p><blockquote><p>åœ¨æˆ‘çœ‹æ¥ï¼Œ<code>Python</code>æ˜¯éå¸¸é€‚åˆä½œä¸ºå­¦ä¹ é«˜çº§è¯­è¨€ç¼–ç¨‹çš„ç¬¬ä¸€é—¨è¯­è¨€çš„ã€‚æœ‰ä¸€æœ¬ä¹¦ï¼Œåå­—å«ã€Šä¸å­©å­ä¸€èµ·å­¦ç¼–ç¨‹ã€‹ï¼Œè¿™æœ¬ä¹¦çš„å®šä½ï¼Œæ˜¯å°† python å®šä½ä¸ºå­¦ä¹ è€…å­¦ä¹ çš„ç¬¬ä¸€é—¨é«˜çº§ç¼–ç¨‹è¯­è¨€ã€‚ç„¶è€Œï¼Œç”±äºè¯»è€…å¯¹è±¡æ˜¯å­©å­ï¼Œå¾ˆå¤šâ€œæˆå¹´äººâ€ä¸å±‘ä¸€é¡¾ï¼Œå½“ç„¶ï¼Œé‡Œé¢çš„è®²æ³•ä¸â€œå®æˆ˜â€æœ‰ç‚¹è·ç¦»ï¼Œå¯¼è‡´ä»¥â€œæ‰¾å·¥ä½œâ€ã€â€œå·¥ä½œéœ€è¦â€ä¸ºç›®æ ‡çš„å­¦ä¹ è€…ï¼Œè®¤ä¸ºè¿™æœ¬ä¹¦è·Ÿè‡ªå·±è¦å­¦çš„æ–¹å‘ç›¸å·®ç”šè¿œã€‚<br>ä¸ºäº†å¼¥è¡¥é‚£æœ¬ä¹¦çš„ç¼ºæ†¾ï¼Œæˆ‘åœ¨è¿™é‡Œæ¨å‡ºé¢å‘æˆå¹´äººâ€”â€”å¤§å­¦ç”Ÿã€æˆ–è€…å…¶ä»–æƒ³å­¦ä¹ ç¨‹åºä½†æ˜¯æ²¡æœ‰ä»»ä½•ç¼–ç¨‹åŸºç¡€çš„æœ‹å‹â€”â€”å­¦ä¹ ç¬¬ä¸€é—¨ç¼–ç¨‹é«˜çº§è¯­è¨€çš„æ•™ç¨‹ã€‚</p></blockquote><p>è¯»å®Œä¸Šé¢çš„ä¹¦ï¼Œä½ å·²ç»æŒæ¡<code>Python</code>çš„è¯­æ³•ç‰¹ç‚¹ï¼Œå¯ä»¥çœ‹æ‡‚è¯­è¨€é€»è¾‘ï¼Œä¹Ÿå¯ä»¥æŒ‰ç…§è‡ªå·±çš„æƒ³æ³•å†™ä¸€ç‚¹å°<code>demo</code>äº†ã€‚è¿™ä¸ªæ—¶å€™ï¼Œå¦‚æœæ‰“ç®—ä»äº‹ç›¸å…³å·¥ä½œï¼Œå¯ä»¥å°è¯•è¿ˆå‡ºç¬¬ä¸€æ­¥å•¦ã€‚éœ€è¦æé†’å¤§å®¶çš„æ˜¯ï¼šè¯»ä¹¦å’Œåšå†™ä»£ç åº”è¯¥æ˜¯å¹¶é©¾é½é©±çš„ï¼Œä¸èƒ½ä¸€å‘³åœ°å»è¯»ä¹¦ï¼Œä¹Ÿä¸è¦ä¸€å‘³æ•²ä»£ç ã€‚ï¼ˆå½“ç„¶ï¼Œä½ å¯èƒ½ä¹Ÿå†™ä¸å‡ºæ¥ï¼‰åªæœ‰ç›¸äº’æœ‰æœºç»“åˆï¼Œæ‰èƒ½è®°å¾—ç¨³å›ºï¼Œå­¦å¾—ç‰¢é ã€‚</p><h2 id="è¿›é˜¶ç¯‡"><a href="#è¿›é˜¶ç¯‡" class="headerlink" title="è¿›é˜¶ç¯‡"></a>è¿›é˜¶ç¯‡</h2><ul><li>ã€Šæµç•…çš„ Pythonã€‹   (ã€ŠFluent Python-Clear, Concise, and Effective Programmingã€‹)</li></ul><p><a href="https://github.com/cundi/fluent-python">æµç•…çš„ Python(æœªå®Œæˆ)</a></p><blockquote><p>è¿™æœ¬ä¹¦å¹¶ä¸æ˜¯ä¸€æœ¬å®Œå¤‡çš„ <code>Python</code> ä½¿ç”¨æ‰‹å†Œï¼Œè€Œæ˜¯ä¼šå¼ºè°ƒ <code>Python</code> ä½œä¸ºç¼–ç¨‹è¯­è¨€ç‹¬æœ‰çš„ç‰¹æ€§ï¼Œè¿™äº›ç‰¹æ€§æˆ–è€…æ˜¯åªæœ‰ <code>Python</code> æ‰å…·å¤‡çš„ï¼Œæˆ–è€…æ˜¯åœ¨å…¶ä»–å¤§ä¼—è¯­è¨€é‡Œå¾ˆå°‘è§çš„ã€‚æœ¬ä¹¦çš„ç›®æ ‡è¯»è€…æ˜¯é‚£äº›æ­£åœ¨ä½¿ç”¨ <code>Python</code>ï¼Œåˆæƒ³ç†Ÿæ‚‰ <code>Python 3</code> çš„ç¨‹åºå‘˜ã€‚æœ¬ä¹¦çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†å……åˆ†åœ°å±•ç° <code>Python 3.4</code> çš„é­…åŠ›ã€‚</p></blockquote><ul><li>ã€Šã€ŠPython Cookbookã€‹3rd Edition ã€‹</li></ul><p><a href="https://python3-cookbook.readthedocs.io/zh_CN/latest/">Python Cookbook</a></p><blockquote><p>è¿™æœ¬ä¹¦çš„ç›®æ ‡è¯»è€…æ˜¯é‚£äº›æƒ³æ·±å…¥ç†è§£<code>Python</code>è¯­è¨€æœºåˆ¶å’Œç°ä»£ç¼–ç¨‹é£æ ¼çš„æœ‰ç»éªŒçš„<code>Python</code>ç¨‹åºå‘˜ã€‚æœ¬ä¹¦å¤§éƒ¨åˆ†å†…å®¹é›†ä¸­äºåœ¨æ ‡å‡†åº“ï¼Œæ¡†æ¶å’Œåº”ç”¨ç¨‹åºä¸­å¹¿æ³›ä½¿ç”¨çš„é«˜çº§æŠ€æœ¯ã€‚<br>æœ¬ä¹¦æ‰€æœ‰ç¤ºä¾‹å‡å‡è®¾è¯»è€…å…·æœ‰ä¸€å®šçš„ç¼–ç¨‹èƒŒæ™¯å¹¶ä¸”å¯ä»¥è¯»æ‡‚ç›¸å…³ä¸»é¢˜ ï¼ˆæ¯”å¦‚åŸºæœ¬çš„è®¡ç®—æœºç§‘å­¦çŸ¥è¯†ï¼Œæ•°æ®ç»“æ„çŸ¥è¯†ï¼Œç®—æ³•å¤æ‚åº¦ï¼Œç³»ç»Ÿç¼–ç¨‹ï¼Œå¹¶è¡Œï¼ŒC è¯­è¨€ç¼–ç¨‹ç­‰ï¼‰ã€‚ å¦å¤–ï¼Œæ¯ä¸ªç¤ºä¾‹éƒ½åªæ˜¯ä¸€ä¸ªå…¥é—¨æŒ‡å¯¼ï¼Œå¦‚æœè¯»è€…æƒ³æ·±å…¥ç ”ç©¶ï¼Œéœ€è¦è‡ªå·±å»æŸ¥é˜…æ›´å¤šèµ„æ–™ã€‚æˆ‘ä»¬å‡å®šè¯»è€…å¯ä»¥å¾ˆç†Ÿç»ƒçš„ä½¿ç”¨æœç´¢å¼•æ“ä»¥åŠçŸ¥é“æ€æ ·æŸ¥è¯¢åœ¨çº¿çš„<code>Python</code>æ–‡æ¡£ã€‚</p></blockquote><p>è¯»å®Œä¸Šé¢çš„ä¹¦ï¼Œä½ å·²ç»å¯ä»¥å†™å‡º<code>Pythonic</code>çš„ä»£ç äº†ï¼Œåº”è¯¥å¯¹<code>Python</code>æœ‰äº†è‡ªå·±çš„ç†è§£ï¼Œå¹¶ä¸”ä¹Ÿä¼šæœ‰è‡ªå·±çš„æ–¹å‘ï¼Œå¯ä»¥ç¡®å®šè‡ªå·±çš„å‘å±•æ–¹å‘ï¼šWeb åº”ç”¨å¼€å‘ã€çˆ¬è™«æ•°æ®åˆ†æã€ç½‘ç»œå®‰å…¨ã€è¿ç»´æµ‹è¯•ã€<code>Linux</code>ç³»ç»Ÿå¼€å‘ã€äººå·¥æ™ºèƒ½/æœºå™¨å­¦ä¹ ã€‚ç›¸ä¿¡è¿™ä¸ªæ—¶å€™ä½ å·²ç»ä¸å†éœ€è¦åˆ«äººçš„æ¨èï¼Œé‚£ä¹ˆæ˜¯æ—¶å€™ä¸º<code>Python</code>çš„è“¬å‹ƒå‘å±•è´¡çŒ®è‡ªå·±çš„åŠ›é‡å•¦ï¼</p><h2 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="headerlink" title="æ¨èé˜…è¯»"></a>æ¨èé˜…è¯»</h2><p><a href="https://foofish.net/python-free-ebook.html">å…è´¹ä¸­æ–‡ Python ç”µå­ä¹¦ï¼ˆæ•™ç¨‹ï¼‰</a><br><a href="https://github.com/Junnplus/awesome-python-books/blob/master/README-ZH_CN.md">Awesome Python Books</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨ Python è¿›è¡Œè®¡æ•°ç»Ÿè®¡</title>
      <link href="blog/2017-11-21/how-to-count-sequense-with-python/"/>
      <url>blog/2017-11-21/how-to-count-sequense-with-python/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><h2 id="ä½¿ç”¨å¸¸è§„forå¾ªç¯"><a href="#ä½¿ç”¨å¸¸è§„forå¾ªç¯" class="headerlink" title="ä½¿ç”¨å¸¸è§„forå¾ªç¯"></a>ä½¿ç”¨å¸¸è§„<code>for</code>å¾ªç¯</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">In [<span class="number">53</span>]: test_seq = <span class="string">&#x27;asfsdgfads&#x27;</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">54</span>]: count_dict = <span class="built_in">dict</span>()</span><br><span class="line"></span><br><span class="line">In [<span class="number">55</span>]: <span class="keyword">for</span> item <span class="keyword">in</span> test_seq:</span><br><span class="line">    ...:     <span class="keyword">if</span> item <span class="keyword">in</span> count_dict:</span><br><span class="line">    ...:         count_dict[item] += <span class="number">1</span></span><br><span class="line">    ...:     <span class="keyword">else</span>:</span><br><span class="line">    ...:         count_dict[item] = <span class="number">0</span></span><br><span class="line">    ...:</span><br><span class="line"></span><br><span class="line">In [<span class="number">56</span>]: count_dict</span><br><span class="line">Out[<span class="number">56</span>]: &#123;<span class="string">&#x27;a&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;d&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;f&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;g&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;s&#x27;</span>: <span class="number">2</span>&#125;</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨collectionsåº“ä¸­çš„defaultdict"><a href="#ä½¿ç”¨collectionsåº“ä¸­çš„defaultdict" class="headerlink" title="ä½¿ç”¨collectionsåº“ä¸­çš„defaultdict"></a>ä½¿ç”¨<code>collections</code>åº“ä¸­çš„<code>defaultdict</code></h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">In [<span class="number">57</span>]: <span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line"></span><br><span class="line">In [<span class="number">58</span>]: cd_dict = defaultdict()</span><br><span class="line"></span><br><span class="line">In [<span class="number">59</span>]: cd_dict = defaultdict(<span class="built_in">int</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">60</span>]: <span class="keyword">for</span> item <span class="keyword">in</span> test_seq:</span><br><span class="line">    ...:     cd_dict[item] += <span class="number">1</span></span><br><span class="line">    ...:</span><br><span class="line">In [<span class="number">62</span>]: cd_dict</span><br><span class="line">Out[<span class="number">62</span>]: defaultdict(<span class="built_in">int</span>, &#123;<span class="string">&#x27;a&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;d&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;f&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;g&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;s&#x27;</span>: <span class="number">3</span>&#125;)</span><br><span class="line">In [<span class="number">63</span>]: cd_dict.items()</span><br><span class="line">Out[<span class="number">63</span>]: [(<span class="string">&#x27;a&#x27;</span>, <span class="number">2</span>), (<span class="string">&#x27;s&#x27;</span>, <span class="number">3</span>), (<span class="string">&#x27;d&#x27;</span>, <span class="number">2</span>), (<span class="string">&#x27;g&#x27;</span>, <span class="number">1</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="number">2</span>)]</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨collectionsåº“ä¸­çš„Counter"><a href="#ä½¿ç”¨collectionsåº“ä¸­çš„Counter" class="headerlink" title="ä½¿ç”¨collectionsåº“ä¸­çš„Counter"></a>ä½¿ç”¨<code>collections</code>åº“ä¸­çš„<code>Counter</code></h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">In [<span class="number">64</span>]: <span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"></span><br><span class="line">In [<span class="number">65</span>]: Counter(test_data)</span><br><span class="line">Out[<span class="number">65</span>]: Counter(&#123;<span class="string">&#x27;a&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;d&#x27;</span>: <span class="number">3</span>, <span class="string">&#x27;g&#x27;</span>: <span class="number">3</span>, <span class="string">&#x27;h&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;s&#x27;</span>: <span class="number">2</span>&#125;)</span><br><span class="line"></span><br><span class="line">In [<span class="number">84</span>]: counter = Counter(test_seq)</span><br><span class="line"></span><br><span class="line">In [<span class="number">85</span>]: counter.items()</span><br><span class="line">Out[<span class="number">85</span>]: [(<span class="string">&#x27;a&#x27;</span>, <span class="number">2</span>), (<span class="string">&#x27;s&#x27;</span>, <span class="number">3</span>), (<span class="string">&#x27;d&#x27;</span>, <span class="number">2</span>), (<span class="string">&#x27;g&#x27;</span>, <span class="number">1</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="number">2</span>)]</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒä¹¦ç±"><a href="#å‚è€ƒä¹¦ç±" class="headerlink" title="å‚è€ƒä¹¦ç±"></a>å‚è€ƒä¹¦ç±</h2><ul><li>ã€Šç¼–å†™é«˜è´¨é‡ä»£ç ï¼šæ”¹å–„ Python ç¨‹åºçš„ 91 ä¸ªå»ºè®®ã€‹è¿·ä½ ä¹¦-å»ºè®® 39ï¼šä½¿ç”¨ Counter è¿›è¡Œè®¡æ•°ç»Ÿè®¡</li></ul>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> HOWTO </tag>
            
            <tag> ç¼–ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç£ç›˜é˜µåˆ—æ§åˆ¶å¡ï¼ˆRAID å¡ï¼‰MegaCli å¸¸ç”¨ç®¡ç†å‘½ä»¤æ±‡æ€»</title>
      <link href="blog/2017-11-20/megacli-command-share/"/>
      <url>blog/2017-11-20/megacli-command-share/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><p>è¿›è¡Œå­˜å‚¨å¼€å‘æ—¶éœ€è¦åˆ›å»ºç£ç›˜é˜µåˆ—ï¼Œæœ¬æ–‡ä¸»è¦è®°å½• RAID å¡ç®¡ç†å·¥å…·<code>MegaCli</code>çš„ä½¿ç”¨ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç›®å‰è¯¥ç®¡ç†å·¥å…·å› ä¸ºå•†ä¸šæ”¶è´­å·²ç»è¢«å®˜æ–¹â€œå¼ƒå‘â€ï¼Œ<code>StorCLI</code>ä½œä¸ºåç»§è€…æ•´åˆäº†<code>LSI</code>å’ŒåŸæ¥<code>3ware</code>çš„äº§å“æ”¯æŒï¼Œå…¼å®¹<code>MegaCLI</code>å‘½ä»¤çš„åŒæ—¶æ›´åŠ ç®€æ´ï¼Œå‚é˜…<a href="/blog/2017-12-27/storcli_command_share/">æ­¤ç¯‡</a>ã€‚<br><a id="more"></a></p><h2 id="å·¡è¯»"><a href="#å·¡è¯»" class="headerlink" title="å·¡è¯»"></a>å·¡è¯»</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">ç«‹å³æ¿€æ´»</span></span><br><span class="line">MegaCli -adppr -enblauto -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">è®¾ç½®æˆæ‰‹åŠ¨æ¨¡å¼ï¼Œéœ€è¦ç”¨MegaCli -adppr -start â€“a0 æ¥æ¿€æ´»</span></span><br><span class="line">MegaCli -adppr -enblman -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">æŸ¥çœ‹å·¡è¯»çš„æ¨¡å¼ï¼Œæœ¬æ¬¡å·¡è¯»ç»“æŸä¸ä¸‹ä¸€æ¬¡å¼€å§‹å·¡è¯»çš„é—´éš”ï¼Œå½“å‰çŠ¶æ€ç­‰ä¿¡æ¯</span></span><br><span class="line">MegaCli -adppr -info -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">æŸ¥çœ‹å·¡è¯»çš„è¿›åº¦</span></span><br><span class="line">MegaCli -fwtermlog -dsply -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">ç»“æŸå·¡è¯»ï¼Œåœ¨å·¡è¯»è¿‡ç¨‹ä¸­ï¼Œå¤šæ¬¡è¿ç”¨MegaCli -adppr -stop -a0æˆ–MegaCli -adppr -start -a0ä¼šä½¿å ä»£æ•°å¢åŠ ï¼Œæ­¤æ—¶å¯èƒ½ä¸èƒ½å¼€å§‹æˆ–ç»“æŸå·¡è¯»ï¼Œç”¨MegaCli -adppr -dsbl -a0æ¥ç¦æ­¢å·¡è¯»ï¼Œé‡æ–°å¼€å§‹ã€‚</span></span><br><span class="line">MegaCli -adppr -stop -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">è®¾ç½®æœ¬æ¬¡å·¡è¯»ç»“æŸä¸ä¸‹ä¸€æ¬¡å·¡è¯»å¼€å§‹çš„æ—¶é—´é—´éš”ï¼Œé»˜è®¤æ˜¯168å°æ—¶ï¼Œå½“val=0æ—¶, æœ¬æ¬¡å·¡è¯»ç»“æŸåï¼Œç«‹å³å¼€å§‹ä¸‹ä¸€æ¬¡å·¡è¯»</span></span><br><span class="line">MegaCli -adppr -setdelay val -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">å·¡è¯»æ—¶æ˜¯å¦çº æ­£åª’ä»‹é”™è¯¯</span></span><br><span class="line">MegaCli -AdpSetProp -PrCorrectUncfgdAreas -val -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">è®¾ç½®å®šæ—¶å·¡è¯» yyyymmdd hhï¼Œå…·ä½“å«ä¹‰å¦‚ä¸‹ï¼š20120108 16è¡¨ç¤º2012å¹´01æœˆ08æ—¥16ç‚¹</span></span><br><span class="line">MegaCli -AdpPR -SetStartTime yyyymmdd hh -a0</span><br></pre></td></tr></table></figure><h2 id="cc-æ ¡éªŒ"><a href="#cc-æ ¡éªŒ" class="headerlink" title="cc æ ¡éªŒ"></a>cc æ ¡éªŒ</h2><ul><li>ç«‹å³å¼€å§‹ cc æ ¡éªŒ</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">L0è¡¨ç¤ºTarget ID ä¸º0çš„raidç»„</span></span><br><span class="line">MegaCli -ldcc -start -L0 â€“a0</span><br><span class="line"><span class="meta">#</span><span class="bash">å¦‚æœæ²¡æœ‰å®Œå…¨åˆå§‹åŒ–æˆ–åå°åˆå§‹åŒ–</span></span><br><span class="line"><span class="meta">#</span><span class="bash">The virtual disk has not been initializedã€ Running a consistency check may result <span class="keyword">in</span> inconsistent messages <span class="keyword">in</span> the <span class="built_in">log</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">å¯ä»¥å¼ºè¡Œccæ ¡éªŒ</span></span><br><span class="line">MegaCli -ldcc -start -force â€“L0 â€“a0</span><br><span class="line"><span class="meta">#</span><span class="bash">æ˜¾ç¤ºå½“å‰ccæ ¡éªŒçš„è¿›åº¦</span></span><br><span class="line">MegaCli -ldcc -progdsply -L0 -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">å…³æ‰å½“å‰çš„ccæ ¡éªŒ</span></span><br><span class="line">MegaCli -ldcc -abort -L0 -a0</span><br></pre></td></tr></table></figure><ul><li>è®¡åˆ’ cc æ ¡éªŒ<br>å¦‚æœæ¨¡å¼ä¸º disable(MegaCli -adpccsched -info -a0 æ¥æŸ¥çœ‹)ï¼Œåˆ™ä¸‹ä¸€æ¬¡å¼€å§‹æ—¶é—´ä¸º 07/28/2135, 02:00:00ï¼ŒçŠ¶æ€ä¸º Stoppedï¼Œå»¶æœŸä¸º 168 ä¸ªå°æ—¶;<br>åªæœ‰æ¨¡å¼ä¸º Sequential å’Œ Concurrent æ¨¡å¼æ—¶ï¼Œæ‰å¯ä»¥è®¾å®šå®šæœŸæ—¶é—´ï¼Œæ‰€ä»¥è¦é¦–å…ˆè®¾å®šæ¨¡å¼;<br>å¦‚æœæ¨¡å¼ä¸º Sequential æ—¶ï¼Œæ‰€æœ‰è™šæ‹Ÿç£ç›˜ç»„é¡ºåºè¿›è¡Œ cc æ ¡éªŒ;<br>å¦‚æœæ¨¡å¼ä¸º Concurrent æ—¶ï¼Œæ‰€æœ‰è™šæ‹Ÿç£ç›˜ç»„åŒæ—¶è¿›è¡Œ cc æ ¡éªŒ;<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">è®¾å®šCCæ¨¡å¼</span></span><br><span class="line">MegaCli -adpccsched -modeconc -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">æˆ–è€…</span></span><br><span class="line">MegaCli -adpccsched -modeseq -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">ç„¶åè®¾å®šå¼€å§‹æ—¶é—´</span></span><br><span class="line">MegaCli -adpccsched setstarttime 20101122 18 -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">è®¾ç½®æœ¬æ¬¡ccæ ¡éªŒç»“æŸå’Œä¸‹æ¬¡ccæ ¡éªŒå¼€å§‹çš„æ—¶é—´é—´éš”</span></span><br><span class="line">MegaCli -adpccsched -setdelay 2 -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">ç¦æ­¢è®¡åˆ’ccæ ¡éªŒ</span></span><br><span class="line">MegaCli -AdpCcSched -dsbl -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">è®¾ç½®é”™è¯¯å‘ç”Ÿæ—¶æ”¾å¼ƒccæ ¡éªŒ</span></span><br><span class="line">MegaCli -adpsetprop -AbortCC -1 -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">æŸ¥çœ‹ccæ ¡éªŒçš„äº‹ä»¶æ—¥å¿—</span></span><br><span class="line">MegaCli -AdpEventLog -GetCCIncon â€“f filename â€“L0 â€“a0</span><br><span class="line"><span class="meta">#</span><span class="bash">å¦‚æœè®¾ç½®å»¶æœŸæ—¶é—´ä¸º0ï¼Œæœ¬æ¬¡ccæ ¡éªŒç»“æŸåï¼Œä¸‹ä¸€æ¬¡ccæ ¡éªŒä¼šç«‹å³å¼€å§‹</span></span><br></pre></td></tr></table></figure><h2 id="å¿«é€Ÿåˆå§‹åŒ–å’Œå®Œå…¨åˆå§‹åŒ–"><a href="#å¿«é€Ÿåˆå§‹åŒ–å’Œå®Œå…¨åˆå§‹åŒ–" class="headerlink" title="å¿«é€Ÿåˆå§‹åŒ–å’Œå®Œå…¨åˆå§‹åŒ–"></a>å¿«é€Ÿåˆå§‹åŒ–å’Œå®Œå…¨åˆå§‹åŒ–</h2>å¿«é€Ÿåˆå§‹åŒ–å€¼æ˜¯å¾€ raid ç»„çš„å‰ 8M å’Œå 8M å†™ 0<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">å¿«é€Ÿåˆå§‹åŒ–</span></span><br><span class="line">MegaCli -LDInit -start â€“L0 -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">å®Œå…¨åˆå§‹åŒ–</span></span><br><span class="line">MegaCli -LDInit -start -full â€“L0 -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">æ˜¾ç¤ºåˆå§‹åŒ–çš„è¿›åº¦</span></span><br><span class="line">MegaCli -LDInit -progdsply -L0 -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">ç»“æŸå®Œå…¨åˆå§‹åŒ–</span></span><br><span class="line">MegaCli -LDInit -abort -L0 -a0</span><br></pre></td></tr></table></figure><h2 id="åå°åˆå§‹åŒ–"><a href="#åå°åˆå§‹åŒ–" class="headerlink" title="åå°åˆå§‹åŒ–"></a>åå°åˆå§‹åŒ–</h2>Raid5 éœ€è¦ 5 ä¸ªæ•°æ®ç›˜æ‰å¯ä»¥åå°åˆå§‹åŒ–(5 ä¸ªç›˜ä¸­ä¸åŒ…å«çƒ­å¤‡ç›˜)<br>åå°åˆå§‹åŒ–æ˜¯åˆ›å»º raid å 5 åˆ†é’Ÿå¼€å§‹çš„(å¥½åƒæœ‰æ—¶ä¸æ˜¯è¿™æ ·çš„)<br>åå°åˆå§‹åŒ–å’Œ cc æ ¡éªŒä¸åŒçš„åœ°æ–¹æ˜¯ï¼Œåå°åˆå§‹åŒ–å¯ä»¥è‡ªåŠ¨å¼€å§‹<br>æ”¹å˜åå°åˆå§‹åŒ–ç‡æ—¶ï¼Œéœ€è¦åœæ­¢åå°åˆå§‹åŒ–ï¼Œå¦åˆ™æ²¡æœ‰æ•ˆæœ<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">ç¦æ­¢åå°åˆå§‹åŒ–</span></span><br><span class="line">MegaCli -LDBI -dsbl -L0 -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">ç»“æŸæ­£åœ¨è¿›è¡Œçš„åå°åˆå§‹åŒ–</span></span><br><span class="line">MegaCli -LDBI -abort -L0 -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">æŸ¥çœ‹åå°åˆå§‹åŒ–çš„è®¾ç½®</span></span><br><span class="line">MegaCli -LDBI -getsetting -L0 -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">æ˜¾ç¤ºåå°åˆå§‹åŒ–è¿›åº¦</span></span><br><span class="line">MegaCli -LDBI -progdsply -L0 -a0</span><br></pre></td></tr></table></figure><h2 id="copyback"><a href="#copyback" class="headerlink" title="copyback"></a>copyback</h2></li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">å¼€å¯æˆ–ç¦ç”¨copyback</span></span><br><span class="line">MegaCli -AdpSetProp â€“CopyBackDsbl -0 -a0 (å¼€å¯)</span><br><span class="line"><span class="meta">#</span><span class="bash">æ˜¾ç¤ºcopybackè®¾ç½®æƒ…å†µ</span></span><br><span class="line">MegaCli â€“AdpGetProp -CopyBackDsbl â€“a0</span><br></pre></td></tr></table></figure><p>å½“è®¾ç½® copyback ä¸º enable æ—¶ï¼Œæ‹”å‡ºåç›˜ï¼Œæ¢ä¸Šä¸€ä¸ª UNCONF çš„æ–°ç›˜ï¼Œå…ˆç”¨çƒ­å¤‡ç›˜è¿›è¡Œé‡å»ºï¼Œç„¶åè¿›è¡Œ copyback æ“ä½œï¼Œå¦‚æœ copyback ä¸º disable æ—¶ï¼Œä¸è¿›è¡Œ copyback æ“ä½œï¼Œå¯ä»¥è®¾å®š copyback ä¸º enableï¼Œç„¶åç”¨ MegaCli -PDCpyBk -Start -PhysDrv[E0:S0,E1:S1] â€“a0 å¼€å§‹ copyback æ“ä½œï¼Œå…¶ä¸­[E0ï¼šS0]æ˜¯ raid ç»„ä¸­çš„ç£ç›˜(æºç›˜)ï¼Œè€Œ[E1ï¼šS1]ä¸æ˜¯ raid ç»„ä¸­çš„ç£ç›˜(ç›®çš„ç›˜)</p><p>å½“æŸä¸ªç›˜å‡ºç°ç¬¬ä¸€ä¸ª smart é”™è¯¯æ—¶ï¼Œå¯ä»¥åœ¨è¿™ä¸ªç›˜å’Œçƒ­å¤‡ç›˜ä¹‹é—´è¿›è¡Œ copyback æ“ä½œï¼Œçƒ­å¤‡ç›˜ä½œä¸ºç›®çš„ç›˜ï¼Œå®Œæˆäº† copyback æ“ä½œæ—¶ï¼Œsmart é”™è¯¯ç›˜æ‰æ ‡è®°ä¸º failed çŠ¶æ€ã€‚<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">å¦‚æœåœ¨copybackæ—¶ï¼Œraidç»„åˆ é™¤ï¼Œç›®çš„ç›˜å›åˆ°çƒ­å¤‡ç›˜çŠ¶æ€æˆ–Unconfigured Good</span></span><br><span class="line">MegaCli -AdpGetProp SMARTCpyBkEnbl -a0</span><br></pre></td></tr></table></figure></p><h2 id="æ—¥å¿—"><a href="#æ—¥å¿—" class="headerlink" title="æ—¥å¿—"></a>æ—¥å¿—</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">æŸ¥çœ‹æ‰€æœ‰çš„informationæ—¥å¿—</span></span><br><span class="line">MegaCli -adpalilog -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">æŸ¥çœ‹å›ºä»¶è°ƒè¯•æ—¥å¿—(å›ºä»¶ç»ˆç«¯æ—¥å¿—)</span></span><br><span class="line">MegaCli -fwtermlog -dsply -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">æŸ¥çœ‹raidå¡æ—¥å¿—</span></span><br><span class="line">MegaCli -adpeventlog -getevents -f filename -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">æ¸…é™¤æ—¥å¿—</span></span><br><span class="line">MegaCli -AdpEventLog -Clear â€“a0</span><br></pre></td></tr></table></figure><h2 id="raid5-æ‰©å®¹"><a href="#raid5-æ‰©å®¹" class="headerlink" title="raid5 æ‰©å®¹"></a>raid5 æ‰©å®¹</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">raid5çš„æ‰©å®¹</span></span><br><span class="line">MegaCli -LDRecon -Start -r5 -Add -Physdrv[E0:S0] -L0 -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">æŸ¥çœ‹æ‰©å®¹çš„è¿›åº¦</span></span><br><span class="line">MegaCli -LDRecon -progdsply -L0 â€“a0</span><br></pre></td></tr></table></figure><h2 id="çº§åˆ«è¿ç§»"><a href="#çº§åˆ«è¿ç§»" class="headerlink" title="çº§åˆ«è¿ç§»"></a>çº§åˆ«è¿ç§»</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">åœ¨è¿ç§»è¿‡ç¨‹ä¸­ï¼Œè½¬æ¢å‰çš„raidçš„ä¸€ä¸ªç›˜ä¸‹çº¿ï¼Œè½¬æ¢å‰raidçš„æ‰€æœ‰ç›˜éƒ½ä¸‹çº¿</span><br><span class="line">æ”¯æŒçš„ç±»å‹ RAID 0 to RAID 1ï¼ŒRAID 0 to RAID 5ï¼ŒRAID 0 to RAID 6ï¼ŒRAID 1 to RAID 0ï¼ŒRAID 1 to RAID 5ï¼ŒRAID 1 to RAID 6ï¼ŒRAID 5 to RAID 0ï¼ŒRAID 5 to RAID 6ï¼ŒRAID 6 to RAID 0ï¼ŒRAID 6 to RAID 5</span><br><span class="line"><span class="meta">#</span><span class="bash">å»ºç«‹äº†ä¸‰ä¸ªç›˜çš„raid 0</span></span><br><span class="line">MegaCli -cfgldadd -r0[117:1,117:3,117:11] -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">å¢åŠ ä¸€ä¸ªç›˜[117:14],è½¬æ¢åˆ°raid5</span></span><br><span class="line">MegaCli -ldrecon -start -r5 -add -physdrv[117:14] -l0 -a0</span><br></pre></td></tr></table></figure><h2 id="å‡çº§-ROM"><a href="#å‡çº§-ROM" class="headerlink" title="å‡çº§ ROM"></a>å‡çº§ ROM</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">ä»ä½ç‰ˆæœ¬åˆ°é«˜ç‰ˆæœ¬å‡çº§</span></span><br><span class="line">MegaCli -adpfwflash -f x.rom -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">ä»é«˜ç‰ˆæœ¬åˆ°ä½ç‰ˆæœ¬é™çº§</span></span><br><span class="line"><span class="meta">#</span><span class="bash">åŠ ä¸Šnoverchkå¿½ç•¥ç‰ˆæœ¬çš„æ£€æŸ¥ï¼Œå‡çº§ä»¥åéœ€è¦é‡å¯æ‰ç”Ÿæ•ˆ</span></span><br><span class="line">MegaCli -adpfwflash -f x.rom -noverchk -a0</span><br></pre></td></tr></table></figure><h2 id="è¿æ¥æ–¹å¼"><a href="#è¿æ¥æ–¹å¼" class="headerlink" title="è¿æ¥æ–¹å¼"></a>è¿æ¥æ–¹å¼</h2><p>Raid å¯¹å†…æœ‰ä¸¤ä¸ªæ¥å£ï¼Œå³ connector0 å’Œ connector1ã€‚å¾—åˆ°è¿æ¥å™¨çš„çŠ¶æ€;<br> MegaCli -adpgetconnectormode -connector0 -a0<br>å¦‚æœè¿æ¥å™¨çš„æ¨¡å¼ä¸º internal æ—¶ï¼Œjbod çš„ç£ç›˜å…¨éƒ¨çœ‹ä¸åˆ°ï¼Œå¦‚æœè¿æ¥å™¨çš„æ¨¡å¼ä¸º external æ—¶ï¼Œä¸»æŸœä¸Šçš„ç£ç›˜å…¨éƒ¨çœ‹ä¸åˆ°;</p><h2 id="å¤–æ¥é…ç½®"><a href="#å¤–æ¥é…ç½®" class="headerlink" title="å¤–æ¥é…ç½®"></a>å¤–æ¥é…ç½®</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">æ‰«æå¤–æ¥é…ç½®çš„ä¸ªæ•°</span></span><br><span class="line">MegaCli -cfgforeign -scan -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">æŸ¥çœ‹å½“å‰çš„ç£ç›˜åœ¨normalæ—¶çš„ä½ç½®</span></span><br><span class="line">MegaCli -cfgforeign -preview -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">æ¥å¯¼å…¥é…ç½®ï¼Œæ¢å¤è™šæ‹Ÿç£ç›˜ç»„</span></span><br><span class="line">MegaCli -cfgforeign -import -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">æ¸…é™¤å¤–æ¥é…ç½®</span></span><br><span class="line">MegaCli -cfgforeign -clear -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">æ˜¾ç¤ºå‡ºç°å¤–æ¥é…ç½®(ç£ç›˜æ’å…¥çš„é¡ºåº)çš„è¿‡ç¨‹</span></span><br><span class="line">MegaCli -cfgforeign -dsply -a0</span><br></pre></td></tr></table></figure><h2 id="ç‰©ç†ç£ç›˜çš„å¤„ç†"><a href="#ç‰©ç†ç£ç›˜çš„å¤„ç†" class="headerlink" title="ç‰©ç†ç£ç›˜çš„å¤„ç†"></a>ç‰©ç†ç£ç›˜çš„å¤„ç†</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">ç£ç›˜çš„çŠ¶æ€ç”±FAULTYå˜æˆCONF</span></span><br><span class="line">MegaCli -PDMakeGood -PhysDrv[E0:S0] â€“a0</span><br><span class="line"><span class="meta">#</span><span class="bash">ç£ç›˜ä¸Šçº¿</span></span><br><span class="line">MegaCli -PDOnline -PhysDrv[E0:S0,E1:S1,...] â€“a0</span><br><span class="line"><span class="meta">#</span><span class="bash">ç£ç›˜ä¸‹çº¿</span></span><br><span class="line"><span class="meta">#</span><span class="bash">failedçŠ¶æ€çš„ç›˜å¯ä»¥ä¸‹çº¿ï¼Œç„¶åç”¨MegaCli -pdmarkmissing -physdrv[E0:S0] -a0è®©ç£ç›˜è¸¢ç›˜ï¼Œè®©å…¶ä»–çš„UNCONFçŠ¶æ€çš„ç£ç›˜æ¥æ›¿ä»£è¿™ä¸ªç›˜MegaCli -PdReplaceMissing -physdrv[E0:S0] -arrayA, -rowB -a0</span></span><br><span class="line">MegaCli -PDOffline -PhysDrv[E0:S0,E1:S1,...] â€“a0 </span><br><span class="line"><span class="meta">#</span><span class="bash">æ­¤æ—¶ç£ç›˜å¤„äºSpun downçŠ¶æ€ï¼Œå¦‚æœç”¨æ­¤ç£ç›˜æ¥å»ºç«‹raidï¼Œåˆ™ç£ç›˜çš„çŠ¶æ€è‡ªåŠ¨å˜æˆSpun Up</span></span><br><span class="line">MegaCli -PdPrpRmv -physdrv[E0:S0] â€“a0</span><br><span class="line"><span class="meta">#</span><span class="bash">æ¸…é™¤å•ä¸ªç£ç›˜</span></span><br><span class="line">MegaCli -pdclear -start -physdrv[E:S] -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">è®¾ç½®çƒ­å¤‡ç›˜çš„èŠ‚ç”µç­–ç•¥</span></span><br><span class="line">MegaCli -AdpSetProp â€“DsblSpinDownHSP -val â€“a0</span><br><span class="line"><span class="meta">#</span><span class="bash">è®¾ç½®ç©ºé—²ç›˜çš„èŠ‚ç”µç­–ç•¥</span></span><br><span class="line">MegaCli -AdpSetProp â€“EnblSpinDownUnConfigDrvs -val â€“a0</span><br><span class="line"><span class="meta">#</span><span class="bash">è·å–æ‰€æœ‰ç£ç›˜çš„è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">MegaCli -PDList â€“a0</span><br><span class="line"><span class="meta">#</span><span class="bash">è·å–å•ä¸ªç›˜çš„è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">MegaCli -pdInfo -PhysDrv[E0:S0] â€“a0</span><br></pre></td></tr></table></figure><h2 id="Adpsetprop-è®¾ç½®å±æ€§"><a href="#Adpsetprop-è®¾ç½®å±æ€§" class="headerlink" title="Adpsetprop è®¾ç½®å±æ€§"></a>Adpsetprop è®¾ç½®å±æ€§</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">RebuildRate ï¼ŒPatrolReadRateï¼ŒBgiRateï¼ŒCCRateï¼ŒReconRateï¼Œè¡¨ç¤ºè¿›è¡Œé‡å»ºï¼Œå·¡è¯»ï¼Œåå°åˆå§‹åŒ–ï¼Œccæ ¡éªŒï¼Œæ‰©å®¹ç­‰æ‰€å æœ‰çš„ç³»ç»Ÿèµ„æºç‡ï¼Œæé«˜é€Ÿåº¦</span><br><span class="line">CoercionMode(å¼ºåˆ¶æ¨¡å¼)ï¼Œåˆ†æˆä¸‰ç§å½¢å¼ï¼ŒNoneï¼Œ128Mï¼Œ1Gï¼Œå½“ä¸º1Gæ—¶ï¼Œæ¯ä¸ªç£ç›˜æ¯”æ²¡æœ‰è®¾ç½®çš„æ—¶å‡å°‘äº†1Gçš„ç©ºé—´;</span><br><span class="line">PredFailPollIntervalï¼Œè½®è¯¢é¢„æµ‹å¤±è´¥çš„æ—¶é—´é—´éš”ã€‚Predictive Failure Countå°±æ˜¯smarté”™è¯¯;</span><br><span class="line">MaintainPdFailHistoryEnbl ä¿å­˜åç›˜çš„å†å²è®°å½•ã€‚å½“ä¸ºenableæ—¶ï¼Œå½“ä¸€ä¸ªç›˜æ‰çº¿å¹¶é‡æ–°ä¸Šçº¿ã€‚éœ€è¦æ¸…é™¤é…ç½®ä¿¡æ¯ï¼Œæ·»åŠ ä¸ºçƒ­å¤‡ç›˜æ‰å¯ä»¥é‡å»ºå½“ä¸ºdisableæ—¶ã€‚å½“ä¸€ä¸ªç›˜æ‰çº¿å¹¶é‡æ–°ä¸Šçº¿ï¼Œè‡ªåŠ¨é‡å»º;</span><br><span class="line"><span class="meta">#</span><span class="bash">è®¾ç½®Clusteræ¨¡å¼ï¼Œç›®å‰ä¸æ”¯æŒï¼Œåªèƒ½è®¾ç½®ä¸ºdisbale</span></span><br><span class="line">MegaCli -AdpSetProp ClusterEnable -0 -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">è®¾ç½®jbodæ¨¡å¼ï¼Œé’ˆå¯¹raid0æœ‰æ•ˆï¼Œå¯¹å•ä¸ªç›˜è¯»å†™ï¼Œå³å…ˆå†™ç¬¬ä¸€ä¸ªç›˜ï¼Œå†™æ»¡äº†åœ¨å†™ç¬¬äºŒä¸ªç›˜ã€‚MegaCli -PDMakeJBOD -physdrv[E0:S0,E1:S1] -a0 å¯ä»¥è®¾ç½®jbodæ¨¡å¼(ç›®å‰ä¸æ”¯æŒ)</span></span><br><span class="line">MegaCli -AdpSetProp -EnableJBOD -1 -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">è®©è®¾å¤‡é©±åŠ¨æš´éœ²enclosure devices</span></span><br><span class="line">MegaCli -AdpSetProp ExposeEnclDevicesEnbl -1 -a0</span><br></pre></td></tr></table></figure><h2 id="NCQ"><a href="#NCQ" class="headerlink" title="NCQ"></a>NCQ</h2><p>Native Command Queuing (NCQ)å¯¹ç¡¬ç›˜çš„è¯»å†™å‘½ä»¤çš„é¡ºåºè¿›è¡Œä¼˜åŒ–ã€‚å¸¦ NCQ æŠ€æœ¯çš„ç¡¬ç›˜åœ¨æ¥åˆ°è¯»å†™æŒ‡ä»¤åï¼Œä¼šæ ¹æ®æŒ‡ä»¤å¯¹è®¿é—®åœ°å€è¿›è¡Œé‡æ–°æ’åºã€‚æ¯”å¦‚æ ¹æ®æŒ‡ä»¤ï¼Œç¡¬ç›˜éœ€è¦è®¿é—® 330 æ‰‡åŒºã€980 æ‰‡åŒºã€340 æ‰‡åŒºï¼Œç”±äºæ•°æ®åœ¨ç£ç›˜ä¸Šåˆ†å¸ƒä½ç½®ä¸åŒï¼Œæ™®é€šç¡¬ç›˜åªä¼šæŒ‰éƒ¨å°±ç­åœ°ä¾æ¬¡è®¿é—®ã€‚è€Œ NCQ ç¡¬ç›˜å¯¹æŒ‡ä»¤è¿›è¡Œä¼˜åŒ–æ’åˆ—ä¹‹åï¼Œå°±å¯ä»¥å…ˆè¯»å– 330 æ‰‡åŒºï¼Œæ¥ç€è¯»å– 340 æ‰‡åŒºï¼Œç„¶åå†è¯»å– 980 æ‰‡åŒºã€‚è¿™æ ·åšçš„å¥½å¤„å°±æ˜¯å‡å°‘äº†ç£å¤´è‡‚æ¥å›ç§»åŠ¨çš„æ—¶é—´ï¼Œä½¿æ•°æ®è¯»å–æ›´æœ‰æ•ˆï¼ŒåŒæ—¶æœ‰æ•ˆåœ°å»¶é•¿äº†ç¡¬ç›˜çš„ä½¿ç”¨å¯¿å‘½ã€‚<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">æ˜¾ç¤ºNCQçš„è®¾ç½®æƒ…å†µ</span></span><br><span class="line">MegaCli -adpgetprop -NCQdsply -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">è®¾ç½®å¼€å¯NCQ</span></span><br><span class="line">MegaCli -adpsetprop -NCQenbl -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">å…³é—­NCQ</span></span><br><span class="line">MegaCli -adpsetprop -NCQdsbl -a0</span><br></pre></td></tr></table></figure></p><h2 id="æ·»åŠ å’Œç§»é™¤çƒ­å¤‡ç›˜"><a href="#æ·»åŠ å’Œç§»é™¤çƒ­å¤‡ç›˜" class="headerlink" title="æ·»åŠ å’Œç§»é™¤çƒ­å¤‡ç›˜"></a>æ·»åŠ å’Œç§»é™¤çƒ­å¤‡ç›˜</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">æ·»åŠ å±€éƒ¨çƒ­å¤‡ç›˜ï¼Œå…¶ä¸­array0è¡¨ç¤ºç¬¬0ä¸ªraid</span></span><br><span class="line">MegaCli -PDHSP -Set -Dedicated -Array0 -physdrv[E:S] -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">æ·»åŠ å…¨å±€çƒ­å¤‡ç›˜</span></span><br><span class="line">MegaCli -pdhsp -set -physdrv[E:S] -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">ç§»é™¤å…¨å±€å’Œçƒ­å¤‡å±€éƒ¨çƒ­å¤‡</span></span><br><span class="line">MegaCli -pdhsp -rmv -physdrv[E:S] -a0</span><br></pre></td></tr></table></figure><h2 id="é‡å»º"><a href="#é‡å»º" class="headerlink" title="é‡å»º"></a>é‡å»º</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">æŸ¥çœ‹é‡å»ºçš„è¿›åº¦</span></span><br><span class="line">MegaCli -PDRbld -progdsply -physdrv[E:S] -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">è°ƒå¿«é‡å»ºçš„é€Ÿåº¦</span></span><br><span class="line">MegaCli -AdpSetProp RebuildRate -val -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">è®¾ç½®è‡ªåŠ¨é‡å»ºï¼Œå½“ä¸€ä¸ªç›˜åæ‰æ—¶ï¼Œçƒ­å¤‡ç›˜å¯ä»¥è‡ªåŠ¨é‡å»ºï¼Œä»£æ›¿åçš„ç›˜</span></span><br><span class="line">MegaCli -AdpAutoRbld -Enbl -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">æ‰‹åŠ¨å¼€å§‹é‡å»ºï¼ŒE0:S0è¡¨ç¤ºåçš„ç›˜</span></span><br><span class="line">MegaCli -PDRbld -Start -PhysDrv [E0:S0] -a0</span><br></pre></td></tr></table></figure><h2 id="æ¢å¤å‡ºå‚è®¾ç½®"><a href="#æ¢å¤å‡ºå‚è®¾ç½®" class="headerlink" title="æ¢å¤å‡ºå‚è®¾ç½®"></a>æ¢å¤å‡ºå‚è®¾ç½®</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">æ¢å¤å‡ºå‚çš„é»˜è®¤é…ç½®</span></span><br><span class="line">MegaCli -AdpFacDefSet â€“a0</span><br></pre></td></tr></table></figure><h2 id="å‘Šè­¦"><a href="#å‘Šè­¦" class="headerlink" title="å‘Šè­¦"></a>å‘Šè­¦</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">ä¸´æ—¶å…³é—­ï¼Œé‡å¯åˆå˜æˆå¼€å¯</span></span><br><span class="line">MegaCli -AdpSetProp -AlarmSilence â€“a0</span><br><span class="line"><span class="meta">#</span><span class="bash">æ°¸ä¹…å…³é—­ï¼Œé‡å¯åè¿˜æ˜¯å…³é—­</span></span><br><span class="line">MegaCli -AdpSetProp -AlarmDsbl â€“a0</span><br><span class="line"><span class="meta">#</span><span class="bash">å¼€å¯</span></span><br><span class="line">MegaCli -AdpSetProp -Alarmenbl â€“a0</span><br><span class="line"><span class="meta">#</span><span class="bash">æŸ¥çœ‹å‘Šè­¦çš„çŠ¶æ€</span></span><br><span class="line">MegaCli -AdpgetProp -Alarmdsply â€“a0</span><br></pre></td></tr></table></figure><h2 id="é…ç½®ç›¸å…³"><a href="#é…ç½®ç›¸å…³" class="headerlink" title="é…ç½®ç›¸å…³"></a>é…ç½®ç›¸å…³</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">å¯ä»¥æŸ¥çœ‹ä¸€ç»„ç£ç›˜ä¸Šçš„å¤šä¸ªraidçš„é…ç½®</span></span><br><span class="line">MegaCli -CfgDsply -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">ä¿å­˜é…ç½®æ–‡ä»¶</span></span><br><span class="line">MegaCli -CfgSave -f filename -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">å¯¼å…¥é…ç½®æ–‡ä»¶ï¼ŒRaidç»„çš„é…ç½®æ–‡ä»¶æ”¾åœ¨æœ€åï¼Œæ”¾åœ¨æ¯ä¸ªç£ç›˜çš„æœ€å512Mï¼Œä¸»è¦åŒ…å«æ•°æ®ä»å“ªé‡Œå¼€å§‹å†™çš„é…ç½®å’Œç”¨æ¥Migration çš„swapæ–‡ä»¶</span></span><br><span class="line">MegaCli -CfgRestore -f filename -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">å¯åŠ¨æ—¶æ¢å¤å¤–æ¥é…ç½®</span></span><br><span class="line">MegaCli -AdpSetProp -AutoEnhancedImportEnbl -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">éªŒè¯é…ç½®æ–‡ä»¶å’Œæ–‡ä»¶çš„å†…å®¹</span></span><br><span class="line">MegaCli -AdpSetVerify -f fileName -a0</span><br></pre></td></tr></table></figure><h2 id="RAID-å¡ç›¸å…³"><a href="#RAID-å¡ç›¸å…³" class="headerlink" title="RAID å¡ç›¸å…³"></a>RAID å¡ç›¸å…³</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">æŸ¥çœ‹raidçš„é…ç½®ä¿¡æ¯</span></span><br><span class="line">MegaCli -adpallinfo -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">å…³é—­raidå¡</span></span><br><span class="line">MegaCli -adpShutDown -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">è·å–raidçš„æ—¶é—´</span></span><br><span class="line">MegaCli -adpGetTime -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">å¯¹raidè¿›è¡Œè¯Šæ–­</span></span><br><span class="line">MegaCli -AdpDiag val -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">è®¾ç½®è´Ÿè½½å‡è¡¡ï¼ŒRaidå¡å¯¹ç»ˆç«¯è®¾å¤‡é‡‡ç”¨å¤šè·¯å¾„è®¿é—®ï¼Œä¸€åŠçš„è®¾å¤‡é€šè¿‡ä¸€æ¡è·¯å¾„ï¼Œå¦ä¸€åŠçš„è®¾å¤‡é€šè¿‡å¦ä¸€æ¡è·¯å¾„ï¼Œä¸€æ¡é€”å¾„æœ‰ç›˜æ’å…¥å’Œç§»é™¤æ—¶ï¼Œå¯åŠ¨è´Ÿè½½å¹³è¡¡ï¼Œé¿å…è®¾å¤‡æœ‰é‡ç”¨</span></span><br><span class="line">MegaCli -AdpSetProp â€“LoadBalanceMode -val â€“a0</span><br><span class="line"><span class="meta">#</span><span class="bash">è·å–raidå¡çš„ä¸ªæ•°</span></span><br><span class="line">MegaCli â€“adpCount</span><br><span class="line"><span class="meta">#</span><span class="bash">è·å–pciä¿¡æ¯</span></span><br><span class="line">MegaCli -AdpGetPciInfo -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">Raidå¡çš„åœ¨çº¿é‡ç½®ï¼Œfwé‡ç½®raidå¡æ§åˆ¶å™¨èŠ¯ç‰‡</span></span><br><span class="line">MegaCli -AdpSetProp DisableOCR -val -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">æ˜¾ç¤ºraidå¡ï¼Œç³»ç»Ÿç­‰çš„ä¸€äº›ç®€å•ä¿¡æ¯</span></span><br><span class="line">MegaCli -ShowSummary -f filename -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">æ˜¾ç¤ºæ¯ä¸ªphyçš„é”™è¯¯æ•°</span></span><br><span class="line">MegaCli -PhyErrorCounters -a0</span><br></pre></td></tr></table></figure><h2 id="Enclosure-çš„ä¿¡æ¯"><a href="#Enclosure-çš„ä¿¡æ¯" class="headerlink" title="Enclosure çš„ä¿¡æ¯"></a>Enclosure çš„ä¿¡æ¯</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">æŸ¥çœ‹æœºæŸœçš„ç›¸å…³ä¿¡æ¯</span></span><br><span class="line">MegaCli -encinfo -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">æŸ¥çœ‹æœºæŸœçš„çŠ¶æ€</span></span><br><span class="line">MegaCli -encstatus -a0</span><br></pre></td></tr></table></figure><h2 id="BIOS-ç›¸å…³"><a href="#BIOS-ç›¸å…³" class="headerlink" title="BIOS ç›¸å…³"></a>BIOS ç›¸å…³</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">åœ¨å¯åŠ¨æ—¶è¦æŒ‰ä»»æ„é”®æ‰å¯ä»¥å¯åŠ¨è¿™ç§æƒ…å†µè®¾ç½®è¿™ä¸ªå‚æ•°ã€‚ä½†æ˜¯é¦–å…ˆè¦ç¡®ä¿ bios å¤„äº <span class="built_in">enable</span> çŠ¶æ€ã€‚é€šè¿‡ MegaCli -AdpBIOS -dsply -a0å¯ä»¥æŸ¥çœ‹ã€‚å¦‚æœä¸æ˜¯ï¼Œå…ˆç”¨MegaCli -AdpBIOS -enbl -a0æ¥è®¾ç½®</span></span><br><span class="line">MegaCli â€“AdpBIOS â€“BE â€“a0</span><br><span class="line"><span class="meta">#</span><span class="bash">æŠŠå½“å‰çš„Raidç»„ä½œä¸ºå¯åŠ¨</span></span><br><span class="line">MegaCli â€“AdpBootDrive -set -L0 -a0</span><br></pre></td></tr></table></figure><h2 id="èƒŒæ¿ç›¸å…³"><a href="#èƒŒæ¿ç›¸å…³" class="headerlink" title="èƒŒæ¿ç›¸å…³"></a>èƒŒæ¿ç›¸å…³</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">å¦‚æœèƒŒæ¿ <span class="built_in">disable</span> æ—¶ï¼Œä¼šè‡ªåŠ¨çš„å»æ£€æµ‹èƒŒæ¿</span></span><br><span class="line">MegaCli -AdpSetProp -AutoDetectBackPlaneDsbl -val â€“a0</span><br></pre></td></tr></table></figure><h2 id="å¯åŠ¨æ—¶ä¸Šç”µ"><a href="#å¯åŠ¨æ—¶ä¸Šç”µ" class="headerlink" title="å¯åŠ¨æ—¶ä¸Šç”µ"></a>å¯åŠ¨æ—¶ä¸Šç”µ</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">è®¾ç½®ä¸€æ¬¡ä¸Šç”µçš„ç£ç›˜çš„ä¸ªæ•°</span></span><br><span class="line">MegaCli -AdpSetProp SpinupDriveCount -val -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">è®¾ç½®ä¸Šç”µçš„å»¶è¿Ÿæ—¶é—´</span></span><br><span class="line">MegaCli -AdpSetProp SpinupDelay -val -a0</span><br></pre></td></tr></table></figure><h2 id="åˆ·æ–°ç¼“å­˜"><a href="#åˆ·æ–°ç¼“å­˜" class="headerlink" title="åˆ·æ–°ç¼“å­˜"></a>åˆ·æ–°ç¼“å­˜</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">åˆ·æ–°raidå¡ç¼“å­˜</span></span><br><span class="line">MegaCli -AdpCacheFlush â€“a0</span><br><span class="line"><span class="meta">#</span><span class="bash">åˆ·ç¼“å­˜çš„æ—¶é—´é—´éš”</span></span><br><span class="line">MegaCli -AdpSetProp CacheFlushInterval â€“val â€“a0</span><br></pre></td></tr></table></figure><h2 id="è®©ç¡¬ç›˜-LED-ç¯é—ªçƒ"><a href="#è®©ç¡¬ç›˜-LED-ç¯é—ªçƒ" class="headerlink" title="è®©ç¡¬ç›˜ LED ç¯é—ªçƒ"></a>è®©ç¡¬ç›˜ LED ç¯é—ªçƒ</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">å¼€å¯blink</span></span><br><span class="line">MegaCli -AdpSetProp UseDiskActivityforLocate -1 -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">è®©ç¡¬ç›˜LEDç¯é—ªçƒ</span></span><br><span class="line">MegaCli -PdLocate -start â€“physdrv[E:S] -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">åœæ‰ç¡¬ç›˜LEDç¯</span></span><br><span class="line">MegaCli -PdLocate -stopt â€“physdrv[E:S] -a0</span><br></pre></td></tr></table></figure><h2 id="ç”µæ± å‘Šè­¦"><a href="#ç”µæ± å‘Šè­¦" class="headerlink" title="ç”µæ± å‘Šè­¦"></a>ç”µæ± å‘Šè­¦</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">MegaCli -AdpSetProp BatWarnDsbl -val -a0</span><br></pre></td></tr></table></figure><h2 id="çº é”™ç ç›¸å…³"><a href="#çº é”™ç ç›¸å…³" class="headerlink" title="çº é”™ç ç›¸å…³"></a>çº é”™ç ç›¸å…³</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">è®¾ç½®çº é”™ç æ¼æ¡¶çš„å­—èŠ‚æ•°</span></span><br><span class="line">MegaCli -AdpSetProp EccBucketSize -val -a0</span><br></pre></td></tr></table></figure><h2 id="åå°åˆå§‹åŒ–ï¼Œå®Œå…¨åˆå§‹åŒ–ï¼Œcc-æ ¡éªŒï¼Œå·¡è¯»ç­‰ä¹‹é—´çš„å…³ç³»"><a href="#åå°åˆå§‹åŒ–ï¼Œå®Œå…¨åˆå§‹åŒ–ï¼Œcc-æ ¡éªŒï¼Œå·¡è¯»ç­‰ä¹‹é—´çš„å…³ç³»" class="headerlink" title="åå°åˆå§‹åŒ–ï¼Œå®Œå…¨åˆå§‹åŒ–ï¼Œcc æ ¡éªŒï¼Œå·¡è¯»ç­‰ä¹‹é—´çš„å…³ç³»"></a>åå°åˆå§‹åŒ–ï¼Œå®Œå…¨åˆå§‹åŒ–ï¼Œcc æ ¡éªŒï¼Œå·¡è¯»ç­‰ä¹‹é—´çš„å…³ç³»</h2><p>åå°åˆå§‹åŒ–å’Œå®Œå…¨åˆå§‹åŒ–ï¼Œcc æ ¡éªŒæ—¶ä¸èƒ½è¿›è¡Œå·¡è¯»;<br>å·¡è¯»æ—¶å¯ä»¥åå°åˆå§‹åŒ–å’Œå®Œå…¨åˆå§‹åŒ–ï¼Œæ­¤æ—¶å·¡è¯»ç»“æŸ;;<br>åœ¨åå°åˆå§‹åŒ–å’Œ cc æ ¡éªŒæ—¶ï¼Œä¸èƒ½å¼€å§‹å®Œå…¨åˆå§‹åŒ–;<br>æ‰©å®¹æ—¶ä¸èƒ½å»º raidï¼Œä¸èƒ½æ·»åŠ çƒ­å¤‡ç›˜;<br>rebuild çš„ä¼˜å…ˆçº§é«˜äº copyback;</p><h2 id="RAID-çš„åˆ›å»ºä¸åˆ é™¤"><a href="#RAID-çš„åˆ›å»ºä¸åˆ é™¤" class="headerlink" title="RAID çš„åˆ›å»ºä¸åˆ é™¤"></a>RAID çš„åˆ›å»ºä¸åˆ é™¤</h2><ul><li>åˆ›å»º raid 0ï¼Œ1ï¼Œ5ï¼Œ6</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">MegaCli -CfgLdAdd -rX[E0:S0,E1:S1,...] [WT|WB] [NORA|RA|ADRA] [Direct|Cached] [CachedBadBBU|NoCachedBadBBU] [-szXXX [-szYYY ...]] [-strpszM] [-Hsp[E0:S0,...]] [-AfterLdX] [-Force]|[FDE|CtrlBased] -a0 å¯ä»¥è®¾ç½®å†™æ¨¡å¼(wtï¼Œwb)ï¼Œè¯»æ¨¡å¼(raï¼Œnoraï¼Œadra)ï¼Œç¼“å­˜æ¨¡å¼(directï¼Œcached)ï¼Œå¤§å°(sz)ï¼Œæ¡å—å¤§å°(strpszM)ç­‰ã€‚æ¯”å¦‚1000Gï¼Œåªç”¨æŒ‡å®šç›˜çš„ä¸€éƒ¨åˆ†(sz1000G)ï¼Œè®¾ç½®æ¡å—çš„å¤§å°strpsz(è®¾ç½®ä¸º16kï¼Œåˆ™ä¸ºstrpsz16)</span></span><br><span class="line">MegaCli -cfgldadd -r5[117:1,117:3,117:11] -wb -ra -cached -cachedbadbbu -force -a0</span><br></pre></td></tr></table></figure><ul><li>åˆ›å»º raid 10ï¼Œ50ï¼Œ60</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">MegaCli -CfgSpanAdd -rX-Array0[E0:S0,E1:S1] -Array1[E0:S0,E1:S1] [-ArrayX[E0:S0,E1:S1] ...] [WT|WB] [NORA|RA|ADRA] [Direct|Cached] [CachedBadBBU| NoCachedBadBBU] [-szXXX[-szYYY ...]][-strpszM][-AfterLdX][-Force] |[FDE|CtrlBased] -aN</span></span><br><span class="line">MegaCli -CfgSpanAdd -r10 -Array0[245:0,245:1] Array1[245:2,245:3] -WB -RA -Cached -Cachedbadbbu -a0</span><br></pre></td></tr></table></figure><ul><li>æ‰¹é‡åˆ›å»º raid0</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">æŠŠæ¯ä¸ªæ§½ä½çš„ç£ç›˜éƒ½åˆ›å»ºä¸ºåªæœ‰ä¸€ä¸ªç›˜çš„raid0</span></span><br><span class="line">MegaCli -CfgEachDskRaid0 -wb -ra -cached -cachedbadbbu -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">æŠŠæ‰€æœ‰çš„ç©ºé—²ç›˜éƒ½åŠ å…¥åˆ°raidä¸­</span></span><br><span class="line">MegaCli -CfgAllFreeDrv -r5 -SATAOnly -wb -ra -cached -cachedbadbbu -a0</span><br></pre></td></tr></table></figure><ul><li>åˆ é™¤ raid ç»„</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">æ¸…é™¤æ‰€æœ‰çš„raidç»„çš„é…ç½®</span></span><br><span class="line">MegaCli -cfgclr -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">åˆ é™¤æŒ‡å®šçš„raidç»„(Target Id: 0)çš„raidç»„</span></span><br><span class="line">MegaCli -cfglddel -L0 -a0</span><br></pre></td></tr></table></figure><h2 id="è®¾ç½®-RAID-ç»„çš„å±æ€§"><a href="#è®¾ç½®-RAID-ç»„çš„å±æ€§" class="headerlink" title="è®¾ç½® RAID ç»„çš„å±æ€§"></a>è®¾ç½® RAID ç»„çš„å±æ€§</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">è®¾ç½®raidç»„çš„åå­—</span></span><br><span class="line">MegaCli -ldsetprop -name dg -L0 -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">è®¾ç½®è®¿é—®ç­–ç•¥ä¸ºè¯»å†™ï¼ŒMegaCli -ldsetprop -blocked -L0 -a0è®¾ç½®è®¿é—®ç­–ç•¥ä¸ºé˜»å¡ï¼Œæ­¤æ—¶raidç»„çš„è®¾å¤‡ä¸å¯ä»¥è®¿é—®ï¼Œfdisk -lä¸èƒ½å‘ç°è®¾å¤‡</span></span><br><span class="line">MegaCli -ldsetprop -rw -L0 -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">è®¾ç½®å†™ç­–ç•¥ä¸ºwt(ç›´å†™)ï¼Œç›´æ¥å†™å…¥åˆ°ç¡¬ç›˜ä¸Šï¼Œç„¶åå†è¿”å›ã€‚wbæ¨¡å¼æ˜¯å†™å…¥åˆ°ç¼“å­˜ä¸­å°±è¿”å›ï¼Œè®¾ç½®wbæ¨¡å¼å†™é€Ÿåº¦æœ‰æ˜¾è‘—çš„æ”¹å–„ï¼Œæé«˜åˆ°12å€</span></span><br><span class="line">MegaCli -ldsetprop -wt -L0 -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">è®¾ç½®è¯»ç­–ç•¥ä¸ºra(é¢„å…ˆè¯»å‡ºä¸€å®šçš„æ•°æ®)ï¼Œè¿˜æœ‰noraæ¨¡å¼ï¼Œraæ¨¡å¼è¯»å¯ä»¥æé«˜åˆ°2å€å·¦å³</span></span><br><span class="line">MegaCli -ldsetprop -ra -L0 -a0 </span><br><span class="line"><span class="meta">#</span><span class="bash">è®¾ç½®ç¼“å­˜ç­–ç•¥ä¸ºcached</span></span><br><span class="line">MegaCli -ldsetprop -cached -L0 -a0</span><br><span class="line"><span class="meta">#</span><span class="bash">å¼€å¯ç£ç›˜çš„ç¼“å­˜ï¼Œå¯¹å†™é€Ÿåº¦æœ‰ä¸€å®šçš„æé«˜(1.4å€)</span></span><br><span class="line">MegaCli -ldsetprop -endskcache -L0 -a0</span><br></pre></td></tr></table></figure><h2 id="æŸ¥è¯¢ç¯‡"><a href="#æŸ¥è¯¢ç¯‡" class="headerlink" title="æŸ¥è¯¢ç¯‡"></a>æŸ¥è¯¢ç¯‡</h2><ul><li>æ˜¾ç¤º BBU çŠ¶æ€ä¿¡æ¯ <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">MegaCli -AdpBbuCmd -GetBbuStatus â€“aALL </span><br></pre></td></tr></table></figure></li><li>æ˜¾ç¤º BBU å®¹é‡ä¿¡æ¯  <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">MegaCli -AdpBbuCmd -GetBbuCapacityInfo â€“aALL </span><br></pre></td></tr></table></figure></li><li>æ˜¾ç¤º BBU è®¾è®¡å‚æ•°  <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">MegaCli -AdpBbuCmd -GetBbuDesignInfo â€“aALL</span><br></pre></td></tr></table></figure></li><li>æ˜¾ç¤ºå½“å‰ BBU å±æ€§  <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">MegaCli -AdpBbuCmd -GetBbuProperties â€“aALL </span><br></pre></td></tr></table></figure></li><li>æŸ¥çœ‹å……ç”µçŠ¶æ€    <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">MegaCli -AdpBbuCmd -GetBbuStatus -aALL |grep &quot;Charger Status&quot; </span><br></pre></td></tr></table></figure></li><li>æŸ¥çœ‹å……ç”µè¿›åº¦ç™¾åˆ†æ¯”     <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">MegaCli -AdpBbuCmd -GetBbuStatus -aALL |grep &quot;Relative State of Charge&quot;</span><br></pre></td></tr></table></figure></li><li>æŸ¥çœ‹æ‰€æœ‰ç‰©ç†ç£ç›˜ä¿¡æ¯     <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">MegaCli -PDList -aALL</span><br></pre></td></tr></table></figure></li><li>æ˜¾ç¤ºæ‰€æœ‰é€»è¾‘ç£ç›˜ç»„ä¿¡æ¯     <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">MegaCli -LDInfo -LALL â€“aAll</span><br></pre></td></tr></table></figure></li><li>æŸ¥çœ‹ç‰©ç†ç£ç›˜é‡å»ºè¿›åº¦(é‡è¦)<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">MegaCli -PDRbld -ShowProg -PhysDrv [1:5] -a0 </span><br></pre></td></tr></table></figure></li><li>æŸ¥çœ‹é€‚é…å™¨ä¸ªæ•°    <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">MegaCli â€“adpCount </span><br></pre></td></tr></table></figure></li><li>æŸ¥çœ‹é€‚é…å™¨æ—¶é—´     <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">MegaCli -AdpGetTime â€“aALL</span><br></pre></td></tr></table></figure></li><li>æ˜¾ç¤ºæ‰€æœ‰é€‚é…å™¨ä¿¡æ¯    <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">MegaCli -AdpAllInfo â€“aAll </span><br></pre></td></tr></table></figure></li><li>æ˜¾ç¤º RAID å¡å‹å·ï¼ŒRAID è®¾ç½®ï¼ŒDisk ç›¸å…³ä¿¡æ¯      <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">MegaCli -cfgdsply â€“aALL </span><br></pre></td></tr></table></figure></li><li>æŸ¥è¯¢ RAID é˜µåˆ—ä¸ªæ•°    <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">MegaCli -cfgdsply -aALL |grep &quot;Number of DISK GROUPS:&quot;</span><br></pre></td></tr></table></figure></li><li>æŸ¥çœ‹ Cache ç­–ç•¥è®¾ç½®    <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">MegaCli -cfgdsply -aALL |grep Polic</span><br></pre></td></tr></table></figure></li><li>æŸ¥çœ‹ç£ç›˜ç¼“å­˜ç­–ç•¥ <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> L----&gt;[VD num or ALL] a----&gt;[Adapter num or ALL]</span></span><br><span class="line">MegaCli -LDGetProp -Cache -L0 -a0</span><br><span class="line"><span class="meta">#</span><span class="bash"> or</span> </span><br><span class="line">MegaCli -LDGetProp -DskCache -LALL -aALL</span><br></pre></td></tr></table></figure></li><li>æŸ¥çœ‹ç‰©ç†ç£ç›˜é‡å»ºè¿›åº¦<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">MegaCli -PDRbld -ShowProg -PhysDrv [1:5] -a0</span><br></pre></td></tr></table></figure></li><li>æŸ¥çœ‹ Megacli çš„ log<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">MegaCli -FwTermLog dsply -a0 &gt; adp2.log</span><br></pre></td></tr></table></figure><h2 id="è®¾ç½®ç¯‡"><a href="#è®¾ç½®ç¯‡" class="headerlink" title="è®¾ç½®ç¯‡"></a>è®¾ç½®ç¯‡</h2></li></ul><h3 id="åˆ›å»º-åˆ é™¤é˜µåˆ—"><a href="#åˆ›å»º-åˆ é™¤é˜µåˆ—" class="headerlink" title="åˆ›å»º/åˆ é™¤é˜µåˆ—"></a>åˆ›å»º/åˆ é™¤é˜µåˆ—</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> åˆ›å»ºä¸€ä¸ª RAID5 é˜µåˆ—ï¼Œç”±ç‰©ç†ç›˜ 2,3,4 æ„æˆï¼Œè¯¥é˜µåˆ—çš„çƒ­å¤‡ç›˜æ˜¯ç‰©ç†ç›˜ 5</span> </span><br><span class="line">MegaCli -CfgLdAdd -r5 [1:2,1:3,1:4] WB Direct -Hsp[1:5] â€“a0 </span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ›å»ºé˜µåˆ—ï¼Œä¸æŒ‡å®šçƒ­å¤‡</span> </span><br><span class="line">MegaCli -CfgLdAdd -r5 [1:2,1:3,1:4] WB Direct â€“a0 </span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ é™¤é˜µåˆ—</span> </span><br><span class="line">MegaCli -CfgLdDel -L1 â€“a0 </span><br><span class="line"><span class="meta">#</span><span class="bash"> åœ¨çº¿æ·»åŠ ç£ç›˜</span> </span><br><span class="line"><span class="meta">#</span><span class="bash"> é‡å»ºé€»è¾‘ç£ç›˜ç»„ 1 , RAID çº§åˆ«æ˜¯5ï¼Œæ·»åŠ ç‰©ç†ç£ç›˜å· 1:4ã€‚</span></span><br><span class="line">MegaCli -LDRecon -Start -r5 -Add -PhysDrv[1:4] -L1 -a0 </span><br></pre></td></tr></table></figure><p><strong>æ³¨ï¼š</strong>é‡å»ºå®Œåï¼Œæ–°æ·»åŠ çš„ç‰©ç†ç£ç›˜ä¼šè‡ªåŠ¨å¤„äºé‡å»º(åŒæ­¥)çŠ¶æ€ï¼Œè¿™ä¸ªæ—¶å€™ <code>fdisk -l</code>æ˜¯çœ‹ä¸åˆ°é˜µåˆ—çš„ç©ºé—´å˜å¤§çš„ï¼Œåªæœ‰åœ¨ç³»ç»Ÿé‡å¯åæ‰èƒ½çœ‹è§ã€‚ </p><h3 id="æŸ¥çœ‹é˜µåˆ—åˆå§‹åŒ–ä¿¡æ¯"><a href="#æŸ¥çœ‹é˜µåˆ—åˆå§‹åŒ–ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹é˜µåˆ—åˆå§‹åŒ–ä¿¡æ¯"></a>æŸ¥çœ‹é˜µåˆ—åˆå§‹åŒ–ä¿¡æ¯</h3><ul><li>é˜µåˆ—åˆ›å»ºå®Œåï¼Œä¼šæœ‰ä¸€ä¸ªåˆå§‹åŒ–åŒæ­¥å—çš„è¿‡ç¨‹ï¼Œå¯ä»¥æŸ¥çœ‹å…¶è¿›åº¦ã€‚ <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">MegaCli -LDInit -ShowProg -LALL -aALL </span><br><span class="line"><span class="meta">#</span><span class="bash"> or ä»¥åŠ¨æ€å¯è§†åŒ–æ–‡å­—ç•Œé¢æ˜¾ç¤º</span> </span><br><span class="line">MegaCli -LDInit -ProgDsply -LALL â€“aALL </span><br></pre></td></tr></table></figure></li><li>æŸ¥çœ‹é˜µåˆ—åå°åˆå§‹åŒ–è¿›åº¦<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">MegaCli -LDBI -ShowProg -LALL -aALL </span><br><span class="line"><span class="meta">#</span><span class="bash"> or ä»¥åŠ¨æ€å¯è§†åŒ–æ–‡å­—ç•Œé¢æ˜¾ç¤º</span> </span><br><span class="line">MegaCli -LDBI -ProgDsply -LALL -aALL </span><br></pre></td></tr></table></figure><h3 id="è®¾ç½®ç£ç›˜ç¼“å­˜ç­–ç•¥"><a href="#è®¾ç½®ç£ç›˜ç¼“å­˜ç­–ç•¥" class="headerlink" title="è®¾ç½®ç£ç›˜ç¼“å­˜ç­–ç•¥"></a>è®¾ç½®ç£ç›˜ç¼“å­˜ç­–ç•¥</h3>ç¼“å­˜ç­–ç•¥è§£é‡Šï¼š</li></ul><table><thead><tr><th style="text-align:left">ä»£ç </th><th style="text-align:left">å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:left">WT</td><td style="text-align:left">(Write through)</td></tr><tr><td style="text-align:left">WB</td><td style="text-align:left">(Write back)</td></tr><tr><td style="text-align:left">NORA</td><td style="text-align:left">(No read ahead)</td></tr><tr><td style="text-align:left">RA</td><td style="text-align:left">(Read ahead)</td></tr><tr><td style="text-align:left">ADRA</td><td style="text-align:left">(Adaptive read ahead)</td></tr><tr><td style="text-align:left">Cached</td><td style="text-align:left">-</td></tr><tr><td style="text-align:left">Direct</td><td style="text-align:left">-</td></tr></tbody></table><p>egï¼š<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">MegaCli -LDSetProp WT|WB|NORA|RA|ADRA -L0 -a0 </span><br><span class="line"><span class="meta">#</span><span class="bash"> or</span> </span><br><span class="line">MegaCli -LDSetProp -Cached|-Direct -L0 -a0 </span><br><span class="line"><span class="meta">#</span><span class="bash"> or</span> </span><br><span class="line">- enable / disable disk cache </span><br><span class="line">MegaCli -LDSetProp -EnDskCache|-DisDskCache -L0 -a0</span><br></pre></td></tr></table></figure></p><h3 id="çƒ­å¤‡ç®¡ç†"><a href="#çƒ­å¤‡ç®¡ç†" class="headerlink" title="çƒ­å¤‡ç®¡ç†"></a>çƒ­å¤‡ç®¡ç†</h3><ul><li>åˆ›å»ºçƒ­å¤‡</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> [1:5]----&gt;[E:S]</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŒ‡å®šç¬¬ 5 å—ç›˜ä½œä¸ºå…¨å±€çƒ­å¤‡</span></span><br><span class="line">MegaCli -PDHSP -Set [-EnclAffinity] [-nonRevertible] -PhysDrv[1:5] -a0 </span><br><span class="line"><span class="meta">#</span><span class="bash"> egï¼š</span></span><br><span class="line">MegaCli -PDHSP   -Set   -Dedicated  -Array0  -physdrv[E:S] -a0</span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¸ºæŸä¸ªé˜µåˆ—æŒ‡å®šä¸“ç”¨çƒ­å¤‡</span> </span><br><span class="line">MegaCli -PDHSP -Set [-Dedicated [-Array1]] [-EnclAffinity] [-nonRevertible] -PhysDrv[1:5] -a0 </span><br></pre></td></tr></table></figure><ul><li>åˆ é™¤çƒ­å¤‡</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">MegaCli -PDHSP -rmv -PhysDrv[1:5] -a0 </span><br></pre></td></tr></table></figure><ul><li>å°†æŸå—ç‰©ç†ç›˜ä¸‹çº¿/ä¸Šçº¿ <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> ä¸‹çº¿</span></span><br><span class="line">MegaCli -PDOffline -PhysDrv [1:4] -a0 </span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¸Šçº¿</span></span><br><span class="line">MegaCli -PDOnline -PhysDrv [1:4] -a0 </span><br></pre></td></tr></table></figure><strong>æ³¨ï¼š</strong>å¦‚æœç›´æ¥åˆ é™¤ RAID è€Œä¸æ“ä½œçƒ­å¤‡ï¼Œå…¶å±€éƒ¨çƒ­å¤‡ä¼šå˜ä¸ºå…¨å±€çƒ­å¤‡ï¼Œè€Œä¸æ˜¯åˆ é™¤ã€‚</li></ul><h2 id="ç®¡ç†ç¯‡"><a href="#ç®¡ç†ç¯‡" class="headerlink" title="ç®¡ç†ç¯‡"></a>ç®¡ç†ç¯‡</h2><ul><li>ç‚¹äº®æŒ‡å®šç¡¬ç›˜ï¼ˆå®šä½ï¼‰<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">MegaCli -PdLocate -start -physdrv[252:2] -a0</span><br></pre></td></tr></table></figure></li><li>æŸ¥çœ‹ RAID é˜µåˆ—ä¸­æ‰çº¿çš„ç›˜<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">MegaCli -pdgetmissing -a0</span><br></pre></td></tr></table></figure></li><li>æ›¿æ¢åæ‰çš„æ¨¡å—<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">MegaCli -pdreplacemissing -physdrv[12:10] -Array5 -row0 -a0</span><br></pre></td></tr></table></figure></li><li>æ‰‹åŠ¨å¼€å¯ rebuid<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">MegaCli -pdrbld -start -physdrv[12:10] -a0</span><br></pre></td></tr></table></figure></li><li>æŸ¥çœ‹ Megacli çš„ log<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">MegaCli -FwTermLog dsply -a0 &gt; adp2.log</span><br></pre></td></tr></table></figure></li><li>å…³é—­ Rebuild<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">MegaCli -AdpAutoRbld -Dsbl -a0</span><br></pre></td></tr></table></figure></li><li>è®¾ç½® rebuild çš„é€Ÿç‡<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">MegaCli -AdpSetProp RebuildRate -30 -a0</span><br></pre></td></tr></table></figure><h3 id="foreign-ç®¡ç†"><a href="#foreign-ç®¡ç†" class="headerlink" title="foreign ç®¡ç†"></a>foreign ç®¡ç†</h3></li></ul><p>åˆ›å»º RAID å‰, éœ€è¦æ£€æµ‹æ˜¯å¦å…·æœ‰<code>foreign</code>é…ç½®, å¦‚æœæœ‰ä½†æ­¤æ—¶ä¸éœ€è¦ä¿ç•™ RAID æ—¶éœ€è¦æ¸…é™¤ RAID çš„ <code>foreign</code>çŠ¶æ€ã€‚</p><ul><li>æ£€æµ‹æ˜¯å¦å…·æœ‰ <code>foreign</code> é…ç½®<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">MegaCli -PDlist -aALL | grep &quot;Foreign State&quot;  </span><br></pre></td></tr></table></figure></li><li>å°†æ ‡æ³¨ä¸º <code>Foreign</code> ç£ç›˜æ ‡æ³¨ä¸º<code>unconfigrue good</code><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">MegaCli -PDMakeGood -PhysDrv[32:5] -a0  </span><br></pre></td></tr></table></figure></li><li>æ¸…é™¤ <code>foreign</code> é…ç½®<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">MegaCli -CfgForeign -Scan -a0  </span><br></pre></td></tr></table></figure><strong>æ³¨</strong>ï¼šä¸€èˆ¬ä»¥ä¸Šä¸¤æ¡éƒ½è¦æ‰§è¡Œæ‰èƒ½æ¸…é™¤ <code>foreign</code> çŠ¶æ€</li></ul><h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><p>ç£ç›˜çŠ¶æ€ State<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">(&quot;Failed&quot;, &quot;Online, Spun Up&quot;, &quot;Online, Spun Down&quot;, &quot;Unconfigured(bad)&quot;, &quot;Unconfigured(good), Spun down&quot;, &quot;Hotspare, Spun down&quot;, &quot;Hotspare, Spun up&quot; or &quot;not Online&quot;)</span><br></pre></td></tr></table></figure></p><h2 id="Unsolved"><a href="#Unsolved" class="headerlink" title="Unsolved"></a>Unsolved</h2><ul><li>æ‰©å±• RAIDï¼ˆåŠ ç›˜ï¼‰</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">MegaCli -LDRecon -Start -r1 -Add -PhysDrv[252:1] -L1 -a0                                     </span><br><span class="line"><span class="meta">#</span><span class="bash"> æŠ¥é”™</span></span><br><span class="line">Failed to Start Reconstruction of Virtual Drive.</span><br><span class="line"></span><br><span class="line">FW error description: </span><br><span class="line"> The requested command has invalid arguments.  </span><br><span class="line"></span><br><span class="line">Exit Code: 0x03</span><br></pre></td></tr></table></figure><p><a href="http://en.community.dell.com/support-forums/servers/f/956/t/19531272">å‚è§è¿™é‡Œ 1</a></p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://www.broadcom.com/site-search?q=megacli">å®˜æ–¹èµ„æºä¸‹è½½-broadcom</a></li><li><a href="https://techedemic.com/2014/08/07/dell-perclsi-megacli-how-to-install/">Dell â€“ PERC/LSI MegaCLI â€“ How to install</a></li><li><a href="https://hwraid.le-vert.net/wiki/LSIMegaRAIDSAS#a3.1.megactl">LSIMegaRAIDSAS</a></li><li><a href="http://zh.community.dell.com/techcenter/b/weblog/archive/2013/03/07/megacli-command-share">DELL ç£ç›˜é˜µåˆ—æ§åˆ¶å¡ï¼ˆRAID å¡ï¼‰MegaCli å¸¸ç”¨ç®¡ç†å‘½ä»¤æ±‡æ€»</a></li><li><a href="http://blog.csdn.net/heart_2011/article/details/7254404">MegaCli å‘½ä»¤æ€»ç»“ - CSDN åšå®¢</a></li><li><a href="http://www.ha97.com/4073.html">Linux ä¸‹æŸ¥çœ‹ Raid ç£ç›˜é˜µåˆ—ä¿¡æ¯çš„æ–¹æ³•</a></li><li><a href="http://www.mamicode.com/info-detail-860128.html">Megacli å¸¸ç”¨å‘½ä»¤</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹è®°å½• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å­˜å‚¨ </tag>
            
            <tag> Linux </tag>
            
            <tag> RAID </tag>
            
            <tag> MegaCli </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åœ¨æ­å»º Hexo ä¸­é‡åˆ°çš„é—®é¢˜è®°å½•</title>
      <link href="blog/2017-11-18/how-to-build-hexo-blog/"/>
      <url>blog/2017-11-18/how-to-build-hexo-blog/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><p>åœ¨ç½‘ç»œä¸Šæœç´¢ä¸€å¤©å¤šæ‰ç£•ç£•ç»Šç»Šæ­å»ºå¥½ <a href="https://www.masantu.com/">è¿™ä¸ª</a> åšå®¢ï¼Œâ„(â„ â„â€¢â„Ï‰â„â€¢â„ â„)â„ ç°åœ¨æŠŠè¿‡ç¨‹ä¸­é‡åˆ°çš„å‘è®°å½•ä¸€ä¸‹ï¼Œå¸Œæœ›å¯ä»¥ç»™ä¹‹åçš„åŒå­¦ä»¬å¸¦æ¥å¸®åŠ©ã€‚<br><a id="more"></a></p><h2 id="npm-åŒ…ç®¡ç†å®‰è£…å¤ªæ…¢æ€ä¹ˆåŠ"><a href="#npm-åŒ…ç®¡ç†å®‰è£…å¤ªæ…¢æ€ä¹ˆåŠ" class="headerlink" title="npm åŒ…ç®¡ç†å®‰è£…å¤ªæ…¢æ€ä¹ˆåŠ"></a>npm åŒ…ç®¡ç†å®‰è£…å¤ªæ…¢æ€ä¹ˆåŠ</h2><ul><li>ä¸´æ—¶ä½¿ç”¨<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm --registry https://registry.npm.taobao.org install express</span><br></pre></td></tr></table></figure></li><li>æŒä¹…ä½¿ç”¨(æ›´æ¢æºé“¾æ¥ä¸ºæ·˜å®æº)<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm config set registry https://registry.npm.taobao.org</span><br><span class="line"><span class="meta">#</span><span class="bash"> é…ç½®åå¯é€šè¿‡ä¸‹é¢æ–¹å¼æ¥éªŒè¯æ˜¯å¦æˆåŠŸ</span></span><br><span class="line">npm config get registry</span><br><span class="line"><span class="meta">#</span><span class="bash"> æˆ–è€…</span></span><br><span class="line">npm info express</span><br></pre></td></tr></table></figure></li><li>é€šè¿‡ cnpm ä½¿ç”¨<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install -g cnpm --registry&#x3D;https:&#x2F;&#x2F;registry.npm.taobao.org</span><br><span class="line"># ä½¿ç”¨</span><br><span class="line">cnpm install expresstall express</span><br></pre></td></tr></table></figure>è¿˜å¯ä»¥å‚è€ƒä¸‹é¢è¿™ä¸ªå·¥å…·:</li></ul><p><a href="https://segmentfault.com/a/1190000000473869">nrm â€”â€” å¿«é€Ÿåˆ‡æ¢ NPM æº ï¼ˆé™„å¸¦æµ‹é€ŸåŠŸèƒ½ï¼‰</a></p><h2 id="æˆ‘æœ‰ä¸¤å°ç”µè„‘-æ¢ç”µè„‘åå¦‚ä½•é‡æ–°å‘å¸ƒåšå®¢"><a href="#æˆ‘æœ‰ä¸¤å°ç”µè„‘-æ¢ç”µè„‘åå¦‚ä½•é‡æ–°å‘å¸ƒåšå®¢" class="headerlink" title="æˆ‘æœ‰ä¸¤å°ç”µè„‘/æ¢ç”µè„‘åå¦‚ä½•é‡æ–°å‘å¸ƒåšå®¢"></a>æˆ‘æœ‰ä¸¤å°ç”µè„‘/æ¢ç”µè„‘åå¦‚ä½•é‡æ–°å‘å¸ƒåšå®¢</h2><p>ä½¿ç”¨ Github çš„ branch åŠŸèƒ½å»ºç«‹ä¸¤ä¸ªåˆ†æ”¯ï¼Œï¼ˆå¦‚ï¼šmaster å’Œ hexoï¼‰è®¾ç½® hexo åˆ†æ”¯ä¸ºé»˜è®¤åˆ†æ”¯ï¼Œç„¶åå°†åšå®¢åå°é…ç½®æ–‡ä»¶å…¨éƒ¨<code>push</code>åˆ°è¯¥åˆ†æ”¯ã€‚master ç«¯ä¸ºä½¿ç”¨<code>hexo d</code>å‘½ä»¤å‘å¸ƒåˆ†æ”¯ã€‚</p><p><strong>æ³¨ï¼š</strong>master åˆ†æ”¯ä¸èƒ½å½“ä½œä»–ç”¨ï¼Œåªèƒ½ä½œä¸º hexo å‘å¸ƒä¹‹åä½¿ç”¨ã€‚</p><p>å¯ä»¥å‚è€ƒä¸‹é¢é“¾æ¥é…ç½®ï¼š<br><a href="http://www.jianshu.com/p/beb8d611340a">Hexo åšå®¢ä»ä¸€å°ç”µè„‘è¿ç§»åˆ°å…¶ä»–ç”µè„‘ - ç®€ä¹¦</a></p><h2 id="å¦‚ä½•è®¾ç½®è…¾è®¯å…¬ç›Šä¸º-404-é¡µé¢"><a href="#å¦‚ä½•è®¾ç½®è…¾è®¯å…¬ç›Šä¸º-404-é¡µé¢" class="headerlink" title="å¦‚ä½•è®¾ç½®è…¾è®¯å…¬ç›Šä¸º 404 é¡µé¢"></a>å¦‚ä½•è®¾ç½®è…¾è®¯å…¬ç›Šä¸º 404 é¡µé¢</h2><p>ä»¥ä¸‹æ˜¯çŸ¥ä¹ç½‘å‹ç»™å‡ºçš„å›ç­”ï¼š</p><blockquote><p>ç›´æ¥åœ¨ source æ ¹ç›®å½•ä¸‹åˆ›å»ºè‡ªå·±çš„<code>404.html</code>å³å¯ã€‚<del>ä½†æ˜¯è‡ªå®šä¹‰ 404 é¡µé¢ä»…å¯¹ç»‘å®šé¡¶çº§åŸŸåçš„é¡¹ç›®æ‰èµ·ä½œç”¨ã€‚</del></p></blockquote><p>ç»æˆ‘è¯•éªŒå¹¶ä¸ä¸€å®šè¦ç»‘å®šé¡¶çº§åŸŸåæ‰å¯ä»¥ï¼Œä½¿ç”¨å®˜æ–¹ç»™å‡ºçš„æ–¹æ¡ˆè®¾ç½®åå¹¶ä¸èƒ½å®ç°é”™è¯¯é¡µé¢è·³è½¬åˆ°æˆ‘ä»¬è®¾ç½®çš„ 404 é¡µé¢ã€‚<br>ä»¥ä¸‹æ¥è‡ª github ç½‘å‹åœ¨ issues ä¸­çš„è§£é‡Šï¼š</p><blockquote><p>ä½ çš„ç«™ç‚¹(ç¼–æ³¨ï¼šäºŒçº§åŸŸåå³ Github)å¯ç”¨äº† httpsï¼Œè…¾è®¯å…¬ç›Š 404 çš„è„šæœ¬æ˜¯ http åè®®ï¼Œå› æ­¤è¿™æ®µè„šæœ¬è¢«é˜»æ­¢äº†ã€‚</p></blockquote><p>è§£å†³çš„æ–¹æ³•æ˜¯å°†é¡µé¢é‡Œçš„ script æ¢æˆå¦‚ä¸‹ï¼š</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/plain&quot;</span> <span class="attr">src</span>=<span class="string">&quot;http://www.qq.com/404/search_children.js&quot;</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> <span class="attr">homePageUrl</span>=<span class="string">&quot;/&quot;</span> <span class="attr">homePageName</span>=<span class="string">&quot;å›åˆ°æˆ‘çš„ä¸»é¡µ&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://qzone.qq.com/gy/404/data.js&quot;</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://qzone.qq.com/gy/404/page.js&quot;</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç»è¯•éªŒè¯¥æ–¹æ³•è¿˜æ˜¯ä¼šå‡ºç°é—®é¢˜ï¼Œä½¿ç”¨ F12 å®¡æŸ¥å…ƒç´ å‡ºç°æŠ¥é”™ä¿¡æ¯ã€‚æœ€åä½¿ç”¨ä»¥ä¸‹æ–¹æ¡ˆè§£å†³è¯¥é—®é¢˜:</p><p><a href="https://eason-yang.com/2016/08/06/set-tencent-lostchild-404-page-for-ssl/">ä½¿è…¾è®¯ 404 å…¬ç›Šé¡µé¢æ”¯æŒ HTTPS</a></p><p><del>ç›®å‰å­˜åœ¨é—®é¢˜ï¼šé¡µé¢ä¼šæœ‰ä¸€ä¸ªå¡é¡¿åŠ è½½çš„è¿‡ç¨‹ï¼Œè¯¥é¡µé¢æ²¡æœ‰é€‚é…ç§»åŠ¨ç«¯ã€‚</del></p><h2 id="æ–‡ç« é¡µå¦‚ä½•è®¾ç½®å¤šæ ‡ç­¾"><a href="#æ–‡ç« é¡µå¦‚ä½•è®¾ç½®å¤šæ ‡ç­¾" class="headerlink" title="æ–‡ç« é¡µå¦‚ä½•è®¾ç½®å¤šæ ‡ç­¾"></a>æ–‡ç« é¡µå¦‚ä½•è®¾ç½®å¤šæ ‡ç­¾</h2><p>åœ¨æ–‡ç« å‘å¸ƒé¡µï¼ˆ<code>MARKDOWN</code> æ–‡ä»¶é¡¶éƒ¨ï¼‰æ·»åŠ å¦‚ä¸‹å­—æ®µ:</p><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">title:</span> <span class="string">åœ¨æ­å»ºHexoä¸­é‡åˆ°çš„é—®é¢˜è®°å½•</span></span><br><span class="line"><span class="comment"># æ ‡ç­¾ï¼ˆæ³¨æ„çŸ­æ¨ªæ åçš„ç©ºæ ¼ï¼‰</span></span><br><span class="line"><span class="attr">tags:</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">HOWTO</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">Hexo</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">Hexo-Next</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">etc.</span></span><br><span class="line"><span class="attr">author:</span> <span class="string">imoyao</span></span><br></pre></td></tr></table></figure><h2 id="å¦‚ä½•ç»™åšå®¢æ–‡ç« é¡µæ·»åŠ éŸ³ä¹"><a href="#å¦‚ä½•ç»™åšå®¢æ–‡ç« é¡µæ·»åŠ éŸ³ä¹" class="headerlink" title="å¦‚ä½•ç»™åšå®¢æ–‡ç« é¡µæ·»åŠ éŸ³ä¹"></a>å¦‚ä½•ç»™åšå®¢æ–‡ç« é¡µæ·»åŠ éŸ³ä¹</h2><p>å¯ä»¥ç”¨éŸ³ä¹ç½‘ç«™çš„å¤–é“¾ï¼Œä½†æ˜¯ä¸€èˆ¬å¤–é“¾æ˜¯<code>&lt;iframe&gt;</code>ï¼Œæ®è¯´è¿™ä¸ªæ–¹æ³•å½±å“ç½‘ç«™çš„ <code>SEO</code>ã€‚</p><p>ä¸‹é¢æˆ‘å°±éš†é‡ä»‹ç»ä¸€æ¬¾ <code>HTML5</code> éŸ³ä¹æ’­æ”¾å™¨â€”â€”<code>Aplayer</code>ã€‚éœ€è¦ç”¨åˆ°<code>hexo-tag-aplayer</code>æ’ä»¶ã€‚</p><p>åˆ‡æ¢åˆ°æœ¬åœ° Hexo ç›®å½•ï¼Œè¿è¡Œï¼š<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install hexo-tag-aplayer@2.0.1</span><br></pre></td></tr></table></figure><br>æ·»åŠ éŸ³é¢‘è¯­æ³•å¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#This is a example.</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% aplayer &quot;å¹³å‡¡ä¹‹è·¯&quot; &quot;æœ´æ ‘&quot; &quot;https:&#x2F;&#x2F;xxx.com&#x2F;%E5%B9%B3%E5%87%A1%E4%B9%8B%E8%B7%AF.mp3&quot; &quot;https:&#x2F;&#x2F;xxx.com&#x2F;1.jpg&quot; &quot;autoplay&quot; %&#125;</span><br><span class="line">å°±ä¼šå‡ºç°ä½ æƒ³è¦çš„éŸ³ä¹å•¦ã€‚</span><br><span class="line"></span><br><span class="line">&#123;% aplayer &quot;è“è²èŠ±&quot; &quot;è®¸å·&quot; &quot;http:&#x2F;&#x2F;oh6j8wijn.bkt.clouddn.com&#x2F;%E8%93%9D%E8%8E%B2%E8%8A%B1.mp3&quot; &quot;http:&#x2F;&#x2F;oh6j8wijn.bkt.clouddn.com&#x2F;133107859321201106e3c3ede9a13305.jpeg&quot; &quot;autoplay&quot; %&#125;&#96;</span><br><span class="line"></span><br><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>å¦‚æœä½ æƒ³åŠ å…¥æ­Œå•ï¼Œæ›´å¤šå‚æ•°çš„é…ç½®å¯ä»¥å‚ç…§<a href="https://github.com/MoePlayer/hexo-tag-aplayer">æ’ä»¶</a>çš„ä½¿ç”¨è¯´æ˜ã€‚</p><h2 id="å¦‚ä½•åœ¨æ–‡ç« é¡µæ’å…¥è§†é¢‘"><a href="#å¦‚ä½•åœ¨æ–‡ç« é¡µæ’å…¥è§†é¢‘" class="headerlink" title="å¦‚ä½•åœ¨æ–‡ç« é¡µæ’å…¥è§†é¢‘"></a>å¦‚ä½•åœ¨æ–‡ç« é¡µæ’å…¥è§†é¢‘</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">video</span> <span class="attr">src</span>=<span class="string">&quot;/media/Dream-It-Possible.mp4&quot;</span> <span class="attr">controls</span>=<span class="string">&quot;controls&quot;</span> <span class="attr">style</span>=<span class="string">&quot;max-width: 100%; display: block; margin-left: auto; margin-right: auto;&quot;</span>&gt;</span> Your browser does not support the video tag. <span class="tag">&lt;/<span class="name">video</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="å¦‚ä½•å¢åŠ â€œç›˜å¤ä¹‹ç™½â€"><a href="#å¦‚ä½•å¢åŠ â€œç›˜å¤ä¹‹ç™½â€" class="headerlink" title="å¦‚ä½•å¢åŠ â€œç›˜å¤ä¹‹ç™½â€"></a>å¦‚ä½•å¢åŠ â€œç›˜å¤ä¹‹ç™½â€</h2><blockquote><p>æœ‰ç ”ç©¶æ˜¾ç¤ºï¼Œæ‰“å­—çš„æ—¶å€™ä¸å–œæ¬¢åœ¨ä¸­æ–‡å’Œè‹±æ–‡ä¹‹é—´åŠ ç©ºæ ¼çš„äººï¼Œæ„Ÿæƒ…è·¯éƒ½èµ°å¾—å¾ˆè¾›è‹¦ï¼Œæœ‰ä¸ƒæˆçš„æ¯”ä¾‹ä¼šåœ¨ 34 å²çš„æ—¶å€™è·Ÿè‡ªå·±ä¸çˆ±çš„äººç»“å©šï¼Œè€Œå…¶ä½™ä¸‰æˆçš„äººæœ€ååªèƒ½æŠŠé—äº§ç•™ç»™è‡ªå·±çš„çŒ«ã€‚æ¯•ç«Ÿçˆ±æƒ…è·Ÿä¹¦å†™éƒ½éœ€è¦é€‚æ—¶åœ°ç•™ç™½ã€‚</p></blockquote><p>ä½¿ç”¨ <a href="https://github.com/hustcc/lint-md/tree/master/packages/lint-md-cli">lint-md</a> è§£å†³åšå®¢ä¸­è‹±æ–‡æ’ç‰ˆç©ºæ ¼çš„é—®é¢˜ï¼›<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">lint-md source\_posts\ -f</span><br></pre></td></tr></table></figure></p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><ol><li><a href="http://theme-next.iissnan.com/getting-started.html">å¼€å§‹ä½¿ç”¨ - NexT ä½¿ç”¨æ–‡æ¡£</a></li><li><a href="https://zhuanlan.zhihu.com/p/26625249">GitHub+Hexo æ­å»ºä¸ªäººç½‘ç«™è¯¦ç»†æ•™ç¨‹</a></li><li><a href="http://tc9011.com/2016/12/24/hexo%E6%B7%BB%E5%8A%A0%E9%9F%B3%E4%B9%90%E3%80%81high%E4%B8%80%E4%B8%8B%E5%8F%8A%E4%B8%80%E4%BA%9B%E5%9D%91/">hexo æ·»åŠ éŸ³ä¹ã€high ä¸€ä¸‹åŠä¸€äº›å‘ | tc9011â€™s</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> åšå®¢ä¸ªæ€§åŒ– </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> HOWTO </tag>
            
            <tag> åšå®¢ä¼˜åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½›ä¸å§‘å¨˜</title>
      <link href="blog/2017-11-11/choose-Buddha-or-gril/"/>
      <url>blog/2017-11-11/choose-Buddha-or-gril/</url>
      
        <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><p>é’ç¯ï¼Œå¤ä½›ã€‚å–é…’ã€åƒè‚‰ã€æ³¡å§‘å¨˜ã€‚<br>æˆ‘ç›˜åå‚äº†ä½ è¿™ä¹ˆé•¿çš„æ—¶é—´ï¼Œå´æ€»ä¸è§ä½ å‘è¨€ã€‚<br>ä½ è¯´äº”è•´çš†ç©ºã€‚å¯è°çš„å¿ƒé‡Œè¿˜ä¸è—ç€ä¸€ä¸ªä¸ç©¿è¡£æœçš„å§‘å¨˜ï¼›ä½ è¯´è§‚æ³•è‡ªåœ¨ï¼Œå¯é‚£å§‘å¨˜å¤œå¤œé’»æˆ‘çš„è¢«çªï¼Œåˆè®©æˆ‘å¦‚ä½•æ˜¯å¥½ï¼Ÿ<br><a id="more"></a></p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=298 height=52 src="//music.163.com/outchain/player?type=2&id=28308561&auto=1&height=32"></iframe><p>æˆ‘æƒ³äº†åˆæƒ³ï¼Œè¿˜æ˜¯æŠŠå¥¹åŠäº†å§ã€‚</p><p>ä½ çœ‹è¿™è‹ç”Ÿä¸‡ç‰©ï¼Œå¿™ç¢Œåœ°ç”Ÿï¼Œå¿™ç¢Œåœ°æ­»ã€‚ä½ ç¬‘ä»–ä»¬æ— çŸ¥æ— åŠ›ï¼Œæˆ‘ä»°ä½ ä¼Ÿå¤§æ…ˆæ‚²ã€‚ä½ å…³ç…§é‚£ä¹ˆå¤šçš„ç”Ÿæ­»ï¼Œæˆ‘å´åªå…³å¿ƒè‡ªå·±çš„çç¢ã€‚<br>ç´¢æ€§æˆ‘ä¹Ÿå¦èƒ¸éœ²ä¹³ï¼Œæˆ‘ä¹Ÿè£…å®ƒä¸ªå››å¤§çš†ç©ºã€‚</p><p>äºæ˜¯ï¼Œä½ æ˜¯ä¸æ˜¯ä¹Ÿè¯¥æ•™æˆ‘ä¸ªè’™äº‹çš„æ³•é—¨ï¼Ÿä¸€å¿µä¸€æ‰§ï¼Œå¿µå¥¹ä¸ªæ­»å¿ƒå¡Œåœ°ï¼Œæ‰§å¥¹ä¸ªæ‰§è¿·ä¸æ‚Ÿã€‚<br>ç®¡ä»–æ¬¢ä¹è¿˜æ˜¯ç—›è‹¦ï¼Œç®¡ä»–å–œæ‚¦è¿˜æ˜¯æ‚²ä¼¤ã€‚<br>èŠ±é—´ä¸€å£¶é…’ï¼Œå¯¹ç€æœˆäº®å–ä¸ªæ­»å»æ´»æ¥ï¼Œæ‘¸ç€å§‘å¨˜çš„å¤§è…¿å–ƒå–ƒé“ï¼šå§æ§½ï¼ŒçœŸæ˜¯éš¾å¾—ç³Šæ¶‚ã€‚</p><p>ç³Šæ¶‚ç€ï¼Œæˆ‘æŠ±ç€é‚£å§‘å¨˜åœ¨åºŠå•ä¸Šæ»šæ¥åˆæ»šå»ã€‚<br>ä½ æç€æ‰‹å°ç¬‘è€Œä¸è¯­åœ°çœ‹ç€æˆ‘ä»¬æ‰‹æ·«ã€‚<br>æˆ‘æƒ³ç€ç­‰å¤´å‘é•¿é•¿äº†ä¹Ÿå»çƒ«ä¸€å¤´å¦‚ä½ ä¸€æ ·äº”è•´çš†ç©ºçš„å¤´å‘ï¼ŒæŠ«ä¸Šä¸€èº«è¢ˆè£Ÿå’Œå§‘å¨˜æ‹‰ç€æ‰‹ç§å¥”â€”â€”ä¹Ÿè¿˜æ˜¯åœ¨ä½ çš„æ‰‹æŒå¿ƒé‡Œæ¸¸è¡ã€‚</p><p>è¯´çœŸçš„ï¼Œå¦‚æœä½ çˆ±æˆ‘å°±èµ¶å¿«å¸¦æˆ‘ç¦»å¼€ã€‚<br>å…¶å®ƒçš„ä¸œè¥¿éƒ½æ˜¯æ‰¯æ·¡ï¼Œæ‰¯å¤šäº†ä½ å°±æ˜¯è€æµæ°“ã€‚</p><p>è°è¯´é‡Šè¿¦è€çˆ·å­ä¸è€æµæ°“ï¼Ÿé‚£æ˜¯ä»–è‡ªå·±è¯´çš„ã€‚</p><p>æˆ‘æŠŠæœ¨é±¼æ•²ç¢ï¼ŒæŠŠè’²å›¢åç©¿ï¼Œåœ¨æ¢¦é‡ŒæŠŠä½ æ‘¸äº†ä¸€éåˆä¸€éã€‚<br>æˆ‘è„±äº†è¿™èº«è¡£æœå°±å·²ä¸å†æ˜¯æˆ‘ï¼Œæˆ‘ç©¿ä¸Šäº†è¡£æœè‡ªå·±å´æ€ä¹ˆä¹Ÿæ‰¾ä¸åˆ°äº†ã€‚</p><p>ä¸€æ—¶ï¼Œä½›åœ¨èˆå«å›½ï¼Œç ´è¡£çƒ‚é’µï¼šâ€œå¯æœ‰æ®‹ç¾¹æ–½èˆï¼Ÿâ€<br>ä¸€ä¸ªè¯´ï¼šâ€œå»å»å»ï¼Œå“ªé‡Œæ¥çš„å«èŠ±ï¼Œè¿™é‡Œäººäººéƒ½å¿™ç€å¯‚å¯ï¼Œå“ªæœ‰é—²å·¥å¤«ç†ä½ ã€‚â€<br>ä½›è¯´ï¼šâ€œå¯‚å¯è¿™ä¸ªä¸œè¥¿ï¼Œå¤šåŠæ˜¯å§‘å¨˜é—¹çš„ã€‚å¯åˆ°å“ªå»æ‰¾ä¸ªå§‘å¨˜ï¼Œä¸å¯è¯´ï¼Œä¸å¯è¯´ã€‚â€</p><p>è¯´åˆ°å¤´æ¥è¿˜æ˜¯è¯´åˆ°å§‘å¨˜ã€‚<br>æˆ‘å°±è¯´å¯‚å¯å°±ä»–å¦ˆæ˜¯ä¸ªå…‰ç€å¤§è…¿çš„å§‘å¨˜ï¼Œè®©ä½ çœ‹ç€åˆååä¸è®©ä½ æ‘¸ã€‚<br>çœ‹å¾—ä½ å¿ƒä¹Ÿç—’ç—’å˜´ä¹Ÿç—’ç—’ï¼Œæ€»æ†‹ç€æ³•åœ°æƒ³ä¸€äº›æ±¡è¨€ç§½è¯­æ¥æŒ‘é€—å¥¹ã€‚<br>å¯è¶Šæ˜¯æŒ‘é€—å¥¹å°±ç¦»ä½ è¶Šè¿‘ï¼Œç¦»ä½ è¶Šè¿‘å°±è¶Šä¸è®©ä½ æ‘¸ã€‚</p><p>æˆ‘è§‰å¾—ï¼Œè¿™å¾ˆæ“è›‹ã€‚</p><p>ä½›è¯´ï¼Œè¿™å°±æ˜¯æ³•å•Šï¼Œä½ æ˜çŸ¥å®ƒæ˜¯çœŸçš„å´æ€»ä¹ŸæŠ“ä¸ä½ï¼Œä½ åˆ†æ˜çœ‹ä¸åˆ°å´æ€»åœ¨ä½ èº«è¾¹è½¬ã€‚é€—ç€ä½ ï¼Œé¦‹ç€ä½ ï¼Œè¯´ä¸€äº›æ¼äººçš„è¯æ¥å‹¾å¼•ä½ ï¼Œæƒ¹ä½ ç”Ÿæ°”ï¼Œæƒ¹ä½ æ¬¢å–œã€‚</p><p>æˆ‘è¯´ï¼Œè¿™åˆ†æ˜æ˜¯è€æµæ°“ã€‚<br>ä½›è¯´ï¼Œå¯¹å‘€ï¼Œå°±æ˜¯è€æµæ°“ï¼Œä½ æŠŠæ¶æ ¹ä¸¢äº†ï¼ŒæŠŠæ‰§å¿µä¸¢äº†ï¼ŒæŠŠå¦„æƒ³ä¸¢äº†ï¼ŒæŠŠå§‘å¨˜ä¸¢äº†ï¼Œè„±å…‰äº†è¡£æœç«™è¡—ä¸Šï¼Œå°±ç«‹åœ°æˆä½›äº†ã€‚</p><p>æˆ‘è„±å…‰äº†è¡£æœç«™åœ¨è¡—ä¸Šï¼Œæ¥äº†ä¸¤ä¸ªæ¼‚äº®çš„å¥³è­¦å¯Ÿé—®æˆ‘åœ¨åšä»€ä¹ˆã€‚<br>æˆ‘è¯´ï¼Œæˆ‘ç«‹åœ°æˆä½›ï¼Œç„¶ååº¦ä½ ä»¬å‡ºè‹¦å„ã€‚<br>å¥¹ä»¬éè¦æŠŠæˆ‘æŠ“èµ°ï¼Œæˆ‘è¯´æˆ‘<strong>æ—¥</strong>ä½ ä»¬è€æ¯ï¼ï¼ï¼</p><p>ä½›ç¬‘äº†ï¼Œååœ¨è¿œè¿œçš„äº‘ç«¯ï¼Œè²èŠ±å°ä¸Šã€‚<br>æˆ‘è¯´è¿™ä¸ç§‘å­¦ï¼Œä¼—ç”Ÿå¤ªæ‰§ï¼Œå§‘å¨˜åˆå¤ªç¾ï¼Œæ•™äººæ€ä¹ˆåº¦ï¼Œæ€ä¹ˆä¸ªæ— æ¬²æ— æ±‚ã€‚<br>ä½›æ‰“äº†ä¸ªå“ˆæ¬ ï¼Œå°±æ²¡å†è¯´ä»€ä¹ˆã€‚</p><p>æˆ‘è§‰å¾—è¿™æœ‰äº›æ‰¯ï¼Œä½†è¿˜æ˜¯è€ç€æ€§å­æ€ç´¢ä¸€äº›äº‹æƒ…ã€‚<br>æœ€åæˆ‘å†³å®šï¼Œè¿˜æ˜¯æŠŠé‚£ä¸ªå‹¾å¼•æˆ‘çš„å°å¨˜ä»¬ç»™åŠäº†ã€‚</p><p>åŠå¥¹ä¸ªäº”è•´çš†ç©ºï¼Œåº¦å¥¹å‡ºå¯‚å¯çš„è‹¦å„ã€‚</p><blockquote><p>ä½ æ€»æœ‰ä¸€å¤©è¦è·Ÿè¿‡å»æ‰€æœ‰çš„è®°å¿†ç›¸å®‰æ— äº‹åœ°æ¡æ‰‹è¨€å’Œã€‚é‚£é‡Œé¢æœ‰ä½ æœ‰å¥¹ï¼Œæœ‰å¥¹ç•™ä¸‹æ¥çš„æ¸©è½¯å¹´åä¹Ÿæœ‰ä½ çš„é²œè¡£æ€’é©¬ã€‚é‚£ä¸ªäººæ°¸è¿œæ´»åœ¨æ—¶é—´é‡Œäº†ï¼Œä½ æŠŠå¥¹æ‹‰ä¸å‡ºæ¥ï¼Œè‡ªå·±ä¹Ÿå›ä¸å»ã€‚å°±è¿™æ ·å§ï¼Œè®©å¥¹å®‰é™åœ°ç•™åœ¨é‚£é‡Œã€‚å¥¹ä¸ä¼šå‘ç¦ï¼Œä¸ä¼šè€å»ï¼Œä¸ä¼šåµé—¹ï¼Œä¸ä¼šç©¿ç€èŒä¸šå¥—è£…é«˜è·Ÿé‹ï¼Œä¸ä¼šå¸¦ç€å®¶é•¿é‡ŒçŸ­æŸ´æ²¹ç±³é†‹çš„æ°”æ¯ï¼Œå¥¹æ°¸è¿œå¹´è½»æ°¸è¿œæ¼‚äº®ï¼Œç©¿ç€é²œè‰³é•¿è£™ã€æŠ«ç€åˆšæŸ“çš„å¾®å·é•¿å‘ç«™åœ¨å›å¿†é‡Œå¯¹ç€ä½ ç¬‘é¥å¦‚èŠ±ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> æ‚¦è¯» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¾æ–‡ </tag>
            
            <tag> é˜…è¯» </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
